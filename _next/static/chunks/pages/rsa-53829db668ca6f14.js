(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5375],{15200:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/rsa",function(){return t(99710)}])},31831:function(e,n,t){"use strict";var r=t(85893),l=t(67294),o=t(95982),i=t(13029),s=t(46901),a=t(20745),c=t(2734);let u=l.forwardRef(function(e,n){return(0,r.jsx)(s.Z,{elevation:6,ref:n,variant:"filled",...e})});function d(e){var n;let t=(0,c.Z)(),[s,a]=(0,l.useState)(!0);return(0,l.useEffect)(()=>{setTimeout(()=>{a(!1)},2e3)},[]),(0,r.jsx)(i.Z,{anchorOrigin:{vertical:"top",horizontal:"center"},open:s,sx:{zIndex:t.zIndex.snackbar+100},children:(0,r.jsx)(u,{sx:{borderRadius:"0","&.MuiAlert-filledSuccess":{backgroundColor:o.T$}},icon:!1,color:null==e?void 0:e.color,children:null!==(n=null==e?void 0:e.content)&&void 0!==n?n:""})},"top-center-warning")}function x(e){let n=document.createElement("div");document.body.appendChild(n),n.id="warning-window",n.style.zIndex="-2",(0,a.createRoot)(n).render((0,r.jsx)(d,{...e})),setTimeout(()=>{n.remove()},3e3)}n.Z={success:e=>x({color:"success",content:e}),warning:e=>x({color:"warning",content:e}),error:e=>x({color:"error",content:e})}},43197:function(e,n,t){"use strict";var r=t(85893),l=t(70671),o=t(88613),i=t(47023),s=t(37375),a=t(55343),c=t(51233),u=t(5616),d=t(15861),x=t(25662),p=t(67294);n.Z=e=>{let{children:n,sx:t,fullScreen:h=!0}=e,{path:m}=(0,o.hI)(),[g]=p.useState(s.Z.find(e=>e.path===m));return(0,p.useEffect)(()=>{let e=e=>{if(!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)){let e=document.getElementById("fullscreen-element"),n=document.getElementById("rivers-header");e&&(e.style.position="unset",e.style.inset="0",e.style.maxWidth="unset",e.style.padding="0",n&&(n.style.display="block"))}};return document.addEventListener("fullscreenchange",e),document.addEventListener("webkitfullscreenchange",e),document.addEventListener("mozfullscreenchange",e),document.addEventListener("MSFullscreenChange",e),()=>{document.removeEventListener("fullscreenchange",e),document.removeEventListener("webkitfullscreenchange",e),document.removeEventListener("mozfullscreenchange",e),document.removeEventListener("MSFullscreenChange",e)}},[]),(0,r.jsxs)(c.Z,{sx:{px:"50px",py:2,overflow:"auto",flex:1,borderRadius:"8px",background:"#fff",boxShadow:"0px 0px 2px 0px rgba(145,158,171,0.2), 0px 12px 24px -4px rgba(145,158,171,0.12)",...t},children:[(0,r.jsxs)(c.Z,{direction:"row",justifyContent:"space-between",children:[(0,r.jsx)(u.Z,{children:(0,r.jsx)(d.Z,{sx:{mb:"0px",fontWeight:600,color:l.Z2,fontSize:"20px"},gutterBottom:!0,variant:"subtitle1",component:"div",children:null==g?void 0:g.label})}),(0,r.jsx)(c.Z,{direction:"row",sx:{fontFamily:"Mono"},children:i.i.filter(e=>null==g?void 0:g.tags.includes(e.name)).map(e=>(0,r.jsx)(u.Z,{sx:{height:"24px",lineHeight:"24px",fontSize:"12px",background:"rgba(52,90,255,0.1)",color:"#345AFF",px:1,borderRadius:1,ml:1},children:e.label},e.name))})]}),(0,r.jsxs)(c.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{position:"relative",width:"100%",alignSelf:"stretch",mb:"24px"},children:[(0,r.jsx)(d.Z,{variant:"caption",sx:{display:"inline-block",maxWidth:"100%",pl:"6px",color:"rgba(11,37,98,0.5)",background:"rgba(11,37,98,0.04)",borderRadius:1,lineHeight:"24px"},children:null==g?void 0:g.subTitle}),h?(0,r.jsx)(x.Z,{size:"small",onClick:()=>{let e=document.body;new Promise(n=>{(null==e?void 0:e.requestFullscreen)?n(e.requestFullscreen()):(null==e?void 0:e.mozRequestFullScreen)?n(null==e?void 0:e.mozRequestFullScreen()):(null==e?void 0:e.webkitRequestFullscreen)?n(null==e?void 0:e.webkitRequestFullscreen()):(null==e?void 0:e.msRequestFullscreen)&&n(null==e?void 0:e.msRequestFullscreen())}).then(()=>{let e=document.getElementById("fullscreen-element"),n=document.getElementById("rivers-header");e&&(e.style.position="fixed",e.style.inset="0",e.style.maxWidth="100vw",e.style.background="#fff",e.style.padding="84px 14px 14px 14px",n&&(n.style.display="none"))})},sx:{borderRadius:"4px",height:"24px"},variant:"outlined",startIcon:(0,r.jsx)(a.Z,{}),children:"全屏"}):null]}),(0,r.jsx)(c.Z,{id:"fullscreen-element",sx:{gap:"18px",maxWidth:"1020px",fontFamily:"Mono",mx:"auto",flex:1,width:"100%"},children:n})]})}},99710:function(e,n,t){"use strict";t.r(n);var r=t(85893),l=t(43197),o=t(45670),i=t(66568),s=t(5616),a=t(40044),c=t(51233),u=t(40476),d=t(68061),x=t(50480),p=t(36872),h=t(61903),m=t(25662),g=t(64666),v=t(37645),Z=t(6514),f=t(58951),b=t(31425),j=t(67294),y=t(22079),w=t.n(y),E=t(31831);n.default=()=>{let[e,n]=j.useState("encrypt"),[t,y]=j.useState(2048),[S,k]=j.useState(""),[C,P]=j.useState(""),[I,R]=j.useState(""),[B,F]=j.useState(""),[K,A]=j.useState("OAEP"),[T,z]=j.useState("Base64"),[N,O]=j.useState(!1),[_,q]=j.useState({}),[H,L]=j.useState(!1);function W(e){switch(e){case"PKCS1":return"RSAES-PKCS1-V1_5";case"OAEP":default:return"RSA-OAEP";case"Raw":return"RAW"}}function M(e){return""===e?null:w().pki.publicKeyFromPem(e)}function Y(e){return""===e?null:w().pki.privateKeyFromPem(e)}let U=async()=>{O(!0),w().pki.rsa.generateKeyPair({bits:t,e:65537,workers:1},function(e,n){e?(console.log(e),E.Z.error("密钥生成失败！")):(k(w().pki.publicKeyToPem(n.publicKey)),P(w().pki.privateKeyToPem(n.privateKey))),O(!1)})},V=e=>{k(e.target.value)},D=e=>{P(e.target.value)};return(0,r.jsx)(l.Z,{children:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.ZP,{value:e,children:(0,r.jsx)(s.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,r.jsxs)(i.Z,{onChange:(e,t)=>{n(t),"encrypt"===t&&F(""),"decrypt"===t&&R(""),"generate"===t&&(y(2048),F(""),R(""),k(""),P(""),O(!1))},children:[(0,r.jsx)(a.Z,{label:"加密",value:"encrypt",sx:{textTransform:"none !important"}}),(0,r.jsx)(a.Z,{label:"解密",value:"decrypt",sx:{textTransform:"none !important"}}),(0,r.jsx)(a.Z,{label:"生成密钥",value:"generate",sx:{textTransform:"none !important"}})]})})}),"generate"!==e&&(0,r.jsxs)(c.Z,{direction:"row",children:[(0,r.jsx)(u.Z,{sx:{lineHeight:"42px",width:"100px",color:"rgba(0, 0, 0, 0.87)"},children:"填充"}),(0,r.jsxs)(d.Z,{row:!0,value:K,onChange:e=>{A(e.target.value)},children:[(0,r.jsx)(x.Z,{value:"OAEP",control:(0,r.jsx)(p.Z,{}),label:"OAEP"}),(0,r.jsx)(x.Z,{value:"PKCS1",control:(0,r.jsx)(p.Z,{}),label:"PKCS1"}),(0,r.jsx)(x.Z,{value:"Raw",control:(0,r.jsx)(p.Z,{}),label:"Raw"})]})]}),"generate"!==e&&(0,r.jsxs)(c.Z,{direction:"row",children:[(0,r.jsx)(u.Z,{sx:{lineHeight:"42px",width:"100px",color:"rgba(0, 0, 0, 0.87)"},children:"编码"}),(0,r.jsxs)(d.Z,{row:!0,value:T,onChange:e=>{z(e.target.value)},children:[(0,r.jsx)(x.Z,{value:"Base64",control:(0,r.jsx)(p.Z,{}),label:"Base64"}),(0,r.jsx)(x.Z,{value:"Hex",control:(0,r.jsx)(p.Z,{}),label:"Hex"})]})]}),"generate"===e&&(0,r.jsxs)(c.Z,{direction:"row",children:[(0,r.jsx)(u.Z,{sx:{lineHeight:"42px",width:"100px",color:"rgba(0, 0, 0, 0.87)"},children:"Key Size"}),(0,r.jsxs)(d.Z,{row:!0,value:t,onChange:e=>{y(Number(e.target.value))},children:[(0,r.jsx)(x.Z,{value:"1024",control:(0,r.jsx)(p.Z,{}),label:"1024 bits"}),(0,r.jsx)(x.Z,{value:"2048",control:(0,r.jsx)(p.Z,{}),label:"2048 bits"}),(0,r.jsx)(x.Z,{value:"3072",control:(0,r.jsx)(p.Z,{}),label:"3072 bits"}),(0,r.jsx)(x.Z,{value:"4096",control:(0,r.jsx)(p.Z,{}),label:"4096 bits"})]})]}),"generate"!==e&&(0,r.jsxs)(c.Z,{direction:"column",spacing:2,sx:{mt:2},children:[(0,r.jsx)(h.Z,{label:"encrypt"===e?"公钥 (PEM格式)":"私钥 (PEM格式)",placeholder:"encrypt"===e?"-----BEGIN PUBLIC KEY-----\n...\n-----END PUBLIC KEY-----":"-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----",multiline:!0,rows:4,fullWidth:!0,margin:"normal",variant:"outlined",value:"encrypt"===e?S:C,onChange:"encrypt"===e?V:D}),(0,r.jsx)(h.Z,{label:"明文",placeholder:"请输入要加密的明文",multiline:!0,rows:4,fullWidth:!0,margin:"normal",variant:"outlined",value:I,onChange:e=>{R(e.target.value)},sx:{display:"encrypt"===e?"block":"none"}}),(0,r.jsx)(h.Z,{label:"密文",placeholder:"请输入要解密的密文",multiline:!0,rows:4,fullWidth:!0,margin:"normal",variant:"outlined",value:B,onChange:e=>{F(e.target.value)},sx:{display:"decrypt"===e?"block":"none"}}),(0,r.jsxs)(c.Z,{direction:"row",spacing:16,sx:{mt:2,justifyContent:"center"},children:[(0,r.jsx)(m.Z,{variant:"contained",onClick:"encrypt"===e?()=>{F(function(e,n,t,r){var l,o=M(n);if(null===o)return E.Z.error("请输入公钥！"),"";if(""===e)return E.Z.error("请输入明文！"),"";e=w().util.encodeUtf8(e);try{l=o.encrypt(e,W(t))}catch(e){return console.log(e),E.Z.error("加密失败！"),""}switch(r){case"Hex":return w().util.bytesToHex(l);case"Base64":return w().util.encode64(l);default:return E.Z.error("未知的编码格式！"),""}}(I,S,K,T))}:()=>{R(function(e,n,t,r){var l,o,i=Y(n);if(null===i)return E.Z.error("请输入私钥！"),"";if(""===e)return E.Z.error("请输入密文！"),"";switch(r){case"Hex":if(!/^[0-9A-Fa-f]+$/.test(e))return E.Z.error("Hex 编码格式错误！"),"";l=w().util.hexToBytes(e);break;case"Base64":if(!/^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(e))return E.Z.error("Base64 编码格式错误！"),"";l=w().util.decode64(e);break;default:return E.Z.error("未知的编码格式！"),""}try{o=i.decrypt(l,W(t))}catch(e){return console.log(e),E.Z.error("解密失败！"),""}return w().util.decodeUtf8(o.replace(/^\0+/,""))}(B,C,K,T))},sx:{alignSelf:"start"},children:"encrypt"===e?"加密":"解密"}),(0,r.jsx)(m.Z,{variant:"contained",onClick:"encrypt"===e?()=>{try{let e=M(S);if(e){let n={n:e.n.toString(),e:e.e.toString()};q(n),L(!0)}}catch(e){console.log(e),E.Z.error("请输入正确公钥！")}}:()=>{try{let e=Y(C);if(e){let n={n:e.n.toString(),e:e.e.toString(),d:e.d.toString(),p:e.p.toString(),q:e.q.toString(),dP:e.dP.toString(),dQ:e.dQ.toString(),qInv:e.qInv.toString()};q(n),L(!0)}}catch(e){console.log(e),E.Z.error("请输入正确私钥！")}},sx:{alignSelf:"start"},children:"encrypt"===e?"解析公钥":"解析私钥"})]}),(0,r.jsx)(h.Z,{label:"encrypt"===e?"密文":"明文",placeholder:"encrypt"===e?"加密结果":"解密结果",multiline:!0,rows:4,fullWidth:!0,margin:"normal",variant:"outlined",value:"encrypt"===e?B:I,InputProps:{readOnly:!0}})]}),"generate"===e&&(0,r.jsx)(c.Z,{direction:"column",spacing:2,sx:{mt:2},children:(0,r.jsx)(m.Z,{variant:"contained",onClick:U,sx:{alignSelf:"start"},children:N?"请等待密钥生成...":"生成密钥"})}),"generate"===e&&(0,r.jsxs)(c.Z,{direction:"column",spacing:2,sx:{mt:2},children:[(0,r.jsx)(h.Z,{label:"公钥 (PEM格式)",placeholder:"-----BEGIN PUBLIC KEY-----\n...\n-----END PUBLIC KEY-----",multiline:!0,rows:4,fullWidth:!0,margin:"normal",variant:"outlined",value:S,onChange:V,InputProps:{readOnly:!0}}),(0,r.jsx)(h.Z,{label:"私钥 (PEM格式)",placeholder:"-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----",multiline:!0,rows:4,fullWidth:!0,margin:"normal",variant:"outlined",value:C,onChange:D,InputProps:{readOnly:!0}})]}),(0,r.jsxs)(g.Z,{open:H,onClose:()=>L(!1),children:[(0,r.jsx)(v.Z,{children:"密钥信息"}),(0,r.jsx)(Z.Z,{dividers:!0,sx:{overflowY:"auto",maxHeight:"200px"},children:Object.entries(_).map(e=>{let[n,t]=e;return(0,r.jsxs)(f.Z,{sx:{wordBreak:"break-all"},children:[(0,r.jsxs)("strong",{children:[n," = "]})," ",t]},n)})}),(0,r.jsxs)(b.Z,{children:[(0,r.jsx)(m.Z,{onClick:()=>{let e=Object.entries(_).map(e=>{let[n,t]=e;return"".concat(n," = ").concat(t)}).join("\n");navigator.clipboard&&window.isSecureContext&&navigator.clipboard.writeText(e).then(()=>{E.Z.success("密钥信息已复制到剪贴板！")}).catch(e=>{E.Z.error("复制到剪贴板失败！")}),E.Z.error("复制到剪贴板失败！")},children:"复制信息"}),(0,r.jsx)(m.Z,{onClick:()=>L(!1),children:"关闭"})]})]})]})})}},62678:function(){},25819:function(){},24112:function(){}},function(e){e.O(0,[9912,9266,5739,5953,9774,2888,179],function(){return e(e.s=15200)}),_N_E=e.O()}]);