"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3522],{8198:function(e,t,n){n.r(t),n.d(t,{Button:function(){return wy},DefaultSidebar:function(){return EO},Excalidraw:function(){return CW},FONT_FAMILY:function(){return em},Footer:function(){return Cv},LiveCollaborationTrigger:function(){return CB},MIME_TYPES:function(){return eC},MainMenu:function(){return ED},Sidebar:function(){return wM},THEME:function(){return ep},TTDDialog:function(){return E9},TTDDialogTrigger:function(){return CF},WelcomeScreen:function(){return Cz},bumpVersion:function(){return g0},convertToExcalidrawElements:function(){return SH},defaultLang:function(){return x},elementPartiallyOverlapsWithOrContainsBBox:function(){return p5},elementsOverlappingBBox:function(){return p8},exportToBlob:function(){return gh},exportToCanvas:function(){return gc},exportToClipboard:function(){return gu},exportToSvg:function(){return gm},getCommonBounds:function(){return m6},getFreeDrawSvgPath:function(){return ms},getNonDeletedElements:function(){return fk},getSceneVersion:function(){return fE},getVisibleSceneBounds:function(){return ue},isElementInsideBBox:function(){return p4},isInvisiblySmallElement:function(){return g2},isLinearElement:function(){return nN},languages:function(){return y},loadFromBlob:function(){return pr},loadLibraryFromBlob:function(){return ps},loadSceneOrLibraryFromBlob:function(){return pl},mergeLibraryItems:function(){return gr},mutateElement:function(){return gQ},newElementWith:function(){return g1},normalizeLink:function(){return aG},parseLibraryTokensFromUrl:function(){return go},restore:function(){return uz},restoreAppState:function(){return uO},restoreElements:function(){return u_},restoreLibraryItems:function(){return uB},sceneCoordsToViewportCoords:function(){return t3},serializeAsJSON:function(){return pE},serializeLibraryAsJSON:function(){return pM},useDevice:function(){return k4},useHandleLibrary:function(){return gd},useI18n:function(){return M},viewportCoordsToSceneCoords:function(){return t2},zoomToFitBounds:function(){return cG}});var i=n(70024),l=n(67294),r=n(84852),a=n(87912),s=n(85893),o=n(79495),d=n(75872),c=n(46890),h=n(73869),m=n(17967);n(49548);var u,p,g,f,x,y,b,v,w,E,S,k,C,I,M,j,T,L,D,A,P,_,R,N,O,z,H,B,F,$,Z,W,U,G,V,K,Y,X,q,J,Q,ee,et,en,ei,el,er,ea,es,eo,ed,ec,eh,em,eu,ep,eg,ef,ex,ey,eb,ev,ew,eE,eS,ek,eC,eI,eM,ej,eT,eL,eD,eA,eP,e_,eR,eN,eO,ez,eH,eB,eF,e$,eZ,eW,eU,eG,eV,eK,eY,eX,eq,eJ,eQ,e1,e0,e2,e3,e6,e4,e5,e8,e7,e9,te,tt,tn,ti,tl,tr,ta,ts,to=n(46597),td=n(42005),tc=n(73935),th=n(56352),tm=n(32912),tu=n(20913),tp=n(93187),tg=n(25901),tf=n(9041),tx=n(58749),ty=n(9986),tb=n(43824),tv=n(93096),tw=n(11031),tE=n(27135),tS=Object.defineProperty,tk=e=>t=>{var n=e[t];if(n)return n();throw Error("Module not found in bundle: "+t)},tC=(e,t)=>()=>(e&&(t=e(e=0)),t),tI=(e,t)=>{for(var n in t)tS(e,n,{get:t[n],enumerable:!0})},tM=tC(()=>{u={PROD:!0}}),tj=tC(()=>{tM(),p=Symbol(),g=(0,i.Vv)()}),tT=tC(()=>{f=tk({"./locales/ar-SA.json":()=>n.e(4962).then(n.t.bind(n,64962,17)),"./locales/az-AZ.json":()=>n.e(9187).then(n.t.bind(n,69187,17)),"./locales/bg-BG.json":()=>n.e(225).then(n.t.bind(n,40225,17)),"./locales/bn-BD.json":()=>n.e(1260).then(n.t.bind(n,41260,17)),"./locales/ca-ES.json":()=>n.e(8087).then(n.t.bind(n,68087,17)),"./locales/cs-CZ.json":()=>n.e(8283).then(n.t.bind(n,58148,17)),"./locales/da-DK.json":()=>n.e(4539).then(n.t.bind(n,4539,17)),"./locales/de-DE.json":()=>n.e(3824).then(n.t.bind(n,6646,17)),"./locales/el-GR.json":()=>n.e(2239).then(n.t.bind(n,2239,17)),"./locales/en.json":()=>Promise.resolve().then(n.t.bind(n,84852,17)),"./locales/es-ES.json":()=>n.e(9571).then(n.t.bind(n,69571,17)),"./locales/eu-ES.json":()=>n.e(540).then(n.t.bind(n,540,17)),"./locales/fa-IR.json":()=>n.e(870).then(n.t.bind(n,60870,17)),"./locales/fi-FI.json":()=>n.e(2685).then(n.t.bind(n,62685,17)),"./locales/fr-FR.json":()=>n.e(7894).then(n.t.bind(n,27894,17)),"./locales/gl-ES.json":()=>n.e(6722).then(n.t.bind(n,26722,17)),"./locales/he-IL.json":()=>n.e(1501).then(n.t.bind(n,41501,17)),"./locales/hi-IN.json":()=>n.e(2500).then(n.t.bind(n,92500,17)),"./locales/hu-HU.json":()=>n.e(2629).then(n.t.bind(n,32629,17)),"./locales/id-ID.json":()=>n.e(7550).then(n.t.bind(n,57550,17)),"./locales/it-IT.json":()=>n.e(7229).then(n.t.bind(n,37229,17)),"./locales/ja-JP.json":()=>n.e(5956).then(n.t.bind(n,25956,17)),"./locales/kaa.json":()=>n.e(3927).then(n.t.bind(n,73927,17)),"./locales/kab-KAB.json":()=>n.e(9163).then(n.t.bind(n,89163,17)),"./locales/kk-KZ.json":()=>n.e(7484).then(n.t.bind(n,67484,17)),"./locales/km-KH.json":()=>n.e(4938).then(n.t.bind(n,74938,17)),"./locales/ko-KR.json":()=>n.e(9115).then(n.t.bind(n,29115,17)),"./locales/ku-TR.json":()=>n.e(1648).then(n.t.bind(n,42574,17)),"./locales/lt-LT.json":()=>n.e(9848).then(n.t.bind(n,29848,17)),"./locales/lv-LV.json":()=>n.e(2757).then(n.t.bind(n,62757,17)),"./locales/mr-IN.json":()=>n.e(4241).then(n.t.bind(n,34241,17)),"./locales/my-MM.json":()=>n.e(1163).then(n.t.bind(n,89659,17)),"./locales/nb-NO.json":()=>n.e(6428).then(n.t.bind(n,96428,17)),"./locales/nl-NL.json":()=>n.e(6621).then(n.t.bind(n,96621,17)),"./locales/nn-NO.json":()=>n.e(4725).then(n.t.bind(n,44725,17)),"./locales/oc-FR.json":()=>n.e(9336).then(n.t.bind(n,19336,17)),"./locales/pa-IN.json":()=>n.e(3743).then(n.t.bind(n,43743,17)),"./locales/percentages.json":()=>Promise.resolve().then(n.t.bind(n,87912,17)),"./locales/pl-PL.json":()=>n.e(6587).then(n.t.bind(n,46587,17)),"./locales/pt-BR.json":()=>n.e(530).then(n.t.bind(n,70530,17)),"./locales/pt-PT.json":()=>n.e(3276).then(n.t.bind(n,33276,17)),"./locales/ro-RO.json":()=>n.e(7830).then(n.t.bind(n,77830,17)),"./locales/ru-RU.json":()=>n.e(345).then(n.t.bind(n,80345,17)),"./locales/si-LK.json":()=>n.e(3112).then(n.t.bind(n,63112,17)),"./locales/sk-SK.json":()=>n.e(5005).then(n.t.bind(n,5005,17)),"./locales/sl-SI.json":()=>n.e(2e3).then(n.t.bind(n,52e3,17)),"./locales/sv-SE.json":()=>n.e(423).then(n.t.bind(n,10423,17)),"./locales/ta-IN.json":()=>n.e(1238).then(n.t.bind(n,91238,17)),"./locales/th-TH.json":()=>n.e(2349).then(n.t.bind(n,92349,17)),"./locales/tr-TR.json":()=>n.e(2834).then(n.t.bind(n,72834,17)),"./locales/uk-UA.json":()=>n.e(4768).then(n.t.bind(n,64768,17)),"./locales/vi-VN.json":()=>n.e(4162).then(n.t.bind(n,54162,17)),"./locales/zh-CN.json":()=>n.e(9033).then(n.t.bind(n,70042,17)),"./locales/zh-HK.json":()=>n.e(9430).then(n.t.bind(n,39430,17)),"./locales/zh-TW.json":()=>n.e(8106).then(n.t.bind(n,28106,17))})}),tL=tC(()=>{tM(),tj(),tT(),y=[x={code:"en",label:"English"},...[{code:"ar-SA",label:"العربية",rtl:!0},{code:"bg-BG",label:"Български"},{code:"ca-ES",label:"Catal\xe0"},{code:"cs-CZ",label:"Česky"},{code:"de-DE",label:"Deutsch"},{code:"el-GR",label:"Ελληνικά"},{code:"es-ES",label:"Espa\xf1ol"},{code:"eu-ES",label:"Euskara"},{code:"fa-IR",label:"فارسی",rtl:!0},{code:"fi-FI",label:"Suomi"},{code:"fr-FR",label:"Fran\xe7ais"},{code:"gl-ES",label:"Galego"},{code:"he-IL",label:"עברית",rtl:!0},{code:"hi-IN",label:"हिन्दी"},{code:"hu-HU",label:"Magyar"},{code:"id-ID",label:"Bahasa Indonesia"},{code:"it-IT",label:"Italiano"},{code:"ja-JP",label:"日本語"},{code:"kab-KAB",label:"Taqbaylit"},{code:"kk-KZ",label:"Қазақ тілі"},{code:"ko-KR",label:"한국어"},{code:"ku-TR",label:"Kurd\xee"},{code:"lt-LT",label:"Lietuvių"},{code:"lv-LV",label:"Latviešu"},{code:"my-MM",label:"Burmese"},{code:"nb-NO",label:"Norsk bokm\xe5l"},{code:"nl-NL",label:"Nederlands"},{code:"nn-NO",label:"Norsk nynorsk"},{code:"oc-FR",label:"Occitan"},{code:"pa-IN",label:"ਪੰਜਾਬੀ"},{code:"pl-PL",label:"Polski"},{code:"pt-BR",label:"Portugu\xeas Brasileiro"},{code:"pt-PT",label:"Portugu\xeas"},{code:"ro-RO",label:"Rom\xe2nă"},{code:"ru-RU",label:"Русский"},{code:"sk-SK",label:"Slovenčina"},{code:"sv-SE",label:"Svenska"},{code:"sl-SI",label:"Slovenščina"},{code:"tr-TR",label:"T\xfcrk\xe7e"},{code:"uk-UA",label:"Українська"},{code:"zh-CN",label:"简体中文"},{code:"zh-TW",label:"繁體中文"},{code:"vi-VN",label:"Tiếng Việt"},{code:"mr-IN",label:"मराठी"}].filter(e=>a[e.code]>=85).sort((e,t)=>e.label>t.label?1:-1)],b="__test__",u.DEV&&y.unshift({code:b,label:"test language"},{code:`${b}.rtl`,label:"‪test language (rtl)‬",rtl:!0}),v=x,w={},E=async e=>{if(v=e,document.documentElement.dir=v.rtl?"rtl":"ltr",document.documentElement.lang=v.code,e.code.startsWith(b))w={};else try{w=await f(`./locales/${v.code}.json`)}catch(t){console.error(`Failed to load language ${e.code}:`,t.message),w=r}g.set(I,e.code)},S=()=>v,k=(e,t)=>{for(let n=0;n<t.length;++n){let i=t[n];if(void 0===e[i])return;e=e[i]}if("string"==typeof e)return e},C=(e,t,n)=>{if(v.code.startsWith(b))return`\u202A[[${t?`${e}(${JSON.stringify(t).slice(1,-1)})`:e}]]\u202C`;let i=e.split("."),l=k(w,i)||k(r,i)||n;if(void 0===l){let t=`Can't find translation for ${e}`;if(u.PROD)return console.warn(t),"";throw Error(t)}if(t)for(let e in t)l=l.replace(`{{${e}}}`,String(t[e]));return l},I=(0,i.cn)(x.code),M=()=>{let e=(0,i.Dv)(I,p);return{t:C,langCode:e}}}),tD=tC(()=>{}),tA=tC(()=>{tM(),tD(),j=({size:e="1em",circleWidth:t=8,synchronized:n=!1})=>{let i=-(l.useRef(Date.now()).current%1600);return(0,s.jsx)("div",{className:"Spinner",children:(0,s.jsx)("svg",{viewBox:"0 0 100 100",style:{width:e,height:e,"--spinner-delay":n?`${i}ms`:0},children:(0,s.jsx)("circle",{cx:"50",cy:"50",r:50-t/2,strokeWidth:t,fill:"none",strokeMiterlimit:"10"})})})}}),tP=tC(()=>{T={}}),t_=tC(()=>{tM(),L=(e,t)=>t.reduce((t,n)=>(n in e&&(t[n]=e[n]),t),{}),D=5,A=5,P=4,_=4,R=1,N=[0,2,4,6,8],z={transparent:"transparent",black:"#1e1e1e",white:"#ffffff",gray:(O=(e,t)=>t.map(t=>o[e][t]))("gray",N),red:O("red",N),pink:O("pink",N),grape:O("grape",N),violet:O("violet",N),blue:O("blue",N),cyan:O("cyan",N),teal:O("teal",N),green:O("green",N),yellow:O("yellow",N),orange:O("orange",N),bronze:["#f8f1ee","#eaddd7","#d2bab0","#a18072","#846358"]},H=L(z,["cyan","blue","violet","grape","pink","green","teal","yellow","orange","red"]),B=[z.black,z.red[_],z.green[_],z.blue[_],z.yellow[_]],F=[z.transparent,z.red[R],z.green[R],z.blue[R],z.yellow[R]],$=[z.white,"#f8f9fa","#f5faff","#fffce8","#fdf8f6"],Z={transparent:z.transparent,white:z.white,gray:z.gray,black:z.black,bronze:z.bronze,...H},W={transparent:z.transparent,white:z.white,gray:z.gray,black:z.black,bronze:z.bronze,...H},U=e=>[z.cyan[e],z.blue[e],z.violet[e],z.grape[e],z.pink[e],z.green[e],z.teal[e],z.yellow[e],z.orange[e],z.red[e]],G=(e,t,n)=>`#${(16777216+(e<<16)+(t<<8)+n).toString(16).slice(1)}`}),tR=tC(()=>{tM(),tP(),t_(),V=/Mac|iPod|iPhone|iPad/.test(navigator.platform),K=/^Win/.test(navigator.platform),/\b(android)\b/i.test(navigator.userAgent),Y="netscape"in window&&navigator.userAgent.indexOf("rv:")>1&&navigator.userAgent.indexOf("Gecko")>1,X=!(-1!==navigator.userAgent.indexOf("Chrome"))&&-1!==navigator.userAgent.indexOf("Safari"),q=/iPad|iPhone/.test(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document,J=()=>navigator.brave?.isBrave?.name==="isBrave",Q="Excalidraw",ee=10,et=8,en=5,ei=1,el=30,er=Math.PI/12,ea={TEXT:"text",CROSSHAIR:"crosshair",GRABBING:"grabbing",GRAB:"grab",POINTER:"pointer",MOVE:"move",AUTO:""},es={MAIN:0,WHEEL:1,SECONDARY:2,TOUCH:-1,ERASER:5},eo={enabled:"all",disabled:"none",inheritFromUI:"var(--ui-pointerEvents)"},ed={UNSTARTED:-1,ENDED:0,PLAYING:1,PAUSED:2,BUFFERING:3,CUED:5},ec={TEST:"test",DEVELOPMENT:"development"},eh={SHAPE_ACTIONS_MENU:"App-menu__left"},eu={[(em={Virgil:1,Helvetica:2,Cascadia:3,Assistant:4}).Virgil]:"YaoSuiXinShouXieTi"},ep={LIGHT:"light",DARK:"dark"},eg={strokeColor:"#bbb",strokeWidth:2,strokeStyle:"solid",fillStyle:"solid",roughness:0,roundness:null,backgroundColor:"transparent",radius:8,nameOffsetY:3,nameColorLightTheme:"#999999",nameColorDarkTheme:"#7a7a7a",nameFontSize:14,nameLineHeight:1.25},ef="Segoe UI Emoji",ex=1,ey=20,eb=em.Virgil,ev="left",ew="top",eE=20,ek=["text/plain","text/html"],eC={json:"application/json",excalidraw:"application/vnd.excalidraw+json",excalidrawlib:"application/vnd.excalidrawlib+json","excalidraw.svg":"image/svg+xml","excalidraw.png":"image/png",binary:"application/octet-stream",...eS={svg:"image/svg+xml",png:"image/png",jpg:"image/jpeg",gif:"image/gif",webp:"image/webp",bmp:"image/bmp",ico:"image/x-icon",avif:"image/avif",jfif:"image/jfif"}},eI={png:"png",svg:"svg",clipboard:"clipboard"},eM={excalidraw:"excalidraw",excalidrawClipboard:"excalidraw/clipboard",excalidrawLibrary:"excalidrawlib",excalidrawClipboardWithAPI:"excalidraw-api/clipboard"},ej=window.EXCALIDRAW_EXPORT_SOURCE||window.location.origin,eT=500,eL=300,eD=500,eA=100,eP=.1,e_=.1,eR=300,eN=T.themeFilter,eO={addLibrary:"addLibrary"},ez={addLibrary:"addLibrary"},eH={canvasActions:{changeViewBackgroundColor:!0,clearCanvas:!0,export:{saveFileToDisk:!0},loadScene:!0,saveToActiveFile:!0,toggleTheme:null,saveAsImage:!0},tools:{image:!0}},eB=730,eF=1e3,e$=500,eZ=1229,eW=parseInt(T.rightSidebarWidth),eU=2,eG=[1,2,3],eV=10,eK=1440,eY=2097152,eX="http://www.w3.org/2000/svg",eq={excalidraw:2,excalidrawLibrary:2},eJ=5,eQ=.7,e1=11,e0={TOP:"top",MIDDLE:"middle",BOTTOM:"bottom"},e2={LEFT:"left",CENTER:"center",RIGHT:"right"},e3=20,e6=.25,e4=32,e5={LEGACY:1,PROPORTIONAL_RADIUS:2,ADAPTIVE_RADIUS:3},e8="__precedingElement__",e7={architect:0,artist:1,cartoonist:2},e9={thin:1,bold:2,extraBold:4},te={strokeColor:z.black,backgroundColor:z.transparent,fillStyle:"solid",strokeWidth:2,strokeStyle:"solid",roughness:e7.artist,opacity:100,locked:!1},tn={name:"default",defaultTab:tt="library"},ti=new Set(["iframe","embeddable","image"]),tl={selection:"selection",rectangle:"rectangle",diamond:"diamond",ellipse:"ellipse",arrow:"arrow",line:"line",freedraw:"freedraw",text:"text",image:"image",eraser:"eraser",hand:"hand",frame:"frame",magicframe:"magicframe",embeddable:"embeddable",laser:"laser"},tr={OAI_API_KEY:"excalidraw-oai-api-key",MERMAID_TO_EXCALIDRAW:"mermaid-to-excalidraw",PUBLISH_LIBRARY:"publish-library-data"}}),tN=tC(()=>{tM(),tL(),tA(),tR(),ta=({delay:e,theme:t})=>{let[n,i]=(0,l.useState)(!!e);return(0,l.useEffect)(()=>{if(!e)return;let t=setTimeout(()=>{i(!1)},e);return()=>clearTimeout(t)},[e]),n?null:(0,s.jsxs)("div",{className:(0,d.Z)("LoadingMessage",{"LoadingMessage--dark":t===ep.DARK}),children:[(0,s.jsx)("div",{children:(0,s.jsx)(j,{})}),(0,s.jsx)("div",{className:"LoadingMessage-text",children:C("labels.loadingScene")})]})}}),tO=tC(()=>{tM(),tN(),tL(),ts=e=>{let[t,n]=(0,l.useState)(!0);return(0,l.useEffect)(()=>{let t=async()=>{await E(i),n(!1)},i=y.find(t=>t.code===e.langCode)||x;t()},[e.langCode]),t?(0,s.jsx)(ta,{theme:e.theme}):e.children}});function tz(e,t,n,i){return e?(e?.addEventListener?.(t,n,i),()=>{e?.removeEventListener?.(t,n,i)}):()=>{}}var tH,tB,tF,t$,tZ,tW,tU,tG,tV,tK,tY,tX,tq,tJ,tQ,t1,t0,t2,t3,t6,t4,t5,t8,t7,t9,ne,nt,nn,ni,nl,nr,na,ns,no,nd,nc,nh,nm,nu,np,ng,nf,nx,ny,nb,nv,nw,nE,nS,nk,nC,nI,nM,nj,nT,nL,nD,nA,nP,n_,nR,nN,nO,nz,nH,nB,nF,n$,nZ,nW,nU,nG,nV,nK,nY,nX,nq,nJ,nQ,n1,n0,n2,n3,n6,n4,n5,n8,n7,n9,ie,it,ii,il,ir,ia,is,io,id,ic,ih,im,iu,ip,ig,ix,iy,ib,iv,iw,iE,iS,ik,iC,iI,iM,ij,iT,iL,iD,iA,iP,i_,iR,iN,iO,iz,iH,iB,iF,i$,iZ,iW,iU,iG,iV,iK,iY,iX,iq,iJ,iQ,i1,i0,i2,i3,i6,i4,i5,i8,i7,i9,le,lt,ln,li,ll,lr,la,ls,lo,ld,lc,lh,lm,lu,lp,lg,lf,lx,ly,lb,lv,lw,lE,lS,lk,lC,lI,lM,lj,lT,lL,lD,lA,lP,l_,lR,lN,lO,lz,lH,lB,lF,l$,lZ,lW,lU,lG,lV,lK,lY,lX,lq,lJ,lQ,l1,l0,l2,l3,l6,l4,l5,l8,l7,l9,re,rt,rn,ri,rl,rr,ra,rs,ro,rd,rc,rh,rm,ru,rp,rg,rf,rx,ry,rb,rv,rw,rE,rS,rk,rC,rI,rM,rj,rT,rL,rD,rA,rP,r_,rR,rN,rO,rz,rH,rB,rF,r$,rZ,rW,rU,rG,rV,rK,rY,rX,rq,rJ,rQ,r1,r0,r2,r3,r6,r4,r5,r8,r7,r9,ae,at,an,ai,al,ar,aa,as,ao,ad,ac,ah,am,au,ap,ag,af,ax,ay,ab,av,aw,aE,aS,ak,aC,aI,aM,aj,aT,aL,aD,aA,aP,a_,aR,aN,aO,az,aH,aB,aF,a$,aZ,aW,aU,aG,aV,aK,aY,aX,aq,aJ,aQ,a1,a0,a2,a3,a6,a4,a5,a8,a7,a9,se,st,sn,si,sl,sr,sa,ss,so,sd,sc,sh,sm,su,sp,sg,sf,sx,sy,sb,sv,sw,sE,sS,sk,sC,sI,sM,sj,sT,sL,sD,sA,sP,s_,sR,sN,sO,sz,sH,sB,sF,s$,sZ,sW,sU,sG,sV,sK,sY,sX,sq,sJ,sQ,s1,s0,s2,s3,s6,s4,s5,s8,s7,s9,oe,ot,on,oi,ol,or,oa,os,oo,od,oc,oh,om,ou,op,og,of,ox,oy,ob,ov,ow,oE,oS,ok,oC,oI,oM,oj,oT,oL,oD,oA,oP,o_,oR,oN,oO,oz,oH,oB,oF,o$,oZ,oW,oU,oG,oV,oK,oY,oX,oq,oJ,oQ,o1,o0,o2,o3,o6,o4,o5,o8,o7,o9,de,dt,dn,di,dl,dr,da,ds,dd,dc,dh,dm,du,dp,dg,df=tC(()=>{tM(),t_(),tR(),tH=()=>{let e=new Date,t=e.getFullYear(),n=`${e.getMonth()+1}`.padStart(2,"0"),i=`${e.getDate()}`.padStart(2,"0"),l=`${e.getHours()}`.padStart(2,"0"),r=`${e.getMinutes()}`.padStart(2,"0");return`${t}-${n}-${i}-${l}${r}`},tB=e=>e.charAt(0).toUpperCase()+e.slice(1),tF=e=>e instanceof HTMLElement&&e.className.includes("ToolIcon"),t$=e=>e instanceof HTMLElement&&"wysiwyg"===e.dataset.type||e instanceof HTMLBRElement||e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement||e instanceof HTMLSelectElement,tZ=e=>t$(e)||e instanceof Element&&!!e.closest("label, button"),tW=e=>e instanceof HTMLElement&&"wysiwyg"===e.dataset.type||e instanceof HTMLBRElement||e instanceof HTMLTextAreaElement||e instanceof HTMLInputElement&&("text"===e.type||"number"===e.type||"password"===e.type),tU=({fontFamily:e})=>{for(let[t,n]of Object.entries(em))if(n===e){let n=eu[e];return n?`${t}, ${n}, ${ef}`:`${t}, ${ef}`}return ef},tG=({fontSize:e,fontFamily:t})=>`${e}px ${tU({fontFamily:t})}`,tV=(e,t)=>{let n=0,i=null,l=(...l)=>{i=l,clearTimeout(n),n=window.setTimeout(()=>{i=null,e(...l)},t)};return l.flush=()=>{if(clearTimeout(n),i){let t=i;i=null,e(...t)}},l.cancel=()=>{i=null,clearTimeout(n)},l},tK=(e,t)=>{let n=null,i=null,l=null,r=t=>{n=window.requestAnimationFrame(()=>{n=null,e(...t),i=null,l&&(i=l,l=null,r(i))})},a=(...a)=>{if("test"===u.MODE){e(...a);return}i=a,null===n?r(i):t?.trailing&&(l=a)};return a.flush=()=>{null!==n&&(cancelAnimationFrame(n),n=null),i&&(e(...l||i),i=l=null)},a.cancel=()=>{i=l=null,null!==n&&(cancelAnimationFrame(n),n=null)},a},tY=e=>1-Math.pow(1-e,4),tX=(e,t,n)=>(t-e)*tY(n)+e,tq=({fromValues:e,toValues:t,onStep:n,duration:i=250,interpolateValue:l,onStart:r,onEnd:a,onCancel:s})=>{let o=!1,d=0,c;return d=window.requestAnimationFrame(function s(h){if(o)return;void 0===c&&(c=h,r?.());let m=Math.min(h-c,i),u=tY(m/i),p={};if(Object.keys(e).forEach(n=>{let i=(t[n]-e[n])*u+e[n];p[n]=i}),n(p),m<i){let r=m/i,a={};Object.keys(e).forEach(n=>{let i=e[n],s=t[n],o;null==(o=l?l(i,s,r,n):tX(i,s,r))&&(o=tX(i,s,r)),a[n]=o}),n(a),d=window.requestAnimationFrame(s)}else n(t),a?.()}),()=>{s?.(),o=!0,window.cancelAnimationFrame(d)}},tJ=(e,t)=>{if(!e.length||t<1)return[];let n=0,i=0,l=Array(Math.ceil(e.length/t));for(;n<e.length;)l[i++]=e.slice(n,n+=t);return l},tQ=(e,t)=>Math.abs(e-t),t1=(e,t)=>"custom"===t.type?{...e.activeTool,type:"custom",customType:t.customType,locked:t.locked??e.activeTool.locked}:{...e.activeTool,lastActiveTool:void 0===t.lastActiveToolBeforeEraser?e.activeTool.lastActiveTool:t.lastActiveToolBeforeEraser,type:t.type,customType:null,locked:t.locked??e.activeTool.locked},t0=e=>(e=e.replace(/\bAlt\b/i,"Alt").replace(/\bShift\b/i,"Shift").replace(/\b(Enter|Return)\b/i,"Enter"),V?e.replace(/\bCtrlOrCmd\b/gi,"Cmd").replace(/\bAlt\b/i,"Option"):e.replace(/\bCtrlOrCmd\b/gi,"Ctrl")),t2=({clientX:e,clientY:t},{zoom:n,offsetLeft:i,offsetTop:l,scrollX:r,scrollY:a})=>({x:(e-i)/n.value-r,y:(t-l)/n.value-a}),t3=({sceneX:e,sceneY:t},{zoom:n,offsetLeft:i,offsetTop:l,scrollX:r,scrollY:a})=>({x:(e+r)*n.value+i,y:(t+a)*n.value+l}),t6=e=>getComputedStyle(document.documentElement).getPropertyValue(`--${e}`),t4=RegExp(`^[^A-Za-z\xc0-\xd6\xd8-\xf6\xf8-ʸ̀-֐ࠀ-῿Ⰰ-﬜﷾-﹯﻽-￿]*[֑-߿יִ-﷽ﹰ-ﻼ]`),t5=e=>t4.test(e),t8=e=>{let[t,n]=e;return{x:t,y:n}},t7=e=>{if(e?.name==="AbortError"){console.warn(e);return}throw e},t9=(e,t,n=0)=>{n<0&&(n=e.length+n);let i=(n=Math.min(e.length,Math.max(n,0)))-1;for(;++i<e.length;)if(t(e[i],i,e))return i;return -1},ne=(e,t,n=e.length-1)=>{n<0&&(n=e.length+n);let i=(n=Math.min(e.length-1,Math.max(n,0)))+1;for(;--i>-1;)if(t(e[i],i,e))return i;return -1},nt=e=>{let t=5===e.length&&"0"===e.substr(4,1),n=9===e.length&&"00"===e.substr(7,2);return t||n||e===z.transparent},nn=e=>{let t=e.parentElement;for(;t&&t!==document.body;){let{overflowY:e}=window.getComputedStyle(t);if(t.scrollHeight>t.clientHeight&&("auto"===e||"scroll"===e||"overlay"===e))return t;t=t.parentElement}return document},ni=e=>{let t=e.parentElement;for(;t;){if(t.tabIndex>-1){t.focus();return}t=t.parentElement}},nl=e=>Array.from(e).map(e=>`0${e.toString(16)}`.slice(-2)).join(""),nr=()=>no()?1:Date.now(),na=e=>e.reduce((e,t)=>(e.set("string"==typeof t?t:t.id,t),e),new Map),ns=e=>e.reduce((e,t,n)=>(e.set(t.id,[t,n]),e),new Map),no=()=>"test"===u.MODE,nd=(e,t)=>new CustomEvent(e,{detail:{nativeEvent:t},cancelable:!0}),nc=(e,t)=>{let n=!1;for(let i in t){let l=t[i];if("u">typeof l){if(e[i]===l&&("object"!=typeof l||null===l))continue;n=!0}}return n?{...e,...t}:e},nh=()=>{try{return window.self===window.top?"top":"iframe"}catch{return"iframe"}},nm=e=>!!e&&"object"==typeof e&&"then"in e&&"catch"in e&&"finally"in e,nu=e=>{let t=e?.querySelectorAll("button, a, input, select, textarea, div[tabindex], label[tabindex]");return t?Array.from(t).filter(e=>e.tabIndex>-1&&!e.disabled):[]},np=(e,t)=>!!(Array.isArray(e)&&Array.isArray(t))&&0===e.length&&0===t.length||e===t,ng=(e,t,n,i=!1)=>{let l=Object.keys(e),r=Object.keys(t);if(l.length!==r.length)return!1;if(n&&Array.isArray(n)){for(let l of n)if(!(e[l]===t[l]||np(e[l],t[l])))return i&&console.warn(`%cisShallowEqual: ${l} not equal ->`,"color: #8B4000",e[l],t[l]),!1;return!0}return l.every(l=>{let r=n?.[l],a=r?r(e[l],t[l]):e[l]===t[l]||np(e[l],t[l]);return!a&&i&&console.warn(`%cisShallowEqual: ${l} not equal ->`,"color: #8B4000",e[l],t[l]),a})},nf=(e,t,{checkForDefaultPrevented:n=!0}={})=>function(i){if(e?.(i),!n||!i.defaultPrevented)return t?.(i)},nx=(e,t,n)=>{if(!t)return e;if(n)return console.error(t),e;throw Error(t)},ny=e=>{let t,n,i=function(i){let l=Object.entries(i);if(t){let e=!0;for(let[n,i]of l)if(t.get(n)!==i){e=!1;break}if(e)return n}let r=e(i);return t=new Map(l),n=r,r};return i.clear=()=>{t=void 0,n=void 0},i},nb=(e,t)=>e instanceof Set||e instanceof Map?e.has(t):"includes"in e?e.includes(t):e.hasOwnProperty(t),nv=e=>JSON.parse(JSON.stringify(e)),nw=e=>"number"==typeof e&&Number.isFinite(e),nE=(e,t)=>ng(e,t)?e:t,nS=(e,t)=>(e+t)/2,nk=e=>e.replace(/\r?\n|\r/g,`
`)}),dx=tC(()=>{tM(),tR(),df(),nC=e=>!!e&&"image"===e.type&&!!e.fileId,nI=e=>!!e&&"image"===e.type,nM=e=>!!e&&"embeddable"===e.type,nj=e=>!!e&&"iframe"===e.type,nT=e=>!!e&&("iframe"===e.type||"embeddable"===e.type),nL=e=>null!=e&&"text"===e.type,nD=e=>null!=e&&"frame"===e.type,nA=e=>null!=e&&"magicframe"===e.type,nP=e=>null!=e&&("frame"===e.type||"magicframe"===e.type),n_=e=>null!=e&&nR(e.type),nR=e=>"freedraw"===e,nN=e=>null!=e&&nz(e.type),nO=e=>null!=e&&"arrow"===e.type,nz=e=>"arrow"===e||"line"===e,nH=(e,t=!0)=>null!=e&&(!e.locked||!0===t)&&nB(e.type),nB=e=>"arrow"===e,nF=(e,t=!0)=>null!=e&&(!e.locked||!0===t)&&("rectangle"===e.type||"diamond"===e.type||"ellipse"===e.type||"image"===e.type||"iframe"===e.type||"embeddable"===e.type||"frame"===e.type||"magicframe"===e.type||"text"===e.type&&!e.containerId),n$=(e,t=!0)=>null!=e&&(!e.locked||!0===t)&&("rectangle"===e.type||"diamond"===e.type||"ellipse"===e.type||nO(e)),nZ=e=>{let t=e?.type;if(!t)return!1;switch(t){case"text":case"diamond":case"rectangle":case"iframe":case"embeddable":case"ellipse":case"arrow":case"freedraw":case"line":case"frame":case"magicframe":case"image":case"selection":return!0;default:return nx(t,null),!1}},nW=e=>n$(e)&&!!e.boundElements?.some(({type:e})=>"text"===e),nU=e=>null!==e&&"containerId"in e&&null!==e.containerId&&nL(e),nG=e=>"rectangle"===e||"embeddable"===e||"iframe"===e,nV=e=>"line"===e||"arrow"===e||"diamond"===e,nK=(e,t)=>!!((e===e5.ADAPTIVE_RADIUS||e===e5.LEGACY)&&nG(t.type)||e===e5.PROPORTIONAL_RADIUS&&nV(t.type)),nY=e=>nV(e.type)?{type:e5.PROPORTIONAL_RADIUS}:nG(e.type)?{type:e5.ADAPTIVE_RADIUS}:null}),dy=tC(()=>{tM(),t_(),tR(),tL(),df(),nX=eG.includes(devicePixelRatio)?devicePixelRatio:1,nq=()=>({showWelcomeScreen:!1,theme:ep.LIGHT,collaborators:new Map,currentChartType:"bar",currentItemBackgroundColor:te.backgroundColor,currentItemEndArrowhead:"arrow",currentItemFillStyle:te.fillStyle,currentItemFontFamily:eb,currentItemFontSize:ey,currentItemOpacity:te.opacity,currentItemRoughness:te.roughness,currentItemStartArrowhead:null,currentItemStrokeColor:te.strokeColor,currentItemRoundness:"round",currentItemStrokeStyle:te.strokeStyle,currentItemStrokeWidth:te.strokeWidth,currentItemTextAlign:ev,cursorButton:"up",activeEmbeddable:null,draggingElement:null,editingElement:null,editingGroupId:null,editingLinearElement:null,activeTool:{type:"selection",customType:null,locked:te.locked,lastActiveTool:null},penMode:!1,penDetected:!1,errorMessage:null,exportBackground:!0,exportScale:nX,exportEmbedScene:!1,exportWithDarkMode:!1,fileHandle:null,gridSize:null,isBindingEnabled:!0,defaultSidebarDockedPreference:!1,isLoading:!1,isResizing:!1,isRotating:!1,lastPointerDownWith:"mouse",multiElement:null,name:`${C("labels.untitled")}-${tH()}`,contextMenu:null,openMenu:null,openPopup:null,openSidebar:null,openDialog:null,pasteDialog:{shown:!1,data:null},previousSelectedElementIds:{},resizingElement:null,scrolledOutside:!1,scrollX:0,scrollY:0,selectedElementIds:{},selectedGroupIds:{},selectedElementsAreBeingDragged:!1,selectionElement:null,shouldCacheIgnoreZoom:!1,showStats:!1,startBoundElement:null,suggestedBindings:[],frameRendering:{enabled:!0,clip:!0,name:!0,outline:!0},frameToHighlight:null,editingFrame:null,elementsToHighlight:null,toast:null,viewBackgroundColor:z.white,zenModeEnabled:!1,zoom:{value:1},viewModeEnabled:!1,pendingImageElementId:null,showHyperlinkPopup:!1,selectedLinearElement:null,snapLines:[],originSnapOffset:{x:0,y:0},objectsSnapModeEnabled:!1,userToFollow:null,followedBy:new Set}),nJ={showWelcomeScreen:{browser:!0,export:!1,server:!1},theme:{browser:!0,export:!1,server:!1},collaborators:{browser:!1,export:!1,server:!1},currentChartType:{browser:!0,export:!1,server:!1},currentItemBackgroundColor:{browser:!0,export:!1,server:!1},currentItemEndArrowhead:{browser:!0,export:!1,server:!1},currentItemFillStyle:{browser:!0,export:!1,server:!1},currentItemFontFamily:{browser:!0,export:!1,server:!1},currentItemFontSize:{browser:!0,export:!1,server:!1},currentItemRoundness:{browser:!0,export:!1,server:!1},currentItemOpacity:{browser:!0,export:!1,server:!1},currentItemRoughness:{browser:!0,export:!1,server:!1},currentItemStartArrowhead:{browser:!0,export:!1,server:!1},currentItemStrokeColor:{browser:!0,export:!1,server:!1},currentItemStrokeStyle:{browser:!0,export:!1,server:!1},currentItemStrokeWidth:{browser:!0,export:!1,server:!1},currentItemTextAlign:{browser:!0,export:!1,server:!1},cursorButton:{browser:!0,export:!1,server:!1},activeEmbeddable:{browser:!1,export:!1,server:!1},draggingElement:{browser:!1,export:!1,server:!1},editingElement:{browser:!1,export:!1,server:!1},editingGroupId:{browser:!0,export:!1,server:!1},editingLinearElement:{browser:!1,export:!1,server:!1},activeTool:{browser:!0,export:!1,server:!1},penMode:{browser:!0,export:!1,server:!1},penDetected:{browser:!0,export:!1,server:!1},errorMessage:{browser:!1,export:!1,server:!1},exportBackground:{browser:!0,export:!1,server:!1},exportEmbedScene:{browser:!0,export:!1,server:!1},exportScale:{browser:!0,export:!1,server:!1},exportWithDarkMode:{browser:!0,export:!1,server:!1},fileHandle:{browser:!1,export:!1,server:!1},gridSize:{browser:!0,export:!0,server:!0},height:{browser:!1,export:!1,server:!1},isBindingEnabled:{browser:!1,export:!1,server:!1},defaultSidebarDockedPreference:{browser:!0,export:!1,server:!1},isLoading:{browser:!1,export:!1,server:!1},isResizing:{browser:!1,export:!1,server:!1},isRotating:{browser:!1,export:!1,server:!1},lastPointerDownWith:{browser:!0,export:!1,server:!1},multiElement:{browser:!1,export:!1,server:!1},name:{browser:!0,export:!1,server:!1},offsetLeft:{browser:!1,export:!1,server:!1},offsetTop:{browser:!1,export:!1,server:!1},contextMenu:{browser:!1,export:!1,server:!1},openMenu:{browser:!0,export:!1,server:!1},openPopup:{browser:!1,export:!1,server:!1},openSidebar:{browser:!0,export:!1,server:!1},openDialog:{browser:!1,export:!1,server:!1},pasteDialog:{browser:!1,export:!1,server:!1},previousSelectedElementIds:{browser:!0,export:!1,server:!1},resizingElement:{browser:!1,export:!1,server:!1},scrolledOutside:{browser:!0,export:!1,server:!1},scrollX:{browser:!0,export:!1,server:!1},scrollY:{browser:!0,export:!1,server:!1},selectedElementIds:{browser:!0,export:!1,server:!1},selectedGroupIds:{browser:!0,export:!1,server:!1},selectedElementsAreBeingDragged:{browser:!1,export:!1,server:!1},selectionElement:{browser:!1,export:!1,server:!1},shouldCacheIgnoreZoom:{browser:!0,export:!1,server:!1},showStats:{browser:!0,export:!1,server:!1},startBoundElement:{browser:!1,export:!1,server:!1},suggestedBindings:{browser:!1,export:!1,server:!1},frameRendering:{browser:!1,export:!1,server:!1},frameToHighlight:{browser:!1,export:!1,server:!1},editingFrame:{browser:!1,export:!1,server:!1},elementsToHighlight:{browser:!1,export:!1,server:!1},toast:{browser:!1,export:!1,server:!1},viewBackgroundColor:{browser:!0,export:!0,server:!0},width:{browser:!1,export:!1,server:!1},zenModeEnabled:{browser:!0,export:!1,server:!1},zoom:{browser:!0,export:!1,server:!1},viewModeEnabled:{browser:!1,export:!1,server:!1},pendingImageElementId:{browser:!1,export:!1,server:!1},showHyperlinkPopup:{browser:!1,export:!1,server:!1},selectedLinearElement:{browser:!0,export:!1,server:!1},snapLines:{browser:!1,export:!1,server:!1},originSnapOffset:{browser:!1,export:!1,server:!1},objectsSnapModeEnabled:{browser:!0,export:!1,server:!1},userToFollow:{browser:!1,export:!1,server:!1},followedBy:{browser:!1,export:!1,server:!1}},nQ=(e,t)=>{let n={};for(let i of Object.keys(e))if(nJ[i]?.[t]){let t=e[i];n[i]=t}return n},n1=e=>nQ(e,"export"),n0=e=>nQ(e,"server"),n2=({activeTool:e})=>"eraser"===e.type,n3=({activeTool:e})=>"hand"===e.type}),db=tC(()=>{tM(),n6=(e,t)=>[0,0,0,0,t,e,1,0],n4=(e,t)=>[0,0,0,0,t,e,0,0],n5=(e=0,t=0)=>{let n=[0,0,0,0,0,0,0,0];if(t<0||t>7)throw Error(`Expected \`index\` between 0 and 7, got \`${t}\``);return 0!==e&&(n[t]=e),n},n8=e=>[e[0],e[1],e[2],e[3],-e[4],-e[5],-e[6],-e[7]],n7=(e,t)=>ih(t)?[e[0]+t,e[1],e[2],e[3],e[4],e[5],e[6],e[7]]:[e[0]+t[0],e[1]+t[1],e[2]+t[2],e[3]+t[3],e[4]+t[4],e[5]+t[5],e[6]+t[6],e[7]+t[7]],n9=(e,t)=>ih(t)?[e[0]-t,e[1],e[2],e[3],e[4],e[5],e[6],e[7]]:[e[0]-t[0],e[1]-t[1],e[2]-t[2],e[3]-t[3],e[4]-t[4],e[5]-t[5],e[6]-t[6],e[7]-t[7]],ie=(e,t)=>ih(t)?[e[0]*t,e[1]*t,e[2]*t,e[3]*t,e[4]*t,e[5]*t,e[6]*t,e[7]*t]:[it(e,t),t[1]*e[0]+t[0]*e[1]-t[4]*e[2]+t[5]*e[3]+t[2]*e[4]-t[3]*e[5]-t[7]*e[6]-t[6]*e[7],t[2]*e[0]+t[0]*e[2]-t[6]*e[3]+t[3]*e[6],t[3]*e[0]+t[6]*e[2]+t[0]*e[3]-t[2]*e[6],t[4]*e[0]+t[2]*e[1]-t[1]*e[2]+t[7]*e[3]+t[0]*e[4]+t[6]*e[5]-t[5]*e[6]+t[3]*e[7],t[5]*e[0]-t[3]*e[1]+t[7]*e[2]+t[1]*e[3]-t[6]*e[4]+t[0]*e[5]+t[4]*e[6]+t[2]*e[7],t[6]*e[0]+t[3]*e[2]-t[2]*e[3]+t[0]*e[6],t[7]*e[0]+t[6]*e[1]+t[5]*e[2]+t[4]*e[3]+t[3]*e[4]+t[2]*e[5]+t[1]*e[6]+t[0]*e[7]],it=(e,t)=>t[0]*e[0]+t[2]*e[2]+t[3]*e[3]-t[6]*e[6],ii=(e,t)=>[t[0]*e[0],t[1]*e[0]+t[0]*e[1],t[2]*e[0]+t[0]*e[2],t[3]*e[0]+t[0]*e[3],t[4]*e[0]+t[2]*e[1]-t[1]*e[2]+t[0]*e[4],t[5]*e[0]-t[3]*e[1]+t[1]*e[3]+t[0]*e[5],t[6]*e[0]+t[3]*e[2]-t[2]*e[3]+t[0]*e[6],t[7]*e[0]+t[6]*e[1]+t[5]*e[2]+t[4]*e[3]+t[3]*e[4]+t[2]*e[5]+t[1]*e[6]],il=(e,t)=>[ir(e,t),e[1]*t[7]+e[4]*t[5]-e[5]*t[4]+e[7]*t[1],e[2]*t[7]-e[4]*t[6]+e[6]*t[4]+e[7]*t[2],e[3]*t[7]+e[5]*t[6]-e[6]*t[5]+e[7]*t[3],e[4]*t[7]+e[7]*t[4],e[5]*t[7]+e[7]*t[5],e[6]*t[7]+e[7]*t[6],e[7]*t[7]],ir=(e,t)=>e[0]*t[7]+e[1]*t[6]+e[2]*t[5]+e[3]*t[4]+e[4]*t[3]+e[5]*t[2]+e[6]*t[1]+e[7]*t[0],ia=(e,t)=>[t[0]*e[0]+t[2]*e[2]+t[3]*e[3]-t[6]*e[6],t[1]*e[0]+t[0]*e[1]-t[4]*e[2]+t[5]*e[3]+t[2]*e[4]-t[3]*e[5]-t[7]*e[6]-t[6]*e[7],t[2]*e[0]+t[0]*e[2]-t[6]*e[3]+t[3]*e[6],t[3]*e[0]+t[6]*e[2]+t[0]*e[3]-t[2]*e[6],t[4]*e[0]+t[7]*e[3]+t[0]*e[4]+t[3]*e[7],t[5]*e[0]+t[7]*e[2]+t[0]*e[5]+t[2]*e[7],t[6]*e[0]+t[0]*e[6],t[7]*e[0]+t[0]*e[7]],is=e=>Math.sqrt(Math.abs(e[0]*e[0]-e[2]*e[2]-e[3]*e[3]+e[6]*e[6])),io=e=>Math.sqrt(Math.abs(e[7]*e[7]-e[5]*e[5]-e[4]*e[4]+e[1]*e[1])),id=e=>{let t=is(e);if(0===t||1===t)return e;let n=e[6]<0?-1:1;return ie(e,n/t)},ic=e=>{let t=io(e);return 0===t||1===t?e:ie(e,1/t)},ih=e=>"number"==typeof e,n5(1,1),n5(1,2),n5(1,3),n5(1,4),n5(1,5),n5(1,6),n5(1,7)}),dv=tC(()=>{tM(),db(),im=(e,t,n)=>id([0,n,e,t,0,0,0,0]),iu=(e,t)=>id(il(t,e)),ip=(e,t)=>ia(e,t),ig=(e,t)=>ip(iu(e,t),t),ix=e=>Math.sign(e[1])}),dw=tC(()=>{tM(),db(),dv(),db(),iy=([e,t])=>[0,0,0,0,t,e,1,0],ib=e=>[e[5],e[4]],iv=e=>[0,0,0,0,Math.abs(e[4]),Math.abs(e[5]),1,0],iw=(e,t)=>id(ii(e,t)),iE=(e,t)=>is(il(e,t)),iS=(e,t)=>ir(e,t)}),dE=tC(()=>{tM(),db(),ik=e=>[0,0,0,0,e[4],e[5],0,0],iC=(e,t)=>ic([0,0,0,0,t[4]-e[4],t[5]-e[5],0,0])}),dS=tC(()=>{tM(),db(),dE(),iI=(e,t)=>n7(ie(e,Math.sin(t/2)),Math.cos(t/2)),iM=e=>[1,0,0,0,-(.5*e[5]),.5*e[4],0,0],ij=(e,t)=>{let n=.5*t;return[1,0,0,0,n*e[4],n*e[5],0,0]},iT=(e,t)=>ie(t,e),iL=(e,t)=>id(ie(ie(e,t),n8(e)))}),dk=tC(()=>{tM(),iD=(e,t,n,i,l,r,a)=>{e.beginPath(),e.moveTo(t+r,n),e.lineTo(t+i-r,n),e.quadraticCurveTo(t+i,n,t+i,n+r),e.lineTo(t+i,n+l-r),e.quadraticCurveTo(t+i,n+l,t+i-r,n+l),e.lineTo(t+r,n+l),e.quadraticCurveTo(t,n+l,t,n+l-r),e.lineTo(t,n+r),e.quadraticCurveTo(t,n,t+r,n),e.closePath(),e.fill(),a&&(e.strokeStyle=a),e.stroke()}}),dC=tC(()=>{tM(),iA=e=>`hsl(${Math.abs(function(e){let t=0;if(0===e.length)return t;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n);return t}(e))%37*10}, 100%, 83%)`,iP=e=>{let t=e?.trim()?.codePointAt(0);return(t?String.fromCodePoint(t):"?").toUpperCase()}}),dI=tC(()=>{let e,t,n,i,l;tM(),fK(),ma(),fz(),i_=(e,t,n)=>{let i=n.reduce((t,n)=>(n.groupIds.includes(e)&&(t[n.id]=!0),t),{});return Object.keys(i).length<2?t.selectedGroupIds[e]||t.editingGroupId===e?{selectedElementIds:t.selectedElementIds,selectedGroupIds:{...t.selectedGroupIds,[e]:!1},editingGroupId:null}:t:{editingGroupId:t.editingGroupId,selectedGroupIds:{...t.selectedGroupIds,[e]:!0},selectedElementIds:{...t.selectedElementIds,...i}}},e=null,t=null,n=null,i=(i,l,r,a)=>{if(void 0!==n&&l===t&&i===e&&r.editingGroupId===n?.editingGroupId)return n;let s={};for(let e of i){let t=e.groupIds;if(r.editingGroupId){let e=t.indexOf(r.editingGroupId);e>-1&&(t=t.slice(0,e))}t.length>0&&(s[t[t.length-1]]=!0)}let o={},d=l.reduce((e,t)=>{let n=t.groupIds.find(e=>s[e]);return n&&(e[t.id]=!0,Array.isArray(o[n])?o[n].push(t.id):o[n]=[t.id]),e},{});for(let e of Object.keys(o))o[e].length<2&&s[e]&&(s[e]=!1);return t=l,e=i,n={editingGroupId:r.editingGroupId,selectedGroupIds:s,selectedElementIds:gY({...r.selectedElementIds,...d},a)}},(l=(e,t,n,l)=>{let r=l?l.scene.getSelectedElements({selectedElementIds:e.selectedElementIds,elements:t}):gV(t,e);return r.length?i(r,t,e,n):{selectedGroupIds:{},editingGroupId:null,selectedElementIds:gY(e.selectedElementIds,n)}}).clearCache=()=>{t=null,e=null,n=null},iR=l,iN=(e,t)=>null!=iO(e,t),iO=(e,t)=>t.groupIds.filter(t=>t!==e.editingGroupId).find(t=>e.selectedGroupIds[t]),iz=e=>Object.entries(e.selectedGroupIds).filter(([e,t])=>t).map(([e,t])=>e),iH=(e,t)=>{let n={...t,selectedGroupIds:{}};for(let i of e){let l=i.groupIds;if(t.editingGroupId){let e=l.indexOf(t.editingGroupId);e>-1&&(l=l.slice(0,e))}if(l.length>0){let t=l[l.length-1];n={...n,...i_(t,n,e)}}}return n.selectedGroupIds},iB=(e,t)=>({...e,editingGroupId:t.groupIds.length?t.groupIds[0]:null,selectedGroupIds:{},selectedElementIds:{[t.id]:!0}}),iF=(e,t)=>e.groupIds.includes(t),i$=(e,t)=>e.filter(e=>iF(e,t)),iZ=(e,t)=>e.groupIds.find(e=>t[e]),iW=(e,t,n)=>{let i=[...e],l=t?e.indexOf(t):-1,r=l>-1?l:e.length;for(let e=0;e<r;e++)i[e]=n(i[e]);return i},iU=(e,t,n)=>{let i=[...e],l=n?i.indexOf(n):-1,r=l>-1?l:i.length;return i.splice(r,0,t),i},iG=(e,t)=>e.filter(e=>!t[e]),iV=e=>{let t=new Map;return e.forEach(e=>{let n=0===e.groupIds.length?e.id:e.groupIds[e.groupIds.length-1],i=t.get(n)||[],l=hU(e);l&&i.push(l),t.set(n,[...i,e])}),Array.from(t.values())}}),dM=tC(()=>{tM()}),dj=tC(()=>{tM(),iK=[],iY=e=>(iK=iK.concat(e),e)}),dT=tC(()=>{tM(),tR(),dy(),iX='<svg viewBox="0 0 24 24" stroke-width="1" width="28" height="28" xmlns="http://www.w3.org/2000/svg">',iq='<path stroke="#1b1b1f" fill="#fff" d="m7.868 11.113 7.773 7.774a2.359 2.359 0 0 0 1.667.691 2.368 2.368 0 0 0 2.357-2.358c0-.625-.248-1.225-.69-1.667L11.201 7.78 9.558 9.469l-1.69 1.643v.001Zm10.273 3.606-3.333 3.333m-3.25-6.583 2 2m-7-7 3 3M3.664 3.625l1 1M2.529 6.922l1.407-.144m5.735-2.932-1.118.866M4.285 9.823l.758-1.194m1.863-6.207-.13 1.408"/>',iJ=`data:${eC.svg},${encodeURIComponent(`${iX}${iq}</svg>`)}`,iQ=`data:${eC.svg},${encodeURIComponent(`${iX}<path d="M6.164 11.755a5.314 5.314 0 0 1-4.932-5.298 5.314 5.314 0 0 1 5.311-5.311 5.314 5.314 0 0 1 5.307 5.113l8.773 8.773a3.322 3.322 0 0 1 0 4.696l-.895.895a3.322 3.322 0 0 1-4.696 0l-8.868-8.868Z" style="fill:#fff"/>${iq}</svg>`)}`,i1=e=>{e&&(e.style.cursor="")},i0=(e,t)=>{e&&(e.style.cursor=t)},i6=(e,t)=>{let n,i;i2&&i2.theme===t||(n=t===ep.DARK,(i2=document.createElement("canvas")).theme=t,i2.height=20,i2.width=20,(i=i2.getContext("2d")).lineWidth=1,i.beginPath(),i.arc(i2.width/2,i2.height/2,5,0,2*Math.PI),i.fillStyle=n?o.black:o.white,i.fill(),i.strokeStyle=n?o.white:o.black,i.stroke(),i3=i2.toDataURL(eC.svg)),i0(e,`url(${i3}) 10 10, auto`)},i4=(e,t)=>{if(e){if("selection"===t.activeTool.type)i1(e);else if(n3(t))e.style.cursor=ea.GRAB;else if(n2(t))i6(e,t.theme);else if("laser"===t.activeTool.type){let n=t.theme===ep.LIGHT?iJ:iQ;e.style.cursor=`url(${n}), auto`}else["image","custom"].includes(t.activeTool.type)?"image"!==t.activeTool.type&&(e.style.cursor=ea.AUTO):e.style.cursor=ea.CROSSHAIR}}}),dL=tC(()=>{tM(),df(),i5=new c.k(Date.now()),i8=0,i7=()=>Math.floor(2147483648*i5.next()),i9=()=>no()?`id${i8++}`:(0,h.x0)()}),dD=tC(()=>{tM(),df(),dL(),fB(),dI(),fG(),uJ(),uq(),ma(),tR(),le=(e,{x:t,y:n,strokeColor:i=te.strokeColor,backgroundColor:l=te.backgroundColor,fillStyle:r=te.fillStyle,strokeWidth:a=te.strokeWidth,strokeStyle:s=te.strokeStyle,roughness:o=te.roughness,opacity:d=te.opacity,width:c=0,height:h=0,angle:m=0,groupIds:u=[],frameId:p=null,roundness:g=null,boundElements:f=null,link:x=null,locked:y=te.locked,...b})=>({id:b.id||i9(),type:e,x:t,y:n,width:c,height:h,angle:m,strokeColor:i,backgroundColor:l,fillStyle:r,strokeWidth:a,strokeStyle:s,roughness:o,opacity:d,groupIds:u,frameId:p,roundness:g,seed:b.seed??i7(),version:b.version||1,versionNonce:b.versionNonce??0,isDeleted:!1,boundElements:f,updated:nr(),link:x,locked:y}),lt=e=>le(e.type,e),ln=e=>le("embeddable",e),li=e=>({...le("iframe",e)}),ll=e=>g1({...le("frame",e),type:"frame",name:e?.name||null},{}),lr=e=>g1({...le("magicframe",e),type:"magicframe",name:e?.name||null},{}),la=(e,t)=>({x:"center"===e.textAlign?t.width/2:"right"===e.textAlign?t.width:0,y:"middle"===e.verticalAlign?t.height/2:0}),ls=e=>{let t=e.fontFamily||eb,n=e.fontSize||ey,i=e.lineHeight||h5(t),l=hS(e.text),r=hT(l,tG({fontFamily:t,fontSize:n}),i),a=e.textAlign||ev,s=e.verticalAlign||ew,o=la({textAlign:a,verticalAlign:s},r);return g1({...le("text",e),text:l,fontSize:n,fontFamily:t,textAlign:a,verticalAlign:s,x:e.x-o.x,y:e.y-o.y,width:r.width,height:r.height,baseline:r.baseline,containerId:e.containerId||null,originalText:l,lineHeight:i},{})},lo=(e,t)=>{let{width:n,height:i,baseline:l}=hT(t,tG(e),e.lineHeight),{textAlign:r,verticalAlign:a}=e,s,o;if("center"!==r||a!==e0.MIDDLE||e.containerId){let[t,l,a,d]=mF(e),[c,h,m,u]=m5(e,n,i,!1);[s,o]=ui({s:!0,e:"center"===r||"left"===r,w:"center"===r||"right"===r},e.x,e.y,e.angle,(t-c)/2,(l-h)/2,(a-m)/2,(d-u)/2)}else{let t=hT(e.text,tG(e),e.lineHeight),l=la(e,{width:n-t.width,height:i-t.height});s=e.x-l.x,o=e.y-l.y}return{width:n,height:i,baseline:l,x:Number.isFinite(s)?s:e.x,y:Number.isFinite(o)?o:e.y}},ld=(e,t=e.text)=>{if(e.isDeleted)return;let n=hG(e);n&&(t=hH(t,tG(e),h2(n)));let i=lo(e,t);return{text:t,...i}},lc=(e,{text:t,isDeleted:n,originalText:i})=>g1(e,{originalText:i,isDeleted:n??e.isDeleted,...ld(e,i)}),lh=e=>({...le(e.type,e),points:e.points||[],pressures:[],simulatePressure:e.simulatePressure,lastCommittedPoint:null}),lm=e=>({...le(e.type,e),points:e.points||[],lastCommittedPoint:null,startBinding:null,endBinding:null,startArrowhead:e.startArrowhead||null,endArrowhead:e.endArrowhead||null}),lu=e=>({...le("image",e),strokeColor:"transparent",status:e.status??"pending",fileId:e.fileId??null,scale:e.scale??[1,1]}),lp=(e,t=0)=>{if(null==e||"object"!=typeof e)return e;let n=Object.prototype.toString.call(e);if("[object Object]"===n){let n="function"==typeof e.constructor?Object.create(Object.getPrototypeOf(e)):{};for(let i in e)if(e.hasOwnProperty(i)){if(0===t&&("shape"===i||"canvas"===i))continue;n[i]=lp(e[i],t+1)}return n}if(Array.isArray(e)){let n=e.length,i=Array(n);for(;n--;)i[n]=lp(e[n],t+1);return i}return u.DEV&&"[object Object]"!==n&&"[object Array]"!==n&&n.startsWith("[object ")&&console.warn(`_deepCloneElement: unexpected object type ${n}. This value will not be cloned!`),e},lg=e=>lp(e),lf=e=>{if(no()&&e){let t=`${e}_copy`;return window.h?.app?.getSceneElementsIncludingDeleted().find(e=>e.id===t)&&(t+="_copy"),t}return i9()},lx=(e,t,n,i)=>{let l=lg(n);return l.id=lf(l.id),l.boundElements=null,l.updated=nr(),l.seed=i7(),l.groupIds=iW(l.groupIds,e,e=>(t.has(e)||t.set(e,lf(e)),t.get(e))),i&&(l=Object.assign(l,i)),l},ly=(e,t)=>{let n=[],i=na(e),l=new Map,r=e=>{if(l.has(e))return l.get(e);if(i.has(e)){let t=lf(e);return l.set(e,t),t}return null},a=new Map;for(let i of e){let e=lp(i);if(e.id=r(i.id),t?.randomizeSeed&&(e.seed=i7(),g0(e)),e.groupIds&&(e.groupIds=e.groupIds.map(e=>(a.has(e)||a.set(e,lf(e)),a.get(e)))),"containerId"in e&&e.containerId){let t=r(e.containerId);e.containerId=t}if("boundElements"in e&&e.boundElements&&(e.boundElements=e.boundElements.reduce((e,t)=>{let n=r(t.id);return n&&e.push({...t,id:n}),e},[])),"endBinding"in e&&e.endBinding){let t=r(e.endBinding.elementId);e.endBinding=t?{...e.endBinding,elementId:t}:null}if("startBinding"in e&&e.startBinding){let t=r(e.startBinding.elementId);e.startBinding=t?{...e.startBinding,elementId:t}:null}e.frameId&&(e.frameId=r(e.frameId)),n.push(e)}return n}}),dA=tC(()=>{tM(),dj(),tR(),tL(),df(),dT(),dD(),ma(),dx(),lb=new Map,lv=/^(?:http(?:s)?:\/\/)?(?:www\.)?youtu(?:be\.com|\.be)\/(embed\/|watch\?v=|shorts\/|playlist\?list=|embed\/videoseries\?list=)?([a-zA-Z0-9_-]+)(?:\?t=|&t=|\?start=|&start=)?([a-zA-Z0-9_-]+)?[^\s]*$/,lw=/^(?:http(?:s)?:\/\/)?(?:(?:w){3}.)?(?:player\.)?vimeo\.com\/(?:video\/)?([^?\s]+)(?:\?.*)?$/,lE=/^https:\/\/(?:www\.)?figma\.com/,lS=/^https:\/\/gist\.github\.com/,lk=/^<script[\s\S]*?\ssrc=["'](https:\/\/gist.github.com\/.*?)\.js["']/i,lC=/(?:http(?:s)?:\/\/)?(?:(?:w){3}.)?(?:twitter|x).com/,lI=/^<blockquote[\s\S]*?\shref=["'](https:\/\/(?:twitter|x).com\/[^"']*)/i,lM=/^https:\/\/(?:www\.)?val.town\/(v|embed)\/[a-zA-Z_$][0-9a-zA-Z_$]+\.[a-zA-Z_$][0-9a-zA-Z_$]+/,lj=/^<(?:iframe|blockquote)[\s\S]*?\s(?:src|href)=["']([^"']*)["'][\s\S]*?>$/i,lT=/giphy.com\/(?:clips|embed|gifs)\/[a-zA-Z0-9]*?-?([a-zA-Z0-9]+)(?:[^a-zA-Z0-9]|$)/,lL=new Set(["youtube.com","youtu.be","vimeo.com","player.vimeo.com","figma.com","link.excalidraw.com","gist.github.com","twitter.com","x.com","*.simplepdf.eu","stackblitz.com","val.town","giphy.com","dddice.com"]),lD=e=>`<html><body>${e}</body></html>`,lA=e=>{if(!e)return null;if(lb.has(e))return lb.get(e);let t=e,n="generic",i={w:560,h:840},l=e.match(lv);if(l?.[2]){let r=l[3]?`&start=${l[3]}`:"",a=e.includes("shorts");switch(n="video",l[1]){case"embed/":case"watch?v=":case"shorts/":default:e=`https://www.youtube.com/embed/${l[2]}?enablejsapi=1${r}`;break;case"playlist?list=":case"embed/videoseries?list=":e=`https://www.youtube.com/embed/videoseries?list=${l[2]}&enablejsapi=1${r}`}return i=a?{w:315,h:560}:{w:560,h:315},lb.set(t,{link:e,intrinsicSize:i,type:n}),{link:e,intrinsicSize:i,type:n}}let r=e.match(lw);if(r?.[1]){let l=r?.[1],a=/^\d+$/.test(l)?void 0:C("toast.unrecognizedLinkFormat");return n="video",e=`https://player.vimeo.com/video/${l}?api=1`,i={w:560,h:315},lb.set(t,{link:e,intrinsicSize:i,type:n}),{link:e,intrinsicSize:i,type:n,warning:a}}if(e.match(lE))return n="generic",e=`https://www.figma.com/embed?embed_host=share&url=${encodeURIComponent(e)}`,i={w:550,h:550},lb.set(t,{link:e,intrinsicSize:i,type:n}),{link:e,intrinsicSize:i,type:n};let a=e.match(lM);if(a)return e="embed"===a[1]?a[0]:a[0].replace("/v","/embed"),lb.set(t,{link:e,intrinsicSize:i,type:n}),{link:e,intrinsicSize:i,type:n};if(lC.test(e)){let n;if(e=e.replace(/\bx.com\b/,"twitter.com"),/<blockquote/.test(e)){let t=lD(e);n={type:"document",srcdoc:()=>t,intrinsicSize:{w:480,h:480}}}else n={type:"document",srcdoc:t=>lD(`<blockquote class="twitter-tweet" data-dnt="true" data-theme="${t}"><a href="${e}"></a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>`),intrinsicSize:{w:480,h:480}};return lb.set(t,n),n}if(lS.test(e)){let t;if(/<script>/.test(e)){let n=lD(e);t={type:"document",srcdoc:()=>n,intrinsicSize:{w:550,h:720}}}else t={type:"document",srcdoc:()=>lD(`
          <script src="${e}.js"></script>
          <style type="text/css">
            * { margin: 0px; }
            table, .gist { height: 100%; }
            .gist .gist-file { height: calc(100vh - 2px); padding: 0px; display: grid; grid-template-rows: 1fr auto; }
          </style>
        `),intrinsicSize:{w:550,h:720}};return lb.set(e,t),t}return lb.set(e,{link:e,intrinsicSize:i,type:n}),{link:e,intrinsicSize:i,type:n}},lP=e=>{if(nT(e))return!0;if("text"===e.type){let t=hG(e);if(t&&nP(t))return!0}return!1},l_=e=>{let t;t=nj(e)?"IFrame element":e.link&&e?.link!==""?e.link:"Empty Web-Embed";let n=Math.max(Math.min(e.width/2,e.width/t.length),e.width/30),i=em.Helvetica,l=tG({fontSize:n,fontFamily:i});return ls({x:e.x+e.width/2,y:e.y+e.height/2,strokeColor:"transparent"!==e.strokeColor?e.strokeColor:"black",backgroundColor:"transparent",fontFamily:i,fontSize:n,text:hH(t,l,e.width-20),textAlign:"center",verticalAlign:e0.MIDDLE,angle:e.angle??0})},iY({name:"setEmbeddableAsActiveTool",trackEvent:{category:"toolbar"},perform:(e,t,n,i)=>{let l=t1(t,{type:"embeddable"});return i4(i.canvas,{...t,activeTool:l}),{elements:e,appState:{...t,activeTool:t1(t,{type:"embeddable"})},commitToHistory:!1}}}),lR=(e,t)=>{try{let{hostname:n}=new URL(e),i=n.replace(/^www\./,""),l=i.replace(/^([^.]+)/,"*");if(t instanceof Set)return lL.has(i)||lL.has(l);if(i===t.replace(/^www\./,""))return!0}catch{}return!1},lN=e=>{let t=e.match(lI);if(t&&2===t.length)return t[1];let n=e.match(lk);if(n&&2===n.length)return n[1];if(lT.test(e))return`https://giphy.com/embed/${lT.exec(e)[1]}`;let i=e.match(lj);return i&&2===i.length?i[1]:e},lO=(e,t)=>{if(!e)return!1;if(null!=t){if("function"==typeof t){let n=t(e);if("boolean"==typeof n)return n}else{if("boolean"==typeof t)return t;if(t instanceof RegExp)return t.test(e);if(Array.isArray(t)){for(let n of t)if(n instanceof RegExp){if(e.match(n))return!0}else if(lR(e,n))return!0;return!1}}}return lR(e,lL)}}),dP=tC(()=>{}),d_=tC(()=>{tM(),lz=class extends Error{constructor(e="Couldn't export canvas.",t="CANVAS_ERROR"){super(),this.name=t,this.message=e}},lH=class extends DOMException{constructor(e="Request Aborted"){super(e,"AbortError")}},lB=class extends Error{code;constructor(e="Image Scene Data Error",t="IMAGE_SCENE_DATA_ERROR"){super(e),this.name="EncodingError",this.code=t}}}),dR=tC(()=>{tM(),dP(),CJ(),d_(),tA(),(lF=l.forwardRef((e,t)=>{let{id:n}=k5(),i=l.useRef(null);l.useImperativeHandle(t,()=>i.current);let r=`ToolIcon_size_${e.size}`,[a,o]=(0,l.useState)(!1),c=(0,l.useRef)(!0),h=async t=>{let n="onClick"in e&&e.onClick?.(t);if(n&&"then"in n)try{o(!0),await n}catch(e){if(e instanceof lH)console.warn(e);else throw e}finally{c.current&&o(!1)}};(0,l.useEffect)(()=>(c.current=!0,()=>{c.current=!1}),[]);let m=(0,l.useRef)(null);if("button"===e.type||"icon"===e.type||"submit"===e.type){let t="icon"===e.type?"button":e.type;return(0,s.jsxs)("button",{className:(0,d.Z)("ToolIcon_type_button",r,e.className,e.visible&&!e.hidden?"ToolIcon_type_button--show":"ToolIcon_type_button--hide",{ToolIcon:!e.hidden,"ToolIcon--selected":e.selected,"ToolIcon--plain":"icon"===e.type}),style:e.style,"data-testid":e["data-testid"],hidden:e.hidden,title:e.title,"aria-label":e["aria-label"],type:t,onClick:h,ref:i,disabled:a||e.isLoading,children:[(e.icon||e.label)&&(0,s.jsxs)("div",{className:"ToolIcon__icon","aria-hidden":"true",children:[e.icon||e.label,e.keyBindingLabel&&(0,s.jsx)("span",{className:"ToolIcon__keybinding",children:e.keyBindingLabel}),e.isLoading&&(0,s.jsx)(j,{})]}),e.showAriaLabel&&(0,s.jsxs)("div",{className:"ToolIcon__label",children:[e["aria-label"]," ",a&&(0,s.jsx)(j,{})]}),e.children]})}return(0,s.jsxs)("label",{className:(0,d.Z)("ToolIcon",e.className),title:e.title,onPointerDown:t=>{m.current=t.pointerType||null,e.onPointerDown?.({pointerType:t.pointerType||null})},onPointerUp:()=>{requestAnimationFrame(()=>{m.current=null})},children:[(0,s.jsx)("input",{className:`ToolIcon_type_radio ${r}`,type:"radio",name:e.name,"aria-label":e["aria-label"],"aria-keyshortcuts":e["aria-keyshortcuts"],"data-testid":e["data-testid"],id:`${n}-${e.id}`,onChange:()=>{e.onChange?.({pointerType:m.current})},checked:e.checked,ref:i}),(0,s.jsxs)("div",{className:"ToolIcon__icon",children:[e.icon,e.keyBindingLabel&&(0,s.jsx)("span",{className:"ToolIcon__keybinding",children:e.keyBindingLabel})]})]})})).defaultProps={visible:!0,className:"",size:"medium"},lF.displayName="ToolButton"}),dN=tC(()=>{tM(),tR(),l$=e=>"var(--icon-fill-color)",lZ=e=>e===ep.LIGHT?o.white:"#1e1e1e",lU={width:24,height:24,fill:"none",strokeWidth:2,stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"},lG={width:20,height:20,fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"},(lW=(e,t=512)=>{let{width:n=512,height:i=n,mirror:l,style:r,...a}="number"==typeof t?{width:t}:t;return(0,s.jsx)("svg",{"aria-hidden":"true",focusable:"false",role:"img",viewBox:`0 0 ${n} ${i}`,className:(0,d.Z)({"rtl-mirror":l}),style:r,...a,children:"string"==typeof e?(0,s.jsx)("path",{fill:"currentColor",d:e}):e})})((0,s.jsxs)("g",{strokeWidth:"1.5",children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("rect",{x:3,y:8,width:18,height:4,rx:1}),(0,s.jsx)("line",{x1:12,y1:8,x2:12,y2:21}),(0,s.jsx)("path",{d:"M19 12v7a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-7"}),(0,s.jsx)("path",{d:"M7.5 8a2.5 2.5 0 0 1 0 -5a4.8 8 0 0 1 4.5 5a4.8 8 0 0 1 4.5 -5a2.5 2.5 0 0 1 0 5"})]}),lU),lV=lW((0,s.jsxs)("g",{strokeWidth:"1.5",children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("path",{d:"M3 19a9 9 0 0 1 9 0a9 9 0 0 1 9 0"}),(0,s.jsx)("path",{d:"M3 6a9 9 0 0 1 9 0a9 9 0 0 1 9 0"}),(0,s.jsx)("line",{x1:"3",y1:"6",x2:"3",y2:"19"}),(0,s.jsx)("line",{x1:"12",y1:"6",x2:"12",y2:"19"}),(0,s.jsx)("line",{x1:"21",y1:"6",x2:"21",y2:"19"})]}),lU),lK=lW((0,s.jsxs)("svg",{strokeWidth:"1.5",children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),(0,s.jsx)("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),lU),lY=lW((0,s.jsxs)("g",{strokeWidth:"1.5",children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("circle",{cx:"12",cy:"12",r:"1"}),(0,s.jsx)("circle",{cx:"12",cy:"19",r:"1"}),(0,s.jsx)("circle",{cx:"12",cy:"5",r:"1"})]}),lU),lX=lW((0,s.jsxs)("svg",{strokeWidth:"1.5",children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("path",{d:"M9 4v6l-2 4v2h10v-2l-2 -4v-6"}),(0,s.jsx)("line",{x1:"12",y1:"16",x2:"12",y2:"21"}),(0,s.jsx)("line",{x1:"8",y1:"4",x2:"16",y2:"4"})]}),lU),lq=lW((0,s.jsxs)("g",{children:[(0,s.jsx)("path",{d:"M13.542 8.542H6.458a2.5 2.5 0 0 0-2.5 2.5v3.75a2.5 2.5 0 0 0 2.5 2.5h7.084a2.5 2.5 0 0 0 2.5-2.5v-3.75a2.5 2.5 0 0 0-2.5-2.5Z",stroke:"currentColor",strokeWidth:"1.25"}),(0,s.jsx)("path",{d:"M10 13.958a1.042 1.042 0 1 0 0-2.083 1.042 1.042 0 0 0 0 2.083Z",stroke:"currentColor",strokeWidth:"1.25"}),(0,s.jsx)("mask",{id:"UnlockedIcon",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:6,y:1,width:9,height:9,children:(0,s.jsx)("path",{stroke:"none",d:"M6.399 9.561V5.175c0-.93.401-1.823 1.116-2.48a3.981 3.981 0 0 1 2.693-1.028c1.01 0 1.98.37 2.694 1.027.715.658 1.116 1.55 1.116 2.481",fill:"#fff"})}),(0,s.jsx)("g",{mask:"url(#UnlockedIcon)",children:(0,s.jsx)("path",{stroke:"none",d:"M5.149 9.561v1.25h2.5v-1.25h-2.5Zm5.06-7.894V.417v1.25Zm2.559 3.508v1.25h2.5v-1.25h-2.5ZM7.648 8.51V5.175h-2.5V8.51h2.5Zm0-3.334c0-.564.243-1.128.713-1.561L6.668 1.775c-.959.883-1.52 2.104-1.52 3.4h2.5Zm.713-1.561a2.732 2.732 0 0 1 1.847-.697v-2.5c-1.31 0-2.585.478-3.54 1.358L8.36 3.614Zm1.847-.697c.71 0 1.374.26 1.847.697l1.694-1.839a5.231 5.231 0 0 0-3.54-1.358v2.5Zm1.847.697c.47.433.713.997.713 1.561h2.5c0-1.296-.56-2.517-1.52-3.4l-1.693 1.839Z",fill:"currentColor"})})]}),lG),lJ=lW((0,s.jsxs)("g",{strokeWidth:"1.25",children:[(0,s.jsx)("path",{d:"M13.542 8.542H6.458a2.5 2.5 0 0 0-2.5 2.5v3.75a2.5 2.5 0 0 0 2.5 2.5h7.084a2.5 2.5 0 0 0 2.5-2.5v-3.75a2.5 2.5 0 0 0-2.5-2.5Z"}),(0,s.jsx)("path",{d:"M10 13.958a1.042 1.042 0 1 0 0-2.083 1.042 1.042 0 0 0 0 2.083Z"}),(0,s.jsx)("path",{d:"M6.667 8.333V5.417C6.667 3.806 8.159 2.5 10 2.5c1.841 0 3.333 1.306 3.333 2.917v2.916"})]}),lG),lQ=lW((0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("path",{d:"M38.5 83.5c-14-2-17.833-10.473-21-22.5C14.333 48.984 12 22 12 12.5",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"}),(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"m12.005 10.478 7.905 14.423L6 25.75l6.005-15.273Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M12.005 10.478c1.92 3.495 3.838 7 7.905 14.423m-7.905-14.423c3.11 5.683 6.23 11.368 7.905 14.423m0 0c-3.68.226-7.35.455-13.91.85m13.91-.85c-5.279.33-10.566.647-13.91.85m0 0c1.936-4.931 3.882-9.86 6.005-15.273M6 25.75c2.069-5.257 4.135-10.505 6.005-15.272",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"})]}),{width:41,height:94,fill:"none"}),l1=lW((0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("path",{d:"M18.026 1.232c-5.268 13.125-5.548 33.555 3.285 42.311 8.823 8.75 33.31 12.304 42.422 13.523",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"}),(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"m72.181 59.247-13.058-10-2.948 13.62 16.006-3.62Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M72.181 59.247c-3.163-2.429-6.337-4.856-13.058-10m13.058 10c-5.145-3.936-10.292-7.882-13.058-10m0 0c-.78 3.603-1.563 7.196-2.948 13.62m2.948-13.62c-1.126 5.168-2.24 10.346-2.948 13.62m0 0c5.168-1.166 10.334-2.343 16.006-3.62m-16.006 3.62c5.51-1.248 11.01-2.495 16.006-3.62",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"})]}),{width:85,height:71,fill:"none"}),l0=lW((0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("path",{d:"M1 77c14-2 31.833-11.973 35-24 3.167-12.016-6-35-9.5-43.5",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"}),(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"m24.165 1.093-2.132 16.309 13.27-4.258-11.138-12.05Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M24.165 1.093c-.522 3.953-1.037 7.916-2.132 16.309m2.131-16.309c-.835 6.424-1.68 12.854-2.13 16.308m0 0c3.51-1.125 7.013-2.243 13.27-4.257m-13.27 4.257c5.038-1.608 10.08-3.232 13.27-4.257m0 0c-3.595-3.892-7.197-7.777-11.14-12.05m11.14 12.05c-3.837-4.148-7.667-8.287-11.14-12.05",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"})]}),{width:38,height:78,fill:"none"}),lW((0,s.jsx)("g",{fill:"currentColor",children:(0,s.jsx)("path",{d:"M39.9 32.889a.326.326 0 0 0-.279-.056c-2.094-3.083-4.774-6-7.343-8.833l-.419-.472a.212.212 0 0 0-.056-.139.586.586 0 0 0-.167-.111l-.084-.083-.056-.056c-.084-.167-.28-.278-.475-.167-.782.39-1.507.973-2.206 1.528-.92.722-1.842 1.445-2.708 2.25a8.405 8.405 0 0 0-.977 1.028c-.14.194-.028.361.14.444-.615.611-1.23 1.223-1.843 1.861a.315.315 0 0 0-.084.223c0 .083.056.166.111.194l1.09.833v.028c1.535 1.528 4.244 3.611 7.12 5.861.418.334.865.667 1.284 1 .195.223.39.473.558.695.084.11.28.139.391.055.056.056.14.111.196.167a.398.398 0 0 0 .167.056.255.255 0 0 0 .224-.111.394.394 0 0 0 .055-.167c.029 0 .028.028.056.028a.318.318 0 0 0 .224-.084l5.082-5.528a.309.309 0 0 0 0-.444Zm-14.63-1.917a.485.485 0 0 0 .111.14c.586.5 1.2 1 1.843 1.555l-2.569-1.945-.251-.166c-.056-.028-.112-.084-.168-.111l-.195-.167.056-.056.055-.055.112-.111c.866-.861 2.346-2.306 3.1-3.028-.81.805-2.43 3.167-2.095 3.944Zm8.767 6.89-2.122-1.612a44.713 44.713 0 0 0-2.625-2.5c1.145.861 2.122 1.611 2.262 1.75 1.117.972 1.06.806 1.815 1.445l.921.666a1.06 1.06 0 0 1-.251.25Zm.558.416-.056-.028c.084-.055.168-.111.252-.194l-.196.222ZM1.089 5.75c.055.361.14.722.195 1.056.335 1.833.67 3.5 1.284 4.75l.252.944c.084.361.223.806.363.917 1.424 1.25 3.602 3.11 5.947 4.889a.295.295 0 0 0 .363 0s0 .027.028.027a.254.254 0 0 0 .196.084.318.318 0 0 0 .223-.084c2.988-3.305 5.221-6.027 6.813-8.305.112-.111.14-.278.14-.417.111-.111.195-.25.307-.333.111-.111.111-.306 0-.39l-.028-.027c0-.055-.028-.139-.084-.167-.698-.666-1.2-1.138-1.731-1.638-.922-.862-1.871-1.75-3.881-3.75l-.028-.028c-.028-.028-.056-.056-.112-.056-.558-.194-1.703-.389-3.127-.639C6.087 2.223 3.21 1.723.614.944c0 0-.168 0-.196.028l-.083.084c-.028.027-.056.055-.224.11h.056-.056c.028.167.028.278.084.473 0 .055.112.5.112.555l.782 3.556Zm15.496 3.278-.335-.334c.084.112.196.195.335.334Zm-3.546 4.666-.056.056c0-.028.028-.056.056-.056Zm-2.038-10c.168.167.866.834 1.033.973-.726-.334-2.54-1.167-3.379-1.445.838.167 1.983.334 2.346.472ZM1.424 2.306c.419.722.754 3.222 1.089 5.666-.196-.778-.335-1.555-.503-2.278-.251-1.277-.503-2.416-.838-3.416.056 0 .14 0 .252.028Zm-.168-.584c-.112 0-.223-.028-.307-.028 0-.027 0-.055-.028-.055.14 0 .223.028.335.083Zm-1.089.222c0-.027 0-.027 0 0ZM39.453 1.333c.028-.11-.558-.61-.363-.639.42-.027.42-.666 0-.666-.558.028-1.144.166-1.675.25-.977.194-1.982.389-2.96.61-2.205.473-4.383.973-6.561 1.557-.67.194-1.424.333-2.066.666-.224.111-.196.333-.084.472-.056.028-.084.028-.14.056-.195.028-.363.056-.558.083-.168.028-.252.167-.224.334 0 .027.028.083.028.11-1.173 1.556-2.485 3.195-3.909 4.945-1.396 1.611-2.876 3.306-4.356 5.056-4.719 5.5-10.052 11.75-15.943 17.25a.268.268 0 0 0 0 .389c.028.027.056.055.084.055-.084.084-.168.14-.252.222-.056.056-.084.111-.084.167a.605.605 0 0 0-.111.139c-.112.111-.112.305.028.389.111.11.307.11.39-.028.029-.028.029-.056.056-.056a.44.44 0 0 1 .615 0c.335.362.67.723.977 1.028l-.698-.583c-.112-.111-.307-.083-.39.028-.113.11-.085.305.027.389l7.427 6.194c.056.056.112.056.196.056s.14-.028.195-.084l.168-.166c.028.027.083.027.111.027.084 0 .14-.027.196-.083 10.052-10.055 18.15-17.639 27.42-24.417.083-.055.111-.166.111-.25.112 0 .196-.083.251-.194 1.704-5.194 2.039-9.806 2.15-12.083v-.028c0-.028.028-.056.028-.083.028-.056.028-.084.028-.084a1.626 1.626 0 0 0-.111-1.028ZM21.472 9.5c.446-.5.893-1.028 1.34-1.5-2.876 3.778-7.65 9.583-14.408 16.5 4.607-5.083 9.242-10.333 13.068-15ZM5.193 35.778h.084-.084Zm3.462 3.194c-.027-.028-.027-.028 0-.028v.028Zm4.16-3.583c.224-.25.448-.472.699-.722 0 0 0 .027.028.027-.252.223-.475.445-.726.695Zm1.146-1.111c.14-.14.279-.334.446-.5l.028-.028c1.648-1.694 3.351-3.389 5.082-5.111l.028-.028c.419-.333.921-.694 1.368-1.028a379.003 379.003 0 0 0-6.952 6.695ZM24.794 6.472c-.921 1.195-1.954 2.778-2.82 4.028-2.736 3.944-11.532 13.583-11.727 13.75a1976.983 1976.983 0 0 1-8.042 7.639l-.167.167c-.14-.167-.14-.417.028-.556C14.49 19.861 22.03 10.167 25.074 5.917c-.084.194-.14.36-.28.555Zm4.83 5.695c-1.116-.64-1.646-1.64-1.34-2.611l.084-.334c.028-.083.084-.194.14-.277.307-.5.754-.917 1.257-1.167.027 0 .055 0 .083-.028-.028-.056-.028-.139-.028-.222.028-.167.14-.278.335-.278.335 0 1.369.306 1.76.639.111.083.223.194.335.305.14.167.363.445.474.667.056.028.112.306.196.445.056.222.111.472.084.694-.028.028 0 .194-.028.194a2.668 2.668 0 0 1-.363 1.028c-.028.028-.028.056-.056.084l-.028.027c-.14.223-.335.417-.53.556-.643.444-1.369.583-2.095.389 0 0-.195-.084-.28-.111Zm8.154-.834a39.098 39.098 0 0 1-.893 3.167c0 .028-.028.083 0 .111-.056 0-.084.028-.14.056-2.206 1.61-4.356 3.305-6.506 5.028 1.843-1.64 3.686-3.306 5.613-4.945.558-.5.949-1.139 1.06-1.861l.28-1.667v-.055c.14-.334.67-.195.586.166Z",fill:"currentColor"})}),{width:40,height:40,fill:"none"}),l2=lW((0,s.jsxs)("g",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("path",{d:"M6 6l4.153 11.793a0.365 .365 0 0 0 .331 .207a0.366 .366 0 0 0 .332 -.207l2.184 -4.793l4.787 -1.994a0.355 .355 0 0 0 .213 -.323a0.355 .355 0 0 0 -.213 -.323l-11.787 -4.36z"}),(0,s.jsx)("path",{d:"M13.5 13.5l4.5 4.5"})]}),{fill:"none",width:22,height:22,strokeWidth:1.25}),l3=lW((0,s.jsxs)("g",{strokeWidth:"1.5",children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})]}),lU),l6=lW((0,s.jsxs)("g",{strokeWidth:"1.5",children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("path",{d:"M10.5 20.4l-6.9 -6.9c-.781 -.781 -.781 -2.219 0 -3l6.9 -6.9c.781 -.781 2.219 -.781 3 0l6.9 6.9c.781 .781 .781 2.219 0 3l-6.9 6.9c-.781 .781 -2.219 .781 -3 0z"})]}),lU),l4=lW((0,s.jsxs)("g",{strokeWidth:"1.5",children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("circle",{cx:"12",cy:"12",r:"9"})]}),lU),l5=lW((0,s.jsxs)("g",{strokeWidth:"1.5",children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("line",{x1:"5",y1:"12",x2:"19",y2:"12"}),(0,s.jsx)("line",{x1:"15",y1:"16",x2:"19",y2:"12"}),(0,s.jsx)("line",{x1:"15",y1:"8",x2:"19",y2:"12"})]}),lU),l8=lW((0,s.jsx)("path",{d:"M4.167 10h11.666",strokeWidth:"1.5"}),lG),l7=lW((0,s.jsxs)("g",{strokeWidth:"1.25",children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("path",{d:"M20 17v-12c0 -1.121 -.879 -2 -2 -2s-2 .879 -2 2v12l2 2l2 -2z"}),(0,s.jsx)("path",{d:"M16 7h4"}),(0,s.jsx)("path",{d:"M18 19h-13a2 2 0 1 1 0 -4h4a2 2 0 1 0 0 -4h-3"})]}),lU),l9=lW((0,s.jsxs)("g",{strokeWidth:"1.25",children:[(0,s.jsx)("path",{clipRule:"evenodd",d:"m7.643 15.69 7.774-7.773a2.357 2.357 0 1 0-3.334-3.334L4.31 12.357a3.333 3.333 0 0 0-.977 2.357v1.953h1.953c.884 0 1.732-.352 2.357-.977Z"}),(0,s.jsx)("path",{d:"m11.25 5.417 3.333 3.333"})]}),lG),re=lW((0,s.jsxs)("g",{strokeWidth:"1.5",children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("line",{x1:"4",y1:"20",x2:"7",y2:"20"}),(0,s.jsx)("line",{x1:"14",y1:"20",x2:"21",y2:"20"}),(0,s.jsx)("line",{x1:"6.9",y1:"15",x2:"13.8",y2:"15"}),(0,s.jsx)("line",{x1:"10.2",y1:"6.3",x2:"16",y2:"20"}),(0,s.jsx)("polyline",{points:"5 20 11 4 13 4 20 20"})]}),lU),rt=lW((0,s.jsxs)("g",{strokeWidth:"1.25",children:[(0,s.jsx)("path",{d:"M12.5 6.667h.01"}),(0,s.jsx)("path",{d:"M4.91 2.625h10.18a2.284 2.284 0 0 1 2.285 2.284v10.182a2.284 2.284 0 0 1-2.284 2.284H4.909a2.284 2.284 0 0 1-2.284-2.284V4.909a2.284 2.284 0 0 1 2.284-2.284Z"}),(0,s.jsx)("path",{d:"m3.333 12.5 3.334-3.333c.773-.745 1.726-.745 2.5 0l4.166 4.166"}),(0,s.jsx)("path",{d:"m11.667 11.667.833-.834c.774-.744 1.726-.744 2.5 0l1.667 1.667"})]}),lG),rn=lW((0,s.jsxs)("g",{strokeWidth:"1.5",children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("path",{d:"M19 20h-10.5l-4.21 -4.3a1 1 0 0 1 0 -1.41l10 -10a1 1 0 0 1 1.41 0l5 5a1 1 0 0 1 0 1.41l-9.2 9.3"}),(0,s.jsx)("path",{d:"M18 13.3l-6.3 -6.3"})]}),lU),ri=lW((0,s.jsx)("path",{strokeWidth:"1.25",d:"M10 4.167v11.666M4.167 10h11.666"}),lG),rl=lW((0,s.jsx)("path",{d:"M5 10h10",strokeWidth:"1.25"}),lG),rr=lW((0,s.jsx)("path",{strokeWidth:"1.25",d:"M3.333 5.833h13.334M8.333 9.167v5M11.667 9.167v5M4.167 5.833l.833 10c0 .92.746 1.667 1.667 1.667h6.666c.92 0 1.667-.746 1.667-1.667l.833-10M7.5 5.833v-2.5c0-.46.373-.833.833-.833h3.334c.46 0 .833.373.833.833v2.5"}),lG),ra=lW((0,s.jsxs)("g",{strokeWidth:"1.25",children:[(0,s.jsx)("polyline",{points:"12 16 18 10 12 4"}),(0,s.jsx)("polyline",{points:"8 4 2 10 8 16"})]}),lG),rs=lW((0,s.jsxs)("g",{strokeWidth:"1.25",children:[(0,s.jsx)("path",{d:"M14.375 6.458H8.958a2.5 2.5 0 0 0-2.5 2.5v5.417a2.5 2.5 0 0 0 2.5 2.5h5.417a2.5 2.5 0 0 0 2.5-2.5V8.958a2.5 2.5 0 0 0-2.5-2.5Z"}),(0,s.jsx)("path",{clipRule:"evenodd",d:"M11.667 3.125c.517 0 .986.21 1.325.55.34.338.55.807.55 1.325v1.458H8.333c-.485 0-.927.185-1.26.487-.343.312-.57.75-.609 1.24l-.005 5.357H5a1.87 1.87 0 0 1-1.326-.55 1.87 1.87 0 0 1-.549-1.325V5c0-.518.21-.987.55-1.326.338-.34.807-.549 1.325-.549h6.667Z"})]}),lG),ro=lW((0,s.jsx)("path",{clipRule:"evenodd",d:"M10 2.5h.328a6.25 6.25 0 0 0 6.6 10.372A7.5 7.5 0 1 1 10 2.493V2.5Z",stroke:"currentColor"}),lG),rd=lW((0,s.jsx)("g",{stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round",children:(0,s.jsx)("path",{d:"M10 12.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5ZM10 4.167V2.5M14.167 5.833l1.166-1.166M15.833 10H17.5M14.167 14.167l1.166 1.166M10 15.833V17.5M5.833 14.167l-1.166 1.166M5 10H3.333M5.833 5.833 4.667 4.667"})}),lG),rc=lW((0,s.jsxs)("g",{strokeWidth:"1.5",children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("line",{x1:"4",y1:"6",x2:"20",y2:"6"}),(0,s.jsx)("line",{x1:"4",y1:"12",x2:"20",y2:"12"}),(0,s.jsx)("line",{x1:"4",y1:"18",x2:"20",y2:"18"})]}),lU),rh=lW((0,s.jsx)("path",{strokeWidth:"1.25",d:"M3.333 14.167v1.666c0 .92.747 1.667 1.667 1.667h10c.92 0 1.667-.746 1.667-1.667v-1.666M5.833 9.167 10 13.333l4.167-4.166M10 3.333v10"}),lG),rm=lW((0,s.jsxs)("g",{strokeWidth:"1.5",children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("circle",{cx:"12",cy:"12",r:"9"}),(0,s.jsx)("line",{x1:"12",y1:"17",x2:"12",y2:"17.01"}),(0,s.jsx)("path",{d:"M12 13.5a1.5 1.5 0 0 1 1 -1.5a2.6 2.6 0 1 0 -3 -4"})]}),lU),ru=lW((0,s.jsx)("path",{strokeWidth:"1.25",d:"M9.167 5.833H5.833c-1.254 0-2.5 1.282-2.5 2.5v5.834c0 1.283 1.252 2.5 2.5 2.5h5.834c1.251 0 2.5-1.25 2.5-2.5v-3.334M8.333 11.667l8.334-8.334M12.5 3.333h4.167V7.5"}),lG),rp=lW((0,s.jsx)("path",{d:"M7.5 15.833c-3.583 1.167-3.583-2.083-5-2.5m10 4.167v-2.917c0-.833.083-1.166-.417-1.666 2.334-.25 4.584-1.167 4.584-5a3.833 3.833 0 0 0-1.084-2.667 3.5 3.5 0 0 0-.083-2.667s-.917-.25-2.917 1.084a10.25 10.25 0 0 0-5.166 0C5.417 2.333 4.5 2.583 4.5 2.583a3.5 3.5 0 0 0-.083 2.667 3.833 3.833 0 0 0-1.084 2.667c0 3.833 2.25 4.75 4.584 5-.5.5-.5 1-.417 1.666V17.5",strokeWidth:"1.25"}),lG),rg=lW((0,s.jsxs)("g",{strokeWidth:"1.25",children:[(0,s.jsx)("path",{d:"M7.5 10.833a.833.833 0 1 0 0-1.666.833.833 0 0 0 0 1.666ZM12.5 10.833a.833.833 0 1 0 0-1.666.833.833 0 0 0 0 1.666ZM6.25 6.25c2.917-.833 4.583-.833 7.5 0M5.833 13.75c2.917.833 5.417.833 8.334 0"}),(0,s.jsx)("path",{d:"M12.917 14.167c0 .833 1.25 2.5 1.666 2.5 1.25 0 2.361-1.39 2.917-2.5.556-1.39.417-4.861-1.25-9.584-1.214-.846-2.5-1.116-3.75-1.25l-.833 2.084M7.083 14.167c0 .833-1.13 2.5-1.526 2.5-1.191 0-2.249-1.39-2.778-2.5-.529-1.39-.397-4.861 1.19-9.584 1.157-.846 2.318-1.116 3.531-1.25l.833 2.084"})]}),lG),rf=lW((0,s.jsxs)("g",{strokeWidth:"1.25",children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("path",{d:"M4 4l11.733 16h4.267l-11.733 -16z"}),(0,s.jsx)("path",{d:"M4 20l6.768 -6.768m2.46 -2.46l6.772 -6.772"})]}),lU),rx=lW((0,s.jsx)("polyline",{fill:"none",stroke:"currentColor",points:"20 6 9 17 4 12"}),{width:24,height:24}),ry=lW((0,s.jsxs)("g",{strokeWidth:"1.25",children:[(0,s.jsx)("path",{d:"M8.333 11.667a2.917 2.917 0 0 0 4.167 0l3.333-3.334a2.946 2.946 0 1 0-4.166-4.166l-.417.416"}),(0,s.jsx)("path",{d:"M11.667 8.333a2.917 2.917 0 0 0-4.167 0l-3.333 3.334a2.946 2.946 0 0 0 4.166 4.166l.417-.416"})]}),lG),rb=lW("M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z",{width:448,height:512}),rv=lW("M252 54L203 8a28 27 0 00-20-8H28C12 0 0 12 0 27v195c0 15 12 26 28 26h204c15 0 28-11 28-26V73a28 27 0 00-8-19zM130 213c-21 0-37-16-37-36 0-19 16-35 37-35 20 0 37 16 37 35 0 20-17 36-37 36zm56-169v56c0 4-4 6-7 6H44c-4 0-7-2-7-6V42c0-4 3-7 7-7h133l4 2 3 2a7 7 0 012 5z M296 201l87 95-188 205-78 9c-10 1-19-8-18-20l9-84zm141-14l-41-44a31 31 0 00-46 0l-38 41 87 95 38-42c13-14 13-36 0-50z",{width:448,height:512}),rw=lW((0,s.jsx)("path",{d:"m9.257 6.351.183.183H15.819c.34 0 .727.182 1.051.506.323.323.505.708.505 1.05v5.819c0 .316-.183.7-.52 1.035-.337.338-.723.522-1.037.522H4.182c-.352 0-.74-.181-1.058-.5-.318-.318-.499-.705-.499-1.057V5.182c0-.351.181-.736.5-1.054.32-.321.71-.503 1.057-.503H6.53l2.726 2.726Z",strokeWidth:"1.25"}),lG),lW("M384 112v352c0 26.51-21.49 48-48 48H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h80c0-35.29 28.71-64 64-64s64 28.71 64 64h80c26.51 0 48 21.49 48 48zM192 40c-13.255 0-24 10.745-24 24s10.745 24 24 24 24-10.745 24-24-10.745-24-24-24m96 114v-20a6 6 0 0 0-6-6H102a6 6 0 0 0-6 6v20a6 6 0 0 0 6 6h180a6 6 0 0 0 6-6z",{width:384,height:512}),rE=lW("M204.3 5C104.9 24.4 24.8 104.3 5.2 203.4c-37 187 131.7 326.4 258.8 306.7 41.2-6.4 61.4-54.6 42.5-91.7-23.1-45.4 9.9-98.4 60.9-98.4h79.7c35.8 0 64.8-29.6 64.9-65.3C511.5 97.1 368.1-26.9 204.3 5zM96 320c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm32-128c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128-64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z"),rS=lW((0,s.jsxs)("g",{strokeWidth:"1.25",children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("path",{d:"M15 8h.01"}),(0,s.jsx)("path",{d:"M12 20h-5a3 3 0 0 1 -3 -3v-10a3 3 0 0 1 3 -3h10a3 3 0 0 1 3 3v5"}),(0,s.jsx)("path",{d:"M4 15l4 -4c.928 -.893 2.072 -.893 3 0l4 4"}),(0,s.jsx)("path",{d:"M14 14l1 -1c.617 -.593 1.328 -.793 2.009 -.598"}),(0,s.jsx)("path",{d:"M19 16v6"}),(0,s.jsx)("path",{d:"M22 19l-3 3l-3 -3"})]}),lU),rk=lW("M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z",{width:512,height:512}),lW("M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z",{width:448,height:512}),lW("M416 208H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h384c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z",{width:448,height:512}),rC=lW("M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"),lW("M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"),rI=lW((0,s.jsx)("path",{d:"M7.5 10.833 4.167 7.5 7.5 4.167M4.167 7.5h9.166a3.333 3.333 0 0 1 0 6.667H12.5",strokeWidth:"1.25"}),lG),rM=lW((0,s.jsx)("path",{d:"M12.5 10.833 15.833 7.5 12.5 4.167M15.833 7.5H6.667a3.333 3.333 0 1 0 0 6.667H7.5",strokeWidth:"1.25"}),lG),rj=lW("M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zM262.655 90c-54.497 0-89.255 22.957-116.549 63.758-3.536 5.286-2.353 12.415 2.715 16.258l34.699 26.31c5.205 3.947 12.621 3.008 16.665-2.122 17.864-22.658 30.113-35.797 57.303-35.797 20.429 0 45.698 13.148 45.698 32.958 0 14.976-12.363 22.667-32.534 33.976C247.128 238.528 216 254.941 216 296v4c0 6.627 5.373 12 12 12h56c6.627 0 12-5.373 12-12v-1.333c0-28.462 83.186-29.647 83.186-106.667 0-58.002-60.165-102-116.531-102zM256 338c-25.365 0-46 20.635-46 46 0 25.364 20.635 46 46 46s46-20.636 46-46c0-25.365-20.635-46-46-46z",{mirror:!0}),lW((0,s.jsx)("path",{d:"M5 12.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5ZM15 7.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5ZM15 17.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5ZM7.25 8.917l5.5-2.834M7.25 11.083l5.5 2.834",strokeWidth:"1.5"}),lG),lW("M16 5l-1.42 1.42-1.59-1.59V16h-1.98V4.83L9.42 6.42 8 5l4-4 4 4zm4 5v11c0 1.1-.9 2-2 2H6c-1.11 0-2-.9-2-2V10c0-1.11.89-2 2-2h3v2H6v11h12V10h-3V8h3c1.1 0 2 .89 2 2z",{width:24,height:24}),lW((0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("path",{fill:"currentColor",d:"M40 5.6v6.1l-4.1.7c-8.9 1.4-16.5 6.9-20.6 15C13 32 10.9 43 12.4 43c.4 0 2.4-1.3 4.4-3 5-3.9 12.1-7 18.2-7.7l5-.6v12.8l11.2-11.3L62.5 22 51.2 10.8 40-.5v6.1zm10.2 22.6L44 34.5v-6.8l-6.9.6c-3.9.3-9.8 1.7-13.2 3.1-3.5 1.4-6.5 2.4-6.7 2.2-.9-1 3-7.5 6.4-10.8C28 18.6 34.4 16 40.1 16c3.7 0 3.9-.1 3.9-3.2V9.5l6.2 6.3 6.3 6.2-6.3 6.2z"}),(0,s.jsx)("path",{stroke:"currentColor",fill:"currentColor",d:"M0 36v20h48v-6.2c0-6 0-6.1-2-4.3-1.1 1-2 2.9-2 4.2V52H4V34c0-17.3-.1-18-2-18s-2 .7-2 20z"})]}),{width:64,height:64}),lW((0,s.jsx)("path",{stroke:"currentColor",strokeWidth:"40",fill:"currentColor",d:"M148 560a318 318 0 0 0 522 110 316 316 0 0 0 0-450 316 316 0 0 0-450 0c-11 11-21 22-30 34v4h47c25 0 46 21 46 46s-21 45-46 45H90c-13 0-25-6-33-14-9-9-14-20-14-33V156c0-25 20-45 45-45s45 20 45 45v32l1 1a401 401 0 0 1 623 509l212 212a42 42 0 0 1-59 59L698 757A401 401 0 0 1 65 570a42 42 0 0 1 83-10z"}),{width:1024}),rT=lW((0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("path",{d:"M13.889 4.167H8.333c-.767 0-1.389.622-1.389 1.389v5.555c0 .767.622 1.389 1.39 1.389h5.555c.767 0 1.389-.622 1.389-1.389V5.556c0-.767-.622-1.39-1.39-1.39Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M12.5 12.5v1.389a1.389 1.389 0 0 1-1.389 1.389H5.556a1.389 1.389 0 0 1-1.39-1.39V8.334a1.389 1.389 0 0 1 1.39-1.389h1.388"})]}),(0,s.jsx)("defs",{children:(0,s.jsx)("clipPath",{id:"a",children:(0,s.jsx)("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),lG),rL=lW((0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.944 12.5H12.5v1.389a1.389 1.389 0 0 1-1.389 1.389H5.556a1.389 1.389 0 0 1-1.39-1.39V8.334a1.389 1.389 0 0 1 1.39-1.389h1.388",fill:"currentColor"}),(0,s.jsx)("path",{d:"M13.889 4.167H8.333c-.767 0-1.389.621-1.389 1.389v5.555c0 .767.622 1.389 1.39 1.389h5.555c.767 0 1.389-.622 1.389-1.389V5.556c0-.768-.622-1.39-1.39-1.39Z"})]}),(0,s.jsx)("defs",{children:(0,s.jsx)("clipPath",{id:"a",children:(0,s.jsx)("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),lG),rD=lW((0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[(0,s.jsx)("path",{d:"M8.775 6.458h2.45a2.316 2.316 0 0 1 2.317 2.316v2.452a2.316 2.316 0 0 1-2.316 2.316H8.774a2.316 2.316 0 0 1-2.317-2.316V8.774a2.316 2.316 0 0 1 2.317-2.316Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M5.441 9.792h2.451a2.316 2.316 0 0 1 2.316 2.316v2.45a2.316 2.316 0 0 1-2.316 2.317h-2.45a2.316 2.316 0 0 1-2.317-2.316v-2.451a2.316 2.316 0 0 1 2.316-2.316ZM12.108 3.125h2.45a2.316 2.316 0 0 1 2.317 2.316v2.451a2.316 2.316 0 0 1-2.316 2.316h-2.451a2.316 2.316 0 0 1-2.316-2.316v-2.45a2.316 2.316 0 0 1 2.316-2.317Z"})]}),(0,s.jsx)("defs",{children:(0,s.jsx)("clipPath",{id:"a",children:(0,s.jsx)("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),lG),rA=lW((0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("g",{clipPath:"url(#a)",children:[(0,s.jsx)("path",{d:"M5.441 9.792h2.451a2.316 2.316 0 0 1 2.316 2.316v2.45a2.316 2.316 0 0 1-2.316 2.317h-2.45a2.316 2.316 0 0 1-2.317-2.316v-2.451a2.316 2.316 0 0 1 2.316-2.316Z",stroke:"currentColor",strokeWidth:"1.25"}),(0,s.jsx)("path",{d:"M5.441 9.792h2.451a2.316 2.316 0 0 1 2.316 2.316v2.45a2.316 2.316 0 0 1-2.316 2.317h-2.45a2.316 2.316 0 0 1-2.317-2.316v-2.451a2.316 2.316 0 0 1 2.316-2.316Z",stroke:"currentColor",strokeWidth:"1.25"}),(0,s.jsx)("mask",{id:"SendToBackIcon",fill:"#fff",children:(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.167 5.833v2.06a2.941 2.941 0 0 0 2.94 2.94h2.06v.393a2.941 2.941 0 0 1-2.941 2.94h-.393v-2.058a2.941 2.941 0 0 0-2.94-2.941h-2.06v-.393a2.941 2.941 0 0 1 2.942-2.94h.392Z"})}),(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.167 5.833v2.06a2.941 2.941 0 0 0 2.94 2.94h2.06v.393a2.941 2.941 0 0 1-2.941 2.94h-.393v-2.058a2.941 2.941 0 0 0-2.94-2.941h-2.06v-.393a2.941 2.941 0 0 1 2.942-2.94h.392Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M9.167 5.833h1.25v-1.25h-1.25v1.25Zm5 5h1.25v-1.25h-1.25v1.25Zm-3.334 3.334h-1.25v1.25h1.25v-1.25Zm-5-5h-1.25v1.25h1.25v-1.25Zm2.084-3.334v2.06h2.5v-2.06h-2.5Zm0 2.06a4.191 4.191 0 0 0 4.19 4.19v-2.5a1.691 1.691 0 0 1-1.69-1.69h-2.5Zm4.19 4.19h2.06v-2.5h-2.06v2.5Zm.81-1.25v.393h2.5v-.393h-2.5Zm0 .393c0 .933-.758 1.69-1.691 1.69v2.5a4.191 4.191 0 0 0 4.19-4.19h-2.5Zm-1.691 1.69h-.393v2.5h.393v-2.5Zm.857 1.25v-2.058h-2.5v2.059h2.5Zm0-2.058a4.191 4.191 0 0 0-4.19-4.191v2.5c.933 0 1.69.757 1.69 1.69h2.5Zm-4.19-4.191h-2.06v2.5h2.06v-2.5Zm-.81 1.25v-.393h-2.5v.393h2.5Zm0-.393c0-.934.758-1.69 1.692-1.69v-2.5a4.191 4.191 0 0 0-4.192 4.19h2.5Zm1.692-1.69h.392v-2.5h-.392v2.5Z",fill:"currentColor",mask:"url(#SendToBackIcon)"}),(0,s.jsx)("path",{d:"M12.108 3.125h2.45a2.316 2.316 0 0 1 2.317 2.316v2.451a2.316 2.316 0 0 1-2.316 2.316h-2.451a2.316 2.316 0 0 1-2.316-2.316v-2.45a2.316 2.316 0 0 1 2.316-2.317Z",stroke:"currentColor",strokeWidth:"1.25"})]}),(0,s.jsx)("defs",{children:(0,s.jsx)("clipPath",{id:"a",children:(0,s.jsx)("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),lG),rP=lW((0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[(0,s.jsx)("path",{d:"M3.333 3.333h13.334",strokeLinecap:"round",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M13.542 6.458h-.417c-.92 0-1.667.747-1.667 1.667v7.083c0 .92.746 1.667 1.667 1.667h.417c.92 0 1.666-.746 1.666-1.667V8.125c0-.92-.746-1.667-1.666-1.667ZM6.875 6.458h-.417c-.92 0-1.666.747-1.666 1.667v3.75c0 .92.746 1.667 1.666 1.667h.417c.92 0 1.667-.746 1.667-1.667v-3.75c0-.92-.747-1.667-1.667-1.667Z"})]}),(0,s.jsx)("defs",{children:(0,s.jsx)("clipPath",{id:"a",children:(0,s.jsx)("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),lG),r_=lW((0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[(0,s.jsx)("path",{d:"M3.333 16.667h13.334",strokeLinecap:"round",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M6.875 3.125h-.417c-.92 0-1.666.746-1.666 1.667v7.083c0 .92.746 1.667 1.666 1.667h.417c.92 0 1.667-.746 1.667-1.667V4.792c0-.92-.747-1.667-1.667-1.667ZM13.542 5.817h-.417c-.92 0-1.667.747-1.667 1.667v4.391c0 .92.746 1.667 1.667 1.667h.417c.92 0 1.666-.746 1.666-1.667V7.484c0-.92-.746-1.667-1.666-1.667Z"})]}),(0,s.jsx)("defs",{children:(0,s.jsx)("clipPath",{id:"a",children:(0,s.jsx)("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),lG),rR=lW((0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[(0,s.jsx)("path",{d:"M3.333 3.333v13.334",strokeLinecap:"round",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M15.208 4.792H8.125c-.92 0-1.667.746-1.667 1.666v.417c0 .92.747 1.667 1.667 1.667h7.083c.92 0 1.667-.747 1.667-1.667v-.417c0-.92-.746-1.666-1.667-1.666ZM12.516 11.458H8.125c-.92 0-1.667.746-1.667 1.667v.417c0 .92.747 1.666 1.667 1.666h4.391c.92 0 1.667-.746 1.667-1.666v-.417c0-.92-.746-1.667-1.667-1.667Z"})]}),(0,s.jsx)("defs",{children:(0,s.jsx)("clipPath",{id:"a",children:(0,s.jsx)("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),lG),rN=lW((0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[(0,s.jsx)("path",{d:"M16.667 3.333v13.334",strokeLinecap:"round",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M11.875 4.792H4.792c-.92 0-1.667.746-1.667 1.666v.417c0 .92.746 1.667 1.667 1.667h7.083c.92 0 1.667-.747 1.667-1.667v-.417c0-.92-.746-1.666-1.667-1.666ZM11.683 11.458H7.292c-.92 0-1.667.746-1.667 1.667v.417c0 .92.746 1.666 1.667 1.666h4.39c.921 0 1.667-.746 1.667-1.666v-.417c0-.92-.746-1.667-1.666-1.667Z"})]}),(0,s.jsx)("defs",{children:(0,s.jsx)("clipPath",{id:"a",children:(0,s.jsx)("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),lG),rO=lW((0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[(0,s.jsx)("path",{d:"M16.667 3.333v13.334M3.333 3.333v13.334",strokeLinecap:"round",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M14.375 10.208v-.416c0-.92-.746-1.667-1.667-1.667H7.292c-.92 0-1.667.746-1.667 1.667v.416c0 .92.746 1.667 1.667 1.667h5.416c.92 0 1.667-.746 1.667-1.667Z"})]}),(0,s.jsx)("defs",{children:(0,s.jsx)("clipPath",{id:"a",children:(0,s.jsx)("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),lG),rz=lW((0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[(0,s.jsx)("path",{d:"M3.333 3.333h13.334M3.333 16.667h13.334",strokeLinecap:"round",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M10.208 5.625h-.416c-.92 0-1.667.746-1.667 1.667v5.416c0 .92.746 1.667 1.667 1.667h.416c.92 0 1.667-.746 1.667-1.667V7.292c0-.92-.746-1.667-1.667-1.667Z"})]}),(0,s.jsx)("defs",{children:(0,s.jsx)("clipPath",{id:"a",children:(0,s.jsx)("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),lG),rH=lW((0,s.jsxs)("g",{stroke:"currentColor",strokeWidth:"1.25",children:[(0,s.jsx)("path",{d:"M1.667 10h2.916",strokeLinecap:"round",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M8.333 10h3.334",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M15.417 10h2.916",strokeLinecap:"round",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M6.875 4.792h-.417c-.92 0-1.666.746-1.666 1.666v7.084c0 .92.746 1.666 1.666 1.666h.417c.92 0 1.667-.746 1.667-1.666V6.458c0-.92-.747-1.666-1.667-1.666ZM13.542 6.458h-.417c-.92 0-1.667.747-1.667 1.667v3.75c0 .92.746 1.667 1.667 1.667h.417c.92 0 1.666-.746 1.666-1.667v-3.75c0-.92-.746-1.667-1.666-1.667Z"})]}),lG),rB=lW((0,s.jsxs)("g",{stroke:"currentColor",strokeWidth:"1.25",children:[(0,s.jsx)("path",{d:"M10 18.333v-2.916",strokeLinecap:"round",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M10 11.667V8.333",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M10 4.583V1.667",strokeLinecap:"round",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M4.792 13.125v.417c0 .92.746 1.666 1.666 1.666h7.084c.92 0 1.666-.746 1.666-1.666v-.417c0-.92-.746-1.667-1.666-1.667H6.458c-.92 0-1.666.746-1.666 1.667ZM6.458 6.458v.417c0 .92.747 1.667 1.667 1.667h3.75c.92 0 1.667-.747 1.667-1.667v-.417c0-.92-.746-1.666-1.667-1.666h-3.75c-.92 0-1.667.746-1.667 1.666Z"})]}),lG),rF=lW((0,s.jsxs)("g",{strokeWidth:"1.5",children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("circle",{cx:"9",cy:"7",r:"4"}),(0,s.jsx)("path",{d:"M3 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2"}),(0,s.jsx)("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"}),(0,s.jsx)("path",{d:"M21 21v-2a4 4 0 0 0 -3 -3.85"})]}),lU),lW("M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm115.7 272l-176 101c-15.8 8.8-35.7-2.5-35.7-21V152c0-18.4 19.8-29.8 35.7-21l176 107c16.4 9.2 16.4 32.9 0 42z"),lW("M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm96 328c0 8.8-7.2 16-16 16H176c-8.8 0-16-7.2-16-16V176c0-8.8 7.2-16 16-16h160c8.8 0 16 7.2 16 16v160z"),r$=lW((0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round",children:(0,s.jsx)("path",{d:"M15 5 5 15M5 5l10 10"})}),(0,s.jsx)("defs",{children:(0,s.jsx)("clipPath",{id:"a",children:(0,s.jsx)("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),lG),rZ=lW("M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z",{width:320,height:512,style:{marginLeft:"-0.2rem"},mirror:!0}),lW("M464 0c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48H176c-26.51 0-48-21.49-48-48V48c0-26.51 21.49-48 48-48h288M176 416c-44.112 0-80-35.888-80-80V128H48c-26.51 0-48 21.49-48 48v288c0 26.51 21.49 48 48 48h288c26.51 0 48-21.49 48-48v-48H176z",{mirror:!0}),lW("M11.553 22.894a.998.998 0 00.894 0s3.037-1.516 5.465-4.097C19.616 16.987 21 14.663 21 12V5a1 1 0 00-.649-.936l-8-3a.998.998 0 00-.702 0l-8 3A1 1 0 003 5v7c0 2.663 1.384 4.987 3.088 6.797 2.428 2.581 5.465 4.097 5.465 4.097zm-1.303-8.481l6.644-6.644a.856.856 0 111.212 1.212l-7.25 7.25a.856.856 0 01-1.212 0l-3.75-3.75a.856.856 0 111.212-1.212l3.144 3.144z",{width:24}),lW("M369.9 97.9L286 14C277 5 264.8-.1 252.1-.1H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V131.9c0-12.7-5.1-25-14.1-34zM332.1 128H256V51.9l76.1 76.1zM48 464V48h160v104c0 13.3 10.7 24 24 24h104v288H48zm32-48h224V288l-23.5-23.5c-4.7-4.7-12.3-4.7-17 0L176 352l-39.5-39.5c-4.7-4.7-12.3-4.7-17 0L80 352v64zm48-240c-26.5 0-48 21.5-48 48s21.5 48 48 48 48-21.5 48-48-21.5-48-48-48z",{width:384,height:512}),rW=l.memo(({theme:e})=>lW((0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("path",{d:"M25 26H111V111H25",fill:l$(e)}),(0,s.jsx)("path",{d:"M25 111C25 80.2068 25 49.4135 25 26M25 26C48.6174 26 72.2348 26 111 26H25ZM25 26C53.3671 26 81.7343 26 111 26H25ZM111 26C111 52.303 111 78.606 111 111V26ZM111 26C111 51.2947 111 76.5893 111 111V26ZM111 111C87.0792 111 63.1585 111 25 111H111ZM111 111C87.4646 111 63.9293 111 25 111H111ZM25 111C25 81.1514 25 51.3028 25 26V111Z",stroke:l$(e),strokeWidth:"2"}),(0,s.jsx)("path",{d:"M100 100H160V160H100",fill:l$(e)}),(0,s.jsx)("path",{d:"M100 160C100 144.106 100 128.211 100 100M100 100C117.706 100 135.412 100 160 100H100ZM100 100C114.214 100 128.428 100 160 100H100ZM160 100C160 120.184 160 140.369 160 160V100ZM160 100C160 113.219 160 126.437 160 160V100ZM160 160C145.534 160 131.068 160 100 160H160ZM160 160C143.467 160 126.934 160 100 160H160ZM100 160C100 143.661 100 127.321 100 100V160Z",stroke:l$(e),strokeWidth:"2"}),(0,s.jsxs)("g",{fill:lZ(e),stroke:l$(e),strokeWidth:"6",children:[(0,s.jsx)("rect",{x:"2.5",y:"2.5",width:"30",height:"30"}),(0,s.jsx)("rect",{x:"2.5",y:"149.5",width:"30",height:"30"}),(0,s.jsx)("rect",{x:"147.5",y:"149.5",width:"30",height:"30"}),(0,s.jsx)("rect",{x:"147.5",y:"2.5",width:"30",height:"30"})]})]}),{width:182,height:182,mirror:!0})),rU=l.memo(({theme:e})=>lW((0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("path",{d:"M25 26H111V111H25",fill:l$(e)}),(0,s.jsx)("path",{d:"M25 111C25 80.2068 25 49.4135 25 26M25 26C48.6174 26 72.2348 26 111 26H25ZM25 26C53.3671 26 81.7343 26 111 26H25ZM111 26C111 52.303 111 78.606 111 111V26ZM111 26C111 51.2947 111 76.5893 111 111V26ZM111 111C87.0792 111 63.1585 111 25 111H111ZM111 111C87.4646 111 63.9293 111 25 111H111ZM25 111C25 81.1514 25 51.3028 25 26V111Z",stroke:l$(e),strokeWidth:"2"}),(0,s.jsx)("path",{d:"M100 100H160V160H100",fill:l$(e)}),(0,s.jsx)("path",{d:"M100 160C100 144.106 100 128.211 100 100M100 100C117.706 100 135.412 100 160 100H100ZM100 100C114.214 100 128.428 100 160 100H100ZM160 100C160 120.184 160 140.369 160 160V100ZM160 100C160 113.219 160 126.437 160 160V100ZM160 160C145.534 160 131.068 160 100 160H160ZM160 160C143.467 160 126.934 160 100 160H160ZM100 160C100 143.661 100 127.321 100 100V160Z",stroke:l$(e),strokeWidth:"2"}),(0,s.jsxs)("g",{fill:lZ(e),stroke:l$(e),strokeWidth:"6",children:[(0,s.jsx)("rect",{x:"2.5",y:"2.5",width:"30",height:"30"}),(0,s.jsx)("rect",{x:"78.5",y:"149.5",width:"30",height:"30"}),(0,s.jsx)("rect",{x:"147.5",y:"149.5",width:"30",height:"30"}),(0,s.jsx)("rect",{x:"147.5",y:"78.5",width:"30",height:"30"}),(0,s.jsx)("rect",{x:"105.5",y:"2.5",width:"30",height:"30"}),(0,s.jsx)("rect",{x:"2.5",y:"102.5",width:"30",height:"30"})]})]}),{width:182,height:182,mirror:!0})),rG=lW((0,s.jsx)("g",{strokeWidth:1.25,children:(0,s.jsx)("path",{d:"M5.879 2.625h8.242a3.27 3.27 0 0 1 3.254 3.254v8.242a3.27 3.27 0 0 1-3.254 3.254H5.88a3.27 3.27 0 0 1-3.254-3.254V5.88A3.27 3.27 0 0 1 5.88 2.626l-.001-.001ZM4.518 16.118l7.608-12.83m.198 13.934 5.051-9.897M2.778 9.675l9.348-6.387m-7.608 12.83 12.857-8.793"})}),lG),rV=lW((0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("path",{d:"M5.879 2.625h8.242a3.254 3.254 0 0 1 3.254 3.254v8.242a3.254 3.254 0 0 1-3.254 3.254H5.88a3.254 3.254 0 0 1-3.254-3.254V5.88a3.254 3.254 0 0 1 3.254-3.254Z",stroke:"currentColor",strokeWidth:"1.25"}),(0,s.jsx)("mask",{id:"FillHachureIcon",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:2,y:2,width:16,height:16,children:(0,s.jsx)("path",{d:"M5.879 2.625h8.242a3.254 3.254 0 0 1 3.254 3.254v8.242a3.254 3.254 0 0 1-3.254 3.254H5.88a3.254 3.254 0 0 1-3.254-3.254V5.88a3.254 3.254 0 0 1 3.254-3.254Z",fill:"currentColor",stroke:"currentColor",strokeWidth:"1.25"})}),(0,s.jsx)("g",{mask:"url(#FillHachureIcon)",children:(0,s.jsx)("path",{d:"M2.258 15.156 15.156 2.258M7.324 20.222 20.222 7.325m-20.444 5.35L12.675-.222m-8.157 18.34L17.416 5.22",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})})]}),lG),rK=lW((0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("g",{clipPath:"url(#a)",children:[(0,s.jsx)("path",{d:"M5.879 2.625h8.242a3.254 3.254 0 0 1 3.254 3.254v8.242a3.254 3.254 0 0 1-3.254 3.254H5.88a3.254 3.254 0 0 1-3.254-3.254V5.88a3.254 3.254 0 0 1 3.254-3.254Z",stroke:"currentColor",strokeWidth:"1.25"}),(0,s.jsx)("mask",{id:"FillCrossHatchIcon",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:-1,y:-1,width:22,height:22,children:(0,s.jsx)("path",{d:"M2.426 15.044 15.044 2.426M7.383 20 20 7.383M0 12.617 12.617 0m-7.98 17.941L17.256 5.324m-2.211 12.25L2.426 4.956M20 12.617 7.383 0m5.234 20L0 7.383m17.941 7.98L5.324 2.745",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,s.jsx)("g",{mask:"url(#FillCrossHatchIcon)",children:(0,s.jsx)("path",{d:"M14.121 2H5.88A3.879 3.879 0 0 0 2 5.879v8.242A3.879 3.879 0 0 0 5.879 18h8.242A3.879 3.879 0 0 0 18 14.121V5.88A3.879 3.879 0 0 0 14.121 2Z",fill:"currentColor"})})]}),(0,s.jsx)("defs",{children:(0,s.jsx)("clipPath",{id:"a",children:(0,s.jsx)("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),lG),rY=lW((0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("g",{clipPath:"url(#a)",children:(0,s.jsx)("path",{d:"M4.91 2.625h10.18a2.284 2.284 0 0 1 2.285 2.284v10.182a2.284 2.284 0 0 1-2.284 2.284H4.909a2.284 2.284 0 0 1-2.284-2.284V4.909a2.284 2.284 0 0 1 2.284-2.284Z",stroke:"currentColor",strokeWidth:"1.25"})}),(0,s.jsx)("defs",{children:(0,s.jsx)("clipPath",{id:"a",children:(0,s.jsx)("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),{...lG,fill:"currentColor"}),rX=lW((0,s.jsx)(s.Fragment,{children:(0,s.jsx)("path",{d:"M4.167 10h11.666",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),lG),rq=lW((0,s.jsx)("path",{d:"M5 10h10",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),lG),rJ=lW((0,s.jsx)("path",{d:"M5 10h10",stroke:"currentColor",strokeWidth:"3.75",strokeLinecap:"round",strokeLinejoin:"round"}),lG),l.memo(({theme:e})=>lW((0,s.jsx)("path",{d:"M6 10H34",stroke:l$(e),strokeWidth:2,fill:"none",strokeLinecap:"round"}),{width:40,height:20})),rQ=lW((0,s.jsxs)("g",{strokeWidth:"2",children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("path",{d:"M5 12h2"}),(0,s.jsx)("path",{d:"M17 12h2"}),(0,s.jsx)("path",{d:"M11 12h2"})]}),lU),r1=lW((0,s.jsxs)("g",{strokeWidth:"2",children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("path",{d:"M4 12v.01"}),(0,s.jsx)("path",{d:"M8 12v.01"}),(0,s.jsx)("path",{d:"M12 12v.01"}),(0,s.jsx)("path",{d:"M16 12v.01"}),(0,s.jsx)("path",{d:"M20 12v.01"})]}),lU),r0=lW((0,s.jsx)("path",{d:"M2.5 12.038c1.655-.885 5.9-3.292 8.568-4.354 2.668-1.063.101 2.821 1.32 3.104 1.218.283 5.112-1.814 5.112-1.814",strokeWidth:"1.25"}),lG),r2=lW((0,s.jsx)("path",{d:"M2.5 12.563c1.655-.886 5.9-3.293 8.568-4.355 2.668-1.062.101 2.822 1.32 3.105 1.218.283 5.112-1.814 5.112-1.814m-13.469 2.23c2.963-1.586 6.13-5.62 7.468-4.998 1.338.623-1.153 4.11-.132 5.595 1.02 1.487 6.133-1.43 6.133-1.43",strokeWidth:"1.25"}),lG),r3=lW((0,s.jsx)("path",{d:"M2.5 11.936c1.737-.879 8.627-5.346 10.42-5.268 1.795.078-.418 5.138.345 5.736.763.598 3.53-1.789 4.235-2.147M2.929 9.788c1.164-.519 5.47-3.28 6.987-3.114 1.519.165 1 3.827 2.121 4.109 1.122.281 3.839-2.016 4.606-2.42",strokeWidth:"1.25"}),lG),r6=lW((0,s.jsxs)("svg",{strokeWidth:"1.5",children:[(0,s.jsx)("path",{d:"M3.33334 9.99998V6.66665C3.33334 6.04326 3.33403 4.9332 3.33539 3.33646C4.95233 3.33436 6.06276 3.33331 6.66668 3.33331H10"}),(0,s.jsx)("path",{d:"M13.3333 3.33331V3.34331"}),(0,s.jsx)("path",{d:"M16.6667 3.33331V3.34331"}),(0,s.jsx)("path",{d:"M16.6667 6.66669V6.67669"}),(0,s.jsx)("path",{d:"M16.6667 10V10.01"}),(0,s.jsx)("path",{d:"M3.33334 13.3333V13.3433"}),(0,s.jsx)("path",{d:"M16.6667 13.3333V13.3433"}),(0,s.jsx)("path",{d:"M3.33334 16.6667V16.6767"}),(0,s.jsx)("path",{d:"M6.66666 16.6667V16.6767"}),(0,s.jsx)("path",{d:"M10 16.6667V16.6767"}),(0,s.jsx)("path",{d:"M13.3333 16.6667V16.6767"}),(0,s.jsx)("path",{d:"M16.6667 16.6667V16.6767"})]}),lG),r4=lW((0,s.jsxs)("g",{strokeWidth:"1.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("path",{d:"M4 12v-4a4 4 0 0 1 4 -4h4"}),(0,s.jsx)("line",{x1:"16",y1:"4",x2:"16",y2:"4.01"}),(0,s.jsx)("line",{x1:"20",y1:"4",x2:"20",y2:"4.01"}),(0,s.jsx)("line",{x1:"20",y1:"8",x2:"20",y2:"8.01"}),(0,s.jsx)("line",{x1:"20",y1:"12",x2:"20",y2:"12.01"}),(0,s.jsx)("line",{x1:"4",y1:"16",x2:"4",y2:"16.01"}),(0,s.jsx)("line",{x1:"20",y1:"16",x2:"20",y2:"16.01"}),(0,s.jsx)("line",{x1:"4",y1:"20",x2:"4",y2:"20.01"}),(0,s.jsx)("line",{x1:"8",y1:"20",x2:"8",y2:"20.01"}),(0,s.jsx)("line",{x1:"12",y1:"20",x2:"12",y2:"20.01"}),(0,s.jsx)("line",{x1:"16",y1:"20",x2:"16",y2:"20.01"}),(0,s.jsx)("line",{x1:"20",y1:"20",x2:"20",y2:"20.01"})]}),lU),r5=lW((0,s.jsx)("path",{d:"M6 10H34",stroke:"currentColor",strokeWidth:2,fill:"none"}),{width:40,height:20}),r8=l.memo(({flip:e=!1})=>lW((0,s.jsxs)("g",{transform:e?"translate(40, 0) scale(-1, 1)":"",stroke:"currentColor",strokeWidth:2,fill:"none",children:[(0,s.jsx)("path",{d:"M34 10H6M34 10L27 5M34 10L27 15"}),(0,s.jsx)("path",{d:"M27.5 5L34.5 10L27.5 15"})]}),{width:40,height:20})),r7=l.memo(({flip:e=!1})=>lW((0,s.jsxs)("g",{stroke:"currentColor",fill:"currentColor",transform:e?"translate(40, 0) scale(-1, 1)":"",children:[(0,s.jsx)("path",{d:"M32 10L6 10",strokeWidth:2}),(0,s.jsx)("circle",{r:"4",transform:"matrix(-1 0 0 1 30 10)"})]}),{width:40,height:20})),r9=l.memo(({flip:e=!1})=>lW((0,s.jsxs)("g",{stroke:"currentColor",fill:"none",transform:e?"translate(40, 0) scale(-1, 1)":"",strokeWidth:2,children:[(0,s.jsx)("path",{d:"M26 10L6 10"}),(0,s.jsx)("circle",{r:"4",transform:"matrix(-1 0 0 1 30 10)"})]}),{width:40,height:20})),ae=l.memo(({flip:e=!1})=>lW((0,s.jsx)("g",{transform:e?"translate(40, 0) scale(-1, 1)":"",children:(0,s.jsx)("path",{d:"M34 10H5.99996M34 10L34 5M34 10L34 15",stroke:"currentColor",strokeWidth:2,fill:"none"})}),{width:40,height:20})),at=l.memo(({flip:e=!1})=>lW((0,s.jsxs)("g",{stroke:"currentColor",fill:"currentColor",transform:e?"translate(40, 0) scale(-1, 1)":"",children:[(0,s.jsx)("path",{d:"M32 10L6 10",strokeWidth:2}),(0,s.jsx)("path",{d:"M27.5 5.5L34.5 10L27.5 14.5L27.5 5.5"})]}),{width:40,height:20})),an=l.memo(({flip:e=!1})=>lW((0,s.jsxs)("g",{stroke:"currentColor",fill:"none",transform:e?"translate(40, 0) scale(-1, 1)":"",strokeWidth:2,strokeLinejoin:"round",children:[(0,s.jsx)("path",{d:"M6,9.5H27"}),(0,s.jsx)("path",{d:"M27,5L34,10L27,14Z",fill:"none"})]}),{width:40,height:20})),ai=l.memo(({flip:e=!1})=>lW((0,s.jsxs)("g",{stroke:"currentColor",fill:"currentColor",transform:e?"translate(40, 0) scale(-1, 1)":"",strokeLinejoin:"round",strokeWidth:2,children:[(0,s.jsx)("path",{d:"M6,9.5H20"}),(0,s.jsx)("path",{d:"M27,5L34,10L27,14L20,9.5Z"})]}),{width:40,height:20})),al=l.memo(({flip:e=!1})=>lW((0,s.jsxs)("g",{stroke:"currentColor",fill:"none",transform:e?"translate(40, 0) scale(-1, 1)":"",strokeLinejoin:"round",strokeWidth:2,children:[(0,s.jsx)("path",{d:"M6,9.5H20"}),(0,s.jsx)("path",{d:"M27,5L34,10L27,14L20,9.5Z"})]}),{width:40,height:20})),ar=lW((0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("g",{clipPath:"url(#a)",children:(0,s.jsx)("path",{d:"M14.167 6.667a3.333 3.333 0 0 0-3.334-3.334H9.167a3.333 3.333 0 0 0 0 6.667h1.666a3.333 3.333 0 0 1 0 6.667H9.167a3.333 3.333 0 0 1-3.334-3.334",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,s.jsx)("defs",{children:(0,s.jsx)("clipPath",{id:"a",children:(0,s.jsx)("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),lG),aa=lW((0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("g",{clipPath:"url(#a)",children:(0,s.jsx)("path",{d:"M5 16.667V3.333L10 15l5-11.667v13.334",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,s.jsx)("defs",{children:(0,s.jsx)("clipPath",{id:"a",children:(0,s.jsx)("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),lG),as=lW((0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("g",{clipPath:"url(#a)",children:(0,s.jsx)("path",{d:"M5.833 3.333v13.334h8.334",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,s.jsx)("defs",{children:(0,s.jsx)("clipPath",{id:"a",children:(0,s.jsx)("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),lG),ao=lW((0,s.jsx)(s.Fragment,{children:(0,s.jsx)("path",{d:"m1.667 3.333 6.666 13.334M8.333 3.333 1.667 16.667M11.667 3.333v13.334h6.666",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),lG),ad=lW((0,s.jsx)(s.Fragment,{children:(0,s.jsx)("g",{stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round",children:(0,s.jsx)("path",{d:"M5.833 16.667v-10a3.333 3.333 0 0 1 3.334-3.334h1.666a3.333 3.333 0 0 1 3.334 3.334v10M5.833 10.833h8.334"})})}),lG),ac=lW((0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round",children:(0,s.jsx)("path",{d:"M5.833 6.667 2.5 10l3.333 3.333M14.167 6.667 17.5 10l-3.333 3.333M11.667 3.333 8.333 16.667"})}),(0,s.jsx)("defs",{children:(0,s.jsx)("clipPath",{id:"a",children:(0,s.jsx)("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),lG),ah=lW((0,s.jsxs)("g",{stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("line",{x1:"4",y1:"8",x2:"20",y2:"8"}),(0,s.jsx)("line",{x1:"4",y1:"12",x2:"12",y2:"12"}),(0,s.jsx)("line",{x1:"4",y1:"16",x2:"16",y2:"16"})]}),lU),am=lW((0,s.jsxs)("g",{stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("line",{x1:"4",y1:"8",x2:"20",y2:"8"}),(0,s.jsx)("line",{x1:"8",y1:"12",x2:"16",y2:"12"}),(0,s.jsx)("line",{x1:"6",y1:"16",x2:"18",y2:"16"})]}),lU),au=lW((0,s.jsxs)("g",{stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("line",{x1:"4",y1:"8",x2:"20",y2:"8"}),(0,s.jsx)("line",{x1:"10",y1:"12",x2:"20",y2:"12"}),(0,s.jsx)("line",{x1:"8",y1:"16",x2:"20",y2:"16"})]}),lU),ap=l.memo(({theme:e})=>lW((0,s.jsxs)("g",{strokeWidth:"1.5",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("line",{x1:"4",y1:"4",x2:"20",y2:"4"}),(0,s.jsx)("rect",{x:"9",y:"8",width:"6",height:"12",rx:"2"})]}),lU)),ag=l.memo(({theme:e})=>lW((0,s.jsxs)("g",{strokeWidth:"2",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("line",{x1:"4",y1:"20",x2:"20",y2:"20"}),(0,s.jsx)("rect",{x:"9",y:"4",width:"6",height:"12",rx:"2"})]}),lU)),af=l.memo(({theme:e})=>lW((0,s.jsxs)("g",{strokeWidth:"1.5",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("line",{x1:"4",y1:"12",x2:"9",y2:"12"}),(0,s.jsx)("line",{x1:"15",y1:"12",x2:"20",y2:"12"}),(0,s.jsx)("rect",{x:"9",y:"6",width:"6",height:"12",rx:"2"})]}),lU)),ax=lW((0,s.jsx)("path",{d:"M537.6 226.6c4.1-10.7 6.4-22.4 6.4-34.6 0-53-43-96-96-96-19.7 0-38.1 6-53.3 16.2C367 64.2 315.3 32 256 32c-88.4 0-160 71.6-160 160 0 2.7.1 5.4.2 8.1C40.2 219.8 0 273.2 0 336c0 79.5 64.5 144 144 144h368c70.7 0 128-57.3 128-128 0-61.9-44-113.6-102.4-125.4zM393.4 288H328v112c0 8.8-7.2 16-16 16h-48c-8.8 0-16-7.2-16-16V288h-65.4c-14.3 0-21.4-17.2-11.3-27.3l105.4-105.4c6.2-6.2 16.4-6.2 22.6 0l105.4 105.4c10.1 10.1 2.9 27.3-11.3 27.3z",fill:"currentColor"}),{width:640,height:512}),lW((0,s.jsx)("path",{d:"M480 416C497.7 416 512 430.3 512 448C512 465.7 497.7 480 480 480H150.6C133.7 480 117.4 473.3 105.4 461.3L25.37 381.3C.3786 356.3 .3786 315.7 25.37 290.7L258.7 57.37C283.7 32.38 324.3 32.38 349.3 57.37L486.6 194.7C511.6 219.7 511.6 260.3 486.6 285.3L355.9 416H480zM265.4 416L332.7 348.7L195.3 211.3L70.63 336L150.6 416L265.4 416z"})),ay=lW((0,s.jsxs)("g",{strokeWidth:1.25,children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("path",{d:"M8 13v-7.5a1.5 1.5 0 0 1 3 0v6.5"}),(0,s.jsx)("path",{d:"M11 5.5v-2a1.5 1.5 0 1 1 3 0v8.5"}),(0,s.jsx)("path",{d:"M14 5.5a1.5 1.5 0 0 1 3 0v6.5"}),(0,s.jsx)("path",{d:"M17 7.5a1.5 1.5 0 0 1 3 0v8.5a6 6 0 0 1 -6 6h-2h.208a6 6 0 0 1 -5.012 -2.7a69.74 69.74 0 0 1 -.196 -.3c-.312 -.479 -1.407 -2.388 -3.286 -5.728a1.5 1.5 0 0 1 .536 -2.022a1.867 1.867 0 0 1 2.28 .28l1.47 1.47"})]}),lU),ab=lW((0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("path",{d:"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2"}),(0,s.jsx)("path",{d:"M7 11l5 5l5 -5"}),(0,s.jsx)("path",{d:"M12 4l0 12"})]}),lU),av=lW((0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("path",{d:"M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"}),(0,s.jsx)("path",{d:"M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"})]}),lU),aw=lW((0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"}),(0,s.jsx)("path",{d:"M12 17l0 .01"}),(0,s.jsx)("path",{d:"M12 13.5a1.5 1.5 0 0 1 1 -1.5a2.6 2.6 0 1 0 -3 -4"})]}),lU),lW((0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("path",{d:"M7 4v16l13 -8z"})]}),lU),lW((0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("path",{d:"M17 4h-10a3 3 0 0 0 -3 3v10a3 3 0 0 0 3 3h10a3 3 0 0 0 3 -3v-10a3 3 0 0 0 -3 -3z",strokeWidth:"0",fill:"currentColor"})]}),lU),lW((0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("path",{d:"M5 12l5 5l10 -10"})]}),lU),aE=lW((0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("path",{d:"M10.24 3.957l-8.422 14.06a1.989 1.989 0 0 0 1.7 2.983h16.845a1.989 1.989 0 0 0 1.7 -2.983l-8.423 -14.06a1.989 1.989 0 0 0 -3.4 0z"}),(0,s.jsx)("path",{d:"M12 9v4"}),(0,s.jsx)("path",{d:"M12 17h.01"})]}),lU),aS=lW((0,s.jsxs)("g",{strokeWidth:1.25,children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("path",{d:"M11 7l6 6"}),(0,s.jsx)("path",{d:"M4 16l11.7 -11.7a1 1 0 0 1 1.4 0l2.6 2.6a1 1 0 0 1 0 1.4l-11.7 11.7h-4v-4z"})]}),lU),ak=lW((0,s.jsxs)("g",{strokeWidth:1.5,children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("path",{d:"M12 3l-4 7h8z"}),(0,s.jsx)("path",{d:"M17 17m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"}),(0,s.jsx)("path",{d:"M4 14m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z"})]}),lU),aC=lW((0,s.jsxs)("g",{strokeWidth:1.5,children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("path",{d:"M4 7l16 0"}),(0,s.jsx)("path",{d:"M4 17l16 0"}),(0,s.jsx)("path",{d:"M7 4l0 16"}),(0,s.jsx)("path",{d:"M17 4l0 16"})]}),lU),aI=lW((0,s.jsx)("path",{fill:"currentColor",d:"M407.48,111.18C335.587,108.103 269.573,152.338 245.08,220C220.587,152.338 154.573,108.103 82.68,111.18C80.285,168.229 107.577,222.632 154.74,254.82C178.908,271.419 193.35,298.951 193.27,328.27L193.27,379.13L296.9,379.13L296.9,328.27C296.816,298.953 311.255,271.42 335.42,254.82C382.596,222.644 409.892,168.233 407.48,111.18Z"})),aM=lW((0,s.jsxs)("g",{strokeWidth:"1.25",children:[(0,s.jsx)("path",{d:"M4.16602 10H15.8327"}),(0,s.jsx)("path",{d:"M12.5 13.3333L15.8333 10"}),(0,s.jsx)("path",{d:"M12.5 6.66666L15.8333 9.99999"})]}),lG),aj=lW((0,s.jsxs)("g",{fill:"none",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round",transform:"rotate(90 10 10)",children:[(0,s.jsx)("path",{clipRule:"evenodd",d:"m9.644 13.69 7.774-7.773a2.357 2.357 0 0 0-3.334-3.334l-7.773 7.774L8 12l1.643 1.69Z"}),(0,s.jsx)("path",{d:"m13.25 3.417 3.333 3.333M10 10l2-2M5 15l3-3M2.156 17.894l1-1M5.453 19.029l-.144-1.407M2.377 11.887l.866 1.118M8.354 17.273l-1.194-.758M.953 14.652l1.408.13"})]}),20),aT=lW((0,s.jsxs)("g",{stroke:"currentColor",fill:"none",children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z"}),(0,s.jsx)("path",{d:"M6 21l15 -15l-3 -3l-15 15l3 3"}),(0,s.jsx)("path",{d:"M15 6l3 3"}),(0,s.jsx)("path",{d:"M9 3a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"}),(0,s.jsx)("path",{d:"M19 13a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"})]}),lU),aL=lW((0,s.jsxs)("g",{stroke:"currentColor",fill:"none",children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("path",{d:"M11.217 19.384a3.501 3.501 0 0 0 6.783 -1.217v-5.167l-6 -3.35"}),(0,s.jsx)("path",{d:"M5.214 15.014a3.501 3.501 0 0 0 4.446 5.266l4.34 -2.534v-6.946"}),(0,s.jsx)("path",{d:"M6 7.63c-1.391 -.236 -2.787 .395 -3.534 1.689a3.474 3.474 0 0 0 1.271 4.745l4.263 2.514l6 -3.348"}),(0,s.jsx)("path",{d:"M12.783 4.616a3.501 3.501 0 0 0 -6.783 1.217v5.067l6 3.45"}),(0,s.jsx)("path",{d:"M18.786 8.986a3.501 3.501 0 0 0 -4.446 -5.266l-4.34 2.534v6.946"}),(0,s.jsx)("path",{d:"M18 16.302c1.391 .236 2.787 -.395 3.534 -1.689a3.474 3.474 0 0 0 -1.271 -4.745l-4.308 -2.514l-5.955 3.42"})]}),lU),aD=lW((0,s.jsxs)("g",{stroke:"currentColor",fill:"none",children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("path",{d:"M4 8v-2a2 2 0 0 1 2 -2h2"}),(0,s.jsx)("path",{d:"M4 16v2a2 2 0 0 0 2 2h2"}),(0,s.jsx)("path",{d:"M16 4h2a2 2 0 0 1 2 2v2"}),(0,s.jsx)("path",{d:"M16 20h2a2 2 0 0 0 2 -2v-2"})]}),lU),aA=lW((0,s.jsxs)("g",{stroke:"currentColor",fill:"none",children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("path",{d:"M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0"}),(0,s.jsx)("path",{d:"M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6"})]}),lU),aP=lW((0,s.jsxs)("g",{stroke:"currentColor",fill:"none",children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("path",{d:"M10.585 10.587a2 2 0 0 0 2.829 2.828"}),(0,s.jsx)("path",{d:"M16.681 16.673a8.717 8.717 0 0 1 -4.681 1.327c-3.6 0 -6.6 -2 -9 -6c1.272 -2.12 2.712 -3.678 4.32 -4.674m2.86 -1.146a9.055 9.055 0 0 1 1.82 -.18c3.6 0 6.6 2 9 6c-.666 1.11 -1.379 2.067 -2.138 2.87"}),(0,s.jsx)("path",{d:"M3 3l18 18"})]}),lU),a_=lW((0,s.jsxs)("g",{stroke:"currentColor",fill:"none",children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("path",{d:"M15.5 13a3.5 3.5 0 0 0 -3.5 3.5v1a3.5 3.5 0 0 0 7 0v-1.8"}),(0,s.jsx)("path",{d:"M8.5 13a3.5 3.5 0 0 1 3.5 3.5v1a3.5 3.5 0 0 1 -7 0v-1.8"}),(0,s.jsx)("path",{d:"M17.5 16a3.5 3.5 0 0 0 0 -7h-.5"}),(0,s.jsx)("path",{d:"M19 9.3v-2.8a3.5 3.5 0 0 0 -7 0"}),(0,s.jsx)("path",{d:"M6.5 16a3.5 3.5 0 0 1 0 -7h.5"}),(0,s.jsx)("path",{d:"M5 9.3v-2.8a3.5 3.5 0 0 1 7 0v10"})]}),lU),aR=lW((0,s.jsxs)("g",{strokeWidth:1.5,children:[(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,s.jsx)("path",{d:"M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0"}),(0,s.jsx)("path",{d:"M21 21l-6 -6"})]}),lU)}),dO=tC(()=>{tM(),tR(),aN={EQUAL:"Equal",MINUS:"Minus",NUM_ADD:"NumpadAdd",NUM_SUBTRACT:"NumpadSubtract",NUM_ZERO:"Numpad0",BRACKET_RIGHT:"BracketRight",BRACKET_LEFT:"BracketLeft",ONE:"Digit1",TWO:"Digit2",THREE:"Digit3",NINE:"Digit9",QUOTE:"Quote",ZERO:"Digit0",SLASH:"Slash",C:"KeyC",D:"KeyD",H:"KeyH",V:"KeyV",Z:"KeyZ",R:"KeyR",S:"KeyS"},aO={ARROW_DOWN:"ArrowDown",ARROW_LEFT:"ArrowLeft",ARROW_RIGHT:"ArrowRight",ARROW_UP:"ArrowUp",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",BACKSPACE:"Backspace",ALT:"Alt",CTRL_OR_CMD:V?"metaKey":"ctrlKey",DELETE:"Delete",ENTER:"Enter",ESCAPE:"Escape",QUESTION_MARK:"?",SPACE:" ",TAB:"Tab",CHEVRON_LEFT:"<",CHEVRON_RIGHT:">",PERIOD:".",COMMA:",",SUBTRACT:"-",A:"a",C:"c",D:"d",E:"e",F:"f",G:"g",H:"h",I:"i",L:"l",O:"o",P:"p",Q:"q",R:"r",S:"s",T:"t",V:"v",X:"x",Y:"y",Z:"z",K:"k",W:"w",0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9"},az=e=>e===aO.ARROW_LEFT||e===aO.ARROW_RIGHT||e===aO.ARROW_DOWN||e===aO.ARROW_UP,aH=e=>e.altKey,aB=e=>e.shiftKey,aF=e=>e.shiftKey}),dz=tC(()=>{}),dH=tC(()=>{tM(),dz(),a$=()=>{let e=document.querySelector(".excalidraw-tooltip");if(e)return e;let t=document.createElement("div");return document.body.appendChild(t),t.classList.add("excalidraw-tooltip"),t},aZ=(e,t,n="bottom")=>{let i,l=e.getBoundingClientRect(),r=window.innerWidth,a=window.innerHeight,s=t.left+t.width/2-l.width/2;s<0?s=5:s+l.width>=r&&(s=r-l.width-5),"bottom"===n?(i=t.top+t.height+5)+l.height>=a&&(i=t.top-l.height-5):(i=t.top-l.height-5)<0&&(i=t.top+t.height+5),Object.assign(e.style,{top:`${i}px`,left:`${s}px`})},aW=(e,t,n,i)=>{t.classList.add("excalidraw-tooltip--visible"),t.style.minWidth=i?"50ch":"10ch",t.style.maxWidth=i?"50ch":"15ch",t.textContent=n;let l=e.getBoundingClientRect();aZ(t,l)},aU=({children:e,label:t,long:n=!1,style:i,disabled:r})=>((0,l.useEffect)(()=>()=>a$().classList.remove("excalidraw-tooltip--visible"),[]),r?null:(0,s.jsx)("div",{className:"excalidraw-tooltip-wrapper",onPointerEnter:e=>aW(e.currentTarget,a$(),t,n),onPointerLeave:()=>a$().classList.remove("excalidraw-tooltip--visible"),style:i,children:e}))}),dB=tC(()=>{tM(),aG=e=>(e=e.trim())&&(0,m.N)(e),aV=e=>!!(e?.includes(location.origin)||e?.startsWith("/")),aK=e=>{if((e=aG(e)).startsWith("/"))return`${location.origin}${e}`;try{new URL(e)}catch{return"about:blank"}return e}}),dF=tC(()=>{}),d$=tC(()=>{tM(),aY=["ai"],aX=(e,t,n,i)=>{try{if(typeof window>"u"||u.VITE_WORKER_ID||u.PROD||!aY.includes(e))return;u.PROD||console.info("trackEvent",{category:e,action:t,label:n,value:i}),window.sa_event&&window.sa_event(t,{category:e,label:n,value:i})}catch(e){console.error("error during analytics",e)}}}),dZ=tC(()=>{tM(),df(),dA(),fB(),dj(),dR(),dN(),tL(),dO(),uK(),uJ(),tR(),dH(),fK(),dK(),fG(),dB(),dF(),d$(),CJ(),dx(),(aq=document.createElement("img")).src=`data:${eC.svg}, ${encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#1971c2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>')}`,aJ=!1,aQ=new Map,a1=({element:e,setAppState:t,onLinkOpen:n,setToast:i,updateEmbedValidationStatus:r})=>{let a=k7(),o=k6(),c=e.link||"",[h,m]=(0,l.useState)(c),u=(0,l.useRef)(null),p="editor"===a.showHyperlinkPopup,g=(0,l.useCallback)(()=>{if(!u.current)return;let n=aG(u.current.value)||null;if(!e.link&&n&&aX("hyperlink","create"),nM(e)){if(a.activeEmbeddable?.element===e&&t({activeEmbeddable:null}),!n){gQ(e,{link:null}),r(e,!1);return}if(lO(n,o.validateEmbeddable)){let{width:t,height:l}=e,a=lA(n);a?.warning&&i({message:a.warning,closable:!0});let s=a?a.intrinsicSize.w/a.intrinsicSize.h:1,o=aQ.get(e.id)!==e.link;gQ(e,{...o?{width:a?.type==="video"?t>l?t:l*s:t,height:a?.type==="video"&&t>l?t/s:l}:{},link:n}),r(e,!0),aQ.has(e.id)&&aQ.delete(e.id)}else n&&i({message:C("toast.unableToEmbed"),closable:!0}),e.link&&aQ.set(e.id,e.link),gQ(e,{link:n}),r(e,!1)}else gQ(e,{link:n})},[e,i,o.validateEmbeddable,a.activeEmbeddable,t,r]);(0,l.useLayoutEffect)(()=>()=>{g()},[g]),(0,l.useEffect)(()=>{let n=null,i=i=>{!p&&(n&&clearTimeout(n),st(e,a,[i.clientX,i.clientY])&&(n=window.setTimeout(()=>{t({showHyperlinkPopup:!1})},500)))};return window.addEventListener("pointermove",i,!1),()=>{window.removeEventListener("pointermove",i,!1),n&&clearTimeout(n)}},[a,e,p,t]);let f=(0,l.useCallback)(()=>{aX("hyperlink","delete"),gQ(e,{link:null}),p&&(u.current.value=""),t({showHyperlinkPopup:!1})},[t,e,p]),{x:x,y:y}=a0(e,a);return a.contextMenu||a.draggingElement||a.resizingElement||a.isRotating||a.openMenu||a.viewModeEnabled?null:(0,s.jsxs)("div",{className:"excalidraw-hyperlinkContainer",style:{top:`${y}px`,left:`${x}px`,width:320,padding:5},onClick:()=>{e.link||p||t({showHyperlinkPopup:"editor"})},children:[p?(0,s.jsx)("input",{className:(0,d.Z)("excalidraw-hyperlinkContainer-input"),placeholder:"Type or paste your link here",ref:u,value:h,onChange:e=>m(e.target.value),autoFocus:!0,onKeyDown:e=>{e.stopPropagation(),e[aO.CTRL_OR_CMD]&&e.key===aO.K&&e.preventDefault(),(e.key===aO.ENTER||e.key===aO.ESCAPE)&&(g(),t({showHyperlinkPopup:"info"}))}}):e.link?(0,s.jsx)("a",{href:aG(e.link||""),className:"excalidraw-hyperlinkContainer-link",target:aV(e.link)?"_self":"_blank",onClick:t=>{if(e.link&&n){let i=nd("excalidraw-link",t.nativeEvent);n({...e,link:aG(e.link)},i),i.defaultPrevented&&t.preventDefault()}},rel:"noopener noreferrer",children:e.link}):(0,s.jsx)("div",{className:"excalidraw-hyperlinkContainer-link",children:C("labels.link.empty")}),(0,s.jsxs)("div",{className:"excalidraw-hyperlinkContainer__buttons",children:[!p&&(0,s.jsx)(lF,{type:"button",title:C("buttons.edit"),"aria-label":C("buttons.edit"),label:C("buttons.edit"),onClick:()=>{aX("hyperlink","edit","popup-ui"),t({showHyperlinkPopup:"editor"})},className:"excalidraw-hyperlinkContainer--edit",icon:l9}),c&&!nM(e)&&(0,s.jsx)(lF,{type:"button",title:C("buttons.remove"),"aria-label":C("buttons.remove"),label:C("buttons.remove"),onClick:f,className:"excalidraw-hyperlinkContainer--remove",icon:rr})]})]})},a0=(e,t)=>{let[n,i]=mF(e),{x:l,y:r}=t3({sceneX:n+e.width/2,sceneY:i},t);return{x:l-t.offsetLeft-160,y:r-t.offsetTop-85}},a2=iY({name:"hyperlink",perform:(e,t)=>"editor"!==t.showHyperlinkPopup&&{elements:e,appState:{...t,showHyperlinkPopup:"editor",openMenu:null},commitToHistory:!0},trackEvent:{category:"hyperlink",action:"click"},keyTest:e=>e[aO.CTRL_OR_CMD]&&e.key===aO.K,contextItemLabel:(e,t)=>a3(e,t),predicate:(e,t)=>1===gV(e,t).length,PanelComponent:({elements:e,appState:t,updateData:n})=>{let i=gV(e,t);return(0,s.jsx)(lF,{type:"button",icon:ry,"aria-label":C(a3(e,t)),title:`${nM(e[0])?C("labels.link.labelEmbed"):C("labels.link.label")} - ${t0("CtrlOrCmd+K")}`,onClick:()=>n(null),selected:1===i.length&&!!i[0].link})}}),a3=(e,t)=>{let n=gV(e,t);return n[0].link?nM(n[0])?"labels.link.editEmbed":"labels.link.edit":nM(n[0])?"labels.link.createEmbed":"labels.link.create"},a6=([e,t,n,i],l,r)=>{let a=mx,s=a/r.zoom.value,o=a/r.zoom.value,d=a/r.zoom.value,c=(a-8)/(2*r.zoom.value),h=4/r.zoom.value,[m,u]=ut(n+h-c+s/2,t-h-d+c+o/2,(e+n)/2,(t+i)/2,l);return[m-s/2,u-o/2,s,o]},a4=(e,t,[n,i])=>{let l=4/t.zoom.value,[r,a,s,o]=mF(e),[d,c,h,m]=a6([r,a,s,o],e.angle,t);return n>d-l&&n<d+l+h&&i>c-l&&i<c+m+l},a5=(e,t,[n,i],l)=>{if(!e.link||t.selectedElementIds[e.id])return!1;let r=4/t.zoom.value;return!!(!l&&t.viewModeEnabled&&s1(e,[n,i],r,null))||a4(e,t,[n,i])},a8=null,a7=(e,t)=>{a8&&clearTimeout(a8),a8=window.setTimeout(()=>a9(e,t),eR)},a9=(e,t)=>{if(!e.link)return;let n=a$();n.classList.add("excalidraw-tooltip--visible"),n.style.maxWidth="20rem",n.textContent=e.link;let[i,l,r,a]=mF(e),[s,o,d,c]=a6([i,l,r,a],e.angle,t),h=t3({sceneX:s,sceneY:o},t);aZ(n,{left:h.x,top:h.y,width:d,height:c},"top"),aX("hyperlink","tooltip","link-icon"),aJ=!0},se=()=>{a8&&clearTimeout(a8),aJ&&(aJ=!1,a$().classList.remove("excalidraw-tooltip--visible"))},st=(e,t,[n,i])=>{let{x:l,y:r}=t2({clientX:n,clientY:i},t),a=15/t.zoom.value;if(s1(e,[l,r],a,null))return!1;let[s,o,d]=mF(e);if(l>=s&&l<=d&&r>=o-85&&r<=o)return!1;let{x:c,y:h}=a0(e,t);return!(n>=c-a&&n<=c+320+10+a&&i>=h-a&&i<=h+a+10+42)}}),dW=tC(()=>{tM(),sn=(e,t)=>{if(!t.snapLines.length)return;let n="light"===t.theme||t.zenModeEnabled?"#ff6b6b":"#ff0000",i=(t.zenModeEnabled?1.5:1)/t.zoom.value;for(let l of(e.save(),e.translate(t.scrollX,t.scrollY),t.snapLines))"pointer"===l.type?(e.lineWidth=i,e.strokeStyle=n,sl(l,e,t)):"gap"===l.type?(e.lineWidth=i,e.strokeStyle=n,ss(l.points[0],l.points[1],l.direction,t,e)):"points"===l.type&&(e.lineWidth=i,e.strokeStyle=n,si(l,e,t));e.restore()},si=(e,t,n)=>{if(!n.zenModeEnabled){let n=e.points[0],i=e.points[e.points.length-1];sa(n,i,t)}for(let i of e.points)sr(i,n,t)},sl=(e,t,n)=>{sr(e.points[0],n,t),n.zenModeEnabled||sa(e.points[0],e.points[1],t)},sr=([e,t],n,i)=>{i.save();let l=(n.zenModeEnabled?3:2)/n.zoom.value;i.beginPath(),i.moveTo(e-l,t-l),i.lineTo(e+l,t+l),i.moveTo(e+l,t-l),i.lineTo(e-l,t+l),i.stroke(),i.restore()},sa=(e,t,n)=>{n.beginPath(),n.lineTo(...e),n.lineTo(...t),n.stroke()},ss=(e,t,n,i,l)=>{let r=8/i.zoom.value,a=r/2,s=r/4;if("horizontal"===n){let n=[(e[0]+t[0])/2,e[1]];i.zenModeEnabled||sa([e[0],e[1]-r],[e[0],e[1]+r],l),sa([n[0]-s,n[1]-a],[n[0]-s,n[1]+a],l),sa([n[0]+s,n[1]-a],[n[0]+s,n[1]+a],l),i.zenModeEnabled||(sa([t[0],t[1]-r],[t[0],t[1]+r],l),sa(e,t,l))}else{let n=[e[0],(e[1]+t[1])/2];i.zenModeEnabled||sa([e[0]-r,e[1]],[e[0]+r,e[1]],l),sa([n[0]-a,n[1]-s],[n[0]+a,n[1]-s],l),sa([n[0]-a,n[1]+s],[n[0]+a,n[1]+s],l),i.zenModeEnabled||(sa([t[0]-r,t[1]],[t[0]+r,t[1]],l),sa(e,t,l))}}}),dU=tC(()=>{tM(),fG(),dk(),fV(),uK(),dC(),dX(),dI(),dK(),dG(),df(),dM(),tR(),dZ(),dW(),dx(),dA(),fO(),so=2,sd=(e,t,n,i,l,r,a,s,o=!1,d=0)=>{e.save(),e.translate(r,a),e.rotate(s),o&&e.fillRect(t-r,n-a,i,l),d&&e.roundRect?(e.beginPath(),e.roundRect(t-r,n-a,i,l,d),e.stroke(),e.closePath()):e.strokeRect(t-r,n-a,i,l),e.restore()},sc=(e,t,n,i,l,r)=>{e.save(),e.translate(i,l),e.rotate(r),e.beginPath(),e.moveTo(0,n/2),e.lineTo(t/2,0),e.lineTo(0,-n/2),e.lineTo(-t/2,0),e.closePath(),e.stroke(),e.restore()},sh=(e,t,n,i,l,r)=>{e.beginPath(),e.ellipse(i,l,t/2,n/2,r,0,2*Math.PI),e.stroke()},sm=(e,t,n,i,l=!0)=>{e.beginPath(),e.arc(t,n,i,0,2*Math.PI),e.fill(),l&&e.stroke()},su=(e,t,n,i,l,r,a)=>{var s;let o;(s=o||={}).Bold="#cccccc",s.Regular="#e5e5e5";let d=-Math.round(l.value/t)*t+n%t,c=-Math.round(l.value/t)*t+i%t,h=Math.min(1/l.value,1),m=1/l.value,u=[3*h,m+(h+m)];e.save(),e.lineWidth=h;for(let i=d;i<d+r+2*t;i+=t){let l=Math.round(i-n)%(5*t)==0;e.beginPath(),e.setLineDash(l?[]:u),e.strokeStyle=l?"#cccccc":"#e5e5e5",e.moveTo(i,c-t),e.lineTo(i,c+a+2*t),e.stroke()}for(let n=c;n<c+a+2*t;n+=t){let l=Math.round(n-i)%(5*t)==0;e.beginPath(),e.setLineDash(l?[]:u),e.strokeStyle=l?"#cccccc":"#e5e5e5",e.moveTo(d-t,n),e.lineTo(d+r+2*t,n),e.stroke()}e.restore()},sp=(e,t,n,i,l,r=!1)=>{e.strokeStyle="#5e5ad8",e.setLineDash([]),e.fillStyle="rgba(255, 255, 255, 0.9)",l?e.fillStyle="rgba(134, 131, 226, 0.9)":r&&(e.fillStyle="rgba(177, 151, 252, 0.7)"),sm(e,n[0],n[1],i/t.zoom.value,!r)},sg=(e,t,n)=>{if(!t.selectedLinearElement)return;e.save(),e.translate(t.scrollX,t.scrollY),e.lineWidth=1/t.zoom.value;let i=o2.getPointsGlobalCoordinates(n),{POINT_HANDLE_SIZE:l}=o2,r=t.editingLinearElement?l:l/2;i.forEach((n,i)=>{let l=!!t.editingLinearElement?.selectedPointsIndices?.includes(i);sp(e,t,n,r,l)}),o2.getEditorMidPoints(n,t).filter(e=>null!==e).forEach(n=>{t?.selectedLinearElement?.segmentMidPointHoveredCoords&&o2.arePointsEqual(n,t.selectedLinearElement.segmentMidPointHoveredCoords)?t.editingLinearElement?(sp(e,t,n,r,!1),sf(n,e,t)):(sf(n,e,t),sp(e,t,n,r,!1)):(t.editingLinearElement||2===i.length)&&sp(e,t,n,l/2,!1,!0)}),e.restore()},sf=(e,t,n)=>{t.fillStyle="rgba(105, 101, 219, 0.4)",sm(t,e[0],e[1],o2.POINT_HANDLE_SIZE/n.zoom.value,!1)},sx=(e,t)=>{let{elementId:n,hoverPointIndex:i}=t.selectedLinearElement;if(t.editingLinearElement?.selectedPointsIndices?.includes(i))return;let l=o2.getElement(n);if(!l)return;let r=o2.getPointAtIndexGlobalCoordinates(l,i);e.save(),e.translate(t.scrollX,t.scrollY),sf(r,e,t),e.restore()},sy=(e,t,n,i)=>{t.translate(e.x+i.scrollX,e.y+i.scrollY),t.beginPath(),t.roundRect?t.roundRect(0,0,e.width,e.height,eg.radius/i.zoom.value):t.rect(0,0,e.width,e.height),t.clip(),t.translate(-(e.x+i.scrollX),-(e.y+i.scrollY))},sb=(e,t)=>[e.width/t,e.height/t],sv=({canvas:e,scale:t,normalizedWidth:n,normalizedHeight:i,theme:l,isExporting:r,viewBackgroundColor:a})=>{let s=e.getContext("2d");return s.setTransform(1,0,0,1,0,0),s.scale(t,t),r&&"dark"===l&&(s.filter=eN),"string"==typeof a?(("transparent"===a||5===a.length||9===a.length||/(hsla|rgba)\(/.test(a))&&s.clearRect(0,0,n,i),s.save(),s.fillStyle=a,s.fillRect(0,0,n,i),s.restore()):s.clearRect(0,0,n,i),s},sw=({canvas:e,elements:t,visibleElements:n,selectedElements:i,scale:l,appState:r,renderConfig:a})=>{let s,d;if(null===e)return{atLeastOneVisibleElement:!1,elements:t};let[c,h]=sb(e,l),m=sv({canvas:e,scale:l,normalizedWidth:c,normalizedHeight:h});if(m.save(),m.scale(r.zoom.value,r.zoom.value),n.forEach(e=>{r.editingLinearElement?.elementId===e.id&&e&&(s=e)}),s&&sg(m,r,s),r.selectionElement)try{mC(r.selectionElement,m,r)}catch(e){console.error(e)}r.isBindingEnabled&&r.suggestedBindings.filter(e=>null!=e).forEach(e=>{sL(m,r,e)}),r.frameToHighlight&&sA(m,r,r.frameToHighlight),r.elementsToHighlight&&sP(m,r,r.elementsToHighlight);let u=i.some(e=>nP(e));if(1===i.length&&r.editingLinearElement?.elementId===i[0].id&&sg(m,r,i[0]),r.selectedLinearElement&&r.selectedLinearElement.hoverPointIndex>=0&&sx(m,r),!r.multiElement&&!r.editingLinearElement){let e=sV(i,r);1===i.length&&nN(i[0])&&r.selectedLinearElement?.elementId===i[0].id&&!i[0].locked&&sg(m,r,i[0]);let n=a.selectionColor||o.black;if(e){let e=i.reduce((e,t)=>(e[t.id]=!0,e),{}),l=t.reduce((t,i)=>{let l=[];if(e[i.id]&&!iN(r,i)&&l.push(n),a.remoteSelectedElementIds[i.id]&&l.push(...a.remoteSelectedElementIds[i.id].map(e=>iA(e))),l.length){let[e,n,s,o,d,c]=mF(i,!0);t.push({angle:i.angle,elementX1:e,elementY1:n,elementX2:s,elementY2:o,selectionColors:l,dashed:!!a.remoteSelectedElementIds[i.id],cx:d,cy:c,activeEmbeddable:r.activeEmbeddable?.element===i&&"active"===r.activeEmbeddable.state})}return t},[]),s=e=>{let n=i$(t,e),[i,r,a,s]=m6(n);l.push({angle:0,elementX1:i,elementX2:a,elementY1:r,elementY2:s,selectionColors:[o.black],dashed:!0,cx:i+(a-i)/2,cy:r+(s-r)/2,activeEmbeddable:!1})};for(let e of iz(r))s(e);r.editingGroupId&&s(r.editingGroupId),l.forEach(e=>sT(m,r,e))}if(m.save(),m.translate(r.scrollX,r.scrollY),1===i.length){m.fillStyle=o.white;let t=sG(i[0],r.zoom,"mouse");!r.viewModeEnabled&&e&&sj(m,a,r,t,i[0].angle)}else if(i.length>1&&!r.isRotating){let e=2*so/r.zoom.value;m.fillStyle=o.white;let[t,l,s,d]=m6(i),c=m.getLineDash();m.setLineDash([2/r.zoom.value]);let h=m.lineWidth;m.lineWidth=1/r.zoom.value,m.strokeStyle=n,sd(m,t-e,l-e,s-t+2*e,d-l+2*e,(t+s)/2,(l+d)/2,0),m.lineWidth=h,m.setLineDash(c);let p=sU([t,l,s,d,(t+s)/2,(l+d)/2],0,r.zoom,"mouse",u?sB:sH);i.some(e=>!e.locked)&&sj(m,a,r,p,0)}m.restore()}for(let e in sn(m,r),m.restore(),a.remotePointerViewportCoords){let{x:t,y:n}=a.remotePointerViewportCoords[e];t-=r.offsetLeft,n-=r.offsetTop;let i=t<0||t>c-11||n<0||n>h-14;t=Math.min(t=Math.max(t,0),c-11),n=Math.min(n=Math.max(n,0),h-14);let l=iA(e);m.save(),m.strokeStyle=l,m.fillStyle=l;let s=a.remotePointerUserStates[e],d=i||"idle"===s||"away"===s;d&&(m.globalAlpha=.3),a.remotePointerButton&&"down"===a.remotePointerButton[e]&&(m.beginPath(),m.arc(t,n,15,0,2*Math.PI,!1),m.lineWidth=3,m.strokeStyle="#ffffff88",m.stroke(),m.closePath(),m.beginPath(),m.arc(t,n,15,0,2*Math.PI,!1),m.lineWidth=1,m.strokeStyle=l,m.stroke(),m.closePath()),m.fillStyle=o.white,m.strokeStyle=o.white,m.lineWidth=6,m.lineJoin="round",m.beginPath(),m.moveTo(t,n),m.lineTo(t+0,n+14),m.lineTo(t+4,n+9),m.lineTo(t+11,n+8),m.closePath(),m.stroke(),m.fill(),m.fillStyle=l,m.strokeStyle=l,m.lineWidth=2,m.lineJoin="round",m.beginPath(),d?(m.moveTo(t-1,n-1),m.lineTo(t-1,n+15),m.lineTo(t+5,n+10),m.lineTo(t+12,n+9),m.closePath(),m.fill()):(m.moveTo(t,n),m.lineTo(t+0,n+14),m.lineTo(t+4,n+9),m.lineTo(t+11,n+8),m.closePath(),m.fill(),m.stroke());let u=a.remotePointerUsernames[e]||"";if(!i&&u){m.font="600 12px sans-serif";let e=t+5.5,i=n+14+2,r=m.measureText(u),a=r.actualBoundingBoxDescent+r.actualBoundingBoxAscent,s=Math.max(a,12),d=e-1,c=i-1,h=r.width+2+10+2,p=s+2+6+2;m.roundRect?(m.beginPath(),m.roundRect(d,c,h,p,8),m.fillStyle=l,m.fill(),m.strokeStyle=o.white,m.stroke()):iD(m,d,c,h,p,8,o.white),m.fillStyle=o.black,m.fillText(u,e+5+1,i+3+r.actualBoundingBoxAscent+Math.floor((s-a)/2)+2)}m.restore(),m.closePath()}return a.renderScrollbars&&(d=fA(t,c,h,r),m.save(),m.fillStyle=fD,m.strokeStyle="rgba(255,255,255,0.8)",[d.horizontal,d.vertical].forEach(e=>{e&&iD(m,e.x,e.y,e.width,e.height,fL/2)}),m.restore()),{scrollBars:d,atLeastOneVisibleElement:n.length>0,elements:t}},sE=({canvas:e,rc:t,elements:n,visibleElements:i,scale:l,appState:r,renderConfig:a})=>{if(null===e)return;let{renderGrid:s=!0,isExporting:o}=a,[d,c]=sb(e,l),h=sv({canvas:e,scale:l,normalizedWidth:d,normalizedHeight:c,theme:r.theme,isExporting:o,viewBackgroundColor:r.viewBackgroundColor});h.scale(r.zoom.value,r.zoom.value),s&&r.gridSize&&su(h,r.gridSize,r.scrollX,r.scrollY,r.zoom,d/r.zoom.value,c/r.zoom.value);let m=new Set;i.forEach(e=>{e.groupIds.length>0&&r.frameToHighlight&&r.selectedElementIds[e.id]&&(gk(e,r.frameToHighlight)||e.groupIds.find(e=>m.has(e)))&&e.groupIds.forEach(e=>m.add(e))}),i.filter(e=>!lP(e)).forEach(e=>{try{if((e.frameId||r.frameToHighlight?.id)&&r.frameRendering.enabled&&r.frameRendering.clip){h.save();let i=gH(e,r);i&&gB(e,n,r)&&sy(i,h,a,r),mI(e,t,h,a,r),h.restore()}else mI(e,t,h,a,r);o||sN(e,h,r)}catch(e){console.error(e)}}),i.filter(e=>lP(e)).forEach(e=>{try{let i=()=>{if(mI(e,t,h,a,r),nT(e)&&(o||nM(e)&&!0!==a.embedsValidationStatus.get(e.id))&&e.width&&e.height){let n=l_(e);mI(n,t,h,a,r)}o||sN(e,h,r)};if((e.frameId||r.frameToHighlight?.id)&&r.frameRendering.enabled&&r.frameRendering.clip){h.save();let t=gH(e,r);t&&gB(e,n,r)&&sy(t,h,a,r),i(),h.restore()}else i()}catch(e){console.error(e)}})},sS=tK(e=>{let t=sw(e);e.callback?.(t)},{trailing:!0}),sk=(e,t)=>{if(t){sS(e);return}let n=sw(e);return e.callback(n),n},sC=tK(e=>{sE(e)},{trailing:!0}),sI=(e,t)=>{if(t){sC(e);return}sE(e)},sM=()=>{sS.cancel(),sC.cancel()},sj=(e,t,n,i,l)=>{Object.keys(i).forEach(r=>{let a=i[r];if(void 0!==a){let[i,s,o,d]=a;e.save(),e.lineWidth=1/n.zoom.value,t.selectionColor&&(e.strokeStyle=t.selectionColor),"rotation"===r?sm(e,i+o/2,s+d/2,o/2):e.roundRect?(e.beginPath(),e.roundRect(i,s,o,d,2/n.zoom.value),e.fill(),e.stroke()):sd(e,i,s,o,d,i+o/2,s+d/2,l,!0),e.restore()}})},sT=(e,t,n,i=2*so)=>{let{angle:l,elementX1:r,elementY1:a,elementX2:s,elementY2:o,selectionColors:d,cx:c,cy:h,dashed:m,activeEmbeddable:u}=n,p=s-r,g=o-a,f=i/t.zoom.value,x=8/t.zoom.value,y=4/t.zoom.value;e.save(),e.translate(t.scrollX,t.scrollY),e.lineWidth=(u?4:1)/t.zoom.value;let b=d.length;for(let t=0;t<b;++t)e.strokeStyle=d[t],m&&e.setLineDash([x,y+(x+y)*(b-1)]),e.lineDashOffset=(x+y)*t,sd(e,r-f,a-f,p+2*f,g+2*f,c,h,l);e.restore()},sL=(e,t,n)=>{let i=Array.isArray(n)?s_:sD;e.save(),e.translate(t.scrollX,t.scrollY),i(e,n),e.restore()},sD=(e,t)=>{let[n,i,l,r]=mF(t),a=l-n,s=r-i,o=s2(t,a,s);e.strokeStyle="rgba(0,0,0,.05)",e.lineWidth=o-4;let d=2+o/2;switch(t.type){case"rectangle":case"text":case"image":case"iframe":case"embeddable":case"frame":case"magicframe":sd(e,n-d,i-d,a+2*d,s+2*d,n+a/2,i+s/2,t.angle);break;case"diamond":let c=Math.hypot(a,s),h=d*c/s,m=d*c/a;sc(e,a+2*h,s+2*m,n+a/2,i+s/2,t.angle);break;case"ellipse":sh(e,a+2*d,s+2*d,n+a/2,i+s/2,t.angle)}},sA=(e,t,n)=>{let[i,l,r,a]=mF(n),s=r-i,o=a-l;e.strokeStyle="rgb(0,118,255)",e.lineWidth=eg.strokeWidth/t.zoom.value,e.save(),e.translate(t.scrollX,t.scrollY),sd(e,i,l,s,o,i+s/2,l+o/2,n.angle,!1,eg.radius/t.zoom.value),e.restore()},sP=(e,t,n)=>{let i=n.filter(e=>0===e.groupIds.length),l=n.filter(e=>e.groupIds.length>0),r=e=>{let[t,n,i,l]=m6(e);return{angle:0,elementX1:t,elementX2:i,elementY1:n,elementY2:l,selectionColors:["rgb(0,118,255)"],dashed:!1,cx:t+(i-t)/2,cy:n+(l-n)/2,activeEmbeddable:!1}},a=e=>r(i$(n,e));Object.entries(iH(l,t)).filter(([e,t])=>t).map(([e,t])=>e).map(e=>a(e)).concat(i.map(e=>r([e]))).forEach(n=>sT(e,t,n))},s_=(e,t)=>{let[n,i,l]=t,r=s2(l,l.width,l.height);e.strokeStyle="rgba(0,0,0,0)",e.fillStyle="rgba(0,0,0,.05)",("both"===i?[0,-1]:"start"===i?[0]:[-1]).forEach(t=>{let[i,l]=o2.getPointAtIndexGlobalCoordinates(n,t);sm(e,i,l,r)})},sN=(e,t,n)=>{if(e.link&&!n.selectedElementIds[e.id]){let[i,l,r,a]=mF(e),[s,o,d,c]=a6([i,l,r,a],e.angle,n),h=s+d/2,m=o+c/2;if(t.save(),t.translate(n.scrollX+h,n.scrollY+m),t.rotate(e.angle),sR&&sR.zoom===n.zoom.value)t.drawImage(sR,s-h,o-m,d,c);else{(sR=document.createElement("canvas")).zoom=n.zoom.value,sR.width=d*window.devicePixelRatio*n.zoom.value,sR.height=c*window.devicePixelRatio*n.zoom.value;let e=sR.getContext("2d");e.scale(window.devicePixelRatio*n.zoom.value,window.devicePixelRatio*n.zoom.value),e.fillStyle="#fff",e.fillRect(0,0,d,c),e.drawImage(aq,0,0,d,c),e.restore(),t.drawImage(sR,s-h,o-m,d,c)}t.restore()}},sO=(e,t,n,i,l)=>{n&&(e.filter(e=>!lP(e)).forEach(e=>{if(!e.isDeleted)try{mT(e,t,n,i,e.x+l.offsetX,e.y+l.offsetY,l)}catch(e){console.error(e)}}),e.filter(e=>nT(e)).forEach(e=>{if(!e.isDeleted)try{mT(e,t,n,i,e.x+l.offsetX,e.y+l.offsetY,l)}catch(e){console.error(e)}}))}}),dG=tC(()=>{tM(),uq(),uJ(),fG(),dx(),dU(),sz={mouse:8,pen:16,touch:28},sH={e:!0,s:!0,n:!0,w:!0},sB={e:!0,s:!0,n:!0,w:!0,rotation:!0},sF={e:!0,s:!0,n:!0,w:!0},s$={e:!0,s:!0,n:!0,w:!0,nw:!0,se:!0},sZ={e:!0,s:!0,n:!0,w:!0},sW=(e,t,n,i,l,r,a)=>{let[s,o]=ut(e+n/2,t+i/2,l,r,a);return[s-n/2,o-i/2,n,i]},sU=([e,t,n,i,l,r],a,s,o,d={},c=4)=>{let h=sz[o],m=h/s.value,u=h/s.value,p=h/s.value,g=h/s.value,f=n-e,x=i-t,y=c/s.value,b=(h-2*so)/(2*s.value),v={nw:d.nw?void 0:sW(e-y-p+b,t-y-g+b,m,u,l,r,a),ne:d.ne?void 0:sW(n+y-b,t-y-g+b,m,u,l,r,a),sw:d.sw?void 0:sW(e-y-p+b,i+y-b,m,u,l,r,a),se:d.se?void 0:sW(n+y-b,i+y-b,m,u,l,r,a),rotation:d.rotation?void 0:sW(e+f/2-m/2,t-y-g+b-16/s.value,m,u,l,r,a)},w=5*sz.mouse/s.value;return Math.abs(f)>w&&(d.n||(v.n=sW(e+f/2-m/2,t-y-g+b,m,u,l,r,a)),d.s||(v.s=sW(e+f/2-m/2,i+y-b,m,u,l,r,a))),Math.abs(x)>w&&(d.w||(v.w=sW(e-y-p+b,t+x/2-u/2,m,u,l,r,a)),d.e||(v.e=sW(n+y-b,t+x/2-u/2,m,u,l,r,a))),v},sG=(e,t,n="mouse")=>{if(e.locked)return{};let i={};if("freedraw"===e.type||nN(e)){if(2===e.points.length){let[,t]=e.points;0===t[0]||0===t[1]?i=sZ:t[0]>0&&t[1]<0?i=s$:t[0]>0&&t[1]>0?i=sZ:t[0]<0&&t[1]>0?i=s$:t[0]<0&&t[1]<0&&(i=sZ)}}else nL(e)?i=sF:nP(e)&&(i={rotation:!0});let l=nN(e)?so+8:so;return sU(mF(e,!0),e.angle,t,n,i,l)},sV=(e,t)=>{if(t.editingLinearElement)return!1;if(e.length>1)return!0;let n=e[0];return!nN(n)||n.points.length>2}}),dV=tC(()=>{tM(),uK(),uY(),t_(),sK=class e{static rg=new to.V;static cache=new WeakMap;static get=t=>e.cache.get(t);static set=(t,n)=>e.cache.set(t,n);static delete=t=>e.cache.delete(t);static destroy=()=>{e.cache=new WeakMap};static generateElementShape=(t,n)=>{let i=n?.isExporting?void 0:e.get(t);if(void 0!==i)return i;mE.delete(t);let l=mO(t,e.rg,n||{isExporting:!1,canvasBackgroundColor:z.white,embedsValidationStatus:null});return e.cache.set(t,l),l}}}),dK=tC(()=>{tM(),db(),dw(),dE(),dv(),dS(),uJ(),uq(),dx(),fG(),df(),dG(),ma(),dV(),sY=e=>{if("arrow"===e.type)return!1;if("freedraw"===e.type)return!0;let t=!nt(e.backgroundColor)||nW(e)||nT(e);return"line"===e.type?t&&ua(e.points):t||nI(e)},sX=(e,t,n,i,l)=>{let r=10/t.zoom.value,a=[i,l];if(sQ(t,e)&&sV([e],t))return s1(e,a,r,n);let s=hU(e);return!!(s&&sX(s,t,n,i,l))||sJ(e,t,n,a)},sq=(e,t,n,i,l)=>{let r=10/t.zoom.value,a=hU(e);return!(a&&sX(a,t,n,i,l))&&!sJ(e,t,n,[i,l])&&s1(e,[i,l],r,n)},sJ=(e,t,n,i)=>{let l=10/t.zoom.value,r=nL(e)?s4:sY(e)?s5:s8;return s3({element:e,point:i,threshold:l,check:r,frameNameBoundsCache:n})},sQ=(e,t)=>e.selectedElementIds[t.id],s1=(e,[t,n],i,l)=>{if(nP(e))return s3({element:e,point:[t,n],threshold:i,check:s5,frameNameBoundsCache:l});let[r,a,s,o]=mF(e),[d,c]=ut(t,n,(r+s)/2,(a+o)/2,-e.angle);return d>r-i&&d<s+i&&c>a-i&&c<o+i},s0=(e,{x:t,y:n})=>{let i=s2(e,e.width,e.height);return s3({element:e,point:[t,n],threshold:i,check:s7,frameNameBoundsCache:null})},s2=(e,t,n)=>Math.max(16,Math.min(("diamond"===e.type?1/Math.sqrt(2):1)*Math.min(t,n)*.25,32)),s3=e=>{switch(e.element.type){case"rectangle":case"iframe":case"embeddable":case"image":case"text":case"diamond":case"ellipse":let t=s6(e.element,e.point);return e.check(t,e.threshold);case"freedraw":return!!e.check(s9(e.element,e.point),e.threshold)&&ol(e.element,e.point,e.threshold);case"arrow":case"line":return or(e);case"selection":return console.warn("This should not happen, we need to investigate why it does."),!1;case"frame":case"magicframe":{if(e.check(s6(e.element,e.point),e.threshold))return!0;let t=e.frameNameBoundsCache?.get(e.element);return!!t&&e.check(oe(t,e.point),e.threshold)}}},s6=(e,t)=>{switch(e.type){case"rectangle":case"image":case"text":case"iframe":case"embeddable":case"frame":case"magicframe":return s9(e,t);case"diamond":return ot(e,t);case"ellipse":return on(e,t)}},s4=(e,t)=>e<0,s5=(e,t)=>e<t,s8=(e,t)=>Math.abs(e)<t,s7=(e,t)=>0<=e&&e<t,s9=(e,t)=>{let[,n,i,l]=oa(e,t);return Math.max(iS(n,im(0,1,-l)),iS(n,im(1,0,-i)))},oe=(e,t)=>{let[,n,i,l]=os(t,e);return Math.max(iS(n,im(0,1,-l)),iS(n,im(1,0,-i)))},ot=(e,t)=>{let[,n,i,l]=oa(e,t),r=im(l,i,-l*i);return iS(n,r)},on=(e,t)=>{let[n,i]=oi(e,t);return-ix(i)*iS(n,i)},oi=(e,t)=>{let[,n,i,l]=oa(e,t),[r,a]=ib(n),s=.707,o=.707;[0,1,2,3].forEach(e=>{let t=i*s,n=l*o,d=(i*i-l*l)*s**3/i,c=(l*l-i*i)*o**3/l,h=r-d,m=a-c,u=Math.hypot(n-c,t-d),p=Math.hypot(m,h);s=Math.min(1,Math.max(0,(h*u/p+d)/i));let g=Math.hypot(o=Math.min(1,Math.max(0,(m*u/p+c)/l)),s);s/=g,o/=g});let d=n6(i*s,l*o),c=ig(n,d);return[n,c]},ol=(e,t,n)=>{let i,l;if(0===e.angle)i=t[0]-e.x,l=t[1]-e.y;else{let[n,r,a,s]=mF(e),o=un(t,[n+(a-n)/2,r+(s-r)/2],-e.angle);i=o[0]-e.x,l=o[1]-e.y}let[r,a]=e.points,s;if(ul(r[0],r[1],i,l)<n||ul(a[0],a[1],i,l)<n)return!0;for(let t=0;t<e.points.length;t++){let o=[a[0]-r[0],a[1]-r[1]],d=Math.hypot(o[1],o[0]),c=[o[0]/d,o[1]/d],h=[i-r[0],l-r[1]],m=(h[0]*c[0]+h[1]*c[1])/Math.hypot(c[1],c[0]);s=[r[0]+c[0]*m,r[1]+c[1]*m];let u=ul(s[0],s[1],r[0],r[1]),p=ul(s[0],s[1],a[0],a[1]);if(Math.hypot(l-(s=p<u&&u>d?a:u<p&&p>d?r:s)[1],i-s[0])<n)return!0;r=a,a=e.points[t+1]}let o=sK.get(e);return!!o&&!!o.sets.length&&("solid"===e.fillStyle?oE(o,i,l,"round"):oS(o,i,l,n))},or=e=>{let{element:t,threshold:n}=e;if(!sK.get(t))return!1;let[i,l,r,a]=oa(e.element,e.point),s=im(0,1,-a),o=im(1,0,-r);if(!s5(iS(l,s),n)||!s5(iS(l,o),n))return!1;let[d,c]=ib(i),h=sK.get(t);return!!h&&(!!(e.check===s5&&h.some(e=>oE(e,d,c,t.roundness?"round":"sharp")))||h.some(e=>oS(e,d,c,n)))},oa=(e,t)=>{let n=iy(t),[i,l,r,a]=mF(e),s=od(i,l,r,a),o=iI(s,e.angle),d=iL(o,n),c=n9(d,ik(s)),h=iv(c),m=n4(e.x,e.y);return[n9(d,m),h,(r-i)/2,(a-l)/2]},os=(e,t)=>{let n=iy(e),[i,l,r,a]=mZ(t),s=od(i,l,r,a),o=iI(s,t.angle),d=iL(o,n),c=n9(d,ik(s)),h=iv(c),m=n4(t.x,t.y);return[n9(d,m),h,(r-i)/2,(a-l)/2]},oo=e=>{let[t,n,i,l]=mF(e),r=od(t,n,i,l),a=iI(r,e.angle),s=n8(iM(ik(r)));return iT(a,s)},od=(e,t,n,i)=>n6((e+n)/2,(t+i)/2),oc=(e,t,n)=>{let i=oo(e),l=iL(i,iy(t)),r=iL(i,iy(n)),a=iu(l,r),s=e.height/e.width,o=e.width/2,d=e.height/2,c=a[2],h=a[3],m=a[1],u=Math.abs(h),p=Math.abs(c),g;switch(e.type){case"rectangle":case"image":case"text":case"iframe":case"embeddable":case"frame":case"magicframe":g=m/(o*(p+s*u));break;case"diamond":g=u<p?m/(p*o):m/(u*d);break;case"ellipse":g=m/(o*Math.sqrt(c**2+s**2*h**2))}return g||0},oh=(e,t,n)=>{if(0===t){let[t,n,i,l]=mF(e),r=od(t,n,i,l);return ib(r)}let i=oo(e),l=iL(i,iy(n)),r=n8(i),a;switch(e.type){case"rectangle":case"image":case"text":case"diamond":case"iframe":case"embeddable":case"frame":case"magicframe":a=ov(e,t,l);break;case"ellipse":a=ob(e,t,l)}return ib(iL(r,a))},om=(e,t,n,i=0)=>{let l=oo(e),r=iL(l,iy(t)),a=iL(l,iy(n)),s=iu(r,a),o=n8(l);return ou(e,s,r,i).map(e=>ib(iL(o,e)))},ou=(e,t,n,i=0)=>{let l;switch(e.type){case"rectangle":case"image":case"text":case"diamond":case"iframe":case"embeddable":case"frame":case"magicframe":let r=op(e);l=r.flatMap((e,n)=>{let l=[e,r[(n+1)%4]];return og(t,of(l,i))}).concat(r.flatMap(e=>oy(e,i,t)));break;case"ellipse":l=ox(e,i,t)}if(l.length<2)return[];let a=l.sort((e,t)=>iE(e,n)-iE(t,n));return[a[0],a[a.length-1]]},op=(e,t=1)=>{let n=t*e.width/2,i=t*e.height/2;switch(e.type){case"rectangle":case"image":case"text":case"iframe":case"embeddable":case"frame":case"magicframe":return[n6(n,i),n6(n,-i),n6(-n,-i),n6(-n,i)];case"diamond":return[n6(0,i),n6(n,0),n6(0,-i),n6(-n,0)]}},og=(e,t)=>{let[n,i]=t;return iS(n,e)*iS(i,e)>=0?[]:[iw(e,iu(n,i))]},of=(e,t)=>{let[n,i]=e,l=ij(iC(n,i),t);return[iL(l,n),iL(l,i)]},ox=(e,t,n)=>{let i=e.width/2+t,l=e.height/2+t,r=n[2],a=n[3],s=n[1],o=i*i*r*r+l*l*a*a,d=o-s*s;if(0===o||d<=0)return[];let c=Math.sqrt(d),h=-i*i*r*s,m=-l*l*a*s;return[n6((h+i*l*a*c)/o,(m-i*l*r*c)/o),n6((h-i*l*a*c)/o,(m+i*l*r*c)/o)]},oy=(e,t,n)=>{if(0===t)return 0===iS(n,e)?[e]:[];let i=n[2],l=n[3],r=n[1],[a,s]=ib(e),o=i*i+l*l,d=t*t*o-(i*a+l*s+r)**2;if(0===o||d<=0)return[];let c=Math.sqrt(d),h=a*l*l-s*i*l-i*r,m=s*i*i-a*i*l-l*r;return[n6((h+l*c)/o,(m-i*c)/o),n6((h-l*c)/o,(m+i*c)/o)]},ob=(e,t,n)=>{let i=Math.abs(t),l=e.width*i/2,r=e.height*i/2,[a,s]=ib(n),o=0===s?1e-4:s,d=a**2*r**2+o**2*l**2,c=(-a*r**2+Math.sign(t)*o*Math.sqrt(Math.max(0,d-l**2*r**2)))/d,h=(-c*a-1)/o;0===h&&(h=(Object.is(h,-0)?-1:1)*.01);let m=-(l**2*c)/(h**2*r**2+c**2*l**2);return n6(m,(-c*m-1)/h)},ov=(e,t,n)=>{let i=Math.sign(t),l=op(e,Math.abs(t)),r=0,a=null;return l.forEach(e=>{let t=i*iu(n,e)[1];t>r&&(r=t,a=e)}),a},ow=(e,t,n,i,[l,r],a)=>{let s=(l,r)=>Math.pow(1-l,3)*i[r]+3*l*Math.pow(1-l,2)*n[r]+3*Math.pow(l,2)*(1-l)*t[r]+e[r]*Math.pow(l,3),o=0;for(;o<=1;){if(Math.sqrt(Math.pow(s(o,0)-l,2)+Math.pow(s(o,1)-r,2))<a)return!0;o+=.01}return!1},oE=(e,t,n,i)=>{let l=mU(e),r=[],a=!1;for(let e of l)"move"===e.op?(a=!a)&&r.push([e.data[0],e.data[1]]):"bcurveTo"===e.op?a&&(r.push([e.data[0],e.data[1]]),r.push([e.data[2],e.data[3]]),r.push([e.data[4],e.data[5]])):"lineTo"===e.op&&a&&r.push([e.data[0],e.data[1]]);if(r.length>=4){if("sharp"===i)return us(r,t,n);let e=(0,td.sU)(r,10,5);return us(e,t,n)}return!1},oS=(e,t,n,i)=>{let l=mU(e),r=[0,0];return l.some(({op:l,data:a},s)=>{if("move"===l)r=a;else if("bcurveTo"===l){let e=[a[0],a[1]],l=[a[2],a[3]],s=[a[4],a[5]],o=r;return r=s,ow(o,e,l,s,[t,n],i)}else{if("lineTo"===l)return oE(e,t,n,"sharp");"qcurveTo"===l&&console.warn("qcurveTo is not implemented yet")}return!1})}}),dY=tC(()=>{tM(),fK(),dx(),dK(),fB(),fH(),dX(),df(),dO(),ma(),ok=e=>!e[aO.CTRL_OR_CMD],oC=e=>e.isBindingEnabled,oI=(e,t)=>{let n=[];return t.forEach(t=>{let i=e.getNonDeletedElement(t);null!=i&&n.push(i)}),n},oM=(e,t,n)=>{let i=new Set,l=new Set;oj(e,t,n,"start",i,l),oj(e,n,t,"end",i,l);let r=Array.from(l).filter(e=>!i.has(e));oI(gJ.getScene(e),r).forEach(t=>{gQ(t,{boundElements:t.boundElements?.filter(t=>"arrow"!==t.type||t.id!==e.id)})})},oj=(e,t,n,i,l,r)=>{if("keep"!==t){if(null!=t)null!=n&&("keep"===n?oP(e,t,i):"start"!==i&&n.id===t.id)||(oA(e,t,i),l.add(t.id));else{let t=oN(e,i);null!=t&&r.add(t)}}},oT=e=>{e.forEach(e=>{nH(e)?oM(e,oG(e,"start"),oG(e,"end")):nF(e)&&oL(e)})},oL=e=>{oK(e).forEach(([t,n])=>oM(t,"end"===n?"keep":e,"start"===n?"keep":e))},oD=(e,t,n,i)=>{null!=t.startBoundElement&&oA(e,t.startBoundElement,"start");let l=oO(i,n);null==l||oP(e,l,"end")||oA(e,l,"end")},oA=(e,t,n)=>{gQ(e,{["start"===n?"startBinding":"endBinding"]:{elementId:t.id,...oz(e,t,n)}}),na(t.boundElements||[]).has(e.id)||gQ(t,{boundElements:(t.boundElements||[]).concat({id:e.id,type:"arrow"})})},oP=(e,t,n)=>{let i=e["start"===n?"endBinding":"startBinding"];return o_(e,i?.elementId,t)},o_=(e,t,n)=>t===n.id&&e.points.length<3,oR=e=>{e.forEach(e=>{nH(e)&&oM(e,null,null)})},oN=(e,t)=>{let n="start"===t?"startBinding":"endBinding",i=e[n];return null==i?null:(gQ(e,{[n]:null}),i.elementId)},oO=(e,t)=>cj(t.getNonDeletedElements(),t=>nF(t,!1)&&s0(t,e)),oz=(e,t,n)=>{let i="start"===n?-1:1,l=-1===i?0:e.points.length-1,r=l-i,a=o2.getPointAtIndexGlobalCoordinates(e,l),s=o2.getPointAtIndexGlobalCoordinates(e,r);return{focus:oc(t,s,a),gap:Math.max(1,s6(t,a))}},oH=(e,t)=>{let n=(e.boundElements??[]).filter(e=>"arrow"===e.type);if(0===n.length)return;let{newSize:i,simultaneouslyUpdated:l}=t??{},r=oF(l);oI(gJ.getScene(e),n.map(e=>e.id)).forEach(t=>{if(!nN(t)||!oB(t,e))return;let n=oZ(e,t.startBinding,i),l=oZ(e,t.endBinding,i);if(r.has(t.id)){gQ(t,{startBinding:n,endBinding:l});return}o$(t,"start",n,e),o$(t,"end",l,e),hU(t)&&hM(t,!1)})},oB=(e,t)=>e.startBinding?.elementId===t.id||e.endBinding?.elementId===t.id,oF=e=>new Set((e||[]).map(e=>e.id)),o$=(e,t,n,i)=>{if(null==n||n.elementId!==i.id&&e.points.length>2)return;let l=gJ.getScene(e).getElement(n.elementId);if(null==l)return;let r="start"===t?-1:1,a=-1===r?0:e.points.length-1,s=o2.getPointAtIndexGlobalCoordinates(e,a-r),o=oh(l,n.focus,s),d;if(0===n.gap)d=o;else{let e=om(l,s,o,n.gap);d=0===e.length?o:e[0]}o2.movePoints(e,[{index:a,point:o2.pointFromAbsoluteCoords(e,d)}],{["start"===t?"startBinding":"endBinding"]:n})},oZ=(e,t,n)=>{if(null==t||null==n)return t;let{gap:i,focus:l,elementId:r}=t,{width:a,height:s}=n,{width:o,height:d}=e;return{elementId:r,gap:Math.max(1,Math.min(s2(e,a,s),i*(a<s?a/o:s/d))),focus:l}},oW=e=>{let t=new Set(e.map(({id:e})=>e));return e.flatMap(e=>nH(e,!1)?oU(e).filter(e=>!t.has(e.id)):nF(e,!1)?oK(e).filter(e=>!t.has(e[0].id)):[])},oU=e=>[oG(e,"start"),oG(e,"end")].filter(e=>null!=e),oG=(e,t)=>oO(oV(e,t),gJ.getScene(e)),oV=(e,t)=>t8(o2.getPointAtIndexGlobalCoordinates(e,"start"===t?0:-1)),oK=e=>gJ.getScene(e).getNonDeletedElements().map(t=>{if(!nH(t,!1))return null;let n=oY(t,"start",e),i=oY(t,"end",e);return n||i?[t,n&&i?"both":n?"start":"end",e]:null}).filter(e=>null!=e),oY=(e,t,n)=>null==e["start"===t?"startBinding":"endBinding"]&&!oP(e,n,t)&&s0(n,oV(e,t)),oX=(e,t,n,i)=>{let l=new Set,r=new Set,a="duplicatesServeAsOld"===i;t.forEach(e=>{let{boundElements:t}=e;if(null!=t&&t.length>0&&(t.forEach(e=>{a&&!n.has(e.id)&&l.add(e.id)}),r.add(n.get(e.id))),nH(e)){if(null!=e.startBinding){let{elementId:t}=e.startBinding;a&&!n.has(t)&&r.add(t)}if(null!=e.endBinding){let{elementId:t}=e.endBinding;a&&!n.has(t)&&r.add(t)}(null!=e.startBinding||null!=e.endBinding)&&l.add(n.get(e.id))}}),e.filter(({id:e})=>l.has(e)).forEach(e=>{let{startBinding:t,endBinding:i}=e;gQ(e,{startBinding:oq(t,n),endBinding:oq(i,n)})}),e.filter(({id:e})=>r.has(e)).forEach(e=>{let{boundElements:t}=e;null!=t&&t.length>0&&gQ(e,{boundElements:t.map(e=>n.has(e.id)?{id:n.get(e.id),type:e.type}:e)})})},oq=(e,t)=>{if(null==e)return null;let{elementId:n,focus:i,gap:l}=e;return{focus:i,gap:l,elementId:t.get(n)??n}},oJ=(e,t)=>{let n=new Set(t.map(e=>e.id)),i=new Set;t.forEach(e=>{nF(e)?e.boundElements?.forEach(e=>{n.has(e.id)||i.add(e.id)}):nH(e)&&(e.startBinding&&i.add(e.startBinding.elementId),e.endBinding&&i.add(e.endBinding.elementId))}),e.filter(({id:e})=>i.has(e)).forEach(e=>{nF(e)?gQ(e,{boundElements:o1(e.boundElements,n)}):nH(e)&&gQ(e,{startBinding:oQ(e.startBinding,n),endBinding:oQ(e.endBinding,n)})})},oQ=(e,t)=>null==e||t.has(e.elementId)?null:e,o1=(e,t)=>e?e.filter(e=>!t.has(e.id)):null}),dX=tC(()=>{tM(),uJ(),fG(),uq(),fB(),fH(),dY(),df(),dx(),dO(),ma(),tR(),dV(),o0={version:null,points:[],zoom:null},o2=class e{elementId;selectedPointsIndices;pointerDownState;isDragging;lastUncommittedPoint;pointerOffset;startBindingElement;endBindingElement;hoverPointIndex;segmentMidPointHoveredCoords;constructor(t,n){this.elementId=t.id,gJ.mapElementToScene(this.elementId,n),e.normalizePoints(t),this.selectedPointsIndices=null,this.lastUncommittedPoint=null,this.isDragging=!1,this.pointerOffset={x:0,y:0},this.startBindingElement="keep",this.endBindingElement="keep",this.pointerDownState={prevSelectedPointsIndices:null,lastClickedPoint:-1,origin:null,segmentMidpoint:{value:null,index:null,added:!1}},this.hoverPointIndex=-1,this.segmentMidPointHoveredCoords=null}static POINT_HANDLE_SIZE=10;static getElement(e){return gJ.getScene(e)?.getNonDeletedElement(e)||null}static handleBoxSelection(t,n,i){if(!n.editingLinearElement||n.draggingElement?.type!=="selection")return!1;let{editingLinearElement:l}=n,{selectedPointsIndices:r,elementId:a}=l,s=e.getElement(a);if(!s)return!1;let[o,d,c,h]=mF(n.draggingElement),m=e.getPointsGlobalCoordinates(s).reduce((e,n,i)=>((n[0]>=o&&n[0]<=c&&n[1]>=d&&n[1]<=h||t.shiftKey&&r?.includes(i))&&e.push(i),e),[]);i({editingLinearElement:{...l,selectedPointsIndices:m.length?m:null}})}static handlePointDragging(t,n,i,l,r,a){if(!a)return!1;let{selectedPointsIndices:s,elementId:o}=a,d=e.getElement(o);if(!d)return!1;let c=d.points[a.pointerDownState.lastClickedPoint];if(s&&c){if(aF(t)&&1===s.length&&d.points.length>1){let r=s[0],o=d.points[0===r?1:r-1],[c,h]=e._getShiftLockedDelta(d,o,[i,l],t[aO.CTRL_OR_CMD]?null:n.gridSize);e.movePoints(d,[{index:r,point:[c+o[0],h+o[1]],isDragging:r===a.pointerDownState.lastClickedPoint}])}else{let r=e.createPointAt(d,i-a.pointerOffset.x,l-a.pointerOffset.y,t[aO.CTRL_OR_CMD]?null:n.gridSize),o=r[0]-c[0],h=r[1]-c[1];e.movePoints(d,s.map(r=>{let s=r===a.pointerDownState.lastClickedPoint?e.createPointAt(d,i-a.pointerOffset.x,l-a.pointerOffset.y,t[aO.CTRL_OR_CMD]?null:n.gridSize):[d.points[r][0]+o,d.points[r][1]+h];return{index:r,point:s,isDragging:r===a.pointerDownState.lastClickedPoint}}))}if(hU(d)&&hM(d,!1),nH(d,!1)){let t=[];0===s[0]&&t.push(t8(e.getPointGlobalCoordinates(d,d.points[0])));let n=s[s.length-1];n===d.points.length-1&&t.push(t8(e.getPointGlobalCoordinates(d,d.points[n]))),t.length&&r(d,t)}return!0}return!1}static handlePointerUp(t,n,i){let{elementId:l,selectedPointsIndices:r,isDragging:a,pointerDownState:s}=n,o=e.getElement(l);if(!o)return n;let d={};if(a&&r){for(let t of r)if(0===t||t===o.points.length-1){ua(o.points,i.zoom.value)&&e.movePoints(o,[{index:t,point:0===t?o.points[o.points.length-1]:o.points[0]}]);let n=oC(i)?oO(t8(e.getPointAtIndexGlobalCoordinates(o,t)),gJ.getScene(o)):null;d[0===t?"startBindingElement":"endBindingElement"]=n}}return{...n,...d,selectedPointsIndices:a||t.shiftKey?!a&&t.shiftKey&&s.prevSelectedPointsIndices?.includes(s.lastClickedPoint)?r&&r.filter(e=>e!==s.lastClickedPoint):r:r?.includes(s.lastClickedPoint)?[s.lastClickedPoint]:r,isDragging:!1,pointerOffset:{x:0,y:0}}}static getEditorMidPoints=(t,n)=>{let i=hU(t);return n.editingLinearElement||!(t.points.length>2)||i?(o0.version===t.version&&o0.zoom===n.zoom.value||e.updateEditorMidPointsCache(t,n),o0.points):[]};static updateEditorMidPointsCache=(t,n)=>{let i=e.getPointsGlobalCoordinates(t),l=0,r=[];for(;l<i.length-1;){if(e.isSegmentTooShort(t,t.points[l],t.points[l+1],n.zoom)){r.push(null),l++;continue}let a=e.getSegmentMidPoint(t,i[l],i[l+1],l+1);r.push(a),l++}o0.points=r,o0.version=t.version,o0.zoom=n.zoom.value};static getSegmentMidpointHitCoords=(t,n,i)=>{let{elementId:l}=t,r=e.getElement(l);if(!r||e.getPointIndexUnderCursor(r,i.zoom,n.x,n.y)>=0||e.getPointsGlobalCoordinates(r).length>=3&&!i.editingLinearElement)return null;let a=e.POINT_HANDLE_SIZE/i.zoom.value,s=t.segmentMidPointHoveredCoords;if(s&&ul(s[0],s[1],n.x,n.y)<=a)return s;let o=0,d=e.getEditorMidPoints(r,i);for(;o<d.length;){if(null!==d[o]&&ul(d[o][0],d[o][1],n.x,n.y)<=a)return d[o];o++}return null};static isSegmentTooShort(t,n,i,l){let r=ul(n[0],n[1],i[0],i[1]);return t.points.length>2&&t.roundness&&(r=ux(t,i)),r*l.value<4*e.POINT_HANDLE_SIZE}static getSegmentMidPoint(t,n,i,l){let r=ur(n,i);if(t.points.length>2&&t.roundness){let n=uu(t,t.points[l]);if(n){let i=uy(t,t.points[l],.5),[a,s]=up(n[0],n[1],n[2],n[3],i);r=e.getPointGlobalCoordinates(t,[a,s])}}return r}static getSegmentMidPointIndex(t,n,i){let l=e.getElement(t.elementId);if(!l)return -1;let r=e.getEditorMidPoints(l,n),a=0;for(;a<r.length;){if(e.arePointsEqual(i,r[a]))return a+1;a++}return -1}static handlePointerDown(t,n,i,l,r){let a={didAddPoint:!1,hitElement:null,linearElementEditor:null};if(!r)return a;let{elementId:s}=r,o=e.getElement(s);if(!o)return a;let d=e.getSegmentMidpointHitCoords(r,l,n),c=null;if(d&&(c=e.getSegmentMidPointIndex(r,n,d)),t.altKey&&n.editingLinearElement)return null==r.lastUncommittedPoint&&(gQ(o,{points:[...o.points,e.createPointAt(o,l.x,l.y,t[aO.CTRL_OR_CMD]?null:n.gridSize)]}),a.didAddPoint=!0),i.resumeRecording(),a.linearElementEditor={...r,pointerDownState:{prevSelectedPointsIndices:r.selectedPointsIndices,lastClickedPoint:-1,origin:{x:l.x,y:l.y},segmentMidpoint:{value:d,index:c,added:!1}},selectedPointsIndices:[o.points.length-1],lastUncommittedPoint:null,endBindingElement:oO(l,gJ.getScene(o))},a.didAddPoint=!0,a;let h=e.getPointIndexUnderCursor(o,n.zoom,l.x,l.y);if(h>=0||d)a.hitElement=o;else{let{startBindingElement:e,endBindingElement:t}=r;oC(n)&&nH(o)&&oM(o,e,t)}let[m,u,p,g]=mF(o),f=h>-1&&ut(o.x+o.points[h][0],o.y+o.points[h][1],(m+p)/2,(u+g)/2,o.angle),x=h>-1||t.shiftKey?t.shiftKey||r.selectedPointsIndices?.includes(h)?o3([...r.selectedPointsIndices||[],h]):[h]:null;return a.linearElementEditor={...r,pointerDownState:{prevSelectedPointsIndices:r.selectedPointsIndices,lastClickedPoint:h,origin:{x:l.x,y:l.y},segmentMidpoint:{value:d,index:c,added:!1}},selectedPointsIndices:x,pointerOffset:f?{x:l.x-f[0],y:l.y-f[1]}:{x:0,y:0}},a}static arePointsEqual(e,t){return!e&&!t||!!e&&!!t&&ub(e,t)}static handlePointerMove(t,n,i,l){let r;if(!l.editingLinearElement)return null;let{elementId:a,lastUncommittedPoint:s}=l.editingLinearElement,o=e.getElement(a);if(!o)return l.editingLinearElement;let{points:d}=o,c=d[d.length-1];if(!t.altKey)return c===s&&e.deletePoints(o,[d.length-1]),{...l.editingLinearElement,lastUncommittedPoint:null};if(aF(t)&&d.length>=2){let a=d[d.length-2],[s,c]=e._getShiftLockedDelta(o,a,[n,i],t[aO.CTRL_OR_CMD]?null:l.gridSize);r=[s+a[0],c+a[1]]}else r=e.createPointAt(o,n-l.editingLinearElement.pointerOffset.x,i-l.editingLinearElement.pointerOffset.y,t[aO.CTRL_OR_CMD]?null:l.gridSize);return c===s?e.movePoints(o,[{index:o.points.length-1,point:r}]):e.addPoints(o,l,[{point:r}]),{...l.editingLinearElement,lastUncommittedPoint:o.points[o.points.length-1]}}static getPointGlobalCoordinates(e,t){let[n,i,l,r]=mF(e),{x:a,y:s}=e;return[a,s]=ut(a+t[0],s+t[1],(n+l)/2,(i+r)/2,e.angle),[a,s]}static getPointsGlobalCoordinates(e){let[t,n,i,l]=mF(e),r=(t+i)/2,a=(n+l)/2;return e.points.map(t=>{let{x:n,y:i}=e;return[n,i]=ut(n+t[0],i+t[1],r,a,e.angle),[n,i]})}static getPointAtIndexGlobalCoordinates(e,t){let n=t<0?e.points.length+t:t,[i,l,r,a]=mF(e),s=(i+r)/2,o=(l+a)/2,d=e.points[n],{x:c,y:h}=e;return d?ut(c+d[0],h+d[1],s,o,e.angle):ut(c,h,s,o,e.angle)}static pointFromAbsoluteCoords(e,t){let[n,i,l,r]=mF(e),[a,s]=ut(t[0],t[1],(n+l)/2,(i+r)/2,-e.angle);return[a-e.x,s-e.y]}static getPointIndexUnderCursor(t,n,i,l){let r=e.getPointsGlobalCoordinates(t),a=r.length;for(;--a>-1;){let t=r[a];if(ul(i,l,t[0],t[1])*n.value<e.POINT_HANDLE_SIZE+1)return a}return -1}static createPointAt(e,t,n,i){let l=uh(t,n,i),[r,a,s,o]=mF(e),[d,c]=ut(l[0],l[1],(r+s)/2,(a+o)/2,-e.angle);return[d-e.x,c-e.y]}static getNormalizedPoints(e){let{points:t}=e,n=t[0][0],i=t[0][1];return{points:t.map((e,t)=>[e[0]-n,e[1]-i]),x:e.x+n,y:e.y+i}}static normalizePoints(t){gQ(t,e.getNormalizedPoints(t))}static duplicateSelectedPoints(t){if(!t.editingLinearElement)return!1;let{selectedPointsIndices:n,elementId:i}=t.editingLinearElement,l=e.getElement(i);if(!l||null===n)return!1;let{points:r}=l,a=[],s=!1,o=-1,d=r.reduce((e,t,i)=>{if(++o,e.push(t),n.includes(i)){let n=r[i+1];n||(s=!0),e.push(n?[(t[0]+n[0])/2,(t[1]+n[1])/2]:[t[0],t[1]]),a.push(o+1),++o}return e},[]);if(gQ(l,{points:d}),s){let t=l.points[l.points.length-1];e.movePoints(l,[{index:l.points.length-1,point:[t[0]+30,t[1]+30]}])}return{appState:{...t,editingLinearElement:{...t.editingLinearElement,selectedPointsIndices:a}}}}static deletePoints(t,n){let i=0,l=0;if(n.includes(0)){let e=t.points.find((e,t)=>!n.includes(t));e&&(i=e[0],l=e[1])}let r=t.points.reduce((e,t,r)=>(n.includes(r)||e.push(e.length?[t[0]-i,t[1]-l]:[0,0]),e),[]);e._updatePoints(t,r,i,l)}static addPoints(t,n,i){let l=[...t.points,...i.map(e=>e.point)];e._updatePoints(t,l,0,0)}static movePoints(t,n,i){let{points:l}=t,r=0,a=0,s=n.find(({index:e})=>0===e);s&&(r=s.point[0]+l[s.index][0],a=s.point[1]+l[s.index][1]);let o=l.map((e,t)=>{let i=n.find(e=>e.index===t);if(i){if(s)return e;let t=i.point[0]-l[i.index][0],n=i.point[1]-l[i.index][1];return[e[0]+t,e[1]+n]}return r||a?[e[0]-r,e[1]-a]:e});e._updatePoints(t,o,r,a,i)}static shouldAddMidpoint(t,n,i){if(!e.getElement(t.elementId))return!1;let{segmentMidpoint:l}=t.pointerDownState;if(l.added||null===l.value||null===l.index||null===t.pointerDownState.origin)return!1;let r=t.pointerDownState.origin,a=ul(r.x,r.y,n.x,n.y);return!(!i.editingLinearElement&&a<ee/i.zoom.value)}static addMidpoint(t,n,i,l){let r=e.getElement(t.elementId);if(!r)return;let{segmentMidpoint:a}=t.pointerDownState,s={pointerDownState:t.pointerDownState,selectedPointsIndices:t.selectedPointsIndices},o=e.createPointAt(r,n.x,n.y,l?i.gridSize:null),d=[...r.points.slice(0,a.index),o,...r.points.slice(a.index)];return gQ(r,{points:d}),s.pointerDownState={...t.pointerDownState,segmentMidpoint:{...t.pointerDownState.segmentMidpoint,added:!0},lastClickedPoint:a.index},s.selectedPointsIndices=[a.index],s}static _updatePoints(e,t,n,i,l){let r=m8(e,t),a=m8(e,e.points),s=(r[0]+r[2])/2,o=(r[1]+r[3])/2,d=(a[0]+a[2])/2,c=(a[1]+a[3])/2,h=ut(n,i,d-s,c-o,e.angle);gQ(e,{...l,points:t,x:e.x+h[0],y:e.y+h[1]})}static _getShiftLockedDelta(t,n,i,l){let r=e.getPointGlobalCoordinates(t,n),[a,s]=uh(i[0],i[1],l),{width:o,height:d}=g4(r[0],r[1],a,s);return un([o,d],[0,0],-t.angle)}static getBoundTextElementPosition=(t,n)=>{let i=e.getPointsGlobalCoordinates(t);i.length<2&&gQ(n,{isDeleted:!0});let l=0,r=0;if(t.points.length%2==1){let i=Math.floor(t.points.length/2),a=e.getPointGlobalCoordinates(t,t.points[i]);l=a[0]-n.width/2,r=a[1]-n.height/2}else{let a=t.points.length/2-1,s=o0.points[a];2===t.points.length&&(s=ur(i[0],i[1])),s&&o0.version===t.version||(s=e.getSegmentMidPoint(t,i[a],i[a+1],a+1)),l=s[0]-n.width/2,r=s[1]-n.height/2}return{x:l,y:r}};static getMinMaxXYWithBoundText=(t,n,i)=>{let[l,r,a,s]=n,o=(l+a)/2,d=(r+s)/2,{x:c,y:h}=e.getBoundTextElementPosition(t,i),m=c+i.width,u=h+i.height,p=un([l,r],[o,d],t.angle),g=un([a,r],[o,d],t.angle),f=un([c,h],[o,d],-t.angle),x=un([m,h],[o,d],-t.angle),y=un([c,u],[o,d],-t.angle),b=un([m,u],[o,d],-t.angle);return p[0]<g[0]&&p[1]>=g[1]?(l=Math.min(l,y[0]),a=Math.max(a,Math.max(x[0],b[0])),r=Math.min(r,f[1]),s=Math.max(s,b[1])):p[0]>=g[0]&&p[1]>g[1]?(l=Math.min(l,b[0]),a=Math.max(a,Math.max(f[0],x[0])),r=Math.min(r,y[1]),s=Math.max(s,x[1])):p[0]>=g[0]?(l=Math.min(l,x[0]),a=Math.max(a,y[0]),r=Math.min(r,b[1]),s=Math.max(s,f[1])):p[1]<=g[1]&&(l=Math.min(l,Math.min(x[0],f[0])),a=Math.max(a,b[0]),r=Math.min(r,x[1]),s=Math.max(s,y[1])),[l,r,a,s,o,d]};static getElementAbsoluteCoords=(t,n=!1)=>{let i,l,r,a,s;if(t.points.length<2||!sK.get(t)){let{minX:e,minY:n,maxX:i,maxY:o}=t.points.reduce((e,[t,n])=>(e.minY=Math.min(e.minY,n),e.minX=Math.min(e.minX,t),e.maxX=Math.max(e.maxX,t),e.maxY=Math.max(e.maxY,n),e),{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0});l=e+t.x,r=n+t.y,a=i+t.x,s=o+t.y}else{let e=sK.generateElementShape(t,null),n=mU(e[0]),[i,o,d,c]=mY(n);l=i+t.x,r=o+t.y,a=d+t.x,s=c+t.y}let o=(l+a)/2,d=(r+s)/2;if(i=[l,r,a,s,o,d],!n)return i;let c=hU(t);return c&&(i=e.getMinMaxXYWithBoundText(t,[l,r,a,s],c)),i}},o3=e=>{let t=[...new Set(e.filter(e=>null!==e&&-1!==e))];return(t=t.sort((e,t)=>e-t)).length?t:null}}),dq=tC(()=>{tM(),o6=e=>(0,s.jsx)("div",{className:"buttonList buttonListIcon",children:e.options.map(t=>"button"===e.type?(0,s.jsx)("button",{onClick:n=>e.onClick(t.value,n),className:(0,d.Z)({active:t.active??e.value===t.value}),"data-testid":t.testId,title:t.text,children:t.icon},t.text):(0,s.jsxs)("label",{className:(0,d.Z)({active:e.value===t.value}),title:t.text,children:[(0,s.jsx)("input",{type:"radio",name:e.group,onChange:()=>e.onChange(t.value),checked:e.value===t.value,"data-testid":t.testId}),t.icon]},t.text))})}),dJ=tC(()=>{tM(),t_(),o4=({onChange:e,type:t,activeColor:n,topPicks:i})=>{let l;return"elementStroke"===t&&(l=B),"elementBackground"===t&&(l=F),"canvasBackground"===t&&(l=$),i&&(l=i),l?(0,s.jsx)("div",{className:"color-picker__top-picks",children:l.map(t=>(0,s.jsx)("button",{className:(0,d.Z)("color-picker__button",{active:t===n,"is-transparent":"transparent"===t||!t}),style:{"--swatch-color":t},type:"button",title:t,onClick:()=>e(t),"data-testid":`color-top-pick-${t}`,children:(0,s.jsx)("div",{className:"color-picker__button-outline"})},t))}):(console.error("Invalid type for TopPicks"),null)}}),dQ=tC(()=>{tM(),t_(),o5=({palette:e,color:t})=>{for(let[n,i]of Object.entries(e))if(Array.isArray(i)){let e=i.indexOf(t);if(e>-1)return{colorName:n,shade:e}}else if(i===t)return{colorName:n,shade:null};return null},o8=[["q","w","e","r","t"],["a","s","d","f","g"],["z","x","c","v","b"]].flat(),o7=({color:e,palette:t})=>!Object.values(t).flat().includes(e),o9=(e,t,n)=>{let i={elementBackground:"backgroundColor",elementStroke:"strokeColor"},l=e.filter(e=>{if(e.isDeleted)return!1;let l=e[i[t]];return o7({color:l,palette:n})}),r=new Map;return l.forEach(e=>{let n=e[i[t]];r.has(n)?r.set(n,r.get(n)+1):r.set(n,1)}),[...r.entries()].sort((e,t)=>t[1]-e[1]).map(e=>e[0]).slice(0,D)},de=(0,i.cn)(null),dt=(e,t,n)=>(299*e+587*t+114*n)/1e3>=160?"black":"white",dn=(e,t)=>{if(t){let t=new Option().style;if(t.color=e,t.color){let e=t.color.replace(/^(rgb|rgba)\(/,"").replace(/\)$/,"").replace(/\s/g,"").split(",");return dt(parseInt(e[0]),parseInt(e[1]),parseInt(e[2]))}}return"transparent"===e?"black":dt(parseInt(e.substring(1,3),16),parseInt(e.substring(3,5),16),parseInt(e.substring(5,7),16))}}),d1=tC(()=>{tM(),dQ(),di=({color:e,keyLabel:t,isCustomColor:n=!1,isShade:i=!1})=>(0,s.jsxs)("div",{className:"color-picker__button__hotkey-label",style:{color:dn(e,n)},children:[i&&"⇧",t]})}),d0=tC(()=>{tM(),dQ(),d1(),tL(),dl=({hex:e,onChange:t,palette:n})=>{let r=o5({color:e||"transparent",palette:n}),[a,o]=(0,i.KO)(de),c=(0,l.useRef)(null);if((0,l.useEffect)(()=>{c.current&&"shades"===a&&c.current.focus()},[r,a]),r){let{colorName:e,shade:i}=r,l=n[e];if(Array.isArray(l))return(0,s.jsx)("div",{className:"color-picker-content--default shades",children:l.map((n,l)=>(0,s.jsxs)("button",{ref:l===i&&"shades"===a?c:void 0,tabIndex:-1,type:"button",className:(0,d.Z)("color-picker__button color-picker__button--large",{active:l===i}),"aria-label":"Shade",title:`${e} - ${l+1}`,style:n?{"--swatch-color":n}:void 0,onClick:()=>{t(n),o("shades")},children:[(0,s.jsx)("div",{className:"color-picker__button-outline"}),(0,s.jsx)(di,{color:n,keyLabel:l+1,isShade:!0})]},l))})}return(0,s.jsxs)("div",{className:"color-picker-content--default",style:{position:"relative"},tabIndex:-1,children:[(0,s.jsx)("button",{type:"button",tabIndex:-1,className:"color-picker__button color-picker__button--large color-picker__button--no-focus-visible"}),(0,s.jsx)("div",{tabIndex:-1,style:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",fontSize:"0.75rem"},children:C("colorPicker.noShades")})]})}}),d2=tC(()=>{tM(),dQ(),d1(),tL(),dr=({palette:e,color:t,onChange:n,label:r,activeShade:a})=>{let o=o5({color:t||"transparent",palette:e}),[c,h]=(0,i.KO)(de),m=(0,l.useRef)(null);return(0,l.useEffect)(()=>{m.current&&"baseColors"===c&&m.current.focus()},[o?.colorName,c]),(0,s.jsx)("div",{className:"color-picker-content--default",children:Object.entries(e).map(([e,t],i)=>{let l=(Array.isArray(t)?t[a]:t)||"transparent",r=o8[i],c=C(`colors.${e.replace(/\d+/,"")}`,null,"");return(0,s.jsxs)("button",{ref:o?.colorName===e?m:void 0,tabIndex:-1,type:"button",className:(0,d.Z)("color-picker__button color-picker__button--large",{active:o?.colorName===e,"is-transparent":"transparent"===l||!l}),onClick:()=>{n(l),h("baseColors")},title:`${c}${l.startsWith("#")?` ${l}`:""} \u2014 ${r}`,"aria-label":`${c} \u2014 ${r}`,style:l?{"--swatch-color":l}:void 0,"data-testid":`color-${e}`,children:[(0,s.jsx)("div",{className:"color-picker__button-outline"}),(0,s.jsx)(di,{color:l,keyLabel:r})]},e)})})}}),d3=tC(()=>{tM(),dQ(),d1(),da=({colors:e,color:t,onChange:n,label:r})=>{let[a,o]=(0,i.KO)(de),c=(0,l.useRef)(null);return(0,l.useEffect)(()=>{c.current&&c.current.focus()},[t,a]),(0,s.jsx)("div",{className:"color-picker-content--default",children:e.map((e,i)=>(0,s.jsxs)("button",{ref:t===e?c:void 0,tabIndex:-1,type:"button",className:(0,d.Z)("color-picker__button color-picker__button--large",{active:t===e,"is-transparent":"transparent"===e||!e}),onClick:()=>{n(e),o("custom")},title:e,"aria-label":r,style:{"--swatch-color":e},children:[(0,s.jsx)("div",{className:"color-picker__button-outline"}),(0,s.jsx)(di,{color:e,keyLabel:i+1,isCustomColor:!0})]},i))})}}),d6=tC(()=>{tM(),dO(),t_(),dQ(),ds=(e,t,n)=>{let i=Math.ceil(n/A);switch(t=t??-1,e){case"ArrowLeft":{let e=t-1;return e<0?n-1:e}case"ArrowRight":return(t+1)%n;case"ArrowDown":{let e=t+A;return e>=n?t%A:e}case"ArrowUp":{let e=t-A,l=e<0?A*i+e:e;return l>=n?void 0:l}}},dd=({e,colorObj:t,onChange:n,palette:i,customColors:l,setActiveColorPickerSection:r,activeShade:a})=>{if(t?.shade!=null&&["Digit1","Digit2","Digit3","Digit4","Digit5"].includes(e.code)&&e.shiftKey){let l=Number(e.code.slice(-1))-1;return n(i[t.colorName][l]),r("shades"),!0}if(["1","2","3","4","5"].includes(e.key)&&l[Number(e.key)-1])return n(l[Number(e.key)-1]),r("custom"),!0;if(o8.includes(e.key)){let t=o8.indexOf(e.key),l=Object.keys(i)[t],s=i[l];return n(Array.isArray(s)?s[a]:s),r("baseColors"),!0}return!1},dc=({event:e,activeColorPickerSection:t,palette:n,color:i,onChange:l,customColors:r,setActiveColorPickerSection:a,updateData:s,activeShade:o,onEyeDropperToggle:d,onEscape:c})=>{if(e[aO.CTRL_OR_CMD])return!1;if(e.key===aO.ESCAPE)return c(e),!0;if(e.key===aO.ALT)return d(!0),!0;if(e.key===aO.I)return d(),!0;let h=o5({color:i,palette:n});if(e.key===aO.TAB){let s=Object.entries({custom:!!r.length,baseColors:!0,shades:h?.shade!=null,hex:!0}).reduce((e,[t,n])=>(n&&e.push(t),e),[]),o=s.indexOf(t),d=e.shiftKey?-1:1,c=o+d>s.length-1?0:o+d<0?s.length-1:o+d,m=s[c];return m&&a(m),"custom"===m?l(r[0]):"baseColors"===m&&(Object.entries(n).find(([e,t])=>Array.isArray(t)?t.includes(i):t===i?e:null)||l(z.black)),e.preventDefault(),e.stopPropagation(),!0}if(dd({e,colorObj:h,onChange:l,palette:n,customColors:r,setActiveColorPickerSection:a,activeShade:o}))return!0;if("shades"===t&&h){let{shade:t}=h,i=ds(e.key,t,A);if(void 0!==i)return l(n[h.colorName][i]),!0}if("baseColors"===t&&h){let{colorName:t}=h,i=Object.keys(n),r=i.indexOf(t),a=ds(e.key,r,i.length);if(void 0!==a){let e=n[i[a]];return l(Array.isArray(e)?e[o]:e),!0}}if("custom"===t){let t=r.indexOf(i),n=ds(e.key,t,r.length);if(void 0!==n)return l(r[n]),!0}return!1}}),d4=tC(()=>{tM(),dh=({children:e})=>(0,s.jsx)("div",{className:"color-picker__heading",children:e})}),d5=tC(()=>{tM(),tL(),d0(),d2(),d3(),d6(),d4(),dQ(),t_(),dO(),tR(),dm=({color:e,onChange:t,label:n,type:r,elements:a,palette:o,updateData:d,children:c,onEyeDropperToggle:h,onEscape:m})=>{let[u]=l.useState(()=>"canvasBackground"===r?[]:o9(a,r,o)),[p,g]=(0,i.KO)(de),f=o5({color:e,palette:o});(0,l.useEffect)(()=>{if(!p){let t=o7({color:e,palette:o});g(t&&!u.includes(e)?"hex":t?"custom":f?.shade!=null?"shades":"baseColors")}},[p,e,o,g,f,u]);let[x,y]=(0,l.useState)(f?.shade??("elementBackground"===r?R:_));(0,l.useEffect)(()=>{f?.shade!=null&&y(f.shade);let e=e=>{e.key===aO.ALT&&h(!1)};return document.addEventListener("keyup",e,{capture:!0}),()=>{document.removeEventListener("keyup",e,{capture:!0})}},[f,h]);let b=l.useRef(null);return(0,s.jsx)("div",{role:"dialog","aria-modal":"true","aria-label":C("labels.colorPicker"),children:(0,s.jsxs)("div",{ref:b,onKeyDown:n=>{dc({event:n,activeColorPickerSection:p,palette:o,color:e,onChange:t,onEyeDropperToggle:h,customColors:u,setActiveColorPickerSection:g,updateData:d,activeShade:x,onEscape:m})&&(n.preventDefault(),n.stopPropagation())},className:"color-picker-content",tabIndex:-1,children:[!!u.length&&(0,s.jsxs)("div",{children:[(0,s.jsx)(dh,{children:C("colorPicker.mostUsedCustomColors")}),(0,s.jsx)(da,{colors:u,color:e,label:C("colorPicker.mostUsedCustomColors"),onChange:t})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(dh,{children:C("colorPicker.colors")}),(0,s.jsx)(dr,{color:e,label:n,palette:o,onChange:t,activeShade:x})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(dh,{children:C("colorPicker.shades")}),(0,s.jsx)(dl,{hex:e,onChange:t,palette:o})]}),c]})})}}),d8=tC(()=>{tM(),du=l.createContext(null),dp=()=>l.useContext(du)}),d7=tC(()=>{tM(),CJ(),d8(),dg=e=>{let[t,n]=(0,l.useState)(null),i=k4(),{theme:r}=dp(),{container:a}=k5();return(0,l.useLayoutEffect)(()=>{t&&(t.className="",t.classList.add("excalidraw",...e?.className?.split(/\s+/)||[]),t.classList.toggle("excalidraw--mobile",i.editor.isMobile),t.classList.toggle("theme--dark","dark"===r))},[t,r,i.editor.isMobile,e?.className]),(0,l.useLayoutEffect)(()=>{let t=e?.parentSelector?a?.querySelector(e.parentSelector):document.body;if(!t)return;let i=document.createElement("div");return t.appendChild(i),n(i),()=>{t.removeChild(i)}},[a,e?.parentSelector]),t}});function d9(e,t,n){(0,l.useEffect)(()=>{function i(i){if(!e.current)return;let l=n?.(i,e.current);if(!0!==l){if(!1===l)return t(i);e.current.contains(i.target)||!document.documentElement.contains(i.target)||i.target.closest("[data-radix-portal]")||i.target===document.documentElement&&"none"===document.body.style.pointerEvents||i.target.closest("[data-prevent-outside-click]")||t(i)}}return document.addEventListener("pointerdown",i),document.addEventListener("touchstart",i),()=>{document.removeEventListener("pointerdown",i),document.removeEventListener("touchstart",i)}},[e,t,n])}var ce,ct,cn,ci,cl,cr,ca,cs,co,cd,cc=tC(()=>{tM(),tR()}),ch=tC(()=>{tM(),ce=e=>{let t=(0,l.useRef)(e);return Object.assign(t.current,e),t.current}}),cm=tC(()=>{}),cu=tC(()=>{tM(),t_(),tR(),d8(),d7(),cc(),dO(),fK(),CJ(),ch(),cm(),ct=(0,i.cn)(null),cn=({onCancel:e,onChange:t,onSelect:n,colorPickerType:i})=>{let r=dg({className:"excalidraw-eye-dropper-backdrop",parentSelector:".excalidraw-eye-dropper-container"}),a=dp(),o=k8(),d=k3(),c=gV(o,a),h=ce({app:d,onCancel:e,onChange:t,onSelect:n,selectedElements:c}),{container:m}=k5();(0,l.useEffect)(()=>{let e=u.current;if(!e||!d.canvas||!r)return;let t=!1,n=d.canvas.getContext("2d"),l=({clientX:e,clientY:t})=>{let i=n.getImageData((e-a.offsetLeft)*window.devicePixelRatio,(t-a.offsetTop)*window.devicePixelRatio,1,1).data;return G(i[0],i[1],i[2])},s=({clientX:n,clientY:r,altKey:a})=>{e.style.top=`${r+20}px`,e.style.left=`${n+20}px`;let s=l({clientX:n,clientY:r});t&&h.onChange(i,s,h.selectedElements,{altKey:a}),e.style.background=s},o=()=>{h.onCancel()},c=(e,t)=>{h.onSelect(e,t)},p=e=>{t=!0,e.stopImmediatePropagation()},g=e=>{t=!1,m?.focus(),e.stopImmediatePropagation(),e.preventDefault(),c(l(e),e)},f=e=>{e.key===aO.ESCAPE&&(e.preventDefault(),e.stopImmediatePropagation(),o())};return r.tabIndex=-1,r.focus(),s({clientX:h.app.lastViewportPosition.x,clientY:h.app.lastViewportPosition.y,altKey:!1}),r.addEventListener("keydown",f),r.addEventListener("pointerdown",p),r.addEventListener("pointerup",g),window.addEventListener("pointermove",s,{passive:!0}),window.addEventListener("blur",o),()=>{t=!1,r.removeEventListener("keydown",f),r.removeEventListener("pointerdown",p),r.removeEventListener("pointerup",g),window.removeEventListener("pointermove",s),window.removeEventListener("blur",o)}},[h,d.canvas,r,i,m,a.offsetLeft,a.offsetTop]);let u=(0,l.useRef)(null);return d9(u,()=>{e()},e=>!!e.target.closest(".excalidraw-eye-dropper-trigger, .excalidraw-eye-dropper-backdrop")),r?(0,tc.createPortal)((0,s.jsx)("div",{ref:u,className:"excalidraw-eye-dropper-preview"}),r):null}}),cp=tC(()=>{tM(),cf(),dQ(),dN(),tj(),dO(),cu(),tL(),CJ(),df(),ci=({color:e,onChange:t,label:n,colorPickerType:r})=>{let a=k4(),[o,c]=(0,l.useState)(e),[h,m]=(0,i.KO)(de);(0,l.useEffect)(()=>{c(e)},[e]);let u=(0,l.useCallback)(e=>{let n=e.toLowerCase(),i=cr(n);i&&t(i),c(n)},[t]),g=(0,l.useRef)(null),f=(0,l.useRef)(null);(0,l.useEffect)(()=>{g.current&&g.current.focus()},[h]);let[x,y]=(0,i.KO)(ct,p);return(0,l.useEffect)(()=>()=>{y(null)},[y]),(0,s.jsxs)("div",{className:"color-picker__input-label",children:[(0,s.jsx)("div",{className:"color-picker__input-hash",children:"#"}),(0,s.jsx)("input",{ref:"hex"===h?g:void 0,style:{border:0,padding:0},spellCheck:!1,className:"color-picker-input","aria-label":n,onChange:e=>{u(e.target.value)},value:(o||"").replace(/^#/,""),onBlur:()=>{c(e)},tabIndex:-1,onFocus:()=>m("hex"),onKeyDown:e=>{e.key!==aO.TAB&&(e.key===aO.ESCAPE&&f.current?.focus(),e.stopPropagation())}}),!a.editor.isMobile&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{style:{width:"1px",height:"1.25rem",backgroundColor:"var(--default-border-color)"}}),(0,s.jsx)("div",{ref:f,className:(0,d.Z)("excalidraw-eye-dropper-trigger",{selected:x}),onClick:()=>y(e=>e?null:{keepOpenOnAlt:!1,onSelect:e=>t(e),colorPickerType:r}),title:`${C("labels.eyeDropper")} \u2014 ${aO.I.toLocaleUpperCase()} or ${t0("Alt")} `,children:aS})]})]})}}),cg=tC(()=>{}),cf=tC(()=>{tM(),df(),dJ(),d5(),dQ(),CJ(),t_(),d4(),tL(),tj(),cp(),cu(),cg(),cl=e=>{let t=new Option().style;return t.color=e,!!t.color},cr=e=>nt(e)?e:cl(`#${e}`)?`#${e}`:cl(e)?e:null,ca=({type:e,color:t,onChange:n,label:r,elements:a,palette:o=z,updateData:d})=>{let[,c]=(0,i.KO)(de),[h,m]=(0,i.KO)(ct,p),{container:u}=k5(),g=k4(),f=(0,s.jsxs)("div",{children:[(0,s.jsx)(dh,{children:C("colorPicker.hexCode")}),(0,s.jsx)(ci,{color:t,label:r,onChange:e=>{n(e)},colorPickerType:e})]}),x=(0,l.useRef)(null),y=()=>{x.current?.querySelector(".color-picker-content")?.focus()};return(0,s.jsx)(th.h_,{container:u,children:(0,s.jsxs)(th.VY,{ref:x,className:"focus-visible-none","data-prevent-outside-click":!0,onFocusOutside:e=>{y(),e.preventDefault()},onPointerDownOutside:e=>{h&&e.preventDefault()},onCloseAutoFocus:e=>{e.stopPropagation(),e.preventDefault(),u&&!tZ(document.activeElement)&&u.focus(),d({openPopup:null}),c(null)},side:g.editor.isMobile&&!g.viewport.isLandscape?"bottom":"right",align:g.editor.isMobile&&!g.viewport.isLandscape?"center":"start",alignOffset:-16,sideOffset:20,style:{zIndex:"var(--zIndex-layerUI)",backgroundColor:"var(--popup-bg-color)",maxWidth:"208px",maxHeight:window.innerHeight,padding:"12px",borderRadius:"8px",boxSizing:"border-box",overflowY:"auto",boxShadow:"0px 7px 14px rgba(0, 0, 0, 0.05), 0px 0px 3.12708px rgba(0, 0, 0, 0.0798), 0px 0px 0.931014px rgba(0, 0, 0, 0.1702)"},children:[o?(0,s.jsx)(dm,{palette:o,color:t,onChange:e=>{n(e)},onEyeDropperToggle:t=>{m(i=>t?((i=i||{keepOpenOnAlt:!0,onSelect:n,colorPickerType:e}).keepOpenOnAlt=!0,i):!1===t||i?null:{keepOpenOnAlt:!1,onSelect:n,colorPickerType:e})},onEscape:e=>{h?m(null):tW(e.target)?y():d({openPopup:null})},label:r,type:e,elements:a,updateData:d,children:f}):f,(0,s.jsx)(th.Eh,{width:20,height:10,style:{fill:"var(--popup-bg-color)",filter:"drop-shadow(rgba(0, 0, 0, 0.05) 0px 3px 2px)"}})]})})},cs=({label:e,color:t,type:n})=>(0,s.jsx)(th.xz,{type:"button",className:(0,d.Z)("color-picker__button active-color",{"is-transparent":"transparent"===t||!t}),"aria-label":e,style:t?{"--swatch-color":t}:void 0,title:"elementStroke"===n?C("labels.showStroke"):C("labels.showBackground"),children:(0,s.jsx)("div",{className:"color-picker__button-outline"})}),co=({type:e,color:t,onChange:n,label:i,elements:l,palette:r=z,topPicks:a,updateData:o,appState:d})=>(0,s.jsx)("div",{children:(0,s.jsxs)("div",{role:"dialog","aria-modal":"true",className:"color-picker-container",children:[(0,s.jsx)(o4,{activeColor:t,onChange:n,type:e,topPicks:a}),(0,s.jsx)("div",{style:{width:1,height:"100%",backgroundColor:"var(--default-border-color)",margin:"0 auto"}}),(0,s.jsxs)(th.fC,{open:d.openPopup===e,onOpenChange:t=>{o({openPopup:t?e:null})},children:[(0,s.jsx)(cs,{color:t,label:i,type:e}),d.openPopup===e&&(0,s.jsx)(ca,{type:e,color:t,onChange:n,label:i,elements:l,palette:r,updateData:o})]})]})})}),cx=tC(()=>{}),cy=tC(()=>{tM(),cx(),df(),dO(),cd=({children:e,left:t,top:n,onCloseRequest:i,fitInViewport:r=!1,offsetLeft:a=0,offsetTop:o=0,viewportWidth:d=window.innerWidth,viewportHeight:c=window.innerHeight})=>{let h=(0,l.useRef)(null);(0,l.useEffect)(()=>{let e=h.current;if(!e)return;e.contains(document.activeElement)||e.focus();let t=t=>{if(t.key===aO.TAB){let n=nu(e),{activeElement:i}=document,l=n.findIndex(e=>e===i);i===e?(t.shiftKey?n[n.length-1]?.focus():n[0].focus(),t.preventDefault(),t.stopImmediatePropagation()):0===l&&t.shiftKey?(n[n.length-1]?.focus(),t.preventDefault(),t.stopImmediatePropagation()):l!==n.length-1||t.shiftKey||(n[0]?.focus(),t.preventDefault(),t.stopImmediatePropagation())}};return e.addEventListener("keydown",t),()=>e.removeEventListener("keydown",t)},[]);let m=(0,l.useRef)(null);return(0,l.useLayoutEffect)(()=>{if(r&&h.current&&null!=n&&null!=t){let e=h.current,{width:i,height:l}=e.getBoundingClientRect();(m.current?.top!==n||m.current?.left!==t)&&(m.current={top:n,left:t},i>=d?(e.style.width=`${d}px`,e.style.left="0px",e.style.overflowX="scroll"):t+i-a>d?e.style.left=`${d-i-10}px`:e.style.left=`${t}px`,l>=c?(e.style.height=`${c-20}px`,e.style.top="10px",e.style.overflowY="scroll"):n+l-o>c?e.style.top=`${c-l}px`:e.style.top=`${n}px`)}},[n,t,r,d,c,a,o]),(0,l.useEffect)(()=>{if(i){let e=e=>{h.current?.contains(e.target)||(0,tc.unstable_batchedUpdates)(()=>i(e))};return document.addEventListener("pointerdown",e,!1),()=>document.removeEventListener("pointerdown",e,!1)}},[i]),(0,s.jsx)("div",{className:"popover",ref:h,tabIndex:-1,children:e})}}),cb=tC(()=>{});function cv({options:e,value:t,label:n,onChange:i,onClose:r}){let a=l.useRef(),o=l.useRef(),c=l.useRef(null);return l.useEffect(()=>{o.current?o.current.focus():c.current&&c.current.focus()},[]),(0,s.jsx)("div",{className:"picker",role:"dialog","aria-modal":"true","aria-label":n,onKeyDown:t=>{let n=e.find(e=>e.keyBinding===t.key.toLowerCase());if(!(t.metaKey||t.altKey||t.ctrlKey)&&n){let i=e.indexOf(n);c.current.children[i].focus(),t.preventDefault()}else if(t.key===aO.TAB)setTimeout(()=>{o.current!==document.activeElement&&r()},0);else if(az(t.key)){let{activeElement:n}=document,i=S().rtl,l=Array.prototype.indexOf.call(c.current.children,n);if(-1!==l){let n=e.length,r=l;switch(t.key){case i?aO.ARROW_LEFT:aO.ARROW_RIGHT:case aO.ARROW_DOWN:r=(l+1)%n;break;case i?aO.ARROW_RIGHT:aO.ARROW_LEFT:case aO.ARROW_UP:r=(n+l-1)%n}c.current.children[r].focus()}t.preventDefault()}else(t.key===aO.ESCAPE||t.key===aO.ENTER)&&(t.preventDefault(),r());t.nativeEvent.stopImmediatePropagation(),t.stopPropagation()},children:(0,s.jsx)("div",{className:"picker-content",ref:c,children:e.map((e,n)=>(0,s.jsxs)("button",{className:(0,d.Z)("picker-option",{active:t===e.value}),onClick:t=>{t.currentTarget.focus(),i(e.value)},title:`${e.text} ${e.keyBinding&&`\u2014 ${e.keyBinding.toUpperCase()}`}`,"aria-label":e.text||"none","aria-keyshortcuts":e.keyBinding||void 0,ref:i=>{i&&0===n&&(a.current=i),i&&e.value===t&&(o.current=i)},onFocus:()=>{i(e.value)},children:[e.icon,e.keyBinding&&(0,s.jsx)("span",{className:"picker-keybinding",children:e.keyBinding})]},e.text))})})}function cw({value:e,label:t,options:n,onChange:i,group:r=""}){let[a,o]=l.useState(!1),d=l.useRef(null),c=S().rtl;return(0,s.jsxs)("div",{children:[(0,s.jsx)("button",{name:r,className:a?"active":"","aria-label":t,onClick:()=>o(!a),ref:d,children:n.find(t=>t.value===e)?.icon}),(0,s.jsx)(l.Suspense,{fallback:"",children:a?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(cd,{onCloseRequest:e=>e.target!==d.current&&o(!1),...c?{right:5.5}:{left:-5.5},children:(0,s.jsx)(cv,{options:n.filter(e=>!1!==e.showInPicker),value:e,label:t,onChange:i,onClose:()=>{o(!1),d.current?.focus()}})}),(0,s.jsx)("div",{className:"picker-triangle"})]}):null})]})}var cE,cS,ck,cC,cI,cM,cj,cT,cL,cD,cA,cP,c_,cR,cN,cO,cz,cH,cB,cF,c$,cZ,cW,cU,cG,cV,cK,cY,cX,cq,cJ,cQ,c1,c0,c2,c3,c6,c4,c5,c8,c7,c9,he,ht,hn,hi,hl,hr,ha,hs,ho,hd,hc,hh,hm,hu,hp,hg,hf,hx,hy,hb,hv,hw,hE,hS,hk,hC,hI,hM,hj,hT,hL,hD,hA,hP,h_,hR,hN,hO,hz,hH,hB,hF,h$,hZ,hW,hU,hG,hV,hK,hY,hX,hq,hJ,hQ,h1,h0,h2,h3,h6,h4,h5,h8=tC(()=>{tM(),cy(),cb(),dO(),tL()}),h7=tC(()=>{tM(),dx(),cE=e=>"rectangle"===e||"iframe"===e||"embeddable"===e||"ellipse"===e||"diamond"===e||"line"===e||"freedraw"===e,cS=e=>"image"!==e&&"frame"!==e&&"magicframe"!==e,ck=e=>"rectangle"===e||"iframe"===e||"embeddable"===e||"ellipse"===e||"diamond"===e||"freedraw"===e||"arrow"===e||"line"===e,cC=e=>"rectangle"===e||"iframe"===e||"embeddable"===e||"ellipse"===e||"diamond"===e||"arrow"===e||"line"===e,cI=e=>"rectangle"===e||"iframe"===e||"embeddable"===e||"arrow"===e||"line"===e||"diamond"===e,cM=e=>"arrow"===e,cj=(e,t)=>{let n=null;for(let i=e.length-1;i>=0;--i){let l=e[i];if(!l.isDeleted&&t(l)){n=l;break}}return n},cT=(e,t)=>{let n=[];return e.filter(e=>!!(!e.isDeleted&&t(e))&&(!nj(e)||(n.push(e),!1))).concat(n)}}),h9=tC(()=>{tM(),t_(),d$(),dq(),cf(),h8(),dN(),tR(),fG(),fB(),ma(),dx(),tL(),dO(),dL(),fK(),h7(),df(),dj(),cL=(e,t,n,i=!1)=>{let l=na(gV(e,t,{includeBoundTextElement:i}));return e.map(e=>l.get(e.id)||e.id===t.editingElement?.id?n(e):e)},cD=function(e,t,n,i,l){let r=t.editingElement,a=fk(e),s=null;return r&&(s=n(r)),s||(s=gU(a,t)?gG(!0===i?a:a.filter(e=>i(e)),t,n)??("function"==typeof l?l(!0):l):"function"==typeof l?l(!1):l),s},cA=(e,t)=>nU(t)?t:gQ(t,{x:"left"===e.textAlign?e.x:e.x+(e.width-t.width)/("center"===e.textAlign?2:1),y:e.y+(e.height-t.height)/2},!1),cP=(e,t,n,i)=>{let l=new Set;return{elements:cL(e,t,e=>{if(nL(e)){let t=n(e);l.add(t);let i=g1(e,{fontSize:t});return hC(i,hG(e)),i=cA(e,i)}return e},!0),appState:{...t,currentItemFontSize:1===l.size?[...l][0]:i??t.currentItemFontSize},commitToHistory:!0}},iY({name:"changeStrokeColor",trackEvent:!1,perform:(e,t,n)=>({...n.currentItemStrokeColor&&{elements:cL(e,t,e=>cS(e.type)?g1(e,{strokeColor:n.currentItemStrokeColor}):e,!0)},appState:{...t,...n},commitToHistory:!!n.currentItemStrokeColor}),PanelComponent:({elements:e,appState:t,updateData:n,appProps:i})=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h3",{"aria-hidden":"true",children:C("labels.stroke")}),(0,s.jsx)(co,{topPicks:B,palette:Z,type:"elementStroke",label:C("labels.stroke"),color:cD(e,t,e=>e.strokeColor,!0,t.currentItemStrokeColor),onChange:e=>n({currentItemStrokeColor:e}),elements:e,appState:t,updateData:n})]})}),iY({name:"changeBackgroundColor",trackEvent:!1,perform:(e,t,n)=>({...n.currentItemBackgroundColor&&{elements:cL(e,t,e=>g1(e,{backgroundColor:n.currentItemBackgroundColor}))},appState:{...t,...n},commitToHistory:!!n.currentItemBackgroundColor}),PanelComponent:({elements:e,appState:t,updateData:n,appProps:i})=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h3",{"aria-hidden":"true",children:C("labels.background")}),(0,s.jsx)(co,{topPicks:F,palette:W,type:"elementBackground",label:C("labels.background"),color:cD(e,t,e=>e.backgroundColor,!0,t.currentItemBackgroundColor),onChange:e=>n({currentItemBackgroundColor:e}),elements:e,appState:t,updateData:n})]})}),iY({name:"changeFillStyle",trackEvent:!1,perform:(e,t,n,i)=>(aX("element","changeFillStyle",`${n} (${i.device.editor.isMobile?"mobile":"desktop"})`),{elements:cL(e,t,e=>g1(e,{fillStyle:n})),appState:{...t,currentItemFillStyle:n},commitToHistory:!0}),PanelComponent:({elements:e,appState:t,updateData:n})=>{let i=gV(e,t),l=i.length>0&&i.every(e=>"zigzag"===e.fillStyle);return(0,s.jsxs)("fieldset",{children:[(0,s.jsx)("legend",{children:C("labels.fill")}),(0,s.jsx)(o6,{type:"button",options:[{value:"hachure",text:`${l?C("labels.zigzag"):C("labels.hachure")} (${t0("Alt-Click")})`,icon:l?rG:rV,active:!!l||void 0,testId:"fill-hachure"},{value:"cross-hatch",text:C("labels.crossHatch"),icon:rK,testId:"fill-cross-hatch"},{value:"solid",text:C("labels.solid"),icon:rY,testId:"fill-solid"}],value:cD(e,t,e=>e.fillStyle,e=>e.hasOwnProperty("fillStyle"),e=>e?null:t.currentItemFillStyle),onClick:(e,t)=>{n(t.altKey&&"hachure"===e&&i.every(e=>"hachure"===e.fillStyle)?"zigzag":e)}})]})}}),iY({name:"changeStrokeWidth",trackEvent:!1,perform:(e,t,n)=>({elements:cL(e,t,e=>g1(e,{strokeWidth:n})),appState:{...t,currentItemStrokeWidth:n},commitToHistory:!0}),PanelComponent:({elements:e,appState:t,updateData:n})=>(0,s.jsxs)("fieldset",{children:[(0,s.jsx)("legend",{children:C("labels.strokeWidth")}),(0,s.jsx)(o6,{group:"stroke-width",options:[{value:e9.thin,text:C("labels.thin"),icon:rX,testId:"strokeWidth-thin"},{value:e9.bold,text:C("labels.bold"),icon:rq,testId:"strokeWidth-bold"},{value:e9.extraBold,text:C("labels.extraBold"),icon:rJ,testId:"strokeWidth-extraBold"}],value:cD(e,t,e=>e.strokeWidth,e=>e.hasOwnProperty("strokeWidth"),e=>e?null:t.currentItemStrokeWidth),onChange:e=>n(e)})]})}),iY({name:"changeSloppiness",trackEvent:!1,perform:(e,t,n)=>({elements:cL(e,t,e=>g1(e,{seed:i7(),roughness:n})),appState:{...t,currentItemRoughness:n},commitToHistory:!0}),PanelComponent:({elements:e,appState:t,updateData:n})=>(0,s.jsxs)("fieldset",{children:[(0,s.jsx)("legend",{children:C("labels.sloppiness")}),(0,s.jsx)(o6,{group:"sloppiness",options:[{value:0,text:C("labels.architect"),icon:r0},{value:1,text:C("labels.artist"),icon:r2},{value:2,text:C("labels.cartoonist"),icon:r3}],value:cD(e,t,e=>e.roughness,e=>e.hasOwnProperty("roughness"),e=>e?null:t.currentItemRoughness),onChange:e=>n(e)})]})}),iY({name:"changeStrokeStyle",trackEvent:!1,perform:(e,t,n)=>({elements:cL(e,t,e=>g1(e,{strokeStyle:n})),appState:{...t,currentItemStrokeStyle:n},commitToHistory:!0}),PanelComponent:({elements:e,appState:t,updateData:n})=>(0,s.jsxs)("fieldset",{children:[(0,s.jsx)("legend",{children:C("labels.strokeStyle")}),(0,s.jsx)(o6,{group:"strokeStyle",options:[{value:"solid",text:C("labels.strokeStyle_solid"),icon:rX},{value:"dashed",text:C("labels.strokeStyle_dashed"),icon:rQ},{value:"dotted",text:C("labels.strokeStyle_dotted"),icon:r1}],value:cD(e,t,e=>e.strokeStyle,e=>e.hasOwnProperty("strokeStyle"),e=>e?null:t.currentItemStrokeStyle),onChange:e=>n(e)})]})}),iY({name:"changeOpacity",trackEvent:!1,perform:(e,t,n)=>({elements:cL(e,t,e=>g1(e,{opacity:n}),!0),appState:{...t,currentItemOpacity:n},commitToHistory:!0}),PanelComponent:({elements:e,appState:t,updateData:n})=>(0,s.jsxs)("label",{className:"control-label",children:[C("labels.opacity"),(0,s.jsx)("input",{type:"range",min:"0",max:"100",step:"10",onChange:e=>n(+e.target.value),value:cD(e,t,e=>e.opacity,!0,t.currentItemOpacity)??void 0})]})}),iY({name:"changeFontSize",trackEvent:!1,perform:(e,t,n)=>cP(e,t,()=>n,n),PanelComponent:({elements:e,appState:t,updateData:n})=>(0,s.jsxs)("fieldset",{children:[(0,s.jsx)("legend",{children:C("labels.fontSize")}),(0,s.jsx)(o6,{group:"font-size",options:[{value:16,text:C("labels.small"),icon:ar,testId:"fontSize-small"},{value:20,text:C("labels.medium"),icon:aa,testId:"fontSize-medium"},{value:28,text:C("labels.large"),icon:as,testId:"fontSize-large"},{value:36,text:C("labels.veryLarge"),icon:ao,testId:"fontSize-veryLarge"}],value:cD(e,t,e=>{if(nL(e))return e.fontSize;let t=hU(e);return t?t.fontSize:null},e=>nL(e)||null!==hU(e),e=>e?null:t.currentItemFontSize||ey),onChange:e=>n(e)})]})}),c_=iY({name:"decreaseFontSize",trackEvent:!1,perform:(e,t,n)=>cP(e,t,e=>Math.round(1/1.1*e.fontSize)),keyTest:e=>e[aO.CTRL_OR_CMD]&&e.shiftKey&&(e.key===aO.CHEVRON_LEFT||e.key===aO.COMMA)}),cR=iY({name:"increaseFontSize",trackEvent:!1,perform:(e,t,n)=>cP(e,t,e=>Math.round(1.1*e.fontSize)),keyTest:e=>e[aO.CTRL_OR_CMD]&&e.shiftKey&&(e.key===aO.CHEVRON_RIGHT||e.key===aO.PERIOD)}),iY({name:"changeFontFamily",trackEvent:!1,perform:(e,t,n)=>({elements:cL(e,t,e=>{if(nL(e)){let t=g1(e,{fontFamily:n,lineHeight:h5(n)});return hC(t,hG(e)),t}return e},!0),appState:{...t,currentItemFontFamily:n},commitToHistory:!0}),PanelComponent:({elements:e,appState:t,updateData:n})=>{let i=[{value:em.Virgil,text:C("labels.handDrawn"),icon:l9,testId:"font-family-virgil"},{value:em.Helvetica,text:C("labels.normal"),icon:ad,testId:"font-family-normal"},{value:em.Cascadia,text:C("labels.code"),icon:ac,testId:"font-family-code"}];return(0,s.jsxs)("fieldset",{children:[(0,s.jsx)("legend",{children:C("labels.fontFamily")}),(0,s.jsx)(o6,{group:"font-family",options:i,value:cD(e,t,e=>{if(nL(e))return e.fontFamily;let t=hU(e);return t?t.fontFamily:null},e=>nL(e)||null!==hU(e),e=>e?null:t.currentItemFontFamily||eb),onChange:e=>n(e)})]})}}),iY({name:"changeTextAlign",trackEvent:!1,perform:(e,t,n)=>({elements:cL(e,t,e=>{if(nL(e)){let t=g1(e,{textAlign:n});return hC(t,hG(e)),t}return e},!0),appState:{...t,currentItemTextAlign:n},commitToHistory:!0}),PanelComponent:({elements:e,appState:t,updateData:n})=>(0,s.jsxs)("fieldset",{children:[(0,s.jsx)("legend",{children:C("labels.textAlign")}),(0,s.jsx)(o6,{group:"text-align",options:[{value:"left",text:C("labels.left"),icon:ah,testId:"align-left"},{value:"center",text:C("labels.center"),icon:am,testId:"align-horizontal-center"},{value:"right",text:C("labels.right"),icon:au,testId:"align-right"}],value:cD(e,t,e=>{if(nL(e))return e.textAlign;let t=hU(e);return t?t.textAlign:null},e=>nL(e)||null!==hU(e),e=>e?null:t.currentItemTextAlign),onChange:e=>n(e)})]})}),iY({name:"changeVerticalAlign",trackEvent:{category:"element"},perform:(e,t,n)=>({elements:cL(e,t,e=>{if(nL(e)){let t=g1(e,{verticalAlign:n});return hC(t,hG(e)),t}return e},!0),appState:{...t},commitToHistory:!0}),PanelComponent:({elements:e,appState:t,updateData:n})=>(0,s.jsx)("fieldset",{children:(0,s.jsx)(o6,{group:"text-align",options:[{value:e0.TOP,text:C("labels.alignTop"),icon:(0,s.jsx)(ap,{theme:t.theme}),testId:"align-top"},{value:e0.MIDDLE,text:C("labels.centerVertically"),icon:(0,s.jsx)(af,{theme:t.theme}),testId:"align-middle"},{value:e0.BOTTOM,text:C("labels.alignBottom"),icon:(0,s.jsx)(ag,{theme:t.theme}),testId:"align-bottom"}],value:cD(e,t,e=>{if(nL(e)&&e.containerId)return e.verticalAlign;let t=hU(e);return t?t.verticalAlign:null},e=>nL(e)||null!==hU(e),e=>e?null:e0.MIDDLE),onChange:e=>n(e)})})}),iY({name:"changeRoundness",trackEvent:!1,perform:(e,t,n)=>({elements:cL(e,t,e=>g1(e,{roundness:"round"===n?{type:nG(e.type)?e5.ADAPTIVE_RADIUS:e5.PROPORTIONAL_RADIUS}:null})),appState:{...t,currentItemRoundness:n},commitToHistory:!0}),PanelComponent:({elements:e,appState:t,updateData:n})=>{let i=gK(fk(e),t).some(e=>e.roundness?.type===e5.LEGACY);return(0,s.jsxs)("fieldset",{children:[(0,s.jsx)("legend",{children:C("labels.edges")}),(0,s.jsx)(o6,{group:"edges",options:[{value:"sharp",text:C("labels.sharp"),icon:r6},{value:"round",text:C("labels.round"),icon:r4}],value:cD(e,t,e=>i?null:e.roundness?"round":"sharp",e=>e.hasOwnProperty("roundness"),e=>e?null:t.currentItemRoundness),onChange:e=>n(e)})]})}}),cN=e=>[{value:null,text:C("labels.arrowhead_none"),keyBinding:"q",icon:r5},{value:"arrow",text:C("labels.arrowhead_arrow"),keyBinding:"w",icon:(0,s.jsx)(r8,{flip:e})},{value:"bar",text:C("labels.arrowhead_bar"),keyBinding:"e",icon:(0,s.jsx)(ae,{flip:e})},{value:"dot",text:C("labels.arrowhead_circle"),keyBinding:null,icon:(0,s.jsx)(r7,{flip:e}),showInPicker:!1},{value:"circle",text:C("labels.arrowhead_circle"),keyBinding:"r",icon:(0,s.jsx)(r7,{flip:e}),showInPicker:!1},{value:"circle_outline",text:C("labels.arrowhead_circle_outline"),keyBinding:null,icon:(0,s.jsx)(r9,{flip:e}),showInPicker:!1},{value:"triangle",text:C("labels.arrowhead_triangle"),icon:(0,s.jsx)(at,{flip:e}),keyBinding:"t"},{value:"triangle_outline",text:C("labels.arrowhead_triangle_outline"),icon:(0,s.jsx)(an,{flip:e}),keyBinding:null,showInPicker:!1},{value:"diamond",text:C("labels.arrowhead_diamond"),icon:(0,s.jsx)(ai,{flip:e}),keyBinding:null,showInPicker:!1},{value:"diamond_outline",text:C("labels.arrowhead_diamond_outline"),icon:(0,s.jsx)(al,{flip:e}),keyBinding:null,showInPicker:!1}],iY({name:"changeArrowhead",trackEvent:!1,perform:(e,t,n)=>({elements:cL(e,t,e=>{if(nN(e)){let{position:t,type:i}=n;if("start"===t)return g1(e,{startArrowhead:i});if("end"===t)return g1(e,{endArrowhead:i})}return e}),appState:{...t,["start"===n.position?"currentItemStartArrowhead":"currentItemEndArrowhead"]:n.type},commitToHistory:!0}),PanelComponent:({elements:e,appState:t,updateData:n})=>{let i=S().rtl;return(0,s.jsxs)("fieldset",{children:[(0,s.jsx)("legend",{children:C("labels.arrowheads")}),(0,s.jsxs)("div",{className:"iconSelectList buttonList",children:[(0,s.jsx)(cw,{label:"arrowhead_start",options:cN(!i),value:cD(e,t,e=>nN(e)&&cM(e.type)?e.startArrowhead:t.currentItemStartArrowhead,!0,t.currentItemStartArrowhead),onChange:e=>n({position:"start",type:e})}),(0,s.jsx)(cw,{label:"arrowhead_end",group:"arrowheads",options:cN(!!i),value:cD(e,t,e=>nN(e)&&cM(e.type)?e.endArrowhead:t.currentItemEndArrowhead,!0,t.currentItemEndArrowhead),onChange:e=>n({position:"end",type:e})})]})]})}})}),me=tC(()=>{tM(),fG(),df(),cO=(e,t)=>{let[n,i,l,r]=t,{x:a,y:s}=t3({sceneX:n,sceneY:i},e),{x:o,y:d}=t3({sceneX:l,sceneY:r},e);return o-a>e.width||d-s>e.height},cz=({scenePoint:e,viewportDimensions:t,zoom:n})=>({scrollX:t.width/2/n.value-e.x,scrollY:t.height/2/n.value-e.y}),cH=(e,t)=>{if(!(e=fS(e)).length)return{scrollX:0,scrollY:0};let[n,i,l,r]=m6(e);return cO(t,[n,i,l,r])&&([n,i,l,r]=m7(e,t2({clientX:t.scrollX,clientY:t.scrollY},t))),cz({scenePoint:{x:(n+l)/2,y:(i+r)/2},viewportDimensions:{width:t.width,height:t.height},zoom:t.zoom})}}),mt=tC(()=>{tM(),tR(),cB=e=>Math.max(e_,Math.min(e,30)),cF=({viewportX:e,viewportY:t,nextZoom:n},i)=>{let l=e-i.offsetLeft,r=t-i.offsetTop,a=i.zoom.value;return{scrollX:i.scrollX+(l-l/a)+-(l-l/n),scrollY:i.scrollY+(r-r/a)+-(r-r/n),zoom:{value:n}}}}),mn=tC(()=>{tM(),cf(),dN(),dR(),tR(),fG(),tL(),dO(),fK(),me(),mt(),df(),dj(),dH(),fB(),dy(),t_(),dT(),iY({name:"changeViewBackgroundColor",trackEvent:!1,predicate:(e,t,n,i)=>!!i.props.UIOptions.canvasActions.changeViewBackgroundColor&&!t.viewModeEnabled,perform:(e,t,n)=>({appState:{...t,...n},commitToHistory:!!n.viewBackgroundColor}),PanelComponent:({elements:e,appState:t,updateData:n,appProps:i})=>(0,s.jsx)(co,{palette:null,topPicks:$,label:C("labels.canvasBackground"),type:"canvasBackground",color:t.viewBackgroundColor,onChange:e=>n({viewBackgroundColor:e}),"data-testid":"canvas-background-picker",elements:e,appState:t,updateData:n})}),c$=iY({name:"clearCanvas",trackEvent:{category:"canvas"},predicate:(e,t,n,i)=>!!i.props.UIOptions.canvasActions.clearCanvas&&!t.viewModeEnabled,perform:(e,t,n,i)=>(i.imageCache.clear(),{elements:e.map(e=>g1(e,{isDeleted:!0})),appState:{...nq(),files:{},theme:t.theme,penMode:t.penMode,penDetected:t.penDetected,exportBackground:t.exportBackground,exportEmbedScene:t.exportEmbedScene,gridSize:t.gridSize,showStats:t.showStats,pasteDialog:t.pasteDialog,activeTool:"image"===t.activeTool.type?{...t.activeTool,type:"selection"}:t.activeTool},commitToHistory:!0})}),cZ=iY({name:"zoomIn",viewMode:!0,trackEvent:{category:"canvas"},perform:(e,t,n,i)=>({appState:{...t,...cF({viewportX:t.width/2+t.offsetLeft,viewportY:t.height/2+t.offsetTop,nextZoom:cB(t.zoom.value+eP)},t),userToFollow:null},commitToHistory:!1}),PanelComponent:({updateData:e})=>(0,s.jsx)(lF,{type:"button",className:"zoom-in-button zoom-button",icon:ri,title:`${C("buttons.zoomIn")} \u2014 ${t0("CtrlOrCmd++")}`,"aria-label":C("buttons.zoomIn"),onClick:()=>{e(null)}}),keyTest:e=>(e.code===aN.EQUAL||e.code===aN.NUM_ADD)&&(e[aO.CTRL_OR_CMD]||e.shiftKey)}),cW=iY({name:"zoomOut",viewMode:!0,trackEvent:{category:"canvas"},perform:(e,t,n,i)=>({appState:{...t,...cF({viewportX:t.width/2+t.offsetLeft,viewportY:t.height/2+t.offsetTop,nextZoom:cB(t.zoom.value-eP)},t),userToFollow:null},commitToHistory:!1}),PanelComponent:({updateData:e})=>(0,s.jsx)(lF,{type:"button",className:"zoom-out-button zoom-button",icon:rl,title:`${C("buttons.zoomOut")} \u2014 ${t0("CtrlOrCmd+-")}`,"aria-label":C("buttons.zoomOut"),onClick:()=>{e(null)}}),keyTest:e=>(e.code===aN.MINUS||e.code===aN.NUM_SUBTRACT)&&(e[aO.CTRL_OR_CMD]||e.shiftKey)}),iY({name:"resetZoom",viewMode:!0,trackEvent:{category:"canvas"},perform:(e,t,n,i)=>({appState:{...t,...cF({viewportX:t.width/2+t.offsetLeft,viewportY:t.height/2+t.offsetTop,nextZoom:cB(1)},t),userToFollow:null},commitToHistory:!1}),PanelComponent:({updateData:e,appState:t})=>(0,s.jsx)(aU,{label:C("buttons.resetZoom"),style:{height:"100%"},children:(0,s.jsxs)(lF,{type:"button",className:"reset-zoom-button zoom-button",title:C("buttons.resetZoom"),"aria-label":C("buttons.resetZoom"),onClick:()=>{e(null)},children:[(100*t.zoom.value).toFixed(0),"%"]})}),keyTest:e=>(e.code===aN.ZERO||e.code===aN.NUM_ZERO)&&(e[aO.CTRL_OR_CMD]||e.shiftKey)}),cU=(e,t)=>{let[n,i,l,r]=e;return Math.min(Math.max(Math.floor(Math.min(t.width/(l-n),t.height/(r-i))/eP)*eP,e_),1)},cG=({bounds:e,appState:t,fitToViewport:n=!1,viewportZoomFactor:i=.7})=>{let[l,r,a,s]=e,o=(l+a)/2,d=(r+s)/2,c,h,m;if(n){c=Math.min(Math.max(c=Math.min(t.width/(a-l),t.height/(s-r))*Math.min(1,Math.max(i,.1)),.1),30);let e=t.width;if(t.openSidebar){let n=document.querySelector(".sidebar")?.offsetWidth??0;e="rtl"===document.documentElement.getAttribute("dir")?t.width+n:t.width-n}h=e/2*(1/c)-o,m=t.height/2*(1/c)-d}else{c=cU(e,{width:t.width,height:t.height});let n=cz({scenePoint:{x:o,y:d},viewportDimensions:{width:t.width,height:t.height},zoom:{value:c}});h=n.scrollX,m=n.scrollY}return{appState:{...t,scrollX:h,scrollY:m,zoom:{value:c}},commitToHistory:!1}},cV=({targetElements:e,appState:t,fitToViewport:n,viewportZoomFactor:i})=>{let l=m6(fk(e));return cG({bounds:l,appState:t,fitToViewport:n,viewportZoomFactor:i})},iY({name:"zoomToFitSelectionInViewport",trackEvent:{category:"canvas"},perform:(e,t,n,i)=>{let l=i.scene.getSelectedElements(t);return cV({targetElements:l.length?l:e,appState:{...t,userToFollow:null},fitToViewport:!1})},keyTest:e=>e.code===aN.TWO&&e.shiftKey&&!e.altKey&&!e[aO.CTRL_OR_CMD]}),iY({name:"zoomToFitSelection",trackEvent:{category:"canvas"},perform:(e,t,n,i)=>{let l=i.scene.getSelectedElements(t);return cV({targetElements:l.length?l:e,appState:{...t,userToFollow:null},fitToViewport:!0})},keyTest:e=>e.code===aN.THREE&&e.shiftKey&&!e.altKey&&!e[aO.CTRL_OR_CMD]}),iY({name:"zoomToFit",viewMode:!0,trackEvent:{category:"canvas"},perform:(e,t)=>cV({targetElements:e,appState:{...t,userToFollow:null},fitToViewport:!1}),keyTest:e=>e.code===aN.ONE&&e.shiftKey&&!e.altKey&&!e[aO.CTRL_OR_CMD]}),cK=iY({name:"toggleTheme",viewMode:!0,trackEvent:{category:"canvas"},perform:(e,t,n)=>({appState:{...t,theme:n||(t.theme===ep.LIGHT?ep.DARK:ep.LIGHT)},commitToHistory:!1}),keyTest:e=>e.altKey&&e.shiftKey&&e.code===aN.D,predicate:(e,t,n,i)=>!!i.props.UIOptions.canvasActions.toggleTheme}),iY({name:"toggleEraserTool",trackEvent:{category:"toolbar"},perform:(e,t)=>{let n;return n=n2(t)?t1(t,{...t.activeTool.lastActiveTool||{type:"selection"},lastActiveToolBeforeEraser:null}):t1(t,{type:"eraser",lastActiveToolBeforeEraser:t.activeTool}),{appState:{...t,selectedElementIds:{},selectedGroupIds:{},activeEmbeddable:null,activeTool:n},commitToHistory:!0}},keyTest:e=>e.key===aO.E}),cY=iY({name:"toggleHandTool",trackEvent:{category:"toolbar"},perform:(e,t,n,i)=>{let l;return n3(t)?l=t1(t,{...t.activeTool.lastActiveTool||{type:"selection"},lastActiveToolBeforeEraser:null}):(l=t1(t,{type:"hand",lastActiveToolBeforeEraser:t.activeTool}),i0(i.interactiveCanvas,ea.GRAB)),{appState:{...t,selectedElementIds:{},selectedGroupIds:{},activeEmbeddable:null,activeTool:l},commitToHistory:!0}},keyTest:e=>!e.altKey&&!e[aO.CTRL_OR_CMD]&&e.key===aO.H})}),mi=tC(()=>{tM(),t_(),tR(),fG(),dL(),cX="NOT_SPREADSHEET",cq="VALID_SPREADSHEET",cJ=e=>{let t=/^([-+]?)[$€£¥₩]?([-+]?)([\d.,]+)[%]?$/.exec(e);return t?parseFloat(`${(t[1]||t[2])+t[3]}`.replace(/,/g,"")):null},cQ=(e,t)=>e.slice(1).every(e=>null!==cJ(e[t])),c1=e=>{let t=e[0].length;if(t>2)return{type:cX,reason:"More than 2 columns"};if(1===t){if(!cQ(e,0))return{type:cX,reason:"Value is not numeric"};let t=null===cJ(e[0][0]),n=(t?e.slice(1):e).map(e=>cJ(e[0]));return n.length<2?{type:cX,reason:"Less than two rows"}:{type:cq,spreadsheet:{title:t?e[0][0]:null,labels:null,values:n}}}let n=cQ(e,0),i=cQ(e,1);if(!n&&!i)return{type:cX,reason:"Value is not numeric"};let[l,r]=i?[0,1]:[1,0],a=null===cJ(e[0][r]),s=a?e.slice(1):e;return s.length<2?{type:cX,reason:"Less than 2 rows"}:{type:cq,spreadsheet:{title:a?e[0][r]:null,labels:s.map(e=>e[l]),values:s.map(e=>cJ(e[r]))}}},c0=e=>{let t=[];for(let n=0;n<e[0].length;n++){let i=[];for(let t=0;t<e.length;t++)i.push(e[t][n]);t.push(i)}return t},c2=e=>{let t=e.trim().split(`
`).map(e=>e.trim().split("	"));if(t.length&&2!==t[0].length&&(t=e.trim().split(`
`).map(e=>e.trim().split(","))),0===t.length)return{type:cX,reason:"No values"};let n=t[0].length;if(!t.every(e=>e.length===n))return{type:cX,reason:"All rows don't have same number of columns"};let i=c1(t);if(i.type!==cq){let e=c1(c0(t));if(e.type===cq)return e}return i},c3=U(P),c6={fillStyle:"hachure",fontFamily:eb,fontSize:ey,opacity:100,roughness:1,strokeColor:z.black,roundness:null,strokeStyle:"solid",strokeWidth:1,verticalAlign:e0.MIDDLE,locked:!1},c4=e=>({chartWidth:44*e.values.length+12,chartHeight:280}),c5=(e,t,n,i,l)=>e.labels?.map((e,r)=>ls({groupIds:[i],backgroundColor:l,...c6,text:e.length>8?`${e.slice(0,5)}...`:e,x:t+r*(32+12)+2*12,y:n+12/2,width:32,angle:5.87,fontSize:16,textAlign:"center",verticalAlign:"top"}))||[],c8=(e,t,n,i,l)=>{let r=ls({groupIds:[i],backgroundColor:l,...c6,x:t-12,y:n-12,text:"0",textAlign:"right"}),a=ls({groupIds:[i],backgroundColor:l,...c6,x:t-12,y:n-256-r.height/2,text:Math.max(...e.values).toLocaleString(),textAlign:"right"});return[r,a]},c7=(e,t,n,i,l)=>{let{chartWidth:r,chartHeight:a}=c4(e);return[lm({backgroundColor:l,groupIds:[i],...c6,type:"line",x:t,y:n,startArrowhead:null,endArrowhead:null,width:r,points:[[0,0],[r,0]]}),lm({backgroundColor:l,groupIds:[i],...c6,type:"line",x:t,y:n,startArrowhead:null,endArrowhead:null,height:a,points:[[0,0],[0,-a]]}),lm({backgroundColor:l,groupIds:[i],...c6,type:"line",x:t,y:n-256-12,startArrowhead:null,endArrowhead:null,strokeStyle:"dotted",width:r,opacity:50,points:[[0,0],[r,0]]})]},c9=(e,t,n,i,l,r)=>{let{chartWidth:a,chartHeight:s}=c4(e),o=e.title?ls({backgroundColor:l,groupIds:[i],...c6,text:e.title,x:t+a/2,y:n-256-24-ey,roundness:null,textAlign:"center"}):null,d=r?lt({backgroundColor:l,groupIds:[i],...c6,type:"rectangle",x:t,y:n-s,width:a,height:s,strokeColor:z.black,fillStyle:"solid",opacity:6}):null;return[...d?[d]:[],...o?[o]:[],...c5(e,t,n,i,l),...c8(e,t,n,i,l),...c7(e,t,n,i,l)]},he=(e,t,n)=>{let i=Math.max(...e.values),l=i9(),r=c3[Math.floor(Math.random()*c3.length)];return[...e.values.map((e,a)=>{let s=e/i*256;return lt({backgroundColor:r,groupIds:[l],...c6,type:"rectangle",x:t+44*a+12,y:n-s-12,width:32,height:s})}),...c9(e,t,n,l,r,u.DEV)]},ht=(e,t,n)=>{let i=Math.max(...e.values),l=i9(),r=c3[Math.floor(Math.random()*c3.length)],a=0,s=[];for(let t of e.values){let e=44*a,n=-(t/i*256);s.push([e,n]),a++}let o=Math.max(...s.map(e=>e[0])),d=Math.max(...s.map(e=>e[1])),c=Math.min(...s.map(e=>e[0])),h=Math.min(...s.map(e=>e[1])),m=lm({backgroundColor:r,groupIds:[l],...c6,type:"line",x:t+12+16,y:n-12,startArrowhead:null,endArrowhead:null,height:d-h,width:o-c,strokeWidth:2,points:s}),p=e.values.map((e,a)=>lt({backgroundColor:r,groupIds:[l],...c6,fillStyle:"solid",strokeWidth:2,type:"ellipse",x:t+(44*a+6)+16,y:n+(-(e/i*256)+6)-24,width:12,height:12})),g=e.values.map((e,a)=>{let s=e/i*256+6+12;return lm({backgroundColor:r,groupIds:[l],...c6,type:"line",x:t+(44*a+6)+16+6,y:n-s,startArrowhead:null,endArrowhead:null,height:s,strokeStyle:"dotted",opacity:50,points:[[0,0],[0,s]]})});return[...c9(e,t,n,l,r,u.DEV),m,...g,...p]},hn=(e,t,n,i)=>"line"===e?ht(t,n,i):he(t,n,i)}),ml=tC(()=>{tM(),mi(),tR(),dx(),dD(),fB(),fO(),df(),tL(),"clipboard"in navigator&&navigator.clipboard,hi="clipboard"in navigator&&"writeText"in navigator.clipboard,hl="clipboard"in navigator&&"write"in navigator.clipboard&&"ClipboardItem"in window&&"toBlob"in HTMLCanvasElement.prototype,hr=e=>!!([eM.excalidraw,eM.excalidrawClipboard,eM.excalidrawClipboardWithAPI].includes(e?.type)&&Array.isArray(e.elements)),ha=({types:e,files:t})=>{e||t||console.warn("createPasteEvent: no types or files provided");let n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});if(e)for(let[t,i]of Object.entries(e))try{if(n.clipboardData?.setData(t,i),n.clipboardData?.getData(t)!==i)throw Error(`Failed to set "${t}" as clipboardData item`)}catch(e){throw Error(e.message)}if(t){let e=-1;for(let i of t){e++;try{if(n.clipboardData?.items.add(i),n.clipboardData?.files[e]!==i)throw Error(`Failed to set file "${i.name}" as clipboardData item`)}catch(e){throw Error(e.message)}}}return n},hs=({elements:e,files:t})=>{let n=new Set(e.filter(e=>nP(e))),i=!1,l=e.reduce((e,n)=>(nC(n)&&(i=!0,t&&t[n.fileId]&&(e[n.fileId]=t[n.fileId])),e),{});return i&&!t&&console.warn("copyToClipboard: attempting to file element(s) without providing associated `files` object."),JSON.stringify({type:eM.excalidrawClipboard,elements:e.map(e=>{if(gA(e)&&!n.has(gA(e))){let t=lg(e);return gQ(t,{frameId:null}),t}return e}),files:t?l:void 0})},ho=async(e,t,n)=>{await hg(hs({elements:e,files:t}),n)},hd=e=>{let t=c2(e);return t.type===cq?{spreadsheet:t.spreadsheet}:null},hc=e=>{let t=e.clipboardData?.getData("text/html");if(!t)return null;try{let e=new DOMParser().parseFromString(t,"text/html"),n=function e(t){let n=[];for(let i of t.childNodes)if(3===i.nodeType){let e=i.textContent?.trim();e&&n.push({type:"text",value:e})}else if(i instanceof HTMLImageElement){let e=i.getAttribute("src");e&&e.startsWith("http")&&n.push({type:"imageUrl",value:e})}else n=n.concat(e(i));return n}(e.body);if(n.length)return{type:"mixedContent",value:n}}catch(e){console.error(`error in parseHTMLFromPaste: ${e.message}`)}return null},hh=async()=>{let e,t={};try{if(navigator.clipboard?.readText)return{"text/plain":await navigator.clipboard?.readText()}}catch(e){if(navigator.clipboard?.read)console.warn(`navigator.clipboard.readText() failed (${e.message}). Failling back to navigator.clipboard.read()`);else throw e}try{e=await navigator.clipboard?.read()}catch(e){if("DataError"===e.name)return console.warn(`navigator.clipboard.read() error, clipboard is probably empty: ${e.message}`),t;throw e}for(let n of e)for(let e of n.types)if(nb(ek,e))try{t[e]=await (await n.getType(e)).text()}catch(t){console.warn(`Cannot retrieve ${e} from clipboardItem: ${t.message}`)}return 0===Object.keys(t).length&&console.warn("No clipboard data found from clipboard.read()."),t},hm=async(e,t=!1)=>{try{let n=!t&&e&&hc(e);return n?n.value.every(e=>"text"===e.type)?{type:"text",value:e.clipboardData?.getData("text/plain")||n.value.map(e=>e.value).join(`
`).trim()}:n:{type:"text",value:(e.clipboardData?.getData("text/plain")||"").trim()}}catch{return{type:"text",value:""}}},hu=async(e,t=!1)=>{let n=await hm(e,t);if("mixedContent"===n.type)return{mixedContent:n.value};try{let e=!t&&hd(n.value);if(e)return e}catch(e){console.error(e)}try{let e=JSON.parse(n.value),i=e.type===eM.excalidrawClipboardWithAPI;if(hr(e))return{elements:e.elements,files:e.files,text:t?JSON.stringify(e.elements,null,2):void 0,programmaticAPI:i}}catch{}return{text:n.value}},hp=async e=>{try{await navigator.clipboard.write([new window.ClipboardItem({[eC.png]:e})])}catch(t){if(nm(e))await navigator.clipboard.write([new window.ClipboardItem({[eC.png]:await e})]);else throw t}},hg=async(e,t)=>{if(hi)try{await navigator.clipboard.writeText(e||"");return}catch(e){console.error(e)}try{if(t){if(t.clipboardData?.setData("text/plain",e||""),t.clipboardData?.getData("text/plain")!==e)throw Error("Failed to setData on clipboardEvent");return}}catch(e){console.error(e)}if(!hf(e))throw Error(C("errors.copyToSystemClipboardFailed"))},hf=e=>{e||(e=" ");let t="rtl"===document.documentElement.getAttribute("dir"),n=document.createElement("textarea");n.style.border="0",n.style.padding="0",n.style.margin="0",n.style.position="absolute",n.style[t?"right":"left"]="-9999px";let i=window.pageYOffset||document.documentElement.scrollTop;n.style.top=`${i}px`,n.style.fontSize="12pt",n.setAttribute("readonly",""),n.value=e,document.body.appendChild(n);let l=!1;try{n.select(),n.setSelectionRange(0,n.value.length),l=document.execCommand("copy")}catch(e){console.error(e)}return n.remove(),l}}),mr=tC(()=>{tM(),dO(),df(),fH(),dx(),tR(),fB(),ma(),h9(),mn(),dX(),ml(),hx=(e,t,n,i,l,r)=>{let{zoom:a}=i,s=e*(a.value-1)/2,o=t*(a.value-1)/2;return e>l&&1!==a.value&&(s=l*(a.value-1)/2),t>r&&1!==a.value&&(o=r*(a.value-1)/2),`translate(${s}px, ${o}px) scale(${a.value}) rotate(${180*n/Math.PI}deg)`},hy={},hb=(e,t)=>{let n=hy[e]||(hy[e]={height:t});return n.height=t,n},hv=e=>{hy[e]&&delete hy[e]},hw=e=>hy[e]?.height??null,hE=({id:e,onChange:t,onSubmit:n,getViewportCoords:i,element:l,canvas:r,excalidrawContainer:a,app:s})=>{let o=(e,t)=>{if(!t.style.fontFamily||!t.style.fontSize)return!1;let n=t.style.fontFamily.replace(/"/g,"");return tU({fontFamily:e.fontFamily})!==n||`${e.fontSize}px`!==t.style.fontSize},d=()=>{let t=s.state,n=gJ.getScene(l)?.getElement(e);if(!n)return;let{textAlign:r,verticalAlign:a}=n;if(n&&nL(n)){let e=n.x,l=n.y,s=hG(n),d=n.width,h=n.height,m=n.width,u=n.height;if(s&&n.containerId){let t;if(nO(s)){let t=o2.getBoundTextElementPosition(s,n);e=t.x,l=t.y}if(o(n,c)?t=hb(s.id,s.height):(t=hy[s.id])||(t=hb(s.id,s.height)),d=h2(s),h=h3(s,n),!nO(s)&&u>h){let e=h0(u,s.type);gQ(s,{height:e});return}if(!nO(s)&&s.height>t.height&&u<h){let e=h0(u,s.type);gQ(s,{height:e})}else{let{y:e}=hj(s,n);l=e}}let[p,g]=i(e,l),f=c.selectionStart,x=c.selectionEnd,y=c.value.length;if(f===x&&x!==y){let e=y-x;c.selectionStart=c.value.length-e,c.selectionEnd=c.value.length-e}s?m+=.5:m=Math.min(m,d=(t.width-8-p)/t.zoom.value);let b=n.lineHeight;X&&(b=hD({...n,fontSize:Math.round(n.fontSize)}));let v=(t.height-g)/t.zoom.value;Object.assign(c.style,{font:tG(n),lineHeight:b,width:`${m}px`,height:`${u}px`,left:`${p}px`,top:`${g}px`,transform:hx(m,u,hY(n),t,d,v),textAlign:r,verticalAlign:a,color:n.strokeColor,opacity:n.opacity/100,filter:"var(--theme-filter)",maxHeight:`${v}px`}),c.scrollTop=0,no()&&(c.style.fontFamily=tU(n)),gQ(n,{x:e,y:l})}},c=document.createElement("textarea");c.dir="auto",c.tabIndex=0,c.dataset.type="wysiwyg",c.wrap="off",c.classList.add("excalidraw-wysiwyg");let h="pre",m="normal";nU(l)&&(h="pre-wrap",m="break-word"),Object.assign(c.style,{position:"absolute",display:"inline-block",minHeight:"1em",backfaceVisibility:"hidden",margin:0,padding:0,border:0,outline:0,resize:"none",background:"transparent",overflow:"hidden",zIndex:"var(--zIndex-wysiwyg)",wordBreak:m,whiteSpace:h,overflowWrap:"break-word",boxSizing:"content-box"}),c.value=l.originalText,d(),t&&(c.onpaste=async e=>{let t=await hu(e,!0);if(!t.text)return;let n=hS(t.text);if(!n)return;let i=hG(l),r=tG({fontSize:s.state.currentItemFontSize,fontFamily:s.state.currentItemFontFamily});if(i){let e=hH(`${c.value}${n}`,r,h2(i)),t=hN(e,r);c.style.width=`${t}px`}},c.oninput=()=>{t(hS(c.value))}),c.onkeydown=e=>{if(!e.shiftKey&&cZ.keyTest(e))e.preventDefault(),s.actionManager.executeAction(cZ),d();else if(!e.shiftKey&&cW.keyTest(e))e.preventDefault(),s.actionManager.executeAction(cW),d();else if(c_.keyTest(e))s.actionManager.executeAction(c_);else if(cR.keyTest(e))s.actionManager.executeAction(cR);else if(e.key===aO.ESCAPE)e.preventDefault(),b=!0,v();else if(e.key===aO.ENTER&&e[aO.CTRL_OR_CMD]){if(e.preventDefault(),e.isComposing||229===e.keyCode)return;b=!0,v()}else if(e.key===aO.TAB||e[aO.CTRL_OR_CMD]&&(e.code===aN.BRACKET_LEFT||e.code===aN.BRACKET_RIGHT)){if(e.preventDefault(),e.isComposing)return;e.shiftKey||e.code===aN.BRACKET_LEFT?f():g(),c.dispatchEvent(new Event("input"))}};let u=" ".repeat(4),p=RegExp("^ {1,4}"),g=()=>{let{selectionStart:e,selectionEnd:t}=c,n=x(),i=c.value;n.forEach(e=>{let t=i.slice(0,e),n=i.slice(e);i=`${t}${u}${n}`}),c.value=i,c.selectionStart=e+4,c.selectionEnd=t+4*n.length},f=()=>{let{selectionStart:e,selectionEnd:t}=c,n=x(),i=[],l=c.value;n.forEach(e=>{let t=l.slice(e,e+4).match(p);if(t){let n=l.slice(0,e),r=l.slice(e+t[0].length);l=`${n}${r}`,i.push(e)}}),c.value=l,i.length&&(e>i[i.length-1]?c.selectionStart=Math.max(e-4,i[i.length-1]):c.selectionStart=e,c.selectionEnd=Math.max(c.selectionStart,t-4*i.length))},x=()=>{let{selectionStart:e,selectionEnd:t,value:n}=c,i=n.slice(0,e).match(/[^\n]*$/)[0].length;return e-=i,n.slice(e,t).split(`
`).reduce((t,n,i,l)=>t.concat(i?t[i-1]+l[i-1].length+1:e),[]).reverse()},y=e=>{e.preventDefault(),e.stopPropagation()},b=!1,v=()=>{w();let e=gJ.getScene(l)?.getElement(l.id);if(!e)return;let t=c.value,i=hG(e);if(i){if(t=e.text,c.value.trim()){let e=hW(i);e&&e===l.id?nO(i)&&g0(i):gQ(i,{boundElements:(i.boundElements||[]).concat({type:"text",id:l.id})})}else gQ(i,{boundElements:i.boundElements?.filter(e=>!nL(e))});hC(e,i)}n({text:t,viaKeyboard:b,originalText:c.value})},w=()=>{C||(C=!0,c.onblur=null,c.oninput=null,c.onkeydown=null,I&&I.disconnect(),window.removeEventListener("resize",d),window.removeEventListener("wheel",y,!0),window.removeEventListener("pointerdown",S),window.removeEventListener("pointerup",E),window.removeEventListener("blur",v),window.removeEventListener("beforeunload",v),k(),c.remove())},E=e=>{window.removeEventListener("pointerup",E);let t=e?.target,n=t instanceof HTMLElement&&t.classList.contains("active-color");setTimeout(()=>{c.onblur=v,n&&new MutationObserver((e,t)=>{e.find(e=>e.removedNodes.length>0&&e.removedNodes[0].dataset?.radixPopperContentWrapper!==void 0)&&(setTimeout(()=>{c.focus()}),t.disconnect())}).observe(document.querySelector(".excalidraw-container"),{childList:!0}),n||c.focus()})},S=e=>{let t=e.target instanceof HTMLElement&&e.target.classList.contains("active-color");((e.target instanceof HTMLElement||e.target instanceof SVGElement)&&e.target.closest(`.${eh.SHAPE_ACTIONS_MENU}`)&&!tW(e.target)||t)&&(c.onblur=null,window.addEventListener("pointerup",E),window.addEventListener("blur",v))},k=gJ.getScene(l).addCallback(()=>{d(),document.activeElement?.closest(".color-picker-content")||c.focus()}),C=!1;c.select(),E();let I=null;r&&"ResizeObserver"in window?(I=new window.ResizeObserver(()=>{d()})).observe(r):window.addEventListener("resize",d),window.addEventListener("pointerdown",S),window.addEventListener("wheel",y,{passive:!1,capture:!0}),window.addEventListener("beforeunload",v),a?.querySelector(".excalidraw-textEditorContainer").appendChild(c)}}),ma=tC(()=>{let e;tM(),df(),fB(),tR(),fH(),fG(),dx(),dX(),dx(),fG(),fK(),dK(),mr(),hS=e=>nk(e).replace(/\t/g,"        "),hk=e=>hS(e).split(`
`),hC=(e,t)=>{let n,i={x:e.x,y:e.y,text:e.text,width:e.width,height:e.height,baseline:e.baseline};i.text=e.text,t&&(n=h2(t,e),i.text=hH(e.originalText,tG(e),n));let l=hT(i.text,tG(e),e.lineHeight);if(i.width=l.width,i.height=l.height,i.baseline=l.baseline,t){let n=h3(t,e),r=h2(t);if(!nO(t)&&l.height>n){let e=h0(l.height,t.type);gQ(t,{height:e}),hb(t.id,e)}if(l.width>r){let e=h0(l.width,t.type);gQ(t,{width:e})}let a={...e,...i},{x:s,y:o}=hj(t,a);i.x=s,i.y=o}gQ(e,i)},hI=(e,t,n)=>{let i=na(e);t.forEach(e=>{let t=n.get(e.id),l=hW(e);if(l){let r=n.get(l);if(r){let n=i.get(t);n&&gQ(n,{boundElements:(e.boundElements||[]).filter(e=>e.id!==r&&e.id!==l).concat({type:"text",id:r})});let a=i.get(r);a&&nL(a)&&gQ(a,{containerId:n?t:null})}}})},hM=(e,t,n=!1)=>{let i=hW(e);if(!i)return;hv(e.id);let l=gJ.getScene(e).getElement(i);if(l&&l.text){if(!e)return;let r=(l=gJ.getScene(e).getElement(i)).text,a=l.height,s=l.width,o=h2(e),d=h3(e,l),c=e.height,h=l.baseline;if(n||"n"!==t&&"s"!==t){r&&(r=hH(l.originalText,tG(l),o));let e=hT(r,tG(l),l.lineHeight);a=e.height,s=e.width,h=e.baseline}if(a>d){let n=(c=h0(a,e.type))-e.height,i=nO(e)||"ne"!==t&&"nw"!==t&&"n"!==t?e.y:e.y-n;gQ(e,{height:c,y:i})}gQ(l,{text:r,width:s,height:a,baseline:h}),nO(e)||gQ(l,hj(e,l))}},hj=(e,t)=>{if(nO(e))return o2.getBoundTextElementPosition(e,t);let n=hK(e),i=h3(e,t),l=h2(e),r;return r=t.verticalAlign===e0.TOP?n.y:t.verticalAlign===e0.BOTTOM?n.y+(i-t.height):n.y+(i/2-t.height/2),{x:t.textAlign===e2.LEFT?n.x:t.textAlign===e2.RIGHT?n.x+(l-t.width):n.x+(l/2-t.width/2),y:r}},hT=(e,t,n)=>{e=e.split(`
`).map(e=>e||" ").join(`
`);let i=parseFloat(t),l=hO(e,i,n);return{width:hN(e,t),height:l,baseline:hL(e,t,n)}},hL=(e,t,n,i)=>{let l=document.createElement("div");l.style.position="absolute",l.style.whiteSpace="pre",l.style.font=t,l.style.minHeight="1em",i&&(l.style.overflow="hidden",l.style.wordBreak="break-word",l.style.whiteSpace="pre-wrap"),l.style.lineHeight=String(n),l.innerText=e,document.body.appendChild(l);let r=document.createElement("span");r.style.display="inline-block",r.style.overflow="hidden",r.style.width="1px",r.style.height="1px",l.appendChild(r);let a=r.offsetTop+r.offsetHeight,s=l.offsetHeight;if(X){let i=hO(e,parseFloat(t),n),l=parseFloat(t),r=hO(e,Math.round(l),n);i>s&&(a+=i-r),s>i&&(a-=r-i)}return document.body.removeChild(l),a},hD=e=>{let t=hk(e.text).length;return e.height/t/e.fontSize},hA=(e,t)=>e*t,hP=(e,t)=>hA(e,t)+2*eJ,hR=(e,t)=>{h_||(h_=document.createElement("canvas"));let n=h_.getContext("2d");n.font=t;let i=n.measureText(e).width;return no()?10*i:i},hN=(e,t)=>{let n=hk(e),i=0;return n.forEach(e=>{i=Math.max(i,hR(e,t))}),i},hO=(e,t,n)=>{let i=hk(e).length;return hA(t,n)*i},hz=e=>{let t=e.split("-");return t.length>1&&t.forEach((e,n)=>{n!==t.length-1&&(t[n]=e+="-")}),t.join(" ").split(" ")},hH=(e,t,n)=>{if(!Number.isFinite(n)||n<0)return e;let i=[],l=e.split(`
`),r=hR(" ",t),a="",s=0,o=e=>{e.trim()&&i.push(e)},d=()=>{a="",s=0};return l.forEach(e=>{if(hN(e,t)<=n){i.push(e);return}let l=hz(e);d();let c=0;for(;c<l.length;){let e=hR(l[c],t);if(e===n)o(l[c]),c++;else if(e>n){for(o(a),d();l[c].length>0;){let e=String.fromCodePoint(l[c].codePointAt(0)),i=hB.calculate(e,t);s+=i,l[c]=l[c].slice(e.length),s>=n?(o(a),a=e,s=i):a+=e}s+r>=n?(o(a),d()):a.endsWith("-")||(a+=" ",s+=r),c++}else for(;s<n&&c<l.length;){let e=l[c];if((s=hR(a+e,t))>n){o(a),d();break}c++;let h=!e.endsWith("-");if(a+=e,h&&(a+=" "),s+r>=n){h?i.push(a.slice(0,-1)):i.push(a),d();break}}}" "===a.slice(-1)&&o(a=a.slice(0,-1))}),i.join(`
`)},e={},hB={calculate:(t,n)=>{let i=t.charCodeAt(0);if(e[n]||(e[n]=[]),!e[n][i]){let l=hR(t,n);e[n][i]=l}return e[n][i]},getCache:t=>e[t]},hF="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".toLocaleUpperCase(),h$=(e,t)=>{let n=hZ(e);return 0===n?hT(hF.split("").join(`
`),e,t).width+2*eJ:n+2*eJ},hZ=e=>{let t=hB.getCache(e);return t?Math.max(...t.filter(e=>void 0!==e)):0},hW=e=>e?.boundElements?.length&&e?.boundElements?.filter(e=>"text"===e.type)[0]?.id||null,hU=e=>{if(!e)return null;let t=hW(e);return t&&gJ.getScene(e)?.getElement(t)||null},hG=e=>e&&e.containerId&&gJ.getScene(e)?.getElement(e.containerId)||null,hV=(e,t)=>{if(!nO(e))return{x:e.x+e.width/2,y:e.y+e.height/2};let n=o2.getPointsGlobalCoordinates(e);if(n.length%2==1){let t=Math.floor(e.points.length/2),n=o2.getPointGlobalCoordinates(e,e.points[t]);return{x:n[0],y:n[1]}}let i=e.points.length/2-1,l=o2.getEditorMidPoints(e,t)[i];return l||(l=o2.getSegmentMidPoint(e,n[i],n[i+1],i+1)),{x:l[0],y:l[1]}},hK=e=>{let t=eJ,n=eJ;return"ellipse"===e.type&&(t+=e.width/2*(1-Math.sqrt(2)/2),n+=e.height/2*(1-Math.sqrt(2)/2)),"diamond"===e.type&&(t+=e.width/4,n+=e.height/4),{x:e.x+t,y:e.y+n}},hY=e=>{let t=hG(e);return!t||nO(t)?e.angle:t.angle},hX=e=>e.some(e=>{if(nU(e)){let t=hG(e);return!(nL(e)&&nO(t))}return!1}),hq=e=>e.some(e=>{if(nU(e)){let t=hG(e);return!(nL(e)&&nO(t))}return nL(e)}),hJ=(e,t,n,i)=>{let l=gV(e,t);if(1===l.length)return n$(l[0],!1)?l[0]:null;let r=null;for(let l=e.length-1;l>=0;--l){if(e[l].isDeleted)continue;let[a,s,o,d]=mF(e[l]);if(nO(e[l])&&sJ(e[l],t,null,[n,i])||a<n&&n<o&&s<i&&i<d){r=e[l];break}}return n$(r,!1)?r:null},hQ=new Set(["rectangle","ellipse","diamond","arrow"]),h1=e=>hQ.has(e.type),h0=(e,t)=>{e=Math.ceil(e);let n=2*eJ;return"ellipse"===t?Math.round((e+n)/Math.sqrt(2)*2):"arrow"===t?e+8*n:"diamond"===t?2*(e+n):e+n},h2=(e,t=hU(e))=>{let{width:n}=e;if(nO(e)){let e=(t?.fontSize??ey)*e1;return Math.max(eQ*n,e)}return"ellipse"===e.type?Math.round(n/2*Math.sqrt(2))-2*eJ:"diamond"===e.type?Math.round(n/2)-2*eJ:n-2*eJ},h3=(e,t)=>{let{height:n}=e;return nO(e)?n-16*eJ<=0?t.height:n:"ellipse"===e.type?Math.round(n/2*Math.sqrt(2))-2*eJ:"diamond"===e.type?Math.round(n/2)-2*eJ:n-2*eJ},h6=()=>hN(hF,tG({fontSize:ey,fontFamily:eb}))>0,h4={[em.Virgil]:1.25,[em.Helvetica]:1.15,[em.Cascadia]:1.2},h5=e=>e in h4?h4[e]:h4[eb]});function ms(e){let t=e.simulatePressure?e.points:e.points.length?e.points.map(([t,n],i)=>[t,n,e.pressures[i]]):[[0,0,.5]],n={simulatePressure:e.simulatePressure,size:4.25*e.strokeWidth,thinning:.6,smoothing:.5,streamline:.5,easing:e=>Math.sin(e*Math.PI/2),last:!!e.lastCommittedPoint};return function(e){if(!e.length)return"";let t=e.length-1;return e.reduce((e,n,i,l)=>(i===t?e.push(n,mo(n,l[0]),"L",l[0],"Z"):e.push(n,mo(n,l[i+1])),e),["M",e[0],"Q"]).join(" ").replace(mD,"$1")}((0,tu.mx)(t,n))}function mo(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}var md,mc,mh,mm,mu,mp,mg,mf,mx,my,mb,mv,mw,mE,mS,mk,mC,mI,mM,mj,mT,mL,mD,mA,mP,m_,mR,mN,mO,mz,mH,mB,mF,m$,mZ,mW,mU,mG,mV,mK,mY,mX,mq,mJ,mQ,m1,m0,m2,m3,m6,m4,m5,m8,m7,m9,ue,ut,un,ui,ul,ur,ua,us,uo,ud,uc,uh,um,uu,up,ug,uf,ux,uy,ub,uv,uw,uE,uS,uk,uC,uI,uM,uj,uT,uL,uD,uA,uP,u_,uR,uN,uO,uz,uH,uB,uF,u$,uZ,uW,uU,uG,uV,uK=tC(()=>{tM(),dx(),uq(),df(),uJ(),dy(),tR(),ma(),dX(),dA(),fO(),dB(),dV(),md="invert(100%) hue-rotate(180deg) saturate(1.25)",mc=nq(),mh=(e,t)=>nC(e)&&!t.imageCache.has(e.fileId),mm=(e,t,n)=>"dark"===n.theme&&nC(e)&&!mh(e,t)&&t.imageCache.get(e.fileId)?.mimeType!==eC.svg,mu=e=>"freedraw"===e.type?12*e.strokeWidth:20,mp=(e,t,n)=>{let i=(t?.opacity??100)*e.opacity/1e4;return(n.has(e.id)||t&&n.has(t.id))&&(i*=e3/100),i},mg=(e,t)=>{let n=mu(e),[i,l,r,a]=mF(e),s=nN(e)||n_(e)?tQ(i,r):e.width,o=nN(e)||n_(e)?tQ(l,a):e.height,d=s*window.devicePixelRatio+2*n,c=o*window.devicePixelRatio+2*n,h=t.value;return(d*h>32767||c*h>32767)&&(h=Math.min(32767/d,32767/c)),d*c*h*h>16777216&&(h=Math.sqrt(16777216/(d*c))),{width:d=Math.floor(d*h),height:c=Math.floor(c*h),scale:h}},mf=(e,t,n,i)=>{let l=document.createElement("canvas"),r=l.getContext("2d"),a=mu(e),{width:s,height:o,scale:d}=mg(e,t);l.width=s,l.height=o;let c=0,h=0;if(nN(e)||n_(e)){let[t,n]=mF(e);c=e.x>t?tQ(e.x,t)*window.devicePixelRatio*d:0,h=e.y>n?tQ(e.y,n)*window.devicePixelRatio*d:0,r.translate(c,h)}r.save(),r.translate(a*d,a*d),r.scale(window.devicePixelRatio*d,window.devicePixelRatio*d);let m=tm.Z.canvas(l);return mm(e,n,i)&&(r.filter=md),mw(e,m,r,n,i),r.restore(),{element:e,canvas:l,theme:i.theme,scale:d,zoomValue:t.value,canvasOffsetX:c,canvasOffsetY:h,boundTextElementVersion:hU(e)?.version||null,containingFrameOpacity:gA(e)?.opacity||100}},mx=14,(my=document.createElement("img")).src=`data:${eC.svg},${encodeURIComponent('<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="image" class="svg-inline--fa fa-image fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="#888" d="M464 448H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h416c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48zM112 120c-30.928 0-56 25.072-56 56s25.072 56 56 56 56-25.072 56-56-25.072-56-56-56zM64 384h384V272l-87.515-87.515c-4.686-4.686-12.284-4.686-16.971 0L208 320l-55.515-55.515c-4.686-4.686-12.284-4.686-16.971 0L64 336v48z"></path></svg>')}`,(mb=document.createElement("img")).src=`data:${eC.svg},${encodeURIComponent('<svg viewBox="0 0 668 668" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2"><path d="M464 448H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h416c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48ZM112 120c-30.928 0-56 25.072-56 56s25.072 56 56 56 56-25.072 56-56-25.072-56-56-56ZM64 384h384V272l-87.515-87.515c-4.686-4.686-12.284-4.686-16.971 0L208 320l-55.515-55.515c-4.686-4.686-12.284-4.686-16.971 0L64 336v48Z" style="fill:#888;fill-rule:nonzero" transform="matrix(.81709 0 0 .81709 124.825 145.825)"/><path d="M256 8C119.034 8 8 119.033 8 256c0 136.967 111.034 248 248 248s248-111.034 248-248S392.967 8 256 8Zm130.108 117.892c65.448 65.448 70 165.481 20.677 235.637L150.47 105.216c70.204-49.356 170.226-44.735 235.638 20.676ZM125.892 386.108c-65.448-65.448-70-165.481-20.677-235.637L361.53 406.784c-70.203 49.356-170.226 44.736-235.638-20.676Z" style="fill:#888;fill-rule:nonzero" transform="matrix(.30366 0 0 .30366 506.822 60.065)"/></svg>')}`,mv=(e,t,n)=>{t.fillStyle="#E7E7E7",t.fillRect(0,0,e.width,e.height);let i=Math.min(e.width,e.height),l=Math.min(i,Math.min(.4*i,100));t.drawImage("error"===e.status?mb:my,e.width/2-l/2,e.height/2-l/2,l,l)},mw=(e,t,n,i,l)=>{switch(e.type){case"rectangle":case"iframe":case"embeddable":case"diamond":case"ellipse":n.lineJoin="round",n.lineCap="round",t.draw(sK.get(e));break;case"arrow":case"line":n.lineJoin="round",n.lineCap="round",sK.get(e).forEach(e=>{t.draw(e)});break;case"freedraw":{n.save(),n.fillStyle=e.strokeColor;let i=mL.get(e),l=sK.get(e);l&&t.draw(l),n.fillStyle=e.strokeColor,n.fill(i),n.restore();break}case"image":{let t=nC(e)?i.imageCache.get(e.fileId)?.image:void 0;null==t||t instanceof Promise?mv(e,n,l.zoom.value):n.drawImage(t,0,0,e.width,e.height);break}default:if(nL(e)){let t=t5(e.text),i=t&&!n.canvas.isConnected;i&&document.body.appendChild(n.canvas),n.canvas.setAttribute("dir",t?"rtl":"ltr"),n.save(),n.font=tG(e),n.fillStyle=e.strokeColor,n.textAlign=e.textAlign;let l=e.text.replace(/\r\n?/g,`
`).split(`
`),r="center"===e.textAlign?e.width/2:"right"===e.textAlign?e.width:0,a=hA(e.fontSize,e.lineHeight),s=e.height-e.baseline;for(let e=0;e<l.length;e++)n.fillText(l[e],r,(e+1)*a-s);n.restore(),i&&n.canvas.remove()}else throw Error(`Unimplemented type ${e.type}`)}},mE=new WeakMap,mS=(e,t,n)=>{let i=t?n.zoom:mc.zoom,l=mE.get(e),r=l&&l.zoomValue!==i.value&&!n?.shouldCacheIgnoreZoom,a=hU(e)?.version||null,s=gA(e)?.opacity||100;if(!l||r||l.theme!==n.theme||l.boundTextElementVersion!==a||l.containingFrameOpacity!==s){let l=mf(e,i,t,n);return mE.set(e,l),l}return l},mk=(e,t,n,i)=>{let l=e.element,r=mu(l),a=e.scale,[s,o,d,c]=mF(l);n_(l)&&(s=Math.floor(s),d=Math.ceil(d),o=Math.floor(o),c=Math.ceil(c));let h=((s+d)/2+i.scrollX)*window.devicePixelRatio,m=((o+c)/2+i.scrollY)*window.devicePixelRatio;t.save(),t.scale(1/window.devicePixelRatio,1/window.devicePixelRatio);let p=hU(l);if(nO(l)&&p){let n=document.createElement("canvas"),i=n.getContext("2d"),u=Math.max(tQ(s,d),tQ(o,c));n.width=u*window.devicePixelRatio*a+r*e.scale*10,n.height=u*window.devicePixelRatio*a+r*e.scale*10;let g=(n.width-e.canvas.width)/2,f=(n.height-e.canvas.height)/2;i.translate(n.width/2,n.height/2),i.rotate(l.angle),i.drawImage(e.canvas,-e.canvas.width/2,-e.canvas.height/2,e.canvas.width,e.canvas.height);let[,,,,x,y]=mF(p);i.rotate(-l.angle);let b=n.width/2-(x-s)*window.devicePixelRatio*a-g-r*a,v=n.height/2-(y-o)*window.devicePixelRatio*a-f-r*a;i.translate(-b,-v),i.clearRect(-(p.width/2+eJ)*window.devicePixelRatio*a,-(p.height/2+eJ)*window.devicePixelRatio*a,(p.width+2*eJ)*window.devicePixelRatio*a,(p.height+2*eJ)*window.devicePixelRatio*a),t.translate(h,m),t.drawImage(n,-(d-s)/2*window.devicePixelRatio-g/a-r,-(c-o)/2*window.devicePixelRatio-f/a-r,n.width/a,n.height/a)}else if(t.translate(h,m),t.rotate(l.angle),"scale"in e.element&&!mh(l,n)&&t.scale(e.element.scale[0],e.element.scale[1]),t.translate(-h,-m),t.drawImage(e.canvas,(s+i.scrollX)*window.devicePixelRatio-r*e.scale/e.scale,(o+i.scrollY)*window.devicePixelRatio-r*e.scale/e.scale,e.canvas.width/e.scale,e.canvas.height/e.scale),"true"===u.VITE_APP_DEBUG_ENABLE_TEXT_CONTAINER_BOUNDING_BOX&&nW(l)){let e=hU(l),n=hK(l);t.strokeStyle="#c92a2a",t.lineWidth=3,t.strokeRect((n.x+i.scrollX)*window.devicePixelRatio,(n.y+i.scrollY)*window.devicePixelRatio,h2(l)*window.devicePixelRatio,h3(l,e)*window.devicePixelRatio)}t.restore()},mC=(e,t,n)=>{t.save(),t.translate(e.x+n.scrollX,e.y+n.scrollY),t.fillStyle="rgba(0, 0, 200, 0.04)";let i=.5/n.zoom.value;t.fillRect(i,i,e.width,e.height),t.lineWidth=1/n.zoom.value,t.strokeStyle=" rgb(105, 101, 219)",t.strokeRect(i,i,e.width,e.height),t.restore()},mI=(e,t,n,i,l)=>{switch(n.globalAlpha=mp(e,gA(e),i.elementsPendingErasure),e.type){case"magicframe":case"frame":l.frameRendering.enabled&&l.frameRendering.outline&&(n.save(),n.translate(e.x+l.scrollX,e.y+l.scrollY),n.fillStyle="rgba(0, 0, 200, 0.04)",n.lineWidth=eg.strokeWidth/l.zoom.value,n.strokeStyle=eg.strokeColor,nA(e)&&(n.strokeStyle="light"===l.theme?"#7affd7":"#1d8264"),eg.radius&&n.roundRect?(n.beginPath(),n.roundRect(0,0,e.width,e.height,eg.radius/l.zoom.value),n.stroke(),n.closePath()):n.strokeRect(0,0,e.width,e.height),n.restore());break;case"freedraw":if(sK.generateElementShape(e,null),i.isExporting){let[r,a,s,o]=mF(e),d=(r+s)/2+l.scrollX,c=(a+o)/2+l.scrollY,h=(s-r)/2-(e.x-r),m=(o-a)/2-(e.y-a);n.save(),n.translate(d,c),n.rotate(e.angle),n.translate(-h,-m),mw(e,t,n,i,l),n.restore()}else mk(mS(e,i,l),n,i,l);break;case"rectangle":case"diamond":case"ellipse":case"line":case"arrow":case"image":case"text":case"iframe":case"embeddable":if(sK.generateElementShape(e,i),i.isExporting){let[r,a,s,o]=mF(e),d=(r+s)/2+l.scrollX,c=(a+o)/2+l.scrollY,h=(s-r)/2-(e.x-r),m=(o-a)/2-(e.y-a);if(nL(e)){let t=hG(e);if(nO(t)){let n=o2.getBoundTextElementPosition(t,e);h=(s-r)/2-(n.x-r),m=(o-a)/2-(n.y-a)}}n.save(),n.translate(d,c),mm(e,i,l)&&(n.filter="none");let u=hU(e);if(nO(e)&&u){let t=document.createElement("canvas"),d=t.getContext("2d"),c=Math.max(tQ(r,s),tQ(a,o)),p=mu(e);t.width=c*l.exportScale+10*p*l.exportScale,t.height=c*l.exportScale+10*p*l.exportScale,d.translate(t.width/2,t.height/2),d.scale(l.exportScale,l.exportScale),h=e.width/2-(e.x-r),m=e.height/2-(e.y-a),d.rotate(e.angle);let g=tm.Z.canvas(t);d.translate(-h,-m),mw(e,g,d,i,l),d.translate(h,m),d.rotate(-e.angle);let[,,,,f,x]=mF(u),y=(r+s)/2-f,b=(a+o)/2-x;d.translate(-y,-b),d.clearRect(-u.width/2,-u.height/2,u.width,u.height),n.scale(1/l.exportScale,1/l.exportScale),n.drawImage(t,-t.width/2,-t.height/2,t.width,t.height)}else n.rotate(e.angle),"image"===e.type&&n.scale(e.scale[0],e.scale[1]),n.translate(-h,-m),mw(e,t,n,i,l);n.restore()}else{let t=mS(e,i,l),r=n.imageSmoothingEnabled;!l?.shouldCacheIgnoreZoom&&(!e.angle||uv(e.angle))&&(n.imageSmoothingEnabled=!1),mk(t,n,i,l),n.imageSmoothingEnabled=r}break;default:throw Error(`Unimplemented type ${e.type}`)}n.globalAlpha=1},mM=(e,t,n)=>{if(typeof n>"u")return e.draw(t);let i={sets:t.sets,shape:t.shape,options:{...t.options,fixedDecimalPlaceDigits:n}};return e.draw(i)},mj=(e,t,n,i)=>{if(!i.enabled||!i.clip)return null;let l=gA(e);if(l){let e=t.ownerDocument.createElementNS(eX,"g");return e.setAttributeNS(eX,"clip-path",`url(#${l.id})`),n.forEach(t=>e.appendChild(t)),e}return null},mT=(e,t,n,i,l,r,a)=>{let s={x:l,y:r},[o,d,c,h]=mF(e),m=(c-o)/2-(e.x-o),u=(h-d)/2-(e.y-d);if(nL(e)){let t=hG(e);if(nO(t)){let[n,i,a,s]=mF(t),o=o2.getBoundTextElementPosition(t,e);m=(a-n)/2-(o.x-n),u=(s-i)/2-(o.y-i),l=l+o.x-e.x,r=r+o.y-e.y}}let p=180*e.angle/Math.PI,g=n;if(e.link){let t=n.ownerDocument.createElementNS(eX,"a");t.setAttribute("href",aG(e.link)),g.appendChild(t),g=t}let f=(e,t)=>{no()&&e.setAttribute("data-id",t.id),g.appendChild(e)},x=(gA(e)?.opacity??100)*e.opacity/1e4;switch(e.type){case"selection":throw Error("Selection rendering is not supported for SVG");case"rectangle":case"diamond":case"ellipse":{let n=mM(t,sK.generateElementShape(e,null),eU);1!==x&&(n.setAttribute("stroke-opacity",`${x}`),n.setAttribute("fill-opacity",`${x}`)),n.setAttribute("stroke-linecap","round"),n.setAttribute("transform",`translate(${l||0} ${r||0}) rotate(${p} ${m} ${u})`),f(mj(e,g,[n],a.frameRendering)||n,e);break}case"iframe":case"embeddable":{let o=sK.generateElementShape(e,a),d=mM(t,o,eU),c=e.opacity/100;1!==c&&(d.setAttribute("stroke-opacity",`${c}`),d.setAttribute("fill-opacity",`${c}`)),d.setAttribute("stroke-linecap","round"),d.setAttribute("transform",`translate(${l||0} ${r||0}) rotate(${p} ${m} ${u})`),f(d,e);let h=l_(e);mT(h,t,g,i,h.x+s.x-e.x,h.y+s.y-e.y,a);let x=mM(t,o,eU);for(x.setAttribute("stroke-linecap","round"),x.setAttribute("transform",`translate(${l||0} ${r||0}) rotate(${p} ${m} ${u})`);x.firstChild;)x.removeChild(x.firstChild);let y=um(Math.min(e.width,e.height),e),b=lA(aK(e.link||""));if(!1===a.renderEmbeddables||b?.type==="document"){let t=n.ownerDocument.createElementNS(eX,"a");t.setAttribute("href",aG(e.link||"")),t.setAttribute("target","_blank"),t.setAttribute("rel","noopener noreferrer"),t.style.borderRadius=`${y}px`,x.appendChild(t)}else{let t=n.ownerDocument.createElementNS(eX,"foreignObject");t.style.width=`${e.width}px`,t.style.height=`${e.height}px`,t.style.border="none";let i=t.ownerDocument.createElementNS(eX,"div");i.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),i.style.width="100%",i.style.height="100%";let l=i.ownerDocument.createElement("iframe");l.src=b?.link??"",l.style.width="100%",l.style.height="100%",l.style.border="none",l.style.borderRadius=`${y}px`,l.style.top="0",l.style.left="0",l.allowFullscreen=!0,i.appendChild(l),t.appendChild(i),x.appendChild(t)}f(x,e);break}case"line":case"arrow":{let i=hU(e),s=n.ownerDocument.createElementNS(eX,"mask");if(i){s.setAttribute("id",`mask-${e.id}`);let t=n.ownerDocument.createElementNS(eX,"rect");l=l||0,r=r||0,t.setAttribute("x","0"),t.setAttribute("y","0"),t.setAttribute("fill","#fff"),t.setAttribute("width",`${e.width+100+l}`),t.setAttribute("height",`${e.height+100+r}`),s.appendChild(t);let a=n.ownerDocument.createElementNS(eX,"rect"),o=o2.getBoundTextElementPosition(e,i),d=l+o.x-e.x,c=r+o.y-e.y;a.setAttribute("x",d.toString()),a.setAttribute("y",c.toString()),a.setAttribute("fill","#000"),a.setAttribute("width",`${i.width}`),a.setAttribute("height",`${i.height}`),a.setAttribute("opacity","1"),s.appendChild(a)}let o=n.ownerDocument.createElementNS(eX,"g");i&&o.setAttribute("mask",`url(#mask-${e.id})`),o.setAttribute("stroke-linecap","round"),sK.generateElementShape(e,a).forEach(n=>{let i=mM(t,n,eU);1!==x&&(i.setAttribute("stroke-opacity",`${x}`),i.setAttribute("fill-opacity",`${x}`)),i.setAttribute("transform",`translate(${l||0} ${r||0}) rotate(${p} ${m} ${u})`),"line"===e.type&&ua(e.points)&&"transparent"!==e.backgroundColor&&i.setAttribute("fill-rule","evenodd"),o.appendChild(i)});let d=mj(e,g,[o,s],a.frameRendering);d?(f(d,e),g.appendChild(d)):(f(o,e),g.append(s));break}case"freedraw":{let i=sK.generateElementShape(e,a),s=i?mM(t,i,eU):n.ownerDocument.createElementNS(eX,"g");1!==x&&(s.setAttribute("stroke-opacity",`${x}`),s.setAttribute("fill-opacity",`${x}`)),s.setAttribute("transform",`translate(${l||0} ${r||0}) rotate(${p} ${m} ${u})`),s.setAttribute("stroke","none");let o=n.ownerDocument.createElementNS(eX,"path");o.setAttribute("fill",e.strokeColor),o.setAttribute("d",ms(e)),s.appendChild(o),f(mj(e,g,[s],a.frameRendering)||s,e);break}case"image":{let t=Math.round(e.width),s=Math.round(e.height),o=nC(e)&&i[e.fileId];if(o){let i=`image-${o.id}`,d=n.querySelector(`#${i}`);if(!d){(d=n.ownerDocument.createElementNS(eX,"symbol")).id=i;let e=n.ownerDocument.createElementNS(eX,"image");e.setAttribute("width","100%"),e.setAttribute("height","100%"),e.setAttribute("href",o.dataURL),d.appendChild(e),g.prepend(d)}let c=n.ownerDocument.createElementNS(eX,"use");if(c.setAttribute("href",`#${i}`),a.exportWithDarkMode&&o.mimeType!==eC.svg&&c.setAttribute("filter",md),c.setAttribute("width",`${t}`),c.setAttribute("height",`${s}`),c.setAttribute("opacity",`${x}`),1!==e.scale[0]||1!==e.scale[1]){let n=1!==e.scale[0]?-t:0,i=1!==e.scale[1]?-s:0;c.setAttribute("transform",`scale(${e.scale[0]}, ${e.scale[1]}) translate(${n} ${i})`)}let h=n.ownerDocument.createElementNS(eX,"g");h.appendChild(c),h.setAttribute("transform",`translate(${l||0} ${r||0}) rotate(${p} ${m} ${u})`),f(mj(e,g,[h],a.frameRendering)||h,e)}break}case"frame":case"magicframe":if(a.frameRendering.enabled&&a.frameRendering.outline){let t=document.createElementNS(eX,"rect");t.setAttribute("transform",`translate(${l||0} ${r||0}) rotate(${p} ${m} ${u})`),t.setAttribute("width",`${e.width}px`),t.setAttribute("height",`${e.height}px`),t.setAttribute("rx",eg.radius.toString()),t.setAttribute("ry",eg.radius.toString()),t.setAttribute("fill","none"),t.setAttribute("stroke",eg.strokeColor),t.setAttribute("stroke-width",eg.strokeWidth.toString()),f(t,e)}break;default:if(nL(e)){let t=n.ownerDocument.createElementNS(eX,"g");1!==x&&(t.setAttribute("stroke-opacity",`${x}`),t.setAttribute("fill-opacity",`${x}`)),t.setAttribute("transform",`translate(${l||0} ${r||0}) rotate(${p} ${m} ${u})`);let i=e.text.replace(/\r\n?/g,`
`).split(`
`),s=hA(e.fontSize,e.lineHeight),o="center"===e.textAlign?e.width/2:"right"===e.textAlign?e.width:0,d=t5(e.text)?"rtl":"ltr",c="center"===e.textAlign?"middle":"right"===e.textAlign||"rtl"===d?"end":"start";for(let l=0;l<i.length;l++){let r=n.ownerDocument.createElementNS(eX,"text");r.textContent=i[l],r.setAttribute("x",`${o}`),r.setAttribute("y",`${l*s}`),r.setAttribute("font-family",tU(e)),r.setAttribute("font-size",`${e.fontSize}px`),r.setAttribute("fill",e.strokeColor),r.setAttribute("text-anchor",c),r.setAttribute("style","white-space: pre;"),r.setAttribute("direction",d),r.setAttribute("dominant-baseline","text-before-edge"),t.appendChild(r)}f(mj(e,g,[t],a.frameRendering)||t,e)}else throw Error(`Unimplemented type ${e.type}`)}},mL=new WeakMap([]),mD=/(\s?[A-Z]?,?-?[0-9]*\.[0-9]{0,2})(([0-9]|e|-)*)/g}),uY=tC(()=>{tM(),fG(),uJ(),uK(),df(),tR(),dx(),h7(),mA=e=>[8,8+e],mP=e=>[1.5,6+e],m_=(e,t=!1)=>{let n,i,l;let r={seed:e.seed,strokeLineDash:"dashed"===e.strokeStyle?mA(e.strokeWidth):"dotted"===e.strokeStyle?mP(e.strokeWidth):void 0,disableMultiStroke:"solid"!==e.strokeStyle,strokeWidth:"solid"!==e.strokeStyle?e.strokeWidth+.5:e.strokeWidth,fillWeight:e.strokeWidth/2,hachureGap:4*e.strokeWidth,roughness:(n=e.roughness,i=Math.max(e.width,e.height),(l=Math.min(e.width,e.height))>=20&&i>=50||l>=15&&e.roundness&&cI(e.type)||nN(e)&&i>=50?n:Math.min(n/(i<10?3:2),2.5)),stroke:e.strokeColor,preserveVertices:t||e.roughness<e7.cartoonist};switch(e.type){case"rectangle":case"iframe":case"embeddable":case"diamond":case"ellipse":return r.fillStyle=e.fillStyle,r.fill=nt(e.backgroundColor)?void 0:e.backgroundColor,"ellipse"===e.type&&(r.curveFitting=1),r;case"line":case"freedraw":return ua(e.points)&&(r.fillStyle=e.fillStyle,r.fill="transparent"===e.backgroundColor?void 0:e.backgroundColor),r;case"arrow":return r;default:throw Error(`Unimplemented type ${e.type}`)}},mR=(e,t,n)=>nT(e)&&(t||nM(e)&&n?.get(e.id)!==!0)&&nt(e.backgroundColor)&&nt(e.strokeColor)?{...e,roughness:0,backgroundColor:"#d3d3d3",fillStyle:"solid"}:nj(e)?{...e,strokeColor:nt(e.strokeColor)?"#000000":e.strokeColor,backgroundColor:nt(e.backgroundColor)?"#f4f4f6":e.backgroundColor}:e,mN=(e,t,n,i,l,r,a)=>{let s=m1(e,t,n,i);if(null===s)return[];switch(i){case"dot":case"circle":case"circle_outline":{let[t,n,o]=s;return delete r.strokeLineDash,[l.circle(t,n,o,{...r,fill:"circle_outline"===i?a:e.strokeColor,fillStyle:"solid",stroke:e.strokeColor,roughness:Math.min(.5,r.roughness||0)})]}case"triangle":case"triangle_outline":{let[t,n,o,d,c,h]=s;return delete r.strokeLineDash,[l.polygon([[t,n],[o,d],[c,h],[t,n]],{...r,fill:"triangle_outline"===i?a:e.strokeColor,fillStyle:"solid",roughness:Math.min(1,r.roughness||0)})]}case"diamond":case"diamond_outline":{let[t,n,o,d,c,h,m,u]=s;return delete r.strokeLineDash,[l.polygon([[t,n],[o,d],[c,h],[m,u],[t,n]],{...r,fill:"diamond_outline"===i?a:e.strokeColor,fillStyle:"solid",roughness:Math.min(1,r.roughness||0)})]}default:{let[t,n,i,a,o,d]=s;if("dotted"===e.strokeStyle){let t=mP(e.strokeWidth-1);r.strokeLineDash=[t[0],t[1]-1]}else delete r.strokeLineDash;return r.roughness=Math.min(1,r.roughness||0),[l.line(i,a,t,n,r),l.line(o,d,t,n,r)]}}},mO=(e,t,{isExporting:n,canvasBackgroundColor:i,embedsValidationStatus:l})=>{switch(e.type){case"rectangle":case"iframe":case"embeddable":{let i;if(e.roundness){let r=e.width,a=e.height,s=um(Math.min(r,a),e);i=t.path(`M ${s} 0 L ${r-s} 0 Q ${r} 0, ${r} ${s} L ${r} ${a-s} Q ${r} ${a}, ${r-s} ${a} L ${s} ${a} Q 0 ${a}, 0 ${a-s} L 0 ${s} Q 0 0, ${s} 0`,m_(mR(e,n,l),!0))}else i=t.rectangle(0,0,e.width,e.height,m_(mR(e,n,l),!1));return i}case"diamond":{let n,[i,l,r,a,s,o,d,c]=mW(e);if(e.roundness){let h=um(Math.abs(i-d),e),m=um(Math.abs(a-l),e);n=t.path(`M ${i+h} ${l+m} L ${r-h} ${a-m}
            C ${r} ${a}, ${r} ${a}, ${r-h} ${a+m}
            L ${s+h} ${o-m}
            C ${s} ${o}, ${s} ${o}, ${s-h} ${o-m}
            L ${d+h} ${c+m}
            C ${d} ${c}, ${d} ${c}, ${d+h} ${c-m}
            L ${i-h} ${l+m}
            C ${i} ${l}, ${i} ${l}, ${i+h} ${l+m}`,m_(e,!0))}else n=t.polygon([[i,l],[r,a],[s,o],[d,c]],m_(e));return n}case"ellipse":return t.ellipse(e.width/2,e.height/2,e.width,e.height,m_(e));case"line":case"arrow":{let n,l=m_(e),r=e.points.length?e.points:[[0,0]];if(n=e.roundness?[t.curve(r,l)]:l.fill?[t.polygon(r,l)]:[t.linearPath(r,l)],"arrow"===e.type){let{startArrowhead:r=null,endArrowhead:a="arrow"}=e;if(null!==r){let a=mN(e,n,"start",r,t,l,i);n.push(...a)}if(null!==a){let r=mN(e,n,"end",a,t,l,i);n.push(...r)}}return n}case"freedraw":{let n,i,l;if(i=ms(e),l=new Path2D(i),mL.set(e,l),ua(e.points)){let i=(0,td.og)(e.points,.75);n=t.curve(i,{...m_(e),stroke:"none"})}else n=null;return n}case"frame":case"magicframe":case"text":case"image":return null;default:return nx(e,`generateElementShape(): Unimplemented type ${e?.type}`),null}}}),uX=tC(()=>{tM(),mz=e=>{let t=e.map(e=>e[0]),n=e.map(e=>e[1]);return{width:Math.max(...t)-Math.min(...t),height:Math.max(...n)-Math.min(...n)}},mH=(e,t,n,i)=>{let l=n.map(t=>t[e]),r=Math.min(...l),a=Math.max(...l)-r,s=0===a?1:t/a,o=1/0,d=n.map(t=>{let n=t[e]*s,i=[...t];return i[e]=n,n<o&&(o=n),i});if(!i||2===d.length)return d;let c=r-o;return d.map(t=>t.map((t,n)=>n===e?t+c:t))}}),uq=tC(()=>{tM(),uJ(),uY(),dx(),uX(),ma(),dX(),dV(),fH(),mB=class e{static boundsCache=new WeakMap;static getBounds(t){let n=e.boundsCache.get(t);if(n?.version&&n.version===t.version&&!nU(t))return n.bounds;let i=e.calculateBounds(t);return gJ.getScene(t)&&e.boundsCache.set(t,{version:t.version,bounds:i}),i}static calculateBounds(e){let t,[n,i,l,r,a,s]=mF(e);if(n_(e)){let[t,n,i,l]=mX(e.points.map(([t,n])=>ut(t,n,a-e.x,s-e.y,e.angle)));return[t+e.x,n+e.y,i+e.x,l+e.y]}if(nN(e))t=m2(e,a,s);else if("diamond"===e.type){let[o,d]=ut(a,i,a,s,e.angle),[c,h]=ut(a,r,a,s,e.angle),[m,u]=ut(n,s,a,s,e.angle),[p,g]=ut(l,s,a,s,e.angle);t=[Math.min(o,c,m,p),Math.min(d,h,u,g),Math.max(o,c,m,p),Math.max(d,h,u,g)]}else if("ellipse"===e.type){let o=(l-n)/2,d=(r-i)/2,c=Math.cos(e.angle),h=Math.sin(e.angle),m=Math.hypot(o*c,d*h),u=Math.hypot(d*c,o*h);t=[a-m,s-u,a+m,s+u]}else{let[o,d]=ut(n,i,a,s,e.angle),[c,h]=ut(n,r,a,s,e.angle),[m,u]=ut(l,r,a,s,e.angle),[p,g]=ut(l,i,a,s,e.angle);t=[Math.min(o,c,m,p),Math.min(d,h,u,g),Math.max(o,c,m,p),Math.max(d,h,u,g)]}return t}},mF=(e,t=!1)=>{if(n_(e))return mq(e);if(nN(e))return o2.getElementAbsoluteCoords(e,t);if(nL(e)){let t=hG(e);if(nO(t)){let n=o2.getBoundTextElementPosition(t,e);return[n.x,n.y,n.x+e.width,n.y+e.height,n.x+e.width/2,n.y+e.height/2]}}return[e.x,e.y,e.x+e.width,e.y+e.height,e.x+e.width/2,e.y+e.height/2]},m$=e=>{let[t,n,i,l,r,a]=mF(e),s=[r,a];if(nN(e)||n_(e)){let t=[],n=0;for(;n<e.points.length-1;)t.push([un([e.points[n][0]+e.x,e.points[n][1]+e.y],s,e.angle),un([e.points[n+1][0]+e.x,e.points[n+1][1]+e.y],s,e.angle)]),n++;return t}let[o,d,c,h,m,u,p,g]=[[t,n],[i,n],[t,l],[i,l],[r,n],[r,l],[t,a],[i,a]].map(t=>un(t,s,e.angle));return"diamond"===e.type?[[m,p],[m,g],[u,p],[u,g]]:"ellipse"===e.type?[[m,p],[m,g],[u,p],[u,g],[m,p],[m,g],[u,p],[u,g]]:[[o,d],[c,h],[o,c],[d,h],[o,g],[c,g],[d,p],[h,p]]},mZ=e=>[e.x,e.y,e.x+e.width,e.y+e.height,e.x+e.width/2,e.y+e.height/2],mW=e=>{let t=Math.floor(e.width/2)+1,n=e.width,i=Math.floor(e.height/2)+1;return[t,0,n,i,t,e.height,0,i]},mU=e=>{for(let t of e.sets)if("path"===t.type)return t.ops;return e.sets[0].ops},mG=(e,t,n,i,l)=>{let r=1-e;return Math.pow(r,3)*t+3*Math.pow(r,2)*e*n+3*r*Math.pow(e,2)*i+Math.pow(e,3)*l},mV=(e,t,n,i)=>{let l=t-e,r=n-t,a=3*l-6*r+3*(i-n),s=6*r-6*l,o=3*l,d=s*s-4*a*o;if(!(d>=0))return!1;let c=null,h=null,m=1/0,u=1/0;return 0===a?m=u=-o/s:(m=(-s+Math.sqrt(d))/(2*a),u=(-s-Math.sqrt(d))/(2*a)),m>=0&&m<=1&&(c=mG(m,e,t,n,i)),u>=0&&u<=1&&(h=mG(u,e,t,n,i)),[c,h]},mK=(e,t,n,i)=>{let l=mV(e[0],t[0],n[0],i[0]),r=mV(e[1],t[1],n[1],i[1]),a=Math.min(e[0],i[0]),s=Math.max(e[0],i[0]);if(l){let e=l.filter(e=>null!==e);a=Math.min(a,...e),s=Math.max(s,...e)}let o=Math.min(e[1],i[1]),d=Math.max(e[1],i[1]);if(r){let e=r.filter(e=>null!==e);o=Math.min(o,...e),d=Math.max(d,...e)}return[a,o,s,d]},mY=(e,t)=>{let n=[0,0],{minX:i,minY:l,maxX:r,maxY:a}=e.reduce((e,{op:i,data:l})=>{if("move"===i)n=l;else if("bcurveTo"===i){let i=[l[0],l[1]],r=[l[2],l[3]],a=[l[4],l[5]],s=t?t(...i):i,o=t?t(...r):r,d=t?t(...a):a,c=t?t(...n):n;n=a;let[h,m,u,p]=mK(c,s,o,d);e.minX=Math.min(e.minX,h),e.minY=Math.min(e.minY,m),e.maxX=Math.max(e.maxX,u),e.maxY=Math.max(e.maxY,p)}return e},{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0});return[i,l,r,a]},mX=e=>{let t=1/0,n=1/0,i=-1/0,l=-1/0;for(let[r,a]of e)t=Math.min(t,r),n=Math.min(n,a),i=Math.max(i,r),l=Math.max(l,a);return[t,n,i,l]},mq=e=>{let[t,n,i,l]=mX(e.points),r=t+e.x,a=n+e.y,s=i+e.x,o=l+e.y;return[r,a,s,o,(r+s)/2,(a+o)/2]},mJ=e=>{switch(e){case"arrow":return 25;case"diamond":case"diamond_outline":return 12;default:return 15}},mQ=e=>{switch(e){case"bar":return 90;case"arrow":return 20;default:return 25}},m1=(e,t,n,i)=>{let l=mU(t[0]);if(l.length<1)return null;let r="start"===n?1:l.length-1,a=l[r].data,s=[a[4],a[5]],o=[a[2],a[3]],d=[a[0],a[1]],c=l[r-1],h=[0,0];"move"===c.op?h=c.data:"bcurveTo"===c.op&&(h=[c.data[4],c.data[5]]);let m=(e,t)=>Math.pow(1-e,3)*s[t]+3*e*Math.pow(1-e,2)*o[t]+3*Math.pow(e,2)*(1-e)*d[t]+h[t]*Math.pow(e,3),[u,p]="start"===n?h:s,[g,f]=[m(.3,0),m(.3,1)],x=Math.hypot(u-g,p-f),y=(u-g)/x,b=(p-f)/x,v=mJ(i),w=0;{let[t,i]="end"===n?e.points[e.points.length-1]:e.points[0],[l,r]=e.points.length>1?"end"===n?e.points[e.points.length-2]:e.points[1]:[0,0];w=Math.hypot(t-l,i-r)}let E=Math.min(v,w*("diamond"===i||"diamond_outline"===i?.25:.5)),S=u-y*E,k=p-b*E;if("dot"===i||"circle"===i||"circle_outline"===i){let t=Math.hypot(k-p,S-u)+e.strokeWidth-2;return[u,p,t]}let C=mQ(i),[I,M]=ut(S,k,u,p,-C*Math.PI/180),[j,T]=ut(S,k,u,p,C*Math.PI/180);if("diamond"===i||"diamond_outline"===i){let t,i;if("start"===n){let[n,l]=e.points.length>1?e.points[1]:[0,0];[t,i]=ut(u+2*E,p,u,p,Math.atan2(l-p,n-u))}else{let[n,l]=e.points.length>1?e.points[e.points.length-2]:[0,0];[t,i]=ut(u-2*E,p,u,p,Math.atan2(p-l,u-n))}return[u,p,I,M,t,i,j,T]}return[u,p,I,M,j,T]},m0=e=>{let t=tm.Z.generator(),n=m_(e);return t[e.roundness?"curve":n.fill?"polygon":"linearPath"](e.points,n)},m2=(e,t,n)=>{if(e.points.length<2){let[i,l]=e.points[0],[r,a]=ut(e.x+i,e.y+l,t,n,e.angle),s=[r,a,r,a],o=hU(e);if(o){let t=o2.getMinMaxXYWithBoundText(e,[r,a,r,a],o);s=[t[0],t[1],t[2],t[3]]}return s}let i=sK.get(e)?.[0]??m0(e),l=mU(i),r=mY(l,(i,l)=>ut(e.x+i,e.y+l,t,n,e.angle)),a=[r[0],r[1],r[2],r[3]],s=hU(e);if(s){let t=o2.getMinMaxXYWithBoundText(e,a,s);a=[t[0],t[1],t[2],t[3]]}return a},m3=e=>mB.getBounds(e),m6=e=>{if(!e.length)return[0,0,0,0];let t=1/0,n=-1/0,i=1/0,l=-1/0;return e.forEach(e=>{let[r,a,s,o]=m3(e);t=Math.min(t,r),i=Math.min(i,a),n=Math.max(n,s),l=Math.max(l,o)}),[t,i,n,l]},m4=(e,t)=>{let[n,i,l,r]=m6(e);return[n+t.x,i+t.y,l+t.x,r+t.y]},m5=(e,t,n,i)=>{if(!(nN(e)||n_(e)))return[e.x,e.y,e.x+t,e.y+n];let l=mH(0,t,mH(1,n,e.points,i),i),r;if(n_(e))r=mX(l);else{let t=tm.Z.generator(),n=e.roundness?t.curve(l,m_(e)):t.linearPath(l,m_(e)),i=mU(n);r=mY(i)}let[a,s,o,d]=r;return[a+e.x,s+e.y,o+e.x,d+e.y]},m8=(e,t)=>{let n=tm.Z.generator(),i=null==e.roundness?n.linearPath(t,m_(e)):n.curve(t,m_(e)),l=mU(i),[r,a,s,o]=mY(l);return[r+e.x,a+e.y,s+e.x,o+e.y]},m7=(e,t)=>{if(!e.length)return[0,0,0,0];let n=1/0,i=e[0];return e.forEach(e=>{let[l,r,a,s]=m3(e),o=ul((l+a)/2,(r+s)/2,t.x,t.y);o<n&&(n=o,i=e)}),m3(i)},m9=e=>{let[t,n,i,l]=m6(e);return{minX:t,minY:n,maxX:i,maxY:l,width:i-t,height:l-n,midX:(t+i)/2,midY:(n+l)/2}},ue=({scrollX:e,scrollY:t,width:n,height:i,zoom:l})=>[-e,-t,-e+n/l.value,-t+i/l.value]}),uJ=tC(()=>{tM(),tR(),uq(),dV(),ut=(e,t,n,i,l)=>[(e-n)*Math.cos(l)-(t-i)*Math.sin(l)+n,(e-n)*Math.sin(l)+(t-i)*Math.cos(l)+i],un=(e,t,n)=>ut(e[0],e[1],t[0],t[1],n),ui=(e,t,n,i,l,r,a,s)=>{let o=Math.cos(i),d=Math.sin(i);return e.e&&e.w?t+=l+a:e.e?(t+=l*(1+o),n+=l*d,t+=a*(1-o),n+=-(a*d)):e.w&&(t+=l*(1-o),n+=-(l*d),t+=a*(1+o),n+=a*d),e.n&&e.s?n+=r+s:e.n?(t+=r*d,n+=r*(1-o),t+=-(s*d),n+=s*(1+o)):e.s&&(t+=-(r*d),n+=r*(1+o),t+=s*d,n+=s*(1-o)),[t,n]},ul=(e,t,n,i)=>Math.hypot(n-e,i-t),ur=(e,t)=>[(e[0]+t[0])/2,(e[1]+t[1])/2],ua=(e,t=1)=>{if(e.length>=3){let[n,i]=[e[0],e[e.length-1]];return ul(n[0],n[1],i[0],i[1])<=et/t}return!1},us=(e,t,n)=>{let i=e.length;if(i<3)return!1;let l=[Number.MAX_SAFE_INTEGER,n],r=[t,n],a=0;for(let t=0;t<i;t++){let n=e[t],s=e[(t+1)%i];if(uc(n,s,r,l)){if(0===ud(n,r,s))return uo(n,r,s);a++}}return a%2==1},uo=(e,t,n)=>t[0]<=Math.max(e[0],n[0])&&t[0]>=Math.min(e[0],n[0])&&t[1]<=Math.max(e[1],n[1])&&t[1]>=Math.min(e[1],n[1]),ud=(e,t,n)=>{let i=(t[1]-e[1])*(n[0]-t[0])-(t[0]-e[0])*(n[1]-t[1]);return 0===i?0:i>0?1:2},uc=(e,t,n,i)=>{let l=ud(e,t,n),r=ud(e,t,i),a=ud(n,i,e),s=ud(n,i,t);return!!(l!==r&&a!==s||0===l&&uo(e,n,t)||0===r&&uo(e,i,t)||0===a&&uo(n,e,i)||0===s&&uo(n,t,i))},uh=(e,t,n)=>n?[Math.round(e/n)*n,Math.round(t/n)*n]:[e,t],um=(e,t)=>{if(t.roundness?.type===e5.PROPORTIONAL_RADIUS||t.roundness?.type===e5.LEGACY)return e*e6;if(t.roundness?.type===e5.ADAPTIVE_RADIUS){let n=t.roundness?.value??e4;return e<=n/e6?e*e6:n}return 0},uu=(e,t)=>{let n=sK.generateElementShape(e,null);if(!n)return null;let i=mU(n[0]),l=[0,0],r=0,a=1/0,s=null;for(;r<i.length;){let{op:e,data:n}=i[r];if("move"===e&&(l=n),"bcurveTo"===e){let e=l,i=[n[0],n[1]],r=[n[2],n[3]],o=[n[4],n[5]],d=ul(o[0],o[1],t[0],t[1]);d<a&&(a=d,s=[e,i,r,o]),l=o}r++}return s},up=(e,t,n,i,l)=>{let r=(l,r)=>Math.pow(1-l,3)*i[r]+3*l*Math.pow(1-l,2)*n[r]+3*Math.pow(l,2)*(1-l)*t[r]+e[r]*Math.pow(l,3);return[r(l,0),r(l,1)]},ug=(e,t)=>{let n=uu(e,t);if(!n)return[];let i=[],l=1;for(;l>0;){let e=up(n[0],n[1],n[2],n[3],l);i.push([e[0],e[1]]),l-=.05}return i.length&&ub(i.at(-1),t)&&i.push([t[0],t[1]]),i},uf=(e,t)=>{let n=[];n[0]=0;let i=ug(e,t),l=0,r=0;for(;l<i.length-1;)r+=ul(i[l][0],i[l][1],i[l+1][0],i[l+1][1]),n.push(r),l++;return n},ux=(e,t)=>uf(e,t).at(-1),uy=(e,t,n)=>{let i=uf(e,t),l=i.length-1,r=n*i.at(-1),a=0,s=l,o=0;for(;a<s;)i[o=Math.floor(a+(s-a)/2)]<r?a=o+1:s=o;return i[o]>r&&o--,i[o]===r?o/l:1-(o+(r-i[o])/(i[o+1]-i[o]))/l},ub=(e,t)=>e[0]===t[0]&&e[1]===t[1],uv=e=>Math.round(e/Math.PI*1e4)%5e3==0,uw=([e,t],[n,i])=>e<=n?t>=n:e>=n&&i>=e,uE=(e,t)=>{let n=Math.max(e[0],t[0]),i=Math.min(e[1],t[1]);return n<=i?[n,i]:null},uS=(e,t,n)=>e>=t&&e<=n}),uQ=tC(()=>{tM(),tR(),d_(),df(),uk=e=>{let t=e.extensions?.reduce((e,t)=>(e.push(eC[t]),e),[]),n=e.extensions?.reduce((e,t)=>"jpg"===t?e.concat(".jpg",".jpeg"):e.concat(`.${t}`),[]);return(0,tp.I$)({description:e.description,extensions:n,mimeTypes:t,multiple:e.multiple??!1,legacySetup:(t,n,i)=>{let l=tV(n,500),r=()=>{a(),document.addEventListener("keyup",l),document.addEventListener("pointerup",l),l()},a=()=>{i.files?.length&&t(e.multiple?[...i.files]:i.files[0])};requestAnimationFrame(()=>{window.addEventListener("focus",r)});let s=window.setInterval(()=>{a()},500);return e=>{clearInterval(s),l.cancel(),window.removeEventListener("focus",r),document.removeEventListener("keyup",l),document.removeEventListener("pointerup",l),e&&(console.warn("Opening the file was canceled (legacy-fs)."),e(new lH))}}})},uC=(e,t)=>(0,tp.NL)(e,{fileName:`${t.name}.${t.extension}`,description:t.description,extensions:[`.${t.extension}`]},t.fileHandle)}),u1=tC(()=>{tM(),fG(),dx(),dL(),tR(),dy(),dX(),fB(),df(),df(),ma(),dB(),uI={selection:!0,text:!0,rectangle:!0,diamond:!0,ellipse:!0,line:!0,image:!0,arrow:!0,freedraw:!0,eraser:!1,custom:!0,frame:!0,embeddable:!0,hand:!0,laser:!1,magicframe:!1},uM=e=>Object.keys(em).includes(e)?em[e]:eb,uj=e=>e?{...e,focus:e.focus||0}:null,uT=(e,t)=>{let n={type:t.type||e.type,version:e.version||1,versionNonce:e.versionNonce??0,isDeleted:e.isDeleted??!1,id:e.id||i9(),fillStyle:e.fillStyle||te.fillStyle,strokeWidth:e.strokeWidth||te.strokeWidth,strokeStyle:e.strokeStyle??te.strokeStyle,roughness:e.roughness??te.roughness,opacity:null==e.opacity?te.opacity:e.opacity,angle:e.angle||0,x:t.x??e.x??0,y:t.y??e.y??0,strokeColor:e.strokeColor||te.strokeColor,backgroundColor:e.backgroundColor||te.backgroundColor,width:e.width||0,height:e.height||0,seed:e.seed??1,groupIds:e.groupIds??[],frameId:e.frameId??null,roundness:e.roundness?e.roundness:"round"===e.strokeSharpness?{type:nG(e.type)?e5.LEGACY:e5.PROPORTIONAL_RADIUS}:null,boundElements:e.boundElementIds?e.boundElementIds.map(e=>({type:"arrow",id:e})):e.boundElements??[],updated:e.updated??nr(),link:e.link?aG(e.link):null,locked:e.locked??!1};return("customData"in e||"customData"in t)&&(n.customData="customData"in t?t.customData:e.customData),e8 in e&&(n[e8]=e[e8]),{...n,...g5(n),...t}},uL=(e,t=!1)=>{switch(e.type){case"text":let n=e.fontSize,i=e.fontFamily;if("font"in e){let[t,l]=e.font.split(" ");n=parseFloat(t),i=uM(l)}let l="string"==typeof e.text&&e.text||"",r=e.lineHeight||(e.height?hD(e):h5(e.fontFamily)),a=hL(e.text,tG(e),r);return e=uT(e,{fontSize:n,fontFamily:i,text:l,textAlign:e.textAlign||ev,verticalAlign:e.verticalAlign||ew,containerId:e.containerId??null,originalText:e.originalText||l,lineHeight:r,baseline:a}),l||e.isDeleted||(e={...e,originalText:l,isDeleted:!0},e=g0(e)),t&&(e={...e,...ld(e)}),e;case"freedraw":return uT(e,{points:e.points,lastCommittedPoint:null,simulatePressure:e.simulatePressure,pressures:e.pressures});case"image":return uT(e,{status:e.status||"pending",fileId:e.fileId,scale:e.scale||[1,1]});case"line":case"draw":case"arrow":{let{startArrowhead:t=null,endArrowhead:n="arrow"===e.type?"arrow":null}=e,i=e.x,l=e.y,r=!Array.isArray(e.points)||e.points.length<2?[[0,0],[e.width,e.height]]:e.points;return(0!==r[0][0]||0!==r[0][1])&&({points:r,x:i,y:l}=o2.getNormalizedPoints(e)),uT(e,{type:"draw"===e.type?"line":e.type,startBinding:uj(e.startBinding),endBinding:uj(e.endBinding),lastCommittedPoint:null,startArrowhead:t,endArrowhead:n,points:r,x:i,y:l})}case"ellipse":case"rectangle":case"diamond":case"iframe":case"embeddable":return uT(e,{});case"magicframe":case"frame":return uT(e,{name:e.name??null})}return null},uD=(e,t)=>{if(e.boundElements){let n=e.boundElements.slice(),i=new Set;e.boundElements=n.reduce((n,l)=>{let r=t.get(l.id);if(r&&!i.has(l.id)){if(i.add(l.id),r.isDeleted)return n;n.push(l),nL(r)&&!r.containerId&&(r.containerId=e.id)}return n},[])}},uA=(e,t)=>{let n=e.containerId?t.get(e.containerId):null;if(!n){e.containerId=null;return}if(!e.isDeleted&&n.boundElements&&!n.boundElements.find(t=>t.id===e.id)){let t=(n.boundElements||(n.boundElements=[])).slice();t.push({type:"text",id:e.id}),n.boundElements=t}},uP=(e,t)=>{e.frameId&&(t.get(e.frameId)||(e.frameId=null))},u_=(e,t,n)=>{let i=new Set,l=t?na(t):null,r=(e||[]).reduce((e,t)=>{if("selection"!==t.type&&!g2(t)){let r=uL(t,n?.refreshDimensions);if(r){let n=l?.get(t.id);n&&n.version>r.version&&(r=g0(r,n.version)),i.has(r.id)&&(r={...r,id:i9()}),i.add(r.id),e.push(r)}}return e},[]);if(!n?.repairBindings)return r;let a=na(r);for(let e of r)e.frameId&&uP(e,a),nL(e)&&e.containerId?uA(e,a):e.boundElements&&uD(e,a);return r},uR=(e,t,n)=>{let i=t[e];return void 0!==i?i:n[e]},uN={isSidebarDocked:(e,t)=>["defaultSidebarDockedPreference",e.isSidebarDocked??uR("defaultSidebarDockedPreference",e,t)]},uO=(e,t)=>{e=e||{};let n=nq(),i={};for(let t of Object.keys(uN))if(t in e){let[l,r]=uN[t](e,n);i[l]=r}for(let[l,r]of Object.entries(n)){let n=e[l],a=t?t[l]:void 0;i[l]=void 0!==n?n:void 0!==a?a:r}return{...i,cursorButton:t?.cursorButton||"up",penDetected:t?.penDetected??(!!e.penMode&&(e.penDetected??!1)),activeTool:{...t1(n,i.activeTool.type&&uI[i.activeTool.type]?i.activeTool:{type:"selection"}),lastActiveTool:null,locked:i.activeTool.locked??!1},zoom:"number"==typeof e.zoom?{value:e.zoom}:e.zoom?.value?e.zoom:n.zoom,openSidebar:"string"==typeof e.openSidebar?{name:tn.name}:i.openSidebar}},uz=(e,t,n,i)=>({elements:u_(e?.elements,n,i),appState:uO(e?.appState,t||null),files:e?.files||{}}),uH=e=>{let t=u_(fk(e.elements),null);return t.length?{...e,elements:t}:null},uB=(e=[],t)=>{let n=[];for(let i of e)if(Array.isArray(i)){let e=uH({status:t,elements:i,id:i9(),created:Date.now()});e&&n.push(e)}else{let e=uH({...i,id:i.id||i9(),status:i.status||t,created:i.created||Date.now()});e&&n.push(e)}return n}}),u0=tC(()=>{tM(),tR(),pW()}),u2=tC(()=>{tM(),u0(),uF=e=>new Promise((t,n)=>{let i=new Blob("string"==typeof e?[new TextEncoder().encode(e)]:[e instanceof Uint8Array?e:new Uint8Array(e)]),l=new FileReader;l.onload=e=>{if(!e.target||"string"!=typeof e.target.result)return n(Error("couldn't convert to byte string"));t(e.target.result)},l.readAsBinaryString(i)}),u$=e=>{let t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let t=0,i=e.length;t<i;t++)n[t]=e.charCodeAt(t);return t},uZ=e=>new TextDecoder("utf-8").decode(u$(e)),uW=async(e,t=!1)=>t?window.btoa(e):window.btoa(await uF(e)),uU=async(e,t=!1)=>t?window.atob(e):uZ(window.atob(e)),uG=async({text:e,compress:t})=>{let n;if(!1!==t)try{n=await uF((0,tg.deflate)(e))}catch(e){console.error("encode: cannot deflate",e)}return{version:"1",encoding:"bstring",compressed:!!n,encoded:n||await uF(e)}},uV=async e=>{let t;if("bstring"===e.encoding)t=e.compressed?e.encoded:await uZ(e.encoded);else throw Error(`decode: unknown encoding "${e.encoding}"`);return e.compressed?(0,tg.inflate)(new Uint8Array(u$(t)),{to:"string"}):t}}),u3={};tI(u3,{decodePngMetadata:()=>u5,decodeSvgMetadata:()=>u7,encodePngMetadata:()=>u4,encodeSvgMetadata:()=>u8,getTEXtChunk:()=>u6});var u6,u4,u5,u8,u7,u9,pe,pt,pn,pi,pl,pr,pa,ps,po,pd,pc,ph,pm,pu,pp,pg,pf,px,py,pb,pv,pw,pE,pS,pk,pC,pI,pM,pj,pT,pL,pD,pA,pP,p_,pR,pN,pO,pz,pH,pB,pF,p$,pZ=tC(()=>{tM(),u2(),tR(),pW(),u6=async e=>{let t=tf(new Uint8Array(await pv(e))).find(e=>"tEXt"===e.name);return t?tx.decode(t.data):null},u4=async({blob:e,metadata:t})=>{let n=tf(new Uint8Array(await pv(e))),i=tx.encode(eC.excalidraw,JSON.stringify(await uG({text:t,compress:!0})));return n.splice(-1,0,i),new Blob([ty(n)],{type:eC.png})},u5=async e=>{let t=await u6(e);if(t?.keyword===eC.excalidraw)try{let e=JSON.parse(t.text);if(!("encoded"in e)){if("type"in e&&e.type===eM.excalidraw)return t.text;throw Error("FAILED")}return await uV(e)}catch(e){throw console.error(e),Error("FAILED")}throw Error("INVALID")},u8=async({text:e})=>{let t=await uW(JSON.stringify(await uG({text:e})),!0);return`<!-- payload-type:${eC.excalidraw} --><!-- payload-version:2 --><!-- payload-start -->`+t+"<!-- payload-end -->"},u7=async({svg:e})=>{if(e.includes(`payload-type:${eC.excalidraw}`)){let t=e.match(/<!-- payload-start -->\s*(.+?)\s*<!-- payload-end -->/);if(!t)throw Error("INVALID");let n="1"!==(e.match(/<!-- payload-version:(\d+) -->/)?.[1]||"1");try{let e=await uU(t[1],n),i=JSON.parse(e);if(!("encoded"in i)){if("type"in i&&i.type===eM.excalidraw)return e;throw Error("FAILED")}return await uV(i)}catch(e){throw console.error(e),Error("FAILED")}}throw Error("INVALID")}}),pW=tC(()=>{tM(),dy(),tR(),fG(),d_(),tL(),fK(),df(),uQ(),pU(),u1(),u9=async e=>{let t;if(e.type===eC.png)try{return await (await Promise.resolve().then(()=>(pZ(),u3))).decodePngMetadata(e)}catch(e){throw"INVALID"===e.message?new lB(C("alerts.imageDoesNotContainScene"),"IMAGE_NOT_CONTAINS_SCENE_DATA"):new lB(C("alerts.cannotRestoreFromImage"))}else if(t="text"in Blob?await e.text():await new Promise(t=>{let n=new FileReader;n.readAsText(e,"utf8"),n.onloadend=()=>{n.readyState===FileReader.DONE&&t(n.result)}}),e.type===eC.svg)try{return await (await Promise.resolve().then(()=>(pZ(),u3))).decodeSvgMetadata({svg:t})}catch(e){throw"INVALID"===e.message?new lB(C("alerts.imageDoesNotContainScene"),"IMAGE_NOT_CONTAINS_SCENE_DATA"):new lB(C("alerts.cannotRestoreFromImage"))}return t},pe=e=>e&&e.name.match(/\.(json|excalidraw|png|svg)$/)?.[1]||null,pt=e=>"png"===e||"svg"===e,pn=e=>{let t=pe(e);return"png"===t||"svg"===t},pi=e=>{let{type:t}=e||{};return!!t&&Object.values(eS).includes(t)},pl=async(e,t,n,i)=>{let l=await u9(e),r;try{try{r=JSON.parse(l)}catch(t){throw pi(e)?new lB(C("alerts.imageDoesNotContainScene"),"IMAGE_NOT_CONTAINS_SCENE_DATA"):t}if(pC(r))return{type:eC.excalidraw,data:uz({elements:fj(r.elements||[]),appState:{theme:t?.theme,fileHandle:i||e.handle||null,...n1(r.appState||{}),...t?cH(r.elements||[],t):{}},files:r.files},t,n,{repairBindings:!0,refreshDimensions:!1})};if(pI(r))return{type:eC.excalidrawlib,data:r};throw Error(C("alerts.couldNotLoadInvalidFile"))}catch(e){throw e instanceof lB?e:Error(C("alerts.couldNotLoadInvalidFile"))}},pr=async(e,t,n,i)=>{let l=await pl(e,t,n,i);if(l.type!==eC.excalidraw)throw Error(C("alerts.couldNotLoadInvalidFile"));return l.data},pa=(e,t="unpublished")=>{let n=JSON.parse(e);if(!pI(n))throw Error("Invalid library");let i=n.libraryItems||n.library;return uB(i,t)},ps=async(e,t="unpublished")=>pa(await u9(e),t),po=async e=>new Promise(async(t,n)=>{try{nm(e)&&(e=await e),e.toBlob(e=>{if(!e)return n(new lz(C("canvasError.canvasTooBig"),"CANVAS_POSSIBLY_TOO_BIG"));t(e)})}catch(e){n(e)}}),pd=async e=>{try{let t=await window.crypto.subtle.digest("SHA-1",await pv(e));return nl(new Uint8Array(t))}catch(e){return console.error(e),(0,h.x0)(40)}},pc=async e=>new Promise((t,n)=>{let i=new FileReader;i.onload=()=>{t(i.result)},i.onerror=e=>n(e),i.readAsDataURL(e)}),ph=(e,t="")=>{let n=e.indexOf(","),i=atob(e.slice(n+1)),l=e.slice(0,n).split(":")[1].split(";")[0],r=new ArrayBuffer(i.length),a=new Uint8Array(r);for(let e=0;e<i.length;e++)a[e]=i.charCodeAt(e);return new File([r],t,{type:l})},pm=async(e,t)=>{if(e.type===eC.svg)return e;let[i,l]=await Promise.all([n.e(6373).then(n.t.bind(n,16373,19)).then(e=>e.default),n.e(434).then(n.bind(n,434)).then(e=>e.default)]),r=l({pica:i({features:["js","wasm"]})});if(t.outputType){let{outputType:e}=t;r._create_blob=function(t){return this.pica.toBlob(t.out_canvas,e,.8).then(e=>(t.out_blob=e,t))}}if(!pi(e))throw Error(C("errors.unsupportedFileType"));return new File([await r.toBlob(e,{max:t.maxWidthOrHeight})],e.name,{type:t.outputType||e.type})},pu=(e,t="")=>new File([new TextEncoder().encode(e)],t,{type:eC.svg}),pp=async(e,t="")=>{let n;try{n=await fetch(e)}catch{throw Error(C("errors.failedToFetchImage"))}if(!n.ok)throw Error(C("errors.failedToFetchImage"));let i=await n.blob();if(i.type&&pi(i)){let e=t||i.name||"";return new File([i],e,{type:i.type})}throw Error(C("errors.unsupportedFileType"))},pg=async e=>{let t=e.dataTransfer.files.item(0),n=await pf(e);return{file:t?await pb(t):null,fileHandle:n}},pf=async e=>{if(tp.Zh)try{return await e.dataTransfer.items[0].getAsFileSystemHandle()||null}catch(e){return console.warn(e.name,e.message),null}return null},px=e=>{let t=null,n=`${[...new Uint8Array(e).slice(0,8)].join(" ")} `,i={png:"137 80 78 71 13 10 26 10 ",jpg:"255 216 255 ",gif:"71 73 70 56 57 97 "};return n===i.png?t=eC.png:n.startsWith(i.jpg)?t=eC.jpg:n.startsWith(i.gif)&&(t=eC.gif),t},py=(e,t,n)=>new File([e],n||"",{type:t}),pb=async e=>{if(e.type){if(pi(e)){let t=await pv(e),n=px(t);n&&n!==e.type&&(e=py(t,n,e.name))}}else if(e?.name?.endsWith(".excalidrawlib"))e=py(await pv(e),eC.excalidrawlib,e.name);else if(e?.name?.endsWith(".excalidraw"))e=py(await pv(e),eC.excalidraw,e.name);else{let t=await pv(e),n=px(t);n&&(e=py(t,n,e.name))}return e},pv=e=>"arrayBuffer"in e?e.arrayBuffer():new Promise((t,n)=>{let i=new FileReader;i.onload=e=>{if(!e.target?.result)return n(Error("Couldn't convert blob to ArrayBuffer"));t(e.target.result)},i.readAsArrayBuffer(e)})}),pU=tC(()=>{tM(),uQ(),dy(),tR(),fG(),pW(),pw=(e,t)=>{let n={};for(let i of e)!i.isDeleted&&"fileId"in i&&i.fileId&&t[i.fileId]&&(n[i.fileId]=t[i.fileId]);return n},pE=(e,t,n,i)=>JSON.stringify({type:eM.excalidraw,version:eq.excalidraw,source:ej,elements:"local"===i?fj(e):fM(e),appState:"local"===i?n1(t):n0(t),files:"local"===i?pw(e,n):void 0},null,2),pS=async(e,t,n)=>{let i=pE(e,t,n,"local"),l=new Blob([i],{type:eC.excalidraw});return{fileHandle:await uC(l,{name:t.name,extension:"excalidraw",description:"Excalidraw file",fileHandle:pn(t.fileHandle)?null:t.fileHandle})}},pk=async(e,t)=>{let n=await uk({description:"Excalidraw files"});return pr(await pb(n),e,t,n.handle)},pC=e=>e?.type===eM.excalidraw&&(!e.elements||Array.isArray(e.elements)&&(!e.appState||"object"==typeof e.appState)),pI=e=>"object"==typeof e&&e&&e.type===eM.excalidrawLibrary&&(1===e.version||2===e.version),pM=e=>JSON.stringify({type:eM.excalidrawLibrary,version:eq.excalidrawLibrary,source:ej,libraryItems:e},null,2),pj=async e=>{let t=pM(e);await uC(new Blob([t],{type:eC.excalidrawlib}),{name:"library",extension:"excalidrawlib",description:"Excalidraw library file"})}}),pG=tC(()=>{tM(),tR(),tL(),dx(),pT=e=>new Promise((t,n)=>{let i=new Image;i.onload=()=>{t(i)},i.onerror=e=>{n(e)},i.src=e}),pL=async({fileIds:e,files:t,imageCache:n})=>{let i=new Map,l=new Map;return await Promise.all(e.reduce((e,r)=>{let a=t[r];return a&&!i.has(r)?(i.set(r,!0),e.concat((async()=>{try{if(a.mimeType===eC.binary)throw Error("Only images can be added to ImageCache");let e=pT(a.dataURL),t={image:e,mimeType:a.mimeType};n.set(r,t);let i=await e;n.set(r,{...t,image:i})}catch{l.set(r,!0)}})())):e},[])),{imageCache:n,updatedFiles:i,erroredFiles:l}},pD=e=>e.filter(e=>nC(e)),pA=e=>e?.nodeName.toLowerCase()==="svg",pP=async e=>{let t=new DOMParser().parseFromString(e,eC.svg),n=t.querySelector("svg");if(t.querySelector("parsererror")||!pA(n))throw Error(C("errors.invalidSVGString"));if(n.hasAttribute("xmlns")||n.setAttribute("xmlns",eX),!n.hasAttribute("width")||!n.hasAttribute("height")){let e=n.getAttribute("viewBox"),t=n.getAttribute("width")||"50",i=n.getAttribute("height")||"50";if(e){let n=e.match(/\d+ +\d+ +(\d+) +(\d+)/);n&&([,t,i]=n)}n.setAttribute("width",t),n.setAttribute("height",i)}return n.outerHTML}}),pV=tC(()=>{tM(),uq(),dU(),df(),tR(),dy(),pU(),pG(),gy(),fO(),fG(),fB(),fH(),dx(),p_=e=>{let t=new gJ;return t.replaceAllElements(nv(e),!1),t},pR=(e,t)=>{if(e.width<=t)return e;let n=document.createElement("canvas").getContext("2d");n.font=tG({fontFamily:e.fontFamily,fontSize:e.fontSize});let i=e.text;if(n.measureText(i).width>t)for(let e=i.length;e>0;e--){let l=`${i.slice(0,e)}...`;if(n.measureText(l).width<=t){i=l;break}}return g1(e,{text:i,width:t})},pN=(e,t)=>{let n=[],i=0,l=0;for(let r of e){if(nP(r)){nD(r)?i++:l++;let e=ls({x:r.x,y:r.y-eg.nameOffsetY,fontFamily:em.Assistant,fontSize:eg.nameFontSize,lineHeight:eg.nameLineHeight,strokeColor:t.exportWithDarkMode?eg.nameColorDarkTheme:eg.nameColorLightTheme,text:gF(r,nD(r)?i:l)});e.y-=e.height,e=pR(e,r.width),n.push(e)}n.push(r)}return n},pO=(e,t)=>(t=t||nq().frameRendering,{enabled:!!e||t.enabled,outline:!e&&t.outline,name:!e&&t.name,clip:!!e||t.clip}),pz=({elements:e,exportingFrame:t,frameRendering:n,exportWithDarkMode:i})=>t?p8({elements:e,bounds:t,type:"overlap"}):n.enabled&&n.name?pN(e,{exportWithDarkMode:i}):e,pH=async(e,t,n,{exportBackground:i,exportPadding:l=eV,viewBackgroundColor:r,exportingFrame:a},s=(e,n)=>{let i=document.createElement("canvas");return i.width=e*t.exportScale,i.height=n*t.exportScale,{canvas:i,scale:t.exportScale}})=>{let o=p_(e);e=o.getNonDeletedElements();let d=pO(a??null,t.frameRendering??null),c=pz({elements:e,exportingFrame:a,exportWithDarkMode:t.exportWithDarkMode,frameRendering:d});a&&(l=0);let[h,m,u,p]=pF(a?[a]:gT(c),l),{canvas:g,scale:f=1}=s(u,p),x=nq(),{imageCache:y}=await pL({imageCache:new Map,fileIds:pD(c).map(e=>e.fileId),files:n});return sI({canvas:g,rc:tm.Z.canvas(g),elements:c,visibleElements:c,scale:f,appState:{...t,frameRendering:d,viewBackgroundColor:i?r:null,scrollX:-h+l,scrollY:-m+l,zoom:x.zoom,shouldCacheIgnoreZoom:!1,theme:t.exportWithDarkMode?"dark":"light"},renderConfig:{canvasBackgroundColor:r,imageCache:y,renderGrid:!1,isExporting:!0,embedsValidationStatus:new Map,elementsPendingErasure:new Set}}),o.destroy(),g},pB=async(e,t,n,i)=>{let l=p_(e);e=l.getNonDeletedElements();let r=pO(i?.exportingFrame??null,t.frameRendering??null),{exportPadding:a=eV,exportWithDarkMode:s=!1,viewBackgroundColor:o,exportScale:d=1,exportEmbedScene:c}=t,{exportingFrame:h=null}=i||{},m=pz({elements:e,exportingFrame:h,exportWithDarkMode:s,frameRendering:r});h&&(a=0);let p="";if(c)try{p=await (await Promise.resolve().then(()=>(pZ(),u3))).encodeSvgMetadata({text:pE(e,t,n||{},"local")})}catch(e){console.error(e)}let[g,f,x,y]=pF(h?[h]:gT(m),a),b=document.createElementNS(eX,"svg");b.setAttribute("version","1.1"),b.setAttribute("xmlns",eX),b.setAttribute("viewBox",`0 0 ${x} ${y}`),b.setAttribute("width",`${x*d}`),b.setAttribute("height",`${y*d}`),s&&b.setAttribute("filter",eN);let v="https://excalidraw.com/";u.VITE_IS_EXCALIDRAW_NPM_PACKAGE&&(v=window.EXCALIDRAW_ASSET_PATH||`https://unpkg.com/${u.VITE_PKG_NAME}@${u.PKG_VERSION}`,v?.startsWith("/")&&(v=v.replace("/",`${window.location.origin}/`)),v=`${v}/dist/excalidraw-assets/`);let w=-g+a,E=-f+a,S=gj(e),k="";for(let e of S){let[t,n,i,l]=mF(e),r=(i-t)/2-(e.x-t),a=(l-n)/2-(e.y-n);k+=`<clipPath id=${e.id}>
            <rect transform="translate(${e.x+w} ${e.y+E}) rotate(${e.angle} ${r} ${a})"
          width="${e.width}"
          height="${e.height}"
          >
          </rect>
        </clipPath>`}if(b.innerHTML=`
  <!-- svg-source:excalidraw -->
  ${p}
  <defs>
    <style class="style-fonts">
      @font-face {
        font-family: "Virgil";
        src: url("https://unpkg.com/@excalidraw/excalidraw@0.17.0/dist/excalidraw-assets/Virgil.woff2");
      }
      @font-face {
        font-family: "Cascadia";
        src: url("https://unpkg.com/@excalidraw/excalidraw@0.17.0/dist/excalidraw-assets/Cascadia.woff2");
      }
      @font-face {
        font-family: "YaoSuiXinShouXieTi";
        src: url("https://heap-web.oss-cn-hangzhou.aliyuncs.com/fonts/YaoSuiXinShouXieTi-2.woff2");
        font-display: swap;
        unicode-range: U+4E00-9FFF;
      }
      @font-face {
        font-family: "Assistant";
        src: url("https://unpkg.com/@excalidraw/excalidraw@0.17.0/dist/excalidraw-assets/Assistant-Regular.woff2");
      }
    </style>
    ${k}
  </defs>
  `,t.exportBackground&&o){let e=b.ownerDocument.createElementNS(eX,"rect");e.setAttribute("x","0"),e.setAttribute("y","0"),e.setAttribute("width",`${x}`),e.setAttribute("height",`${y}`),e.setAttribute("fill",o),b.appendChild(e)}let C=tm.Z.svg(b),I=i?.renderEmbeddables??!1;return sO(m,C,b,n||{},{offsetX:w,offsetY:E,isExporting:!0,exportWithDarkMode:s,renderEmbeddables:I,frameRendering:r,canvasBackgroundColor:o,embedsValidationStatus:I?new Map(m.filter(e=>nP(e)).map(e=>[e.id,!0])):new Map}),l.destroy(),b},pF=(e,t)=>{let[n,i,l,r]=m6(e),a=tQ(n,l)+2*t,s=tQ(i,r)+2*t;return[n,i,a,s]},p$=(e,t,n)=>{let[,,i,l]=pF(e,t).map(e=>Math.trunc(e*n));return[i,l]}});function pK(e){return[Math.min(e[0][0],e[1][0]),Math.min(e[0][1],e[1][1]),Math.max(e[0][0],e[1][0]),Math.max(e[0][1],e[1][1])]}function pY(e,t){return e[0]*t[1]-t[0]*e[1]}function pX(e,t){return[e[0]-t[0],e[1]-t[1]]}function pq(e,t){return Math.abs(pY(pX(e[1],e[0]),pX(t,e[0])))<p1}function pJ(e,t){return 0>pY(pX(e[1],e[0]),pX(t,e[0]))}function pQ(e,t){return pq(e,t[0])||pq(e,t[1])||(pJ(e,t[0])?!pJ(e,t[1]):pJ(e,t[1]))}var p1,p0,p2,p3,p6,p4,p5,p8,p7,p9,ge,gt,gn,gi,gl,gr,ga,gs,go,gd,gc,gh,gm,gu,gp=tC(()=>{tM(),p1=1e-6}),gg=tC(()=>{tM(),dx(),uJ(),uq(),p0=e=>"diamond"===e.type?[[e.width/2,0],[e.width,e.height/2],[e.width/2,e.height],[0,e.height/2]]:[[0,0],[0+e.width,0],[0+e.width,e.height],[0,e.height]],p2=e=>nN(e)||n_(e)?e.points:p0(e),p3=e=>{let t=e.reduce((e,[t,n])=>(e.minY=Math.min(e.minY,n),e.minX=Math.min(e.minX,t),e.maxX=Math.max(e.maxX,t),e.maxY=Math.max(e.maxY,n),e),{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0,cx:0,cy:0});return t.cx=(t.maxX+t.minX)/2,t.cy=(t.maxY+t.minY)/2,t},p6=e=>{let t=p2(e),{cx:n,cy:i}=p3(t),l=[n,i],{minX:r,minY:a,maxX:s,maxY:o}=p3(t.map(t=>un([t[0],t[1]],l,e.angle)));return[r+e.x,a+e.y,s+e.x,o+e.y]},p4=(e,t,n=!1)=>{let i=p6(e),l=t[0]<=i[0]&&t[2]>=i[2]&&t[1]<=i[1]&&t[3]>=i[3];return n?!!l||i[0]<=t[0]&&i[2]>=t[2]&&i[1]<=t[1]&&i[3]>=t[3]:l},p5=(e,t)=>{let n=p6(e);return(uS(n[0],t[0],t[2])||uS(t[0],n[0],n[2]))&&(uS(n[1],t[1],t[3])||uS(t[1],n[1],n[3]))},p8=({elements:e,bounds:t,type:n,errorMargin:i=0})=>{nZ(t)&&(t=m3(t));let l=[t[0]-i,t[1]-i,t[2]+i,t[3]+i],r=new Set;for(let t of e)if(!r.has(t.id)&&("overlap"===n?p5(t,l):"inside"===n?p4(t,l):p4(t,l,!0))){if(r.add(t.id),t.boundElements)for(let e of t.boundElements)r.add(e.id);nL(t)&&t.containerId&&r.add(t.containerId),nO(t)&&(t.startBinding&&r.add(t.startBinding.elementId),t.endBinding&&r.add(t.endBinding?.elementId))}return e.filter(e=>r.has(e.id))}}),gf=tC(()=>{tM(),t_(),tj(),gy(),p7=(0,i.cn)(new Map),p9=async e=>await gm({elements:e,appState:{exportBackground:!1,viewBackgroundColor:z.white},files:null,renderEmbeddables:!1}),ge=(e,t,n)=>{let[i,r]=(0,l.useState)();return(0,l.useEffect)(()=>{if(t){if(e){let i=n.get(e);i?r(i):(async()=>{let i=await p9(t);i.querySelector(".style-fonts")?.remove(),i&&(n.set(e,i),r(i))})()}else(async()=>{r(await p9(t))})()}},[e,t,n,r]),i},gt=()=>{let[e]=(0,i.KO)(p7,p);return{clearLibraryCache:()=>e.clear(),deleteItemsFromLibraryCache:t=>{t.forEach(t=>e.delete(t))},svgCache:e}}}),gx=tC(()=>{tM(),pW(),u1(),tj(),uq(),d_(),tL(),tR(),gf(),df(),gn=(0,i.cn)({status:"loaded",isInitialized:!0,libraryItems:[]}),gi=e=>nv(e),gl=(e,t)=>!e.find(e=>e.elements.length===t.elements.length&&e.elements.every((e,n)=>e.id===t.elements[n].id&&e.versionNonce===t.elements[n].versionNonce)),gr=(e,t)=>{let n=[];for(let i of t)gl(e,i)&&n.push(i);return[...n,...e]},ga=class{lastLibraryItems=[];isInitialized=!1;app;constructor(e){this.app=e}updateQueue=[];getLastUpdateTask=()=>this.updateQueue[this.updateQueue.length-1];notifyListeners=()=>{if(this.updateQueue.length>0)g.set(gn,{status:"loading",libraryItems:this.lastLibraryItems,isInitialized:this.isInitialized});else{this.isInitialized=!0,g.set(gn,{status:"loaded",libraryItems:this.lastLibraryItems,isInitialized:this.isInitialized});try{this.app.props.onLibraryChange?.(gi(this.lastLibraryItems))}catch(e){console.error(e)}}};destroy=()=>{this.isInitialized=!1,this.updateQueue=[],this.lastLibraryItems=[],g.set(p7,new Map)};resetLibrary=()=>this.setLibrary([]);getLatestLibrary=()=>new Promise(async e=>{try{let t=await (this.getLastUpdateTask()||this.lastLibraryItems);e(this.updateQueue.length>0?this.getLatestLibrary():gi(t))}catch{return e(this.lastLibraryItems)}});updateLibrary=async({libraryItems:e,prompt:t=!1,merge:n=!1,openLibraryMenu:i=!1,defaultStatus:l="unpublished"})=>(i&&this.app.setState({openSidebar:{name:tn.name,tab:tt}}),this.setLibrary(()=>new Promise(async(i,r)=>{try{let a=await ("function"!=typeof e||e instanceof Blob?e:e(this.lastLibraryItems)),s;s=a instanceof Blob?await ps(a,l):uB(a,l),!t||window.confirm(C("alerts.confirmAddLibrary",{numShapes:s.length}))?(t&&this.app.focusContainer(),i(n?gr(this.lastLibraryItems,s):s)):r(new lH)}catch(e){r(e)}})));setLibrary=e=>{let t=new Promise(async(t,n)=>{try{await this.getLastUpdateTask(),"function"==typeof e&&(e=e(this.lastLibraryItems)),this.lastLibraryItems=gi(await e),t(this.lastLibraryItems)}catch(e){n(e)}}).catch(e=>{if("AbortError"===e.name)return console.warn("Library update aborted by user"),this.lastLibraryItems;throw e}).finally(()=>{this.updateQueue=this.updateQueue.filter(e=>e!==t),this.notifyListeners()});return this.updateQueue.push(t),this.notifyListeners(),t}},gs=e=>{let t=Math.ceil(Math.sqrt(e.length)),n=[],i=n=>e.slice(n*t,n*t+t).reduce((e,t)=>{let{height:n}=m9(t.elements);return Math.max(e,n)},0),l=n=>{let i=0,l=0,r=0;for(let a of e){if(i%t==0&&(l=0),l===n){let{width:e}=m9(a.elements);r=Math.max(r,e)}i++,l++}return r},r=0,a=0,s=0,o=0,d=0,c=0,h=0;for(let m of e){d&&d%t==0&&(a+=s+50,r=0,c=0,h++),0===c&&(s=i(h)),o=l(c);let{minX:e,minY:u,width:p,height:g}=m9(m.elements),f=(o-p)/2,x=(s-g)/2;n.push(...m.elements.map(t=>({...t,x:t.x+r+f-e,y:t.y+a+x-u}))),r+=o+50,d++,c++}return n},go=()=>{let e=new URLSearchParams(window.location.hash.slice(1)).get(ez.addLibrary)||new URLSearchParams(window.location.search).get(eO.addLibrary),t=e?new URLSearchParams(window.location.hash.slice(1)).get("token"):null;return e?{libraryUrl:e,idToken:t}:null},gd=({excalidrawAPI:e,getInitialLibraryItems:t})=>{let n=(0,l.useRef)(t);(0,l.useEffect)(()=>{if(!e)return;let t=async({libraryUrl:t,idToken:n})=>{let i=new Promise(async(e,n)=>{try{let n=await (await fetch(decodeURIComponent(t))).blob();e(n)}catch(e){n(e)}}),l=n!==e.id;await (l&&document.hidden?new Promise(e=>{window.addEventListener("focus",()=>e(),{once:!0})}):null);try{await e.updateLibrary({libraryItems:i,prompt:l,merge:!0,defaultStatus:"published",openLibraryMenu:!0})}catch(e){throw e}finally{if(window.location.hash.includes(ez.addLibrary)){let e=new URLSearchParams(window.location.hash.slice(1));e.delete(ez.addLibrary),window.history.replaceState({},Q,`#${e.toString()}`)}else if(window.location.search.includes(eO.addLibrary)){let e=new URLSearchParams(window.location.search);e.delete(eO.addLibrary),window.history.replaceState({},Q,`?${e.toString()}`)}}},i=e=>{e.preventDefault();let n=go();n&&(e.stopImmediatePropagation(),window.history.replaceState({},"",e.oldURL),t(n))};n.current&&e.updateLibrary({libraryItems:n.current()});let l=go();return l&&t(l),window.addEventListener("hashchange",i),()=>{window.removeEventListener("hashchange",i)}},[e])}}),gy=tC(()=>{tM(),pV(),dy(),u1(),tR(),pZ(),pU(),ml(),gp(),gg(),pU(),pW(),uK(),gx(),gc=({elements:e,appState:t,files:n,maxWidthOrHeight:i,getDimensions:l,exportPadding:r,exportingFrame:a})=>{let{elements:s,appState:o}=uz({elements:e,appState:t},null,null),{exportBackground:d,viewBackgroundColor:c}=o;return pH(s,{...o,offsetTop:0,offsetLeft:0,width:0,height:0},n||{},{exportBackground:d,exportPadding:r,viewBackgroundColor:c,exportingFrame:a},(e,n)=>{let r=document.createElement("canvas");if(i){"function"==typeof l&&console.warn("`getDimensions()` is ignored when `maxWidthOrHeight` is supplied.");let a=Math.max(e,n),s=i<a?i/a:t?.exportScale??1;return r.width=e*s,r.height=n*s,{canvas:r,scale:s}}let a=l?.(e,n)||{width:e,height:n};return r.width=a.width,r.height=a.height,{canvas:r,scale:a.scale??1}})},gh=async e=>{let{mimeType:t=eC.png,quality:n}=e;t===eC.png&&"number"==typeof n&&console.warn(`"quality" will be ignored for "${eC.png}" mimeType`),"image/jpg"===t&&(t=eC.jpg),t!==eC.jpg||e.appState?.exportBackground||(console.warn(`Defaulting "exportBackground" to "true" for "${eC.jpg}" mimeType`),e={...e,appState:{...e.appState,exportBackground:!0}});let i=await gc(e);return n=n||(/image\/jpe?g/.test(t)?.92:.8),new Promise((l,r)=>{i.toBlob(async n=>{if(!n)return r(Error("couldn't export to blob"));n&&t===eC.png&&e.appState?.exportEmbedScene&&(n=await u4({blob:n,metadata:pE(e.elements,e.appState,e.files||{},"local")})),l(n)},t,n)})},gm=async({elements:e,appState:t=nq(),files:n={},exportPadding:i,renderEmbeddables:l,exportingFrame:r})=>{let{elements:a,appState:s}=uz({elements:e,appState:t},null,null),o={...s,exportPadding:i};return pB(a,o,n,{exportingFrame:r,renderEmbeddables:l})},gu=async e=>{if("svg"===e.type){let t=await gm(e);await hg(t.outerHTML)}else if("png"===e.type)await hp(gh(e));else if("json"===e.type)await ho(e.elements,e.files);else throw Error("Invalid export type")}});function gb(e,t){let n=m$(t),i=m$(e);return n.some(e=>i.some(t=>{var n,i;return n=pK(e),i=pK(t),n[0]<=i[2]&&n[2]>=i[0]&&n[1]<=i[3]&&n[3]>=i[1]&&pQ(e,t)&&pQ(t,e)}))}var gv,gw,gE,gS,gk,gC,gI,gM,gj,gT,gL,gD,gA,gP,g_,gR,gN,gO,gz,gH,gB,gF,g$,gZ,gW,gU,gG,gV,gK,gY,gX,gq,gJ,gQ,g1,g0,g2,g3,g6,g4,g5,g8,g7,g9,fe,ft,fn,fi,fl,fr,fa,fs,fo,fd,fc,fh,fm,fu,fp,fg,ff,fx,fy,fb,fv,fw,fE,fS,fk,fC,fI,fM,fj,fT,fL,fD,fA,fP,f_,fR,fN,fO=tC(()=>{tM(),fG(),uJ(),ma(),df(),fB(),fK(),dI(),fH(),uq(),gy(),dx(),gv=(e,t,n)=>{let i=na(e);for(let e of t)if(e.frameId){let t=n.get(e.id),l=n.get(e.frameId);if(t){let n=i.get(t);n&&gQ(n,{frameId:l??e.frameId},!1)}}},gw=(e,t)=>gz(gZ(e,t,!1)).filter(e=>!nP(e)&&!e.frameId||e.frameId===t.id),gE=(e,t,n)=>gZ(e,t).some(e=>e.id===n.id),gS=(e,t)=>{let[n,i,l,r]=mF(t),[a,s,o,d]=m6(e);return n<=a&&i<=s&&l>=o&&r>=d},gk=(e,t)=>gS([e],t)||gb(e,t)||gE([t],e,t),gC=(e,t)=>{let[n,i,l,r]=mF(t);return uo([n,i],[e.x,e.y],[l,r])},gI=e=>{let t=new Map;for(let n of e){let i=nP(n)?n.id:n.frameId;i&&!t.has(i)&&t.set(i,gM(e,i))}return t},gM=(e,t)=>e.filter(e=>e.frameId===t),gj=e=>e.filter(e=>nP(e)),gT=e=>{let t=na(gj(e));return e.filter(e=>t.has(e.id)||!e.frameId||!t.has(e.frameId))},gL=(e,t,n)=>{let i=gM(e,t.id),l=new Set(i),r=new Set([...gw(e,t),...i.filter(n=>gE(e,n,t))]),a=i.filter(e=>!r.has(e)),s=new Set(Array.from(r).flatMap(e=>e.groupIds));for(let e of a)if(gb(e,t)){if(e.groupIds.length>0)for(let t of e.groupIds)s.add(t)}else 0===e.groupIds.length&&l.delete(e);for(let e of a)if(e.groupIds.length>0){let t=!0;for(let n of e.groupIds)s.has(n)&&(t=!1);t&&l.delete(e)}for(let e of Array.from(r).filter(e=>0===e.groupIds.length))l.add(e);let o=Array.from(r).filter(e=>e.groupIds.length>0);for(let[i,r]of Object.entries(iH(o,n)))if(r){let n=i$(e,i);if(gS(n,t))for(let e of n)l.add(e)}return[...l].filter(e=>!(nL(e)&&e.containerId))},gD=(e,t)=>gz(e,gw(e,t)),gA=(e,t)=>e.frameId?t?t.get(e.frameId)||null:gJ.getScene(e)?.getElement(e.frameId)||null:null,gP=(e,t,n)=>{let{currTargetFrameChildrenMap:i}=e.reduce((e,t,i)=>(t.frameId===n.id&&e.currTargetFrameChildrenMap.set(t.id,!0),e),{currTargetFrameChildrenMap:new Map}),l=new Set(t.map(e=>e.id)),r=[];for(let n of gz(e,t)){i.has(n.id)||r.push(n);let e=hU(n);!e||l.has(e.id)||i.has(e.id)||r.push(e)}for(let e of r)gQ(e,{frameId:n.id},!1);return e.slice()},g_=(e,t,n)=>{let i=new Map,l=new Map;for(let e of t)if(e.frameId){i.set(e.id,e);let t=l.get(e.frameId)||[];t.push(e);let n=hU(e);n&&(i.set(n.id,n),t.push(n)),l.set(e.frameId,t)}for(let[,e]of i)gQ(e,{frameId:null},!1);return e.slice()},gR=(e,t,n)=>{let i=gM(e,t.id);return g_(e,i,n)},gN=(e,t,n,i)=>gP(gR(e,n,i),t,n),gO=(e,t,n)=>{let i=n.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,elements:e}),l=new Set(i);if(t.editingGroupId)for(let t of i)0===t.groupIds.length?l.add(t):t.groupIds.flatMap(t=>i$(e,t)).forEach(e=>l.add(e));let r=new Set;return l.forEach(n=>{!n.frameId||nP(n)||gB(n,e,t)||r.add(n)}),r.size>0?g_(e,[...r],t):e},gz=(e,t)=>{let n=new Set;for(let i of t||e){let e=i.groupIds[i.groupIds.length-1];e&&n.add(e)}let i=new Set;for(let t of n)i$(e,t).some(e=>nP(e))&&i.add(t);return(t||e).filter(e=>!i.has(e.groupIds[e.groupIds.length-1]))},gH=(e,t)=>{let n=nL(e)&&hG(e)||e;return t.selectedElementIds[n.id]&&t.selectedElementsAreBeingDragged?t.frameToHighlight:gA(n)},gB=(e,t,n)=>{let i=gH(e,n),l=nL(e)&&hG(e)||e;if(i){if(!n.selectedElementIds[e.id]||!n.selectedElementsAreBeingDragged)return!0;if(0===l.groupIds.length)return gk(l,i);let r=new Set(l.groupIds.flatMap(e=>i$(t,e)));if(n.editingGroupId&&n.selectedElementsAreBeingDragged){let e=new Set(gV(t,n));if(null!==n.frameToHighlight)return!0;e.forEach(e=>{r.delete(e)})}for(let e of r)if(nP(e))return!1;for(let e of r)if(gk(e,i))return!0}return!1},gF=(e,t)=>e.name?.trim()||(nD(e)?`Frame ${t}`:`AI Frame ${t}`)}),fz=tC(()=>{let e,t,n,i;tM(),fG(),dx(),fO(),df(),fF(),g$=e=>{let t=new Set;return e.forEach(e=>{nP(e)&&t.add(e.id)}),e.filter(e=>!(e.frameId&&t.has(e.frameId)))},gZ=(e,t,n=!0)=>{let[i,l,r,a]=mF(t),s=e.filter(e=>{let[t,n,s,o]=m3(e),d=gA(e);if(d){let[e,i,l,r]=m3(d);t=Math.max(e,t),n=Math.max(i,n),s=Math.min(l,s),o=Math.min(r,o)}return!1===e.locked&&"selection"!==e.type&&!nU(e)&&i<=t&&l<=n&&r>=s&&a>=o});return(s=n?g$(s):s).filter(e=>{let t=gA(e);return!t||gk(e,t)})},gW=(e,t,n)=>{let i=new Set(t.map(e=>e.id));return e.filter(e=>{let t=g3(e,n.width,n.height,n);return!i.has(e.id)&&t})},e=null,t=null,n=null,(i=(i,l)=>(null!=n&&i===e&&l.selectedElementIds===t||(n=i.some(e=>l.selectedElementIds[e.id]),e=i,t=l.selectedElementIds),n)).clearCache=()=>{e=null,t=null,n=null},gU=i,gG=(e,t,n)=>{let i=Array.from(new Set(gV(e,t).map(e=>n(e))));return 1===i.length?i[0]:null},gV=(e,t,n)=>{let i=e.filter(e=>t.selectedElementIds[e.id]||n?.includeBoundTextElement&&nU(e)&&t.selectedElementIds[e?.containerId]?e:null);if(n?.includeElementsInFrames){let t=[];return i.forEach(n=>{nP(n)&&gM(e,n.id).forEach(e=>t.push(e)),t.push(n)}),t}return i},gK=(e,t)=>t.editingElement?[t.editingElement]:gV(e,t,{includeBoundTextElement:!0}),gY=(e,t)=>ng(t.selectedElementIds,e)?t.selectedElementIds:e}),fH=tC(()=>{tM(),fG(),dx(),fz(),dL(),gX=e=>{let t="";for(let n of["includeBoundTextElement","includeElementsInFrames"])t+=`${n}:${e[n]?"1":"0"}`;return t},gq=e=>"string"==typeof e,gJ=class e{static sceneMapByElement=new WeakMap;static sceneMapById=new Map;static mapElementToScene(e,t,n=!0){gq(e)?n&&this.sceneMapById.set(e,t):(this.sceneMapByElement.set(e,t),n||this.sceneMapById.set(e.id,t))}static getScene(e){return gq(e)?this.sceneMapById.get(e)||null:this.sceneMapByElement.get(e)||null}callbacks=new Set;nonDeletedElements=[];elements=[];nonDeletedFramesLikes=[];frames=[];elementsMap=new Map;selectedElementsCache={selectedElementIds:null,elements:null,cache:new Map};versionNonce;getElementsIncludingDeleted(){return this.elements}getNonDeletedElements(){return this.nonDeletedElements}getFramesIncludingDeleted(){return this.frames}getSelectedElements(e){let t=gX(e),n=e?.elements||this.nonDeletedElements;if(this.selectedElementsCache.elements===n&&this.selectedElementsCache.selectedElementIds===e.selectedElementIds){let e=this.selectedElementsCache.cache.get(t);if(e)return e}else e?.elements==null&&this.selectedElementsCache.cache.clear();let i=gV(n,{selectedElementIds:e.selectedElementIds},e);return e?.elements==null&&(this.selectedElementsCache.selectedElementIds=e.selectedElementIds,this.selectedElementsCache.elements=this.nonDeletedElements,this.selectedElementsCache.cache.set(t,i)),i}getNonDeletedFramesLikes(){return this.nonDeletedFramesLikes}getElement(e){return this.elementsMap.get(e)||null}getVersionNonce(){return this.versionNonce}getNonDeletedElement(e){let t=this.getElement(e);return t&&fC(t)?t:null}mapElements(e){let t=!1,n=this.elements.map(n=>{let i=e(n);return i!==n&&(t=!0),i});return t&&this.replaceAllElements(n),t}replaceAllElements(t,n=!0){this.elements=t;let i=[];this.elementsMap.clear(),t.forEach(t=>{nP(t)&&i.push(t),this.elementsMap.set(t.id,t),e.mapElementToScene(t,this)}),this.nonDeletedElements=fk(this.elements),this.frames=i,this.nonDeletedFramesLikes=fk(this.frames),this.informMutation()}informMutation(){for(let e of(this.versionNonce=i7(),Array.from(this.callbacks)))e()}addCallback(e){if(this.callbacks.has(e))throw Error();return this.callbacks.add(e),()=>{if(!this.callbacks.has(e))throw Error();this.callbacks.delete(e)}}destroy(){this.nonDeletedElements=[],this.elements=[],this.nonDeletedFramesLikes=[],this.frames=[],this.elementsMap.clear(),this.selectedElementsCache.selectedElementIds=null,this.selectedElementsCache.elements=null,this.selectedElementsCache.cache.clear(),e.sceneMapById.forEach((t,n)=>{t===this&&e.sceneMapById.delete(n)}),this.callbacks.clear()}insertElementAtIndex(e,t){if(!Number.isFinite(t)||t<0)throw Error("insertElementAtIndex can only be called with index >= 0");let n=[...this.elements.slice(0,t),e,...this.elements.slice(t)];this.replaceAllElements(n)}insertElementsAtIndex(e,t){if(!Number.isFinite(t)||t<0)throw Error("insertElementAtIndex can only be called with index >= 0");let n=[...this.elements.slice(0,t),...e,...this.elements.slice(t)];this.replaceAllElements(n)}addNewElement=e=>{e.frameId?this.insertElementAtIndex(e,this.getElementIndex(e.frameId)):this.replaceAllElements([...this.elements,e])};getElementIndex(e){return this.elements.findIndex(t=>t.id===e)}}}),fB=tC(()=>{tM(),fH(),uX(),dL(),df(),dV(),gQ=(e,t,n=!0)=>{let i=!1,{points:l,fileId:r}=t;for(let n in"u">typeof l&&(t={...mz(l),...t}),t){let l=t[n];if("u">typeof l){if(e[n]===l&&("object"!=typeof l||null===l||"groupIds"===n||"scale"===n))continue;if("scale"===n){let t=e[n];if(t[0]===l[0]&&t[1]===l[1])continue}else if("points"===n){let t=e[n];if(t.length===l.length){let e=!1,n=t.length;for(;--n;){let i=t[n],r=l[n];if(i[0]!==r[0]||i[1]!==r[1]){e=!0;break}}if(!e)continue}}e[n]=l,i=!0}}return i&&(("u">typeof t.height||"u">typeof t.width||"u">typeof r||"u">typeof l)&&sK.delete(e),e.version++,e.versionNonce=i7(),e.updated=nr(),n&&gJ.getScene(e)?.informMutation()),e},g1=(e,t)=>{let n=!1;for(let i in t){let l=t[i];if("u">typeof l){if(e[i]===l&&("object"!=typeof l||null===l))continue;n=!0}}return n?{...e,...t,updated:nr(),version:e.version+1,versionNonce:i7()}:e},g0=(e,t)=>(e.version=(t??e.version)+1,e.versionNonce=i7(),e.updated=nr(),e)}),fF=tC(()=>{tM(),fB(),dx(),tR(),uq(),df(),g2=e=>nN(e)||n_(e)?e.points.length<2:0===e.width&&0===e.height,g3=(e,t,n,i)=>{let[l,r,a,s]=m3(e),o=t2({clientX:i.offsetLeft,clientY:i.offsetTop},i),d=t2({clientX:i.offsetLeft+t,clientY:i.offsetTop+n},i);return o.x<=a&&o.y<=s&&d.x>=l&&d.y>=r},g6=(e,t,n)=>{let i=Math.abs(t),l=Math.abs(n);if("line"===e||"arrow"===e||"freedraw"===e){let e=Math.round(Math.atan(l/i)/er)*er;0===e?n=0:e===Math.PI/2?t=0:n=i*Math.tan(e)*Math.sign(n)||n}else"selection"!==e&&(n=i*Math.sign(n));return{width:t,height:n}},g4=(e,t,n,i)=>{let l=n-e,r=i-t,a=Math.round(Math.atan(r/l)/er)*er;if(0===a)r=0;else if(a===Math.PI/2)l=0;else{let s=Math.tan(a),o=t-s*e,d=-1/s,c=i-d*n;l=(-1*c- -1*o)/(-1*s- -1*d)-e,r=(o*d-c*s)/(-1*s- -1*d)-t}return{width:l,height:r}},g5=e=>{let t={width:e.width,height:e.height,x:e.x,y:e.y};if(e.width<0){let n=Math.abs(e.width);t.width=n,t.x=e.x-n}if(e.height<0){let n=Math.abs(e.height);t.height=n,t.y=e.y-n}return t}}),f$=tC(()=>{tM(),dG(),g8=(e,t,n)=>t>=e[0]&&t<=e[0]+e[2]&&n>=e[1]&&n<=e[1]+e[3],g7=(e,t,n,i,l,r)=>{if(!t.selectedElementIds[e.id])return!1;let{rotation:a,...s}=sG(e,l,r);if(a&&g8(a,n,i))return"rotation";let o=Object.keys(s).filter(e=>{let t=s[e];return!!t&&g8(t,n,i)});return o.length>0&&o[0]},g9=(e,t,n,i,l,r)=>e.reduce((e,a)=>{if(e)return e;let s=g7(a,t,n,i,l,r);return s?{element:a,transformHandleType:s}:null},null),fe=([e,t,n,i],l,r,a,s)=>{let o=sU([e,t,n,i,(e+n)/2,(t+i)/2],0,a,s,sH);return Object.keys(o).find(e=>{let t=o[e];return t&&g8(t,l,r)})||!1},ft=["ns","nesw","ew","nwse"],fn=(e,t)=>{let n=ft.indexOf(e);return n>=0&&(e=ft[(n+Math.round(t/(Math.PI/4)))%ft.length]),e},fi=e=>{let{element:t,transformHandleType:n}=e,i=t&&Math.sign(t.height)*Math.sign(t.width)==-1,l=null;switch(n){case"n":case"s":l="ns";break;case"w":case"e":l="ew";break;case"nw":case"se":l=i?"nesw":"nwse";break;case"ne":case"sw":l=i?"nwse":"nesw";break;case"rotation":return"grab"}return l&&t&&(l=fn(l,t.angle)),l?`${l}-resize`:""}}),fZ=tC(()=>{tM(),tR(),uX(),uJ(),uq(),dx(),fB(),df(),dY(),fH(),ma(),dX(),fl=e=>e<0?e+2*Math.PI:e>=2*Math.PI?e-2*Math.PI:e,fr=(e,t,n,i,l,r,a,s,o,d,c,h)=>{if(1===n.length){let[i]=n;return"rotation"===t?(fa(i,s,o,l,e.originalElements),oH(i)):nL(i)&&("nw"===t||"ne"===t||"sw"===t||"se"===t)?(fc(i,t,r,s,o),oH(i)):t&&fh(e.originalElements,a,i,t,r,s,o),!0}if(n.length>1){if("rotation"===t)return fu(e,n,s,o,l,d,c),!0;if("nw"===t||"ne"===t||"sw"===t||"se"===t)return fm(e,n,t,r,s,o),!0}return!1},fa=(e,t,n,i,l)=>{let[r,a,s,o]=mF(e),d;nP(e)?d=0:(d=5*Math.PI/2+Math.atan2(n-(a+o)/2,t-(r+s)/2),i&&(d+=er/2,d-=d%er),d=fl(d));let c=hW(e);if(gQ(e,{angle:d}),c){let t=gJ.getScene(e)?.getElement(c);t&&!nO(e)&&gQ(t,{angle:d})}},fs=(e,t,n,i)=>nN(e)||n_(e)?{points:mH(0,t,mH(1,n,e.points,i),i)}:{},fo=(e,t,n)=>{let i=e.width;if(nU(e)){let t=hG(e);t&&(i=h2(t))}let l=e.fontSize*(t/i);if(l<ex)return null;let r=hT(e.text,tG({fontSize:l,fontFamily:e.fontFamily}),e.lineHeight);return{size:l,baseline:r.baseline+(n-r.height)}},fd=(e,t)=>({n:/^(n|ne|nw)$/.test(e)||t&&/^(s|se|sw)$/.test(e),s:/^(s|se|sw)$/.test(e)||t&&/^(n|ne|nw)$/.test(e),w:/^(w|nw|sw)$/.test(e)||t&&/^(e|ne|se)$/.test(e),e:/^(e|ne|se)$/.test(e)||t&&/^(w|nw|sw)$/.test(e)}),fc=(e,t,n,i,l)=>{let[r,a,s,o]=mF(e),[d,c]=ut(i,l,(r+s)/2,(a+o)/2,-e.angle),h;switch(t){case"se":h=Math.max((d-r)/(s-r),(c-a)/(o-a));break;case"nw":h=Math.max((s-d)/(s-r),(o-c)/(o-a));break;case"ne":h=Math.max((d-r)/(s-r),(o-c)/(o-a));break;case"sw":h=Math.max((s-d)/(s-r),(c-a)/(o-a))}if(h>0){let i=e.width*h,l=e.height*h,d=fo(e,i,l);if(null===d)return;let[c,m,u,p]=m5(e,i,l,!1),[g,f]=ui(fd(t,n),e.x,e.y,e.angle,(r-c)/2,(a-m)/2,(s-u)/2,(o-p)/2);gQ(e,{fontSize:d.size,width:i,height:l,baseline:d.baseline,x:g,y:f})}},fh=(e,t,n,i,l,r,a)=>{let s=e.get(n.id),[o,d,c,h]=m5(s,s.width,s.height,!0),m=[o,d],u=[c,h],p=ur(m,u),g=un([r,a],p,-s.angle),[f,x,y,b]=m5(n,n.width,n.height,!0),v=y-f,w=b-x,E=u[0]-m[0],S=u[1]-m[1],k=E/v,C=S/w,I={},M=hU(n);i.includes("e")&&(k=(g[0]-m[0])/v),i.includes("s")&&(C=(g[1]-m[1])/w),i.includes("w")&&(k=(u[0]-g[0])/v),i.includes("n")&&(C=(u[1]-g[1])/w);let j=s.width,T=s.height,L=n.width*k,D=n.height*C;if(l&&(L=2*L-j,D=2*D-T),t){let e=Math.abs(L)/j,t=Math.abs(D)/T;if(1===i.length&&(D*=e,L*=t),2===i.length){let n=Math.max(e,t);L=j*n*Math.sign(L),D=T*n*Math.sign(D)}}if(M){let i=e.get(M.id);if(i&&(I={fontSize:i.fontSize,baseline:i.baseline}),t){let e={...n,width:L,height:D},t=fo(M,h2(e),h3(e,M));if(null===t)return;I={fontSize:t.size,baseline:t.baseline}}else{let e=h$(tG(M),M.lineHeight),t=hP(M.fontSize,M.lineHeight);L=Math.max(L,e),D=Math.max(D,t)}}let[A,P,_,R]=m5(s,L,D,!0),N=_-A,O=R-P,z=[...m];if(["n","w","nw"].includes(i)&&(z=[u[0]-Math.abs(N),u[1]-Math.abs(O)]),"ne"===i){let e=[m[0],u[1]];z=[e[0],e[1]-Math.abs(O)]}if("sw"===i){let e=[u[0],m[1]];z=[e[0]-Math.abs(N),e[1]]}t&&(["s","n"].includes(i)&&(z[0]=p[0]-N/2),["e","w"].includes(i)&&(z[1]=p[1]-O/2));let H=D<0;L<0&&(i.includes("e")&&(z[0]-=Math.abs(N)),i.includes("w")&&(z[0]+=Math.abs(N))),H&&(i.includes("s")&&(z[1]-=Math.abs(O)),i.includes("n")&&(z[1]+=Math.abs(O))),l&&(z[0]=p[0]-Math.abs(N)/2,z[1]=p[1]-Math.abs(O)/2);let B=s.angle,F=un(z,p,B),$=[z[0]+Math.abs(N)/2,z[1]+Math.abs(O)/2],Z=un($,p,B),W=[...z=un(F,Z,-B)],U=s.x-A,G=s.y-P;W[0]+=U,W[1]+=G;let V=W[0],K=W[1],Y,X;(nN(n)||n_(n))&&(Y=mH(1,D,s.points,!0),X=mH(0,L,Y,!0));let q={width:Math.abs(L),height:Math.abs(D),x:V,y:K,points:X};if("scale"in n&&"scale"in s&&gQ(n,{scale:[(Math.sign(_-s.x)||s.scale[0])*s.scale[0],(Math.sign(R-s.y)||s.scale[1])*s.scale[1]]}),nO(n)&&M&&t){let e=q.width/n.width*M.fontSize;if(e<ex)return;I.fontSize=e}0!==q.width&&0!==q.height&&Number.isFinite(q.x)&&Number.isFinite(q.y)&&(gQ(n,q),oH(n,{newSize:{width:q.width,height:q.height}}),M&&null!=I&&gQ(M,{fontSize:I.fontSize,baseline:I.baseline}),hM(n,i,t))},fm=(e,t,n,i,l,r)=>{let a=t.reduce((t,n)=>{let i=e.originalElements.get(n.id);return i&&t.push({orig:i,latest:n}),t},[]),s=a.reduce((t,{orig:n})=>{if(!nN(n))return t;let i=hW(n);if(!i)return t;let l=e.originalElements.get(i)??null;if(!nU(l))return t;let r=o2.getBoundTextElementPosition(n,l);return[...t,{...l,...r}]},[]),{minX:o,minY:d,maxX:c,maxY:h,midX:m,midY:u}=m9(a.map(({orig:e})=>e).concat(s)),[p,g]=i?[m,u]:({ne:[o,h],se:[o,d],sw:[c,d],nw:[c,h]})[n],f=Math.max(Math.abs(l-p)/(c-o)||0,Math.abs(r-g)/(h-d)||0)*(i?2:1);if(0===f)return;let[x,y]=({ne:[l>=p,r<=g],se:[l>=p,r>=g],sw:[l<=p,r>=g],nw:[l<=p,r<=g]})[n].map(e=>e?1:-1),b=x<0,v=y<0,w=[];for(let{orig:t,latest:n}of a){if(nL(t)&&nU(t))continue;let i=t.width*f,l=t.height*f,r=fl(t.angle*x*y),s=nN(t)||n_(t),o=t.x-p,d=t.y-g,c=p+x*(o*f+(b&&!s?i:0)),h=g+y*(d*f+(v&&!s?l:0)),m=fs(t,i*x,l*y,!1),u={x:c,y:h,width:i,height:l,angle:r,...m};if(nI(t)&&1===a.length&&(u.scale=[t.scale[0]*x,t.scale[1]*y]),nN(t)&&(b||v)){let e=m8(t,t.points),n=m8({...t,x:c,y:h},m.points),i=[t.x,t.y],l=[c,h],r=t=>{let r="x"===t?0:1;return(n[r+2]-l[r]-(i[r]-e[r])*f+(e[r+2]-i[r])*f-(l[r]-n[r]))/2};b&&(u.x-=r("x")),v&&(u.y-=r("y"))}if(nL(t)){let e=fo(t,i,l);if(!e)return;u.fontSize=e.size,u.baseline=e.baseline}let E=e.originalElements.get(hW(t)??"");if(E){let e=E.fontSize*f;if(e<ex)return;u.boundTextFontSize=e}w.push({element:n,update:u})}let E=w.map(({element:e})=>e);for(let{element:e,update:{boundTextFontSize:t,...i}}of w){let{width:l,height:r,angle:a}=i;gQ(e,i,!1),oH(e,{simultaneouslyUpdated:E,newSize:{width:l,height:r}});let s=hU(e);s&&t&&(gQ(s,{fontSize:t,angle:nN(e)?void 0:a},!1),hM(e,n,!0))}gJ.getScene(w[0].element)?.informMutation()},fu=(e,t,n,i,l,r,a)=>{let s=5*Math.PI/2+Math.atan2(i-a,n-r);l&&(s+=er/2,s-=s%er),t.filter(e=>!nP(e)).forEach(n=>{let[i,l,o,d]=mF(n),c=(i+o)/2,h=(l+d)/2,m=e.originalElements.get(n.id)?.angle??n.angle,[u,p]=ut(c,h,r,a,s+m-n.angle);gQ(n,{x:n.x+(u-c),y:n.y+(p-h),angle:fl(s+m)},!1),oH(n,{simultaneouslyUpdated:t});let g=hU(n);g&&!nO(n)&&gQ(g,{x:g.x+(u-c),y:g.y+(p-h),angle:fl(s+m)},!1)}),gJ.getScene(t[0])?.informMutation()},fp=(e,t,n,i)=>{let[l,r,a,s]=1===t.length?mF(t[0]):m6(t),o=1===t.length?t[0].angle:0;switch([n,i]=ut(n,i,(l+a)/2,(r+s)/2,-o),e){case"n":return ut(n-(l+a)/2,i-r,0,0,o);case"s":return ut(n-(l+a)/2,i-s,0,0,o);case"w":return ut(n-l,i-(r+s)/2,0,0,o);case"e":return ut(n-a,i-(r+s)/2,0,0,o);case"nw":return ut(n-l,i-r,0,0,o);case"ne":return ut(n-a,i-r,0,0,o);case"sw":return ut(n-l,i-s,0,0,o);case"se":return ut(n-a,i-s,0,0,o);default:return[0,0]}},fg=(e,t)=>{let[,[n,i]]=t.points;return"nw"===e&&(n<0||i<0)||"ne"===e&&n>=0||"sw"===e&&n<=0||"se"===e&&(n>0||i>0)?"end":"origin"}}),fW=tC(()=>{tM(),dY(),uq(),fB(),fF(),ma(),uJ(),dx(),ff=(e,t,n,i,l,r,a)=>{let s=new Set(t),o=t.filter(e=>nP(e)).map(e=>e.id);if(o.length>0)for(let e of l.getNonDeletedElements())null!==e.frameId&&o.includes(e.frameId)&&s.add(e);let d=m6(Array.from(s).map(t=>e.originalElements.get(t.id)??t)),c=fx(d,n,r,a);s.forEach(t=>{if(fy(e,t,c),!nO(t)){let n=hU(t);n&&fy(e,n,c)}oH(t,{simultaneouslyUpdated:Array.from(s)})})},fx=(e,t,n,i)=>{let[l,r]=e,a=l+t.x+n.x,s=r+t.y+n.y;if(0===n.x||0===n.y){let[e,o]=uh(l+t.x,r+t.y,i);0===n.x&&(a=e),0===n.y&&(s=o)}return{x:a-l,y:s-r}},fy=(e,t,n)=>{let i=e.originalElements.get(t.id)??t,l=i.x+n.x,r=i.y+n.y;gQ(t,{x:l,y:r})},fb=(e,t,n)=>{let[i,l]=m6(e);return[t-i,n-l]},fv=(e,t,n,i,l,r,a,s,o,d,c,h=null)=>{o&&"selection"!==e.type&&(c?s=a/c:(Math.abs(r-i)>Math.abs(l-n)?{width:a,height:s}=g6(t,s,l<n?-a:a):{width:a,height:s}=g6(t,a,r<i?-s:s),s<0&&(s=-s)));let m=l<n?n-a:n,u=r<i?i-s:i;d&&(a+=a,s+=s,m=n-a/2,u=i-s/2),0!==a&&0!==s&&gQ(e,{x:m+(h?.x??0),y:u+(h?.y??0),width:a,height:s})}}),fU=tC(()=>{tM(),fK(),fw=(e,t)=>!!(!e.viewModeEnabled&&("custom"!==e.activeTool.type&&(e.editingElement||"selection"!==e.activeTool.type&&"eraser"!==e.activeTool.type&&"hand"!==e.activeTool.type&&"laser"!==e.activeTool.type)||gV(t,e).length))}),fG=tC(()=>{tM(),fF(),dx(),dD(),uq(),dG(),dK(),f$(),fZ(),fW(),dx(),mr(),ma(),fF(),fU(),fE=e=>e.reduce((e,t)=>e+t.version,0),fS=e=>e.filter(e=>!e.isDeleted&&!g2(e)),fk=e=>e.filter(e=>!e.isDeleted),fC=e=>!e.isDeleted,fI=e=>fk(e).map(e=>nz(e.type)?{...e,lastCommittedPoint:null}:e),fM=e=>fI(e),fj=e=>fI(e)}),fV=tC(()=>{tM(),fG(),df(),tL(),fT=4,fL=6,fD="rgba(0,0,0,0.3)",fA=(e,t,n,i)=>{if(0===e.length)return{horizontal:null,vertical:null};let[l,r,a,s]=m6(e),o=t/i.zoom.value,d=n/i.zoom.value,c={top:parseInt(t6("sat"))||0,bottom:parseInt(t6("sab"))||0,left:parseInt(t6("sal"))||0,right:parseInt(t6("sar"))||0},h=S().rtl,m=-i.scrollX+(t-o)/2+c.left,u=-i.scrollY+(n-d)/2+c.top,p=m+o-c.right,g=u+d-c.bottom,f=Math.min(l,m),x=Math.min(r,u),y=Math.max(a,p),b=Math.max(s,g);return{horizontal:m===f&&p===y?null:{x:Math.max(c.left,fT)+(m-f)/(y-f)*t,y:n-fL-Math.max(fT,c.bottom),width:(p-m)/(y-f)*t-Math.max(2*fT,c.left+c.right),height:fL},vertical:u===x&&g===b?null:{x:h?Math.max(c.left,fT):t-fL-Math.max(c.right,fT),y:(u-x)/(b-x)*n+Math.max(c.top,fT),width:fL,height:(g-u)/(b-x)*n-Math.max(2*fT,c.top+c.bottom)}}},fP=(e,t,n)=>{let[i,l]=[e.horizontal,e.vertical].map(e=>null!=e&&e.x<=t&&t<=e.x+e.width&&e.y<=n&&n<=e.y+e.height);return{isOverEither:i||l,isOverHorizontal:i,isOverVertical:l}}}),fK=tC(()=>{tM(),fV(),fz(),me(),h7(),mt()}),fY=tC(()=>{tM(),fK(),dO(),dR(),tL(),dj(),fG(),fB(),dI(),dX(),dY(),dx(),df(),dN(),f_=(e,t)=>{let n=new Set(gV(e.filter(e=>nP(e)),t).map(e=>e.id));return{elements:e.map(e=>t.selectedElementIds[e.id]?g1(e,{isDeleted:!0}):e.frameId&&n.has(e.frameId)?g1(e,{isDeleted:!0}):nU(e)&&t.selectedElementIds[e.containerId]?g1(e,{isDeleted:!0}):e),appState:{...t,selectedElementIds:{},selectedGroupIds:{}}}},fR=(e,t)=>{if(e.editingGroupId){let n=i$(fk(t),e.editingGroupId);if(n.length)return{...e,selectedElementIds:{[n[0].id]:!0}}}return e},fN=iY({name:"deleteSelectedElements",trackEvent:{category:"element",action:"delete"},perform:(e,t)=>{if(t.editingLinearElement){let{elementId:n,selectedPointsIndices:i,startBindingElement:l,endBindingElement:r}=t.editingLinearElement,a=o2.getElement(n);if(!a||null==i)return!1;if(a.points.length<2){let n=e.map(e=>e.id===a.id?g1(e,{isDeleted:!0}):e),i=fR(t,n);return{elements:n,appState:{...i,editingLinearElement:null},commitToHistory:!1}}let s={startBindingElement:i?.includes(0)?null:l,endBindingElement:i?.includes(a.points.length-1)?null:r};return o2.deletePoints(a,i),{elements:e,appState:{...t,editingLinearElement:{...t.editingLinearElement,...s,selectedPointsIndices:i?.[0]>0?[i[0]-1]:[0]}},commitToHistory:!0}}let{elements:n,appState:i}=f_(e,t);return oJ(n,e.filter(({id:e})=>t.selectedElementIds[e])),i=fR(i,n),{elements:n,appState:{...i,activeTool:t1(t,{type:"selection"}),multiElement:null,activeEmbeddable:null},commitToHistory:gU(fk(e),t)}},contextItemLabel:"labels.delete",keyTest:(e,t,n)=>(e.key===aO.BACKSPACE||e.key===aO.DELETE)&&!e[aO.CTRL_OR_CMD],PanelComponent:({elements:e,appState:t,updateData:n})=>(0,s.jsx)(lF,{type:"button",icon:rr,title:C("labels.delete"),"aria-label":C("labels.delete"),onClick:()=>n(null),visible:gU(fk(e),t)})})});function fX(e,t,n,i){let l=na(gV(e,t,{includeBoundTextElement:!0,includeElementsInFrames:!0})),r={regularElements:[],frameChildren:new Map},a=new Set;for(let t of e)l.has(t.id)&&nP(t)&&a.add(t.id);for(let t of e)if(l.has(t.id)){if(nP(t)||t.frameId&&a.has(t.frameId))r.regularElements.push(t);else if(t.frameId){let e=r.frameChildren.get(t.frameId)||[];e.push(t),r.frameChildren.set(t.frameId,e)}else r.regularElements.push(t)}let s=e;for(let[l,a]of Array.from(r.frameChildren.entries()))s=i(e,t,n,l,a);return i(s,t,n,null,r.regularElements)}var fq,fJ,fQ,f1,f0,f2,f3,f6,f4,f5,f8,f7,f9,xe,xt,xn,xi,xl,xr,xa,xs,xo,xd,xc,xh,xm,xu,xp,xg,xf,xx,xy,xb,xv,xw,xE,xS,xk,xC,xI,xM,xj,xT,xL,xD,xA,xP,x_,xR,xN,xO,xz,xH,xB,xF,x$,xZ,xW,xU,xG,xV,xK,xY,xX,xq,xJ,xQ,x1,x0,x2,x3,x6,x4,x5,x8,x7,x9,ye,yt,yn,yi,yl,yr,ya,ys,yo,yd,yc,yh,ym,yu,yp,yg,yf,yx,yy,yb,yv,yw,yE,yS,yk,yC,yI,yM,yj,yT,yL,yD,yA,yP,y_,yR,yN,yO,yz,yH,yB,yF,y$,yZ,yW,yU,yG,yV,yK,yY,yX,yq,yJ,yQ,y1,y0,y2,y3,y6,y4,y5,y8,y7,y9,be,bt,bn,bi,bl,br,ba,bs,bo=tC(()=>{tM(),fB(),dx(),dI(),fK(),fH(),df(),fq=(e,t)=>e.frameId===t||e.id===t,fJ=(e,t,n)=>{let i=[],l=[],r=null,a=-1,s=na(n||gV(e,t,{includeBoundTextElement:!0,includeElementsInFrames:!0}));for(;++a<e.length;){let t=e[a];s.get(t.id)?(l.length&&(i=i.concat(l),l=[]),i.push(a),r=a+1):t.isDeleted&&r===a?(r=a+1,l.push(a)):l=[]}return i},fQ=e=>{let t=0;return e.reduce((n,i,l)=>(l>0&&e[l-1]!==i-1&&(t=++t),(n[t]||(n[t]=[])).push(i),n),[])},f1=(e,t,n)=>{if("containerId"in e&&e.containerId){if("left"!==n)return t.indexOf(e);{let n=gJ.getScene(e).getElement(e.containerId);if(n)return t.indexOf(n)}}else{let i=e.boundElements?.find(e=>"arrow"!==e.type)?.id;if(i){if("left"===n)return t.indexOf(e);let l=gJ.getScene(e).getElement(i);if(l)return t.indexOf(l)}}},f0=(e,t)=>{let n=-1,i=-1;return e.forEach((e,l)=>{fq(e,t)&&(-1===n&&(n=l),i=l)}),-1===n?[]:e.slice(n,i+1)},f2=(e,t,n,i,l)=>{let r=t[n],a=t=>!t.isDeleted&&(l?t.frameId===l:!e.editingGroupId||t.groupIds.includes(e.editingGroupId)),s="left"===i?ne(t,e=>a(e),Math.max(0,n-1)):t9(t,e=>a(e),n+1),o=t[s];if(!o)return -1;if(e.editingGroupId){if(r?.groupIds.join("")===o?.groupIds.join(""))return f1(o,t,i)??s;if(!o?.groupIds.includes(e.editingGroupId))return -1}if(!l&&(o.frameId||nP(o))){let e=f0(t,o.frameId||o.id);return"left"===i?t.indexOf(e[0]):t.indexOf(e[e.length-1])}if(!o.groupIds.length)return f1(o,t,i)??s;let d=e.editingGroupId?o.groupIds[o.groupIds.indexOf(e.editingGroupId)-1]:o.groupIds[o.groupIds.length-1],c=i$(t,d);return c.length?"left"===i?t.indexOf(c[0]):t.indexOf(c[c.length-1]):s},f3=(e,t)=>t.reduce((t,n)=>{let i=e[n];return t[i.id]=i,t},{}),f6=(e,t,n)=>{let i=fJ(e,t),l=f3(e,i),r=fQ(i);"right"===n&&(r=r.reverse());let a=new Set(i.filter(t=>nP(e[t])).map(t=>e[t].id));return r.forEach((i,l)=>{let r=i[0],s=i[i.length-1],o="left"===n?r:s,d=i.some(t=>{let n=e[t];return n.frameId&&a.has(n.frameId)})?null:e[o]?.frameId,c=f2(t,e,o,n,d);if(-1===c||o===c)return;let h="left"===n?e.slice(0,c):e.slice(0,r),m=e.slice(r,s+1),u="left"===n?e.slice(c,r):e.slice(s+1,c+1),p="left"===n?e.slice(s+1):e.slice(c+1);e="left"===n?[...h,...m,...u,...p]:[...h,...u,...m,...p]}),e.map(e=>l[e.id]?g0(e):e)},f4=(e,t,n,i,l)=>{let r=fJ(e,t,l),a=f3(e,r),s=[],o,d;if("left"===n){if(i)o=t9(e,e=>fq(e,i));else if(t.editingGroupId){let n=i$(e,t.editingGroupId);if(!n.length)return e;o=e.indexOf(n[0])}else o=0;d=r[r.length-1]}else{if(i)d=ne(e,e=>fq(e,i));else if(t.editingGroupId){let n=i$(e,t.editingGroupId);if(!n.length)return e;d=e.indexOf(n[n.length-1])}else d=e.length-1;o=r[0]}-1===o&&(o=0);for(let t=o;t<d+1;t++)r.includes(t)||s.push(e[t]);let c=Object.values(a).map(e=>g0(e)),h=e.slice(0,o),m=e.slice(d+1);return"left"===n?[...h,...c,...s,...m]:[...h,...s,...c,...m]},f5=(e,t)=>f6(e,t,"left"),f8=(e,t)=>f6(e,t,"right"),f7=(e,t)=>fX(e,t,"left",f4),f9=(e,t)=>fX(e,t,"right",f4)}),bd=tC(()=>{tM(),bo(),dO(),tL(),df(),dj(),dN(),tR(),xe=iY({name:"sendBackward",trackEvent:{category:"element"},perform:(e,t)=>({elements:f5(e,t),appState:t,commitToHistory:!0}),contextItemLabel:"labels.sendBackward",keyPriority:40,keyTest:e=>e[aO.CTRL_OR_CMD]&&!e.shiftKey&&e.code===aN.BRACKET_LEFT,PanelComponent:({updateData:e,appState:t})=>(0,s.jsx)("button",{type:"button",className:"zIndexButton",onClick:()=>e(null),title:`${C("labels.sendBackward")} \u2014 ${t0("CtrlOrCmd+[")}`,children:rL})}),xt=iY({name:"bringForward",trackEvent:{category:"element"},perform:(e,t)=>({elements:f8(e,t),appState:t,commitToHistory:!0}),contextItemLabel:"labels.bringForward",keyPriority:40,keyTest:e=>e[aO.CTRL_OR_CMD]&&!e.shiftKey&&e.code===aN.BRACKET_RIGHT,PanelComponent:({updateData:e,appState:t})=>(0,s.jsx)("button",{type:"button",className:"zIndexButton",onClick:()=>e(null),title:`${C("labels.bringForward")} \u2014 ${t0("CtrlOrCmd+]")}`,children:rT})}),xn=iY({name:"sendToBack",trackEvent:{category:"element"},perform:(e,t)=>({elements:f7(e,t),appState:t,commitToHistory:!0}),contextItemLabel:"labels.sendToBack",keyTest:e=>V?e[aO.CTRL_OR_CMD]&&e.altKey&&e.code===aN.BRACKET_LEFT:e[aO.CTRL_OR_CMD]&&e.shiftKey&&e.code===aN.BRACKET_LEFT,PanelComponent:({updateData:e,appState:t})=>(0,s.jsx)("button",{type:"button",className:"zIndexButton",onClick:()=>e(null),title:`${C("labels.sendToBack")} \u2014 ${V?t0("CtrlOrCmd+Alt+["):t0("CtrlOrCmd+Shift+[")}`,children:rA})}),xi=iY({name:"bringToFront",trackEvent:{category:"element"},perform:(e,t)=>({elements:f9(e,t),appState:t,commitToHistory:!0}),contextItemLabel:"labels.bringToFront",keyTest:e=>V?e[aO.CTRL_OR_CMD]&&e.altKey&&e.code===aN.BRACKET_RIGHT:e[aO.CTRL_OR_CMD]&&e.shiftKey&&e.code===aN.BRACKET_RIGHT,PanelComponent:({updateData:e,appState:t})=>(0,s.jsx)("button",{type:"button",className:"zIndexButton",onClick:t=>e(null),title:`${C("labels.bringToFront")} \u2014 ${V?t0("CtrlOrCmd+Alt+]"):t0("CtrlOrCmd+Shift+]")}`,children:rD})})}),bc=tC(()=>{tM(),dO(),dj(),dI(),fG(),dx(),dX(),fz(),xl=iY({name:"selectAll",trackEvent:{category:"canvas"},perform:(e,t,n,i)=>{if(t.editingLinearElement)return!1;let l=g$(e.filter(e=>!e.isDeleted&&!(nL(e)&&e.containerId)&&!e.locked)).reduce((e,t)=>(e[t.id]=!0,e),{});return{appState:{...t,...iR({editingGroupId:null,selectedElementIds:l},fk(e),t,i),selectedLinearElement:1===Object.keys(l).length&&nN(e[0])?new o2(e[0],i.scene):null},commitToHistory:!0}},contextItemLabel:"labels.selectAll",keyTest:e=>e[aO.CTRL_OR_CMD]&&e.key===aO.A})}),bh=tC(()=>{tM(),df(),xr=e=>{let t=e.slice(),n=new Set,i=e=>{let t=e[0]?.groupIds?.join(""),n=[e[0]],l=[];for(let i of e.slice(1))i.groupIds?.join("")===t?n.push(i):l.push(i);return l.length?[...n,...i(l)]:n},l=new Map;return t.forEach((e,r)=>{if(!l.has(e.id)){if(e.groupIds?.length){let a=e.groupIds[e.groupIds.length-1];for(let e of i(t.slice(r).filter(e=>{let t=e?.groupIds?.some(e=>e===a);return t&&l.set(e.id,!0),t})))n.add(e)}else n.add(e)}}),n.size!==e.length?(console.error("normalizeGroupElementOrder: lost some elements... bailing!"),e):[...n]},xa=e=>{let t=ns(e),n=e.slice(),i=new Set;return n.forEach((e,l)=>{e&&(e.boundElements?.length?(i.add(e),n[l]=null,e.boundElements.forEach(e=>{let l=t.get(e.id);l&&"text"===e.type&&(i.add(l[0]),n[l[1]]=null)})):"text"===e.type&&e.containerId&&t.get(e.containerId)?.[0].boundElements?.find(t=>t.id===e.id)||(i.add(e),n[l]=null))}),i.size!==e.length?(console.error("normalizeBoundElementsOrder: lost some elements... bailing!"),e):[...i]},xs=e=>xa(xr(e))}),bm=tC(()=>{tM(),dO(),dj(),fG(),fK(),dR(),tL(),df(),dX(),dI(),dY(),tR(),ma(),dx(),bh(),dN(),fO(),fz(),xo=iY({name:"duplicateSelection",trackEvent:{category:"element"},perform:(e,t)=>{if(t.editingLinearElement){let n=o2.duplicateSelectedPoints(t);return!!n&&{elements:e,appState:n.appState,commitToHistory:!0}}return{...xd(e,t),commitToHistory:!0}},contextItemLabel:"labels.duplicateSelection",keyTest:e=>e[aO.CTRL_OR_CMD]&&e.key===aO.D,PanelComponent:({elements:e,appState:t,updateData:n})=>(0,s.jsx)(lF,{type:"button",icon:rs,title:`${C("labels.duplicateSelection")} \u2014 ${t0("CtrlOrCmd+D")}`,"aria-label":C("labels.duplicateSelection"),onClick:()=>n(null),visible:gU(fk(e),t)})}),xd=(e,t)=>{let n=xs(e),i=new Map,l=[],r=[],a=new Map,s=e=>{let n=lx(t.editingGroupId,i,e,{x:e.x+eE/2,y:e.y+eE/2});return a.set(e.id,n.id),r.push(e),l.push(n),n},o=na(gV(n,t,{includeBoundTextElement:!0,includeElementsInFrames:!0})),d=new Map,c=e=>{for(let t of e)d.set(t.id,!0);return e},h=[],m=-1;for(;++m<n.length;){let i=n[m];if(d.get(i.id))continue;let l=hU(i),r=nP(i);if(o.get(i.id)){if(i.groupIds.length||l||r){let a=iO(t,i);if(a){let t=i$(n,a).flatMap(t=>nP(t)?[...gM(e,t.id),t]:[t]);h.push(...c([...t,...t.map(e=>s(e))]));continue}if(l){h.push(...c([i,l,s(i),s(l)]));continue}if(r){let e=gM(n,i.id);h.push(...c([...e,i,...e.map(e=>s(e)),s(i)]));continue}}i.frameId&&o.has(i.frameId)||h.push(...c([i,s(i)]))}else h.push(...c([i]))}let u=[],p=new Map;for(m=h.length;--m>=0;){let e=h[m];p.get(e.id)||(p.set(e.id,!0),u.push(e))}let g=u.reverse();hI(h,r,a),oX(h,r,a),gv(g,r,a);let f=g$(l);return{elements:g,appState:{...t,...iR({editingGroupId:t.editingGroupId,selectedElementIds:f.reduce((e,t)=>(nU(t)||(e[t.id]=!0),e),{})},fk(g),t,null)}}}}),bu=tC(()=>{tM(),dO(),fG(),df(),dR(),dN(),tL(),dj(),fB(),uJ(),dX(),fH(),dY(),dx(),dT(),xc=iY({name:"finalize",trackEvent:!1,perform:(e,t,n,{interactiveCanvas:i,focusContainer:l,scene:r})=>{let a;if(t.editingLinearElement){let{elementId:n,startBindingElement:i,endBindingElement:l}=t.editingLinearElement,r=o2.getElement(n);if(r)return nH(r)&&oM(r,i,l),{elements:r.points.length<2||g2(r)?e.filter(e=>e.id!==r.id):void 0,appState:{...t,cursorButton:"up",editingLinearElement:null},commitToHistory:!0}}let s=e,o=t.pendingImageElementId&&r.getElement(t.pendingImageElementId);o&&gQ(o,{isDeleted:!0},!1),window.document.activeElement instanceof HTMLElement&&l();let d=t.multiElement?t.multiElement:t.editingElement?.type==="freedraw"?t.editingElement:null;if(d){if("freedraw"!==d.type&&"touch"!==t.lastPointerDownWith){let{points:e,lastCommittedPoint:t}=d;t&&e[e.length-1]===t||gQ(d,{points:d.points.slice(0,-1)})}g2(d)&&(s=s.filter(e=>e.id!==d.id));let e=ua(d.points,t.zoom.value);if(("line"===d.type||"freedraw"===d.type)&&e){let e=d.points,t=e[0];gQ(d,{points:e.map((n,i)=>i===e.length-1?[t[0],t[1]]:n)})}if(nH(d)&&!e&&d.points.length>1){let[e,n]=o2.getPointAtIndexGlobalCoordinates(d,-1);oD(d,t,gJ.getScene(d),{x:e,y:n})}}return(t.activeTool.locked||"freedraw"===t.activeTool.type)&&d||i1(i),a="eraser"===t.activeTool.type?t1(t,{...t.activeTool.lastActiveTool||{type:"selection"},lastActiveToolBeforeEraser:null}):t1(t,{type:"selection"}),{elements:s,appState:{...t,cursorButton:"up",activeTool:(t.activeTool.locked||"freedraw"===t.activeTool.type)&&d?t.activeTool:a,activeEmbeddable:null,draggingElement:null,multiElement:null,editingElement:null,startBoundElement:null,suggestedBindings:[],selectedElementIds:d&&!t.activeTool.locked&&"freedraw"!==t.activeTool.type?{...t.selectedElementIds,[d.id]:!0}:t.selectedElementIds,selectedLinearElement:d&&nN(d)?new o2(d,r):t.selectedLinearElement,pendingImageElementId:null},commitToHistory:"freedraw"===t.activeTool.type}},keyTest:(e,t)=>e.key===aO.ESCAPE&&(null!==t.editingLinearElement||!t.draggingElement&&null===t.multiElement)||(e.key===aO.ESCAPE||e.key===aO.ENTER)&&null!==t.multiElement,PanelComponent:({appState:e,updateData:t,data:n})=>(0,s.jsx)(lF,{type:"button",icon:rC,title:C("buttons.done"),"aria-label":C("buttons.done"),onClick:t,visible:null!=e.multiElement,size:n?.size||"medium"})})}),bp=tC(()=>{}),bg=tC(()=>{}),bf=tC(()=>{tM(),bp(),df(),bg(),CJ(),dO(),xh=e=>{let{id:t}=k5(),[n,i]=(0,l.useState)(e.value);return(0,s.jsxs)("div",{className:"ProjectName",children:[(0,s.jsx)("label",{className:"ProjectName-label",htmlFor:"filename",children:`${e.label}${e.isNameEditable?"":":"}`}),e.isNameEditable?(0,s.jsx)("input",{type:"text",className:"TextInput",onBlur:t=>{e.ignoreFocus||ni(t.target);let n=t.target.value;n!==e.value&&e.onChange(n)},onKeyDown:e=>{e.key!==aO.ENTER||(e.preventDefault(),e.nativeEvent.isComposing||229===e.keyCode||e.currentTarget.blur())},id:`${t}-filename`,value:n,onChange:e=>i(e.target.value)}):(0,s.jsx)("span",{className:"TextInput TextInput--readonly",id:`${t}-filename`,children:e.value})]})}}),bx=tC(()=>{tM(),dP(),tL(),dR(),tR(),xm=e=>{let t=e.title||("dark"===e.value?C("buttons.lightMode"):C("buttons.darkMode"));return(0,s.jsx)(lF,{type:"icon",icon:e.value===ep.LIGHT?xu.MOON:xu.SUN,title:t,"aria-label":t,onClick:()=>e.onChange(e.value===ep.DARK?ep.LIGHT:ep.DARK),"data-testid":"toggle-dark-mode"})},xu={SUN:(0,s.jsx)("svg",{width:"512",height:"512",className:"rtl-mirror",viewBox:"0 0 512 512",children:(0,s.jsx)("path",{fill:"currentColor",d:"M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96 96-43.1 96-96-43.1-96-96-96zm246.4 80.5l-94.7-47.3 33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5-47.4-94.8c-6.4-12.8-24.6-12.8-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4-94.7 47.4c-12.8 6.4-12.8 24.6 0 31l94.7 47.3-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.4-33.5 47.3 94.7c6.4 12.8 24.6 12.8 31 0l47.3-94.7 100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4 94.7-47.3c13-6.5 13-24.7.2-31.1zm-155.9 106c-49.9 49.9-131.1 49.9-181 0-49.9-49.9-49.9-131.1 0-181 49.9-49.9 131.1-49.9 181 0 49.9 49.9 49.9 131.1 0 181z"})}),MOON:(0,s.jsx)("svg",{width:"512",height:"512",className:"rtl-mirror",viewBox:"0 0 512 512",children:(0,s.jsx)("path",{fill:"currentColor",d:"M283.211 512c78.962 0 151.079-35.925 198.857-94.792 7.068-8.708-.639-21.43-11.562-19.35-124.203 23.654-238.262-71.576-238.262-196.954 0-72.222 38.662-138.635 101.498-174.394 9.686-5.512 7.25-20.197-3.756-22.23A258.156 258.156 0 0 0 283.211 0c-141.309 0-256 114.511-256 256 0 141.309 114.511 256 256 256z"})})}}),by=tC(()=>{tM(),ml(),tR(),fG(),dx(),tL(),gy(),fK(),pV(),df(),pW(),uQ(),pU(),pW(),pU(),xp=(e,{selectedElementIds:t},n)=>{e=fk(e);let i=n&&gU(e,{selectedElementIds:t}),l=null,r=i?gV(e,{selectedElementIds:t},{includeBoundTextElement:!0}):e;return i&&(1===r.length&&nP(r[0])?(l=r[0],r=p8({elements:e,bounds:l,type:"overlap"})):r.length>1&&(r=gV(e,{selectedElementIds:t},{includeBoundTextElement:!0,includeElementsInFrames:!0}))),{exportingFrame:l,exportedElements:nv(r)}},xg=async(e,t,n,i,{exportBackground:l,exportPadding:r=eV,viewBackgroundColor:a,name:s,fileHandle:o=null,exportingFrame:d=null})=>{if(0===t.length)throw Error(C("alerts.cannotExportEmptyCanvas"));if("svg"===e||"clipboard-svg"===e){let c=await pB(t,{exportBackground:l,exportWithDarkMode:n.exportWithDarkMode,viewBackgroundColor:a,exportPadding:r,exportScale:n.exportScale,exportEmbedScene:n.exportEmbedScene&&"svg"===e},i,{exportingFrame:d});if("svg"===e)return await uC(new Blob([c.outerHTML],{type:eC.svg}),{description:"Export to SVG",name:s,extension:n.exportEmbedScene?"excalidraw.svg":"svg",fileHandle:o});if("clipboard-svg"===e){await hg(c.outerHTML);return}}let c=pH(t,n,i,{exportBackground:l,viewBackgroundColor:a,exportPadding:r,exportingFrame:d});if("png"===e){let e=await po(c);return n.exportEmbedScene&&(e=await (await Promise.resolve().then(()=>(pZ(),u3))).encodePngMetadata({blob:e,metadata:pE(t,n,i,"local")})),await uC(e,{description:"Export to PNG",name:s,extension:"png",fileHandle:o})}if("clipboard"===e)try{let e=po(c);await hp(e)}catch(e){throw console.warn(e),"CANVAS_POSSIBLY_TOO_BIG"===e.name?e:Y&&"TypeError"===e.name?Error(`${C("alerts.couldNotCopyToClipboard")}

${C("hints.firefox_clipboard_write")}`):Error(C("alerts.couldNotCopyToClipboard"))}else throw Error("Unsupported export type")}}),bb=tC(()=>{tM(),by(),pW(),xf=async(e,t,n)=>{let{exportBackground:i,viewBackgroundColor:l,name:r,fileHandle:a}=t,s=pe(a);if(!a||!pt(s))throw Error("fileHandle should exist and should be of type svg or png when resaving");t={...t,exportEmbedScene:!0};let{exportedElements:o,exportingFrame:d}=xp(e,t,!1);return await xg(s,o,t,n,{exportBackground:i,viewBackgroundColor:l,name:r,fileHandle:a,exportingFrame:d}),{fileHandle:a}}}),bv=tC(()=>{}),bw=tC(()=>{tM(),dN(),bv(),xx=({children:e,checked:t,onChange:n,className:i})=>(0,s.jsxs)("div",{className:(0,d.Z)("Checkbox",i,{"is-checked":t}),onClick:e=>{n(!t,e),e.currentTarget.querySelector(".Checkbox-box").focus()},children:[(0,s.jsx)("button",{className:"Checkbox-box",role:"checkbox","aria-checked":t,children:rx}),(0,s.jsx)("div",{className:"Checkbox-label",children:e})]})}),bE=tC(()=>{tM(),dN(),bf(),dR(),dH(),bx(),by(),bb(),tL(),CJ(),dO(),dj(),bw(),pV(),tR(),fK(),fG(),pW(),uQ(),dP(),xy=iY({name:"changeProjectName",trackEvent:!1,perform:(e,t,n)=>({appState:{...t,name:n},commitToHistory:!1}),PanelComponent:({appState:e,updateData:t,appProps:n,data:i})=>(0,s.jsx)(xh,{label:C("labels.fileTitle"),value:e.name||"Unnamed",onChange:e=>t(e),isNameEditable:typeof n.name>"u"&&!e.viewModeEnabled,ignoreFocus:i?.ignoreFocus??!1})}),xb=iY({name:"changeExportScale",trackEvent:{category:"export",action:"scale"},perform:(e,t,n)=>({appState:{...t,exportScale:n},commitToHistory:!1}),PanelComponent:({elements:e,appState:t,updateData:n})=>{let i=fk(e),l=gU(i,t)?gV(i,t):i;return(0,s.jsx)(s.Fragment,{children:eG.map(e=>{let[i,r]=p$(l,eV,e),a=`${C("imageExportDialog.label.scale")} ${e}x (${i}x${r})`;return(0,s.jsx)(lF,{size:"small",type:"radio",icon:`${e}x`,name:"export-canvas-scale",title:a,"aria-label":a,id:"export-canvas-scale",checked:e===t.exportScale,onChange:()=>n(e)},e)})})}}),xv=iY({name:"changeExportBackground",trackEvent:{category:"export",action:"toggleBackground"},perform:(e,t,n)=>({appState:{...t,exportBackground:n},commitToHistory:!1}),PanelComponent:({appState:e,updateData:t})=>(0,s.jsx)(xx,{checked:e.exportBackground,onChange:e=>t(e),children:C("imageExportDialog.label.withBackground")})}),xw=iY({name:"changeExportEmbedScene",trackEvent:{category:"export",action:"embedScene"},perform:(e,t,n)=>({appState:{...t,exportEmbedScene:n},commitToHistory:!1}),PanelComponent:({appState:e,updateData:t})=>(0,s.jsxs)(xx,{checked:e.exportEmbedScene,onChange:e=>t(e),children:[C("imageExportDialog.label.embedScene"),(0,s.jsx)(aU,{label:C("imageExportDialog.tooltip.embedScene"),long:!0,children:(0,s.jsx)("div",{className:"excalidraw-tooltip-icon",children:rj})})]})}),xE=iY({name:"saveToActiveFile",trackEvent:{category:"export"},predicate:(e,t,n,i)=>!!i.props.UIOptions.canvasActions.saveToActiveFile&&!!t.fileHandle&&!t.viewModeEnabled,perform:async(e,t,n,i)=>{let l=!!t.fileHandle;try{let{fileHandle:n}=pn(t.fileHandle)?await xf(e,t,i.files):await pS(e,t,i.files);return{commitToHistory:!1,appState:{...t,fileHandle:n,toast:l?{message:n?.name?C("toast.fileSavedToFilename").replace("{filename}",`"${n.name}"`):C("toast.fileSaved")}:null}}}catch(e){return e?.name!=="AbortError"?console.error(e):console.warn(e),{commitToHistory:!1}}},keyTest:e=>e.key===aO.S&&e[aO.CTRL_OR_CMD]&&!e.shiftKey}),xS=iY({name:"saveFileToDisk",viewMode:!0,trackEvent:{category:"export"},perform:async(e,t,n,i)=>{try{let{fileHandle:n}=await pS(e,{...t,fileHandle:null},i.files);return{commitToHistory:!1,appState:{...t,openDialog:null,fileHandle:n,toast:{message:C("toast.fileSaved")}}}}catch(e){return e?.name!=="AbortError"?console.error(e):console.warn(e),{commitToHistory:!1}}},keyTest:e=>e.key===aO.S&&e.shiftKey&&e[aO.CTRL_OR_CMD],PanelComponent:({updateData:e})=>(0,s.jsx)(lF,{type:"button",icon:rv,title:C("buttons.saveAs"),"aria-label":C("buttons.saveAs"),showAriaLabel:k4().editor.isMobile,hidden:!tp.Zh,onClick:()=>e(null),"data-testid":"save-as-button"})}),xk=iY({name:"loadScene",trackEvent:{category:"export"},predicate:(e,t,n,i)=>!!i.props.UIOptions.canvasActions.loadScene&&!t.viewModeEnabled,perform:async(e,t,n,i)=>{try{let{elements:n,appState:i,files:l}=await pk(t,e);return{elements:n,appState:i,files:l,commitToHistory:!0}}catch(n){return n?.name==="AbortError"?(console.warn(n),!1):{elements:e,appState:{...t,errorMessage:n.message},files:i.files,commitToHistory:!1}}},keyTest:e=>e[aO.CTRL_OR_CMD]&&e.key===aO.O}),xC=iY({name:"exportWithDarkMode",trackEvent:{category:"export",action:"toggleTheme"},perform:(e,t,n)=>({appState:{...t,exportWithDarkMode:n},commitToHistory:!1}),PanelComponent:({appState:e,updateData:t})=>(0,s.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"-45px",marginBottom:"10px"},children:(0,s.jsx)(xm,{value:e.exportWithDarkMode?ep.DARK:ep.LIGHT,onChange:e=>{t(e===ep.DARK)},title:C("imageExportDialog.label.darkMode")})})})}),bS=tC(()=>{tM(),fG(),dO(),tL(),dj(),fB(),tR(),ma(),dx(),fK(),xI="{}",xM=iY({name:"copyStyles",trackEvent:{category:"element"},perform:(e,t)=>{let n=[],i=e.find(e=>t.selectedElementIds[e.id]);if(n.push(i),i&&nW(i)){let e=hU(i);n.push(e)}return i&&(xI=JSON.stringify(n)),{appState:{...t,toast:{message:C("toast.copyStyles")}},commitToHistory:!1}},contextItemLabel:"labels.copyStyles",keyTest:e=>e[aO.CTRL_OR_CMD]&&e.altKey&&e.code===aN.C}),xj=iY({name:"pasteStyles",trackEvent:{category:"element"},perform:(e,t)=>{let n=JSON.parse(xI),i=n[0],l=n[1];if(!nZ(i))return{elements:e,commitToHistory:!1};let r=gV(e,t,{includeBoundTextElement:!0}),a=r.map(e=>e.id);return{elements:e.map(e=>{if(a.includes(e.id)){let t=i;if(nL(e)&&e.containerId&&(t=l),!t)return e;let n=g1(e,{backgroundColor:t?.backgroundColor,strokeWidth:t?.strokeWidth,strokeColor:t?.strokeColor,strokeStyle:t?.strokeStyle,fillStyle:t?.fillStyle,opacity:t?.opacity,roughness:t?.roughness,roundness:t.roundness?nK(t.roundness.type,e)?t.roundness:nY(e):null});if(nL(n)){let e=t.fontSize||ey,i=t.fontFamily||eb;n=g1(n,{fontSize:e,fontFamily:i,textAlign:t.textAlign||ev,lineHeight:t.lineHeight||h5(i)});let l=null;n.containerId&&(l=r.find(e=>nL(n)&&e.id===n.containerId)||null),hC(n,l)}return"arrow"===n.type&&nO(t)&&(n=g1(n,{startArrowhead:t.startArrowhead,endArrowhead:t.endArrowhead})),nP(e)&&(n=g1(n,{roundness:null,backgroundColor:"transparent"})),n}return e}),commitToHistory:!0}},contextItemLabel:"labels.pasteStyles",keyTest:e=>e[aO.CTRL_OR_CMD]&&e.altKey&&e.code===aN.V})}),bk=tC(()=>{tM(),dN(),dR(),tL(),fG(),dj(),dO(),iY({name:"toggleCanvasMenu",trackEvent:{category:"menu"},perform:(e,t)=>({appState:{...t,openMenu:"canvas"===t.openMenu?null:"canvas"},commitToHistory:!1}),PanelComponent:({appState:e,updateData:t})=>(0,s.jsx)(lF,{type:"button",icon:rc,"aria-label":C("buttons.menu"),onClick:t,selected:"canvas"===e.openMenu})}),iY({name:"toggleEditMenu",trackEvent:{category:"menu"},perform:(e,t)=>({appState:{...t,openMenu:"shape"===t.openMenu?null:"shape"},commitToHistory:!1}),PanelComponent:({elements:e,appState:t,updateData:n})=>(0,s.jsx)(lF,{visible:fw(t,fk(e)),type:"button",icon:rE,"aria-label":C("buttons.edit"),onClick:n,selected:"shape"===t.openMenu})}),xT=iY({name:"toggleShortcuts",viewMode:!0,trackEvent:{category:"menu",action:"toggleHelpDialog"},perform:(e,t,n,{focusContainer:i})=>(t.openDialog?.name==="help"&&i(),{appState:{...t,openDialog:t.openDialog?.name==="help"?null:{name:"help"}},commitToHistory:!1}),keyTest:e=>e.key===aO.QUESTION_MARK})}),bC=tC(()=>{tM(),dO(),tL(),df(),dj(),dN(),fB(),fK(),dI(),fG(),dL(),dR(),dx(),fO(),xL=e=>{if(e.length>=2){for(let t of e[0].groupIds)if(e.reduce((e,n)=>e&&iF(n,t),!0))return!0}return!1},xD=(e,t,n)=>{let i=n.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0});return i.length>=2&&!xL(i)},xA=iY({name:"group",trackEvent:{category:"element"},perform:(e,t,n,i)=>{let l=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0});if(l.length<2)return{appState:t,elements:e,commitToHistory:!1};let r=iz(t);if(1===r.length){let n=r[0],i=new Set(i$(e,n).map(e=>e.id)),a=new Set(l.map(e=>e.id));if(new Set([...Array.from(i),...Array.from(a)]).size===i.size)return{appState:t,elements:e,commitToHistory:!1}}let a=[...e];new Set(l.map(e=>e.frameId)).size>1&&gI(l).forEach((e,n)=>{a=g_(a,e,t)});let s=i9(),o=na(l);a=a.map(e=>o.get(e.id)?g1(e,{groupIds:iU(e.groupIds,s,t.editingGroupId)}):e);let d=i$(a,s),c=d[d.length-1],h=a.lastIndexOf(c),m=a.slice(h+1);return a=[...a.slice(0,h).filter(e=>!iF(e,s)),...d,...m],{appState:{...t,...i_(s,{...t,selectedGroupIds:{}},fk(a))},elements:a,commitToHistory:!0}},contextItemLabel:"labels.group",predicate:(e,t,n,i)=>xD(e,t,i),keyTest:e=>!e.shiftKey&&e[aO.CTRL_OR_CMD]&&e.key===aO.G,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>(0,s.jsx)(lF,{hidden:!xD(e,t,i),type:"button",icon:(0,s.jsx)(rW,{theme:t.theme}),onClick:()=>n(null),title:`${C("labels.group")} \u2014 ${t0("CtrlOrCmd+G")}`,"aria-label":C("labels.group"),visible:gU(fk(e),t)})}),xP=iY({name:"ungroup",trackEvent:{category:"element"},perform:(e,t,n,i)=>{if(0===iz(t).length)return{appState:t,elements:e,commitToHistory:!1};let l=[...e],r=[];l=l.map(e=>{nU(e)&&r.push(e.id);let n=iG(e.groupIds,t.selectedGroupIds);return n.length===e.groupIds.length?e:g1(e,{groupIds:n})});let a=iR(t,fk(l),t,null),s=i.scene.getSelectedElements(t),o=new Set(s.filter(e=>e.frameId).map(e=>e.frameId));return gj(e).filter(e=>o.has(e.id)).forEach(e=>{e&&(l=gN(l,gL(l,e,t),e,t))}),a.selectedElementIds=Object.entries(a.selectedElementIds).reduce((e,[t,n])=>(n&&!r.includes(t)&&(e[t]=!0),e),{}),{appState:{...t,...a},elements:l,commitToHistory:!0}},keyTest:e=>e.shiftKey&&e[aO.CTRL_OR_CMD]&&e.key===aO.G.toUpperCase(),contextItemLabel:"labels.ungroup",predicate:(e,t)=>iz(t).length>0,PanelComponent:({elements:e,appState:t,updateData:n})=>(0,s.jsx)(lF,{type:"button",hidden:0===iz(t).length,icon:(0,s.jsx)(rU,{theme:t.theme}),onClick:()=>n(null),title:`${C("labels.ungroup")} \u2014 ${t0("CtrlOrCmd+Shift+G")}`,"aria-label":C("labels.ungroup"),visible:gU(fk(e),t)})})}),bI=tC(()=>{}),bM=tC(()=>{tM(),bI(),dC(),x_=({color:e,onClick:t,name:n,src:i,isBeingFollowed:r,isCurrentUser:a})=>{let o=iP(n),[c,h]=(0,l.useState)(!1),m=!c&&i;return(0,s.jsx)("div",{className:(0,d.Z)("Avatar",{"Avatar--is-followed":r,"Avatar--is-current-user":a}),style:m?void 0:{background:e},onClick:t,children:m?(0,s.jsx)("img",{className:"Avatar-img",src:i,alt:o,referrerPolicy:"no-referrer",onError:()=>h(!0)}):o})}}),bj=tC(()=>{tM(),dC(),bM(),dN(),tL(),dj(),iY({name:"goToCollaborator",viewMode:!0,trackEvent:{category:"collab"},perform:(e,t,n)=>!n.socketId||t.userToFollow?.socketId===n.socketId||n.isCurrentUser?{appState:{...t,userToFollow:null},commitToHistory:!1}:{appState:{...t,userToFollow:{socketId:n.socketId,username:n.username||""},openMenu:"canvas"===t.openMenu?null:t.openMenu},commitToHistory:!1},PanelComponent:({updateData:e,data:t,appState:n})=>{let{clientId:i,collaborator:l,withName:r,isBeingFollowed:a}=t,o=iA(i);return r?(0,s.jsxs)("div",{className:"dropdown-menu-item dropdown-menu-item-base UserList__collaborator",onClick:()=>e(l),children:[(0,s.jsx)(x_,{color:o,onClick:()=>{},name:l.username||"",src:l.avatarUrl,isBeingFollowed:a,isCurrentUser:!0===l.isCurrentUser}),l.username,(0,s.jsx)("div",{className:"UserList__collaborator-follow-status-icon",style:{visibility:a?"visible":"hidden"},title:a?C("userList.hint.followStatus"):void 0,"aria-hidden":!0,children:aA})]}):(0,s.jsx)(x_,{color:o,onClick:()=>{e(l)},name:l.username||"",src:l.avatarUrl,isBeingFollowed:a,isCurrentUser:!0===l.isCurrentUser})}})}),bT=tC(()=>{tM(),dj(),dD(),dL(),tL(),tR(),xR=iY({name:"addToLibrary",trackEvent:{category:"element"},perform:(e,t,n,i)=>{let l=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0});for(let e of ti)if(l.some(t=>t.type===e))return{commitToHistory:!1,appState:{...t,errorMessage:C(`errors.libraryElementTypeError.${e}`)}};return i.library.getLatestLibrary().then(e=>i.library.setLibrary([{id:i9(),status:"unpublished",elements:l.map(lg),created:Date.now()},...e])).then(()=>({commitToHistory:!1,appState:{...t,toast:{message:C("toast.addedToLibrary")}}})).catch(e=>({commitToHistory:!1,appState:{...t,errorMessage:e.message}}))},contextItemLabel:"labels.addToLibrary"})}),bL=tC(()=>{tM(),fB(),uq(),dI(),xN=(e,t)=>{let n=iV(e),i=m9(e);return n.flatMap(e=>{let n=xO(e,i,t);return e.map(e=>g1(e,{x:e.x+n.x,y:e.y+n.y}))})},xO=(e,t,{axis:n,position:i})=>{let l=m9(e),[r,a]="x"===n?["minX","maxX"]:["minY","maxY"],s={x:0,y:0};return"start"===i?{...s,[n]:t[r]-l[r]}:"end"===i?{...s,[n]:t[a]-l[a]}:{...s,[n]:(t[r]+t[a])/2-(l[r]+l[a])/2}}}),bD=tC(()=>{tM(),bL(),dN(),dR(),fG(),dx(),fO(),tL(),dO(),fK(),df(),dj(),xz=(e,t,n,i)=>{let l=i.scene.getSelectedElements(t);return l.length>1&&!l.some(e=>nP(e))},xH=(e,t,n,i)=>{let l=n.scene.getSelectedElements(t),r=xN(l,i),a=na(r);return gO(e.map(e=>a.get(e.id)||e),t,n)},iY({name:"alignTop",trackEvent:{category:"element"},predicate:xz,perform:(e,t,n,i)=>({appState:t,elements:xH(e,t,i,{position:"start",axis:"y"}),commitToHistory:!0}),keyTest:e=>e[aO.CTRL_OR_CMD]&&e.shiftKey&&e.key===aO.ARROW_UP,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>(0,s.jsx)(lF,{hidden:!xz(e,t,null,i),type:"button",icon:rP,onClick:()=>n(null),title:`${C("labels.alignTop")} \u2014 ${t0("CtrlOrCmd+Shift+Up")}`,"aria-label":C("labels.alignTop"),visible:gU(fk(e),t)})}),iY({name:"alignBottom",trackEvent:{category:"element"},predicate:xz,perform:(e,t,n,i)=>({appState:t,elements:xH(e,t,i,{position:"end",axis:"y"}),commitToHistory:!0}),keyTest:e=>e[aO.CTRL_OR_CMD]&&e.shiftKey&&e.key===aO.ARROW_DOWN,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>(0,s.jsx)(lF,{hidden:!xz(e,t,null,i),type:"button",icon:r_,onClick:()=>n(null),title:`${C("labels.alignBottom")} \u2014 ${t0("CtrlOrCmd+Shift+Down")}`,"aria-label":C("labels.alignBottom"),visible:gU(fk(e),t)})}),iY({name:"alignLeft",trackEvent:{category:"element"},predicate:xz,perform:(e,t,n,i)=>({appState:t,elements:xH(e,t,i,{position:"start",axis:"x"}),commitToHistory:!0}),keyTest:e=>e[aO.CTRL_OR_CMD]&&e.shiftKey&&e.key===aO.ARROW_LEFT,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>(0,s.jsx)(lF,{hidden:!xz(e,t,null,i),type:"button",icon:rR,onClick:()=>n(null),title:`${C("labels.alignLeft")} \u2014 ${t0("CtrlOrCmd+Shift+Left")}`,"aria-label":C("labels.alignLeft"),visible:gU(fk(e),t)})}),iY({name:"alignRight",trackEvent:{category:"element"},predicate:xz,perform:(e,t,n,i)=>({appState:t,elements:xH(e,t,i,{position:"end",axis:"x"}),commitToHistory:!0}),keyTest:e=>e[aO.CTRL_OR_CMD]&&e.shiftKey&&e.key===aO.ARROW_RIGHT,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>(0,s.jsx)(lF,{hidden:!xz(e,t,null,i),type:"button",icon:rN,onClick:()=>n(null),title:`${C("labels.alignRight")} \u2014 ${t0("CtrlOrCmd+Shift+Right")}`,"aria-label":C("labels.alignRight"),visible:gU(fk(e),t)})}),iY({name:"alignVerticallyCentered",trackEvent:{category:"element"},predicate:xz,perform:(e,t,n,i)=>({appState:t,elements:xH(e,t,i,{position:"center",axis:"y"}),commitToHistory:!0}),PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>(0,s.jsx)(lF,{hidden:!xz(e,t,null,i),type:"button",icon:rH,onClick:()=>n(null),title:C("labels.centerVertically"),"aria-label":C("labels.centerVertically"),visible:gU(fk(e),t)})}),iY({name:"alignHorizontallyCentered",trackEvent:{category:"element"},predicate:xz,perform:(e,t,n,i)=>({appState:t,elements:xH(e,t,i,{position:"center",axis:"x"}),commitToHistory:!0}),PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>(0,s.jsx)(lF,{hidden:!xz(e,t,null,i),type:"button",icon:rB,onClick:()=>n(null),title:C("labels.centerHorizontally"),"aria-label":C("labels.centerHorizontally"),visible:gU(fk(e),t)})})}),bA=tC(()=>{tM(),fB(),dI(),uq(),xB=(e,t)=>{let[n,i,l,r]="x"===t.axis?["minX","midX","maxX","width"]:["minY","midY","maxY","height"],a=m9(e),s=iV(e).map(e=>[e,m9(e)]).sort((e,t)=>e[1][i]-t[1][i]),o=0;for(let e of s)o+=e[1][r];let d=(a[r]-o)/(s.length-1);if(d<0){let e=s.findIndex(e=>e[1][n]===a[n]),r=s.findIndex(e=>e[1][l]===a[l]),o=(s[r][1][i]-s[e][1][i])/(s.length-1),d=s[e][1][i];return s.flatMap(([n,l],a)=>{let s={x:0,y:0};return a!==e&&a!==r&&(d+=o,s[t.axis]=d-l[i]),n.map(e=>g1(e,{x:e.x+s.x,y:e.y+s.y}))})}let c=a[n];return s.flatMap(([e,i])=>{let l={x:0,y:0};return l[t.axis]=c-i[n],c+=d+i[r],e.map(e=>g1(e,{x:e.x+l.x,y:e.y+l.y}))})}}),bP=tC(()=>{tM(),dN(),dR(),bA(),fG(),dx(),fO(),tL(),dO(),fK(),df(),dj(),xF=(e,t)=>{let n=t.scene.getSelectedElements(e);return n.length>1&&!n.some(e=>nP(e))},x$=(e,t,n,i)=>{let l=n.scene.getSelectedElements(t),r=xB(l,i),a=na(r);return gO(e.map(e=>a.get(e.id)||e),t,n)},iY({name:"distributeHorizontally",trackEvent:{category:"element"},perform:(e,t,n,i)=>({appState:t,elements:x$(e,t,i,{space:"between",axis:"x"}),commitToHistory:!0}),keyTest:e=>!e[aO.CTRL_OR_CMD]&&e.altKey&&e.code===aN.H,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>(0,s.jsx)(lF,{hidden:!xF(t,i),type:"button",icon:rO,onClick:()=>n(null),title:`${C("labels.distributeHorizontally")} \u2014 ${t0("Alt+H")}`,"aria-label":C("labels.distributeHorizontally"),visible:gU(fk(e),t)})}),iY({name:"distributeVertically",trackEvent:{category:"element"},perform:(e,t,n,i)=>({appState:t,elements:x$(e,t,i,{space:"between",axis:"y"}),commitToHistory:!0}),keyTest:e=>!e[aO.CTRL_OR_CMD]&&e.altKey&&e.code===aN.V,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>(0,s.jsx)(lF,{hidden:!xF(t,i),type:"button",icon:rz,onClick:()=>n(null),title:`${C("labels.distributeVertically")} \u2014 ${t0("Alt+V")}`,"aria-label":C("labels.distributeVertically"),visible:gU(fk(e),t)})})}),b_=tC(()=>{tM(),dj(),fK(),fG(),fZ(),df(),dO(),uq(),dY(),fO(),xZ=iY({name:"flipHorizontal",trackEvent:{category:"element"},perform:(e,t,n,i)=>({elements:gO(xU(e,t,"horizontal"),t,i),appState:t,commitToHistory:!0}),keyTest:e=>e.shiftKey&&e.code===aN.H,contextItemLabel:"labels.flipHorizontal"}),xW=iY({name:"flipVertical",trackEvent:{category:"element"},perform:(e,t,n,i)=>({elements:gO(xU(e,t,"vertical"),t,i),appState:t,commitToHistory:!0}),keyTest:e=>e.shiftKey&&e.code===aN.V&&!e[aO.CTRL_OR_CMD],contextItemLabel:"labels.flipVertical"}),xU=(e,t,n)=>{let i=gV(fk(e),t,{includeBoundTextElement:!0,includeElementsInFrames:!0}),l=xG(i,t,n),r=na(l);return e.map(e=>r.get(e.id)||e)},xG=(e,t,n)=>{let{minX:i,minY:l,maxX:r,maxY:a}=m9(e);return fm({originalElements:na(e)},e,"nw",!0,"horizontal"===n?r:i,"horizontal"===n?l:a),(oC(t)?oT:oR)(e),e}}),bR=tC(()=>{tM(),dO(),dj(),ml(),fY(),by(),fG(),tL(),tR(),xV=iY({name:"copy",trackEvent:{category:"element"},perform:async(e,t,n,i)=>{let l=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0});try{await ho(l,i.files,n)}catch(e){return{commitToHistory:!1,appState:{...t,errorMessage:e.message}}}return{commitToHistory:!1}},contextItemLabel:"labels.copy",keyTest:void 0}),xK=iY({name:"paste",trackEvent:{category:"element"},perform:async(e,t,n,i)=>{let l;try{l=await hh()}catch(e){return"AbortError"!==e.name&&"NotAllowedError"!==e.name&&(console.error(`actionPaste ${e.name}: ${e.message}`),Y?{commitToHistory:!1,appState:{...t,errorMessage:C("hints.firefox_clipboard_write")}}:{commitToHistory:!1,appState:{...t,errorMessage:C("errors.asyncPasteFailedOnRead")}})}try{i.pasteFromClipboard(ha({types:l}))}catch(e){return console.error(e),{commitToHistory:!1,appState:{...t,errorMessage:C("errors.asyncPasteFailedOnParse")}}}return{commitToHistory:!1}},contextItemLabel:"labels.paste",keyTest:void 0}),xY=iY({name:"cut",trackEvent:{category:"element"},perform:(e,t,n,i)=>(xV.perform(e,t,n,i),fN.perform(e,t)),contextItemLabel:"labels.cut",keyTest:e=>e[aO.CTRL_OR_CMD]&&e.key===aO.X}),xX=iY({name:"copyAsSvg",trackEvent:{category:"element"},perform:async(e,t,n,i)=>{if(!i.canvas)return{commitToHistory:!1};let{exportedElements:l,exportingFrame:r}=xp(e,t,!0);try{return await xg("clipboard-svg",l,t,i.files,{...t,exportingFrame:r}),{commitToHistory:!1}}catch(e){return console.error(e),{appState:{...t,errorMessage:e.message},commitToHistory:!1}}},predicate:e=>hi&&e.length>0,contextItemLabel:"labels.copyAsSvg"}),xq=iY({name:"copyAsPng",trackEvent:{category:"element"},perform:async(e,t,n,i)=>{if(!i.canvas)return{commitToHistory:!1};let l=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0}),{exportedElements:r,exportingFrame:a}=xp(e,t,!0);try{return await xg("clipboard",r,t,i.files,{...t,exportingFrame:a}),{appState:{...t,toast:{message:C("toast.copyToClipboardAsPng",{exportSelection:l.length?C("toast.selection"):C("toast.canvas"),exportColorScheme:t.exportWithDarkMode?C("buttons.darkMode"):C("buttons.lightMode")})}},commitToHistory:!1}}catch(e){return console.error(e),{appState:{...t,errorMessage:e.message},commitToHistory:!1}}},predicate:e=>hl&&e.length>0,contextItemLabel:"labels.copyAsPng",keyTest:e=>e.code===aN.C&&e.altKey&&e.shiftKey}),xJ=iY({name:"copyText",trackEvent:{category:"element"},perform:(e,t,n,i)=>{let l=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0}).reduce((e,t)=>(nL(t)&&e.push(t.text),e),[]).join(`

`);return hg(l),{commitToHistory:!1}},predicate:(e,t,n,i)=>hi&&i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0}).some(nL),contextItemLabel:"labels.copyText"})}),bN=tC(()=>{tM(),dO(),dj(),tR(),xQ=iY({name:"gridMode",viewMode:!0,trackEvent:{category:"canvas",predicate:e=>!e.gridSize},perform(e,t){return{appState:{...t,gridSize:this.checked(t)?null:eE,objectsSnapModeEnabled:!1},commitToHistory:!1}},checked:e=>null!==e.gridSize,predicate:(e,t,n)=>typeof n.gridModeEnabled>"u",contextItemLabel:"labels.showGrid",keyTest:e=>e[aO.CTRL_OR_CMD]&&e.code===aN.QUOTE})}),bO=tC(()=>{tM(),dO(),dj(),x1=iY({name:"zenMode",viewMode:!0,trackEvent:{category:"canvas",predicate:e=>!e.zenModeEnabled},perform(e,t){return{appState:{...t,zenModeEnabled:!this.checked(t)},commitToHistory:!1}},checked:e=>e.zenModeEnabled,predicate:(e,t,n)=>typeof n.zenModeEnabled>"u",contextItemLabel:"buttons.zenMode",keyTest:e=>!e[aO.CTRL_OR_CMD]&&e.altKey&&e.code===aN.Z})}),bz=tC(()=>{tM(),dO(),dj(),x0=iY({name:"objectsSnapMode",viewMode:!0,trackEvent:{category:"canvas",predicate:e=>!e.objectsSnapModeEnabled},perform(e,t){return{appState:{...t,objectsSnapModeEnabled:!this.checked(t),gridSize:null},commitToHistory:!1}},checked:e=>e.objectsSnapModeEnabled,predicate:(e,t,n)=>typeof n.objectsSnapModeEnabled>"u",contextItemLabel:"buttons.objectsSnapMode",keyTest:e=>!e[aO.CTRL_OR_CMD]&&e.altKey&&e.code===aN.S})}),bH=tC(()=>{tM(),dj(),dO(),x2=iY({name:"stats",viewMode:!0,trackEvent:{category:"menu"},perform(e,t){return{appState:{...t,showStats:!this.checked(t)},commitToHistory:!1}},checked:e=>e.showStats,contextItemLabel:"stats.title",keyTest:e=>!e[aO.CTRL_OR_CMD]&&e.altKey&&e.code===aN.SLASH})}),bB=tC(()=>{tM(),tR(),fG(),fB(),ma(),mr(),dx(),df(),dj(),x3=iY({name:"unbindText",contextItemLabel:"labels.unbindText",trackEvent:{category:"element"},predicate:(e,t,n,i)=>i.scene.getSelectedElements(t).some(e=>nW(e)),perform:(e,t,n,i)=>(i.scene.getSelectedElements(t).forEach(e=>{let t=hU(e);if(t){let{width:n,height:i,baseline:l}=hT(t.originalText,tG(t),t.lineHeight),r=hw(e.id);hv(e.id);let{x:a,y:s}=hj(e,t);gQ(t,{containerId:null,width:n,height:i,baseline:l,text:t.originalText,x:a,y:s}),gQ(e,{boundElements:e.boundElements?.filter(e=>e.id!==t.id),height:r||e.height})}}),{elements:e,appState:t,commitToHistory:!0})}),x6=iY({name:"bindText",contextItemLabel:"labels.bindText",trackEvent:{category:"element"},predicate:(e,t,n,i)=>{let l=i.scene.getSelectedElements(t);if(2===l.length){let e=nL(l[0])||nL(l[1]),t;if(n$(l[0])?t=l[0]:n$(l[1])&&(t=l[1]),e&&t&&null===hU(t))return!0}return!1},perform:(e,t,n,i)=>{let l=i.scene.getSelectedElements(t),r,a;nL(l[0])&&n$(l[1])?(r=l[0],a=l[1]):(r=l[1],a=l[0]),gQ(r,{containerId:a.id,verticalAlign:e0.MIDDLE,textAlign:e2.CENTER}),gQ(a,{boundElements:(a.boundElements||[]).concat({type:"text",id:r.id})});let s=a.height;return hC(r,a),hb(a.id,s),{elements:x4(e,a,r),appState:{...t,selectedElementIds:{[a.id]:!0}},commitToHistory:!0}}}),x4=(e,t,n)=>{let i=e.slice(),l=i.findIndex(e=>e.id===n.id);i.splice(l,1);let r=i.findIndex(e=>e.id===t.id);return i.splice(r+1,0,n),i},x5=(e,t,n)=>{let i=e.slice(),l=i.findIndex(e=>e.id===t.id);i.splice(l,1);let r=i.findIndex(e=>e.id===n.id);return i.splice(r,0,t),i},x8=iY({name:"wrapTextInContainer",contextItemLabel:"labels.createContainerFromText",trackEvent:{category:"element"},predicate:(e,t,n,i)=>{let l=i.scene.getSelectedElements(t),r=l.every(e=>nL(e));return l.length>0&&r},perform:(e,t,n,i)=>{let l=i.scene.getSelectedElements(t),r=e.slice(),a={};for(let e of l)if(nL(e)){let n=lt({type:"rectangle",backgroundColor:t.currentItemBackgroundColor,boundElements:[...e.boundElements||[],{id:e.id,type:"text"}],angle:e.angle,fillStyle:t.currentItemFillStyle,strokeColor:t.currentItemStrokeColor,roughness:t.currentItemRoughness,strokeWidth:t.currentItemStrokeWidth,strokeStyle:t.currentItemStrokeStyle,roundness:"round"===t.currentItemRoundness?{type:nG("rectangle")?e5.ADAPTIVE_RADIUS:e5.PROPORTIONAL_RADIUS}:null,opacity:100,locked:!1,x:e.x-eJ,y:e.y-eJ,width:h0(e.width,"rectangle"),height:h0(e.height,"rectangle"),groupIds:e.groupIds,frameId:e.frameId});if(e.boundElements?.length){let t=e.boundElements.filter(e=>"arrow"===e.type).map(e=>e.id);r.filter(e=>t.includes(e.id)).forEach(t=>{let i=t.startBinding,l=t.endBinding;i?.elementId===e.id&&(i={...i,elementId:n.id}),l?.elementId===e.id&&(l={...l,elementId:n.id}),(i||l)&&gQ(t,{startBinding:i,endBinding:l},!1)})}gQ(e,{containerId:n.id,verticalAlign:e0.MIDDLE,boundElements:null,textAlign:e2.CENTER},!1),hC(e,n),r=x5([...r,n],n,e),a[n.id]=!0}return{elements:r,appState:{...t,selectedElementIds:a},commitToHistory:!0}}})}),bF=tC(()=>{tM(),fB(),dx(),dO(),df(),dj(),x7=e=>e.every(e=>!e.locked),x9=iY({name:"toggleElementLock",trackEvent:{category:"element"},predicate:(e,t,n,i)=>!i.scene.getSelectedElements(t).some(e=>e.locked&&e.frameId),perform:(e,t,n,i)=>{let l=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0});if(!l.length)return!1;let r=x7(l),a=na(l);return{elements:e.map(e=>a.has(e.id)?g1(e,{locked:r}):e),appState:{...t,selectedLinearElement:r?null:t.selectedLinearElement},commitToHistory:!0}},contextItemLabel:(e,t,n)=>{let i=n.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!1});return 1!==i.length||nP(i[0])?x7(i)?"labels.elementLock.lockAll":"labels.elementLock.unlockAll":i[0].locked?"labels.elementLock.unlock":"labels.elementLock.lock"},keyTest:(e,t,n,i)=>e.key.toLocaleLowerCase()===aO.L&&e[aO.CTRL_OR_CMD]&&e.shiftKey&&i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!1}).length>0}),ye=iY({name:"unlockAllElements",trackEvent:{category:"canvas"},viewMode:!1,predicate:e=>e.some(e=>e.locked),perform:(e,t)=>{let n=e.filter(e=>e.locked);return{elements:e.map(e=>e.locked?g1(e,{locked:!1}):e),appState:{...t,selectedElementIds:Object.fromEntries(n.map(e=>[e.id,!0]))},commitToHistory:!0}},contextItemLabel:"labels.elementLock.unlockAll"})}),b$=tC(()=>{tM(),dX(),dx(),dj(),yt=iY({name:"toggleLinearEditor",trackEvent:{category:"element"},predicate:(e,t,n,i)=>{let l=i.scene.getSelectedElements(t);return!!(1===l.length&&nN(l[0]))},perform(e,t,n,i){let l=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0})[0],r=t.editingLinearElement?.elementId===l.id?null:new o2(l,i.scene);return{appState:{...t,editingLinearElement:r},commitToHistory:!1}},contextItemLabel:(e,t,n)=>{let i=n.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0})[0];return t.editingLinearElement?.elementId===i.id?"labels.lineEditor.exit":"labels.lineEditor.edit"}})}),bZ=tC(()=>{tM(),fY(),bd(),bc(),bm(),h9(),mn(),bu(),bE(),bS(),bk(),bC(),bj(),bT(),bD(),bP(),b_(),bR(),bN(),bO(),bz(),bH(),bB(),dZ(),bF(),b$()}),bW=tC(()=>{tM(),dN(),dR(),tL(),dO(),fB(),dY(),df(),tR(),yn=(e,t,n)=>{if(!t.multiElement&&!t.resizingElement&&!t.editingElement&&!t.draggingElement){let i=n();if(null===i)return{commitToHistory:!1};let l=na(e),r=i.elements,a=na(r),s=e.filter(e=>!a.has(e.id)),o=r.map(e=>g1(l.get(e.id)||e,e)).concat(s.map(e=>g1(e,{isDeleted:!0})));return oJ(o,s),{elements:o,appState:{...t,...i.appState},commitToHistory:!1,syncHistory:!0}}return{commitToHistory:!1}},yi=e=>({name:"undo",trackEvent:{category:"history"},perform:(t,n)=>yn(t,n,()=>e.undoOnce()),keyTest:e=>e[aO.CTRL_OR_CMD]&&e.key.toLowerCase()===aO.Z&&!e.shiftKey,PanelComponent:({updateData:e,data:t})=>(0,s.jsx)(lF,{type:"button",icon:rI,"aria-label":C("buttons.undo"),onClick:e,size:t?.size||"medium"}),commitToHistory:()=>!1}),yl=e=>({name:"redo",trackEvent:{category:"history"},perform:(t,n)=>yn(t,n,()=>e.redoOnce()),keyTest:e=>e[aO.CTRL_OR_CMD]&&e.shiftKey&&e.key.toLowerCase()===aO.Z||K&&e.ctrlKey&&!e.shiftKey&&e.key===aO.Y,PanelComponent:({updateData:e,data:t})=>(0,s.jsx)(lF,{type:"button",icon:rM,"aria-label":C("buttons.redo"),onClick:e,size:t?.size||"medium"}),commitToHistory:()=>!1})}),bU=tC(()=>{tM(),d$(),yr=(e,t,n,i,l,r)=>{if(e.trackEvent)try{"object"==typeof e.trackEvent&&(!e.trackEvent.predicate||e.trackEvent.predicate(n,i,r))&&aX(e.trackEvent.category,e.trackEvent.action||e.name,`${t} (${l.device.editor.isMobile?"mobile":"desktop"})`)}catch(e){console.error("error while logging action:",e)}},ya=class{actions={};updater;getAppState;getElementsIncludingDeleted;app;constructor(e,t,n,i){this.updater=t=>{if(!t||!("then"in t))return e(t);t.then(t=>e(t))},this.getAppState=t,this.getElementsIncludingDeleted=n,this.app=i}registerAction(e){this.actions[e.name]=e}registerAll(e){e.forEach(e=>this.registerAction(e))}handleKeyDown(e){let t=this.app.props.UIOptions.canvasActions,n=Object.values(this.actions).sort((e,t)=>(t.keyPriority||0)-(e.keyPriority||0)).filter(n=>(!(n.name in t)||t[n.name])&&n.keyTest&&n.keyTest(e,this.getAppState(),this.getElementsIncludingDeleted(),this.app));if(1!==n.length)return n.length>1&&console.warn("Canceling as multiple actions match this shortcut",n),!1;let i=n[0];if(this.getAppState().viewModeEnabled&&!0!==i.viewMode)return!1;let l=this.getElementsIncludingDeleted(),r=this.getAppState();return yr(i,"keyboard",r,l,this.app,null),e.preventDefault(),e.stopPropagation(),this.updater(n[0].perform(l,r,null,this.app)),!0}executeAction(e,t="api",n=null){let i=this.getElementsIncludingDeleted(),l=this.getAppState();yr(e,t,l,i,this.app,n),this.updater(e.perform(i,l,n,this.app))}renderAction=(e,t)=>{let n=this.app.props.UIOptions.canvasActions;if(this.actions[e]&&"PanelComponent"in this.actions[e]&&(!(e in n)||n[e])){let n=this.actions[e],i=n.PanelComponent;i.displayName="PanelComponent";let l=this.getElementsIncludingDeleted(),r=this.getAppState();return(0,s.jsx)(i,{elements:this.getElementsIncludingDeleted(),appState:this.getAppState(),updateData:e=>{yr(n,"ui",r,l,this.app,e),this.updater(n.perform(this.getElementsIncludingDeleted(),this.getAppState(),e,this.app))},appProps:this.app.props,app:this.app,data:t})}return null};isActionEnabled=e=>{let t=this.getElementsIncludingDeleted(),n=this.getAppState();return!e.predicate||e.predicate(t,n,this.app.props,this.app)}}}),bG=tC(()=>{tM(),ys=e=>{let t=Array.from(e.values());return{x:yd(t,e=>e.x)/t.length,y:yd(t,e=>e.y)/t.length}},yo=([e,t])=>Math.hypot(e.x-t.x,e.y-t.y),yd=(e,t)=>e.reduce((e,n)=>e+t(n),0)}),bV=tC(()=>{tM(),dx(),dD(),yc=e=>({selectedElementIds:e.selectedElementIds,selectedGroupIds:e.selectedGroupIds,viewBackgroundColor:e.viewBackgroundColor,editingLinearElement:e.editingLinearElement,editingGroupId:e.editingGroupId,name:e.name}),yh=class{elementCache=new Map;recording=!0;stateHistory=[];redoStack=[];lastEntry=null;hydrateHistoryEntry({appState:e,elements:t}){return{appState:JSON.parse(e),elements:t.map(e=>{let t=this.elementCache.get(e.id)?.get(e.versionNonce);if(!t)throw Error(`Element not found: ${e.id}:${e.versionNonce}`);return t})}}dehydrateHistoryEntry({appState:e,elements:t}){return{appState:JSON.stringify(e),elements:t.map(e=>{this.elementCache.has(e.id)||this.elementCache.set(e.id,new Map);let t=this.elementCache.get(e.id);return t.has(e.versionNonce)||t.set(e.versionNonce,lg(e)),{id:e.id,versionNonce:e.versionNonce}})}}getSnapshotForTest(){return{recording:this.recording,stateHistory:this.stateHistory.map(e=>this.hydrateHistoryEntry(e)),redoStack:this.redoStack.map(e=>this.hydrateHistoryEntry(e))}}clear(){this.stateHistory.length=0,this.redoStack.length=0,this.lastEntry=null,this.elementCache.clear()}generateEntry=(e,t)=>this.dehydrateHistoryEntry({appState:yc(e),elements:t.reduce((t,n)=>{if(nN(n)&&e.multiElement&&e.multiElement.id===n.id){if(e.multiElement&&e.multiElement.id===n.id&&n.points.length<2)return t;t.push({...n,points:n.lastCommittedPoint!==n.points[n.points.length-1]?n.points.slice(0,-1):n.points})}else t.push(n);return t},[])});shouldCreateEntry(e){let t,{lastEntry:n}=this;if(!n||e.elements.length!==n.elements.length)return!0;for(let t=e.elements.length-1;t>-1;t--){let i=e.elements[t],l=n.elements[t];if(!i||!l||i.id!==l.id||i.versionNonce!==l.versionNonce)return!0}for(t in e.appState)if(!("editingLinearElement"===t&&e.appState[t]?.elementId===n.appState[t]?.elementId)&&!("selectedElementIds"===t||"selectedGroupIds"===t)&&e.appState[t]!==n.appState[t])return!0;return!1}pushEntry(e,t){let n=this.generateEntry(e,t),i=this.hydrateHistoryEntry(n);if(i){if(!this.shouldCreateEntry(i))return;this.stateHistory.push(n),this.lastEntry=i,this.clearRedoStack()}}clearRedoStack(){this.redoStack.splice(0,this.redoStack.length)}redoOnce(){if(0===this.redoStack.length)return null;let e=this.redoStack.pop();return void 0!==e?(this.stateHistory.push(e),this.hydrateHistoryEntry(e)):null}undoOnce(){if(1===this.stateHistory.length)return null;let e=this.stateHistory.pop(),t=this.stateHistory[this.stateHistory.length-1];return void 0!==e?(this.redoStack.push(e),this.hydrateHistoryEntry(t)):null}setCurrentState(e,t){this.lastEntry=this.hydrateHistoryEntry(this.generateEntry(e,t))}resumeRecording(){this.recording=!0}record(e,t){this.recording&&(this.pushEntry(e,t),this.recording=!1)}}}),bK=tC(()=>{tM(),dN(),dO(),ym=[{icon:l2,value:"selection",key:aO.V,numericKey:aO[1],fillable:!0},{icon:l3,value:"rectangle",key:aO.R,numericKey:aO[2],fillable:!0},{icon:l6,value:"diamond",key:aO.D,numericKey:aO[3],fillable:!0},{icon:l4,value:"ellipse",key:aO.O,numericKey:aO[4],fillable:!0},{icon:l5,value:"arrow",key:aO.A,numericKey:aO[5],fillable:!0},{icon:l8,value:"line",key:aO.L,numericKey:aO[6],fillable:!0},{icon:l9,value:"freedraw",key:[aO.P,aO.X],numericKey:aO[7],fillable:!1},{icon:re,value:"text",key:aO.T,numericKey:aO[8],fillable:!1},{icon:rt,value:"image",key:null,numericKey:aO[9],fillable:!1},{icon:rn,value:"eraser",key:aO.E,numericKey:aO[0],fillable:!1}],yu=e=>ym.find((t,n)=>null!=t.numericKey&&e===t.numericKey.toString()||t.key&&("string"==typeof t.key?t.key===e:t.key.includes(e)))?.value||null}),bY=tC(()=>{}),bX=tC(()=>{tM(),tR(),tL(),df(),yp={toggleTheme:[t0("Shift+Alt+D")],saveScene:[t0("CtrlOrCmd+S")],loadScene:[t0("CtrlOrCmd+O")],clearCanvas:[t0("CtrlOrCmd+Delete")],imageExport:[t0("CtrlOrCmd+Shift+E")],cut:[t0("CtrlOrCmd+X")],copy:[t0("CtrlOrCmd+C")],paste:[t0("CtrlOrCmd+V")],copyStyles:[t0("CtrlOrCmd+Alt+C")],pasteStyles:[t0("CtrlOrCmd+Alt+V")],selectAll:[t0("CtrlOrCmd+A")],deleteSelectedElements:[t0("Delete")],duplicateSelection:[t0("CtrlOrCmd+D"),t0(`Alt+${C("helpDialog.drag")}`)],sendBackward:[t0("CtrlOrCmd+[")],bringForward:[t0("CtrlOrCmd+]")],sendToBack:[V?t0("CtrlOrCmd+Alt+["):t0("CtrlOrCmd+Shift+[")],bringToFront:[V?t0("CtrlOrCmd+Alt+]"):t0("CtrlOrCmd+Shift+]")],copyAsPng:[t0("Shift+Alt+C")],copyAsSvg:[],group:[t0("CtrlOrCmd+G")],ungroup:[t0("CtrlOrCmd+Shift+G")],gridMode:[t0("CtrlOrCmd+'")],zenMode:[t0("Alt+Z")],objectsSnapMode:[t0("Alt+S")],stats:[t0("Alt+/")],addToLibrary:[],flipHorizontal:[t0("Shift+H")],flipVertical:[t0("Shift+V")],viewMode:[t0("Alt+R")],hyperlink:[t0("CtrlOrCmd+K")],toggleElementLock:[t0("CtrlOrCmd+Shift+L")]},yg=e=>{let t=yp[e];return t&&t.length>0?t[0]:""}}),bq=tC(()=>{tM(),cy(),tL(),bY(),bX(),CJ(),yf="separator",yx=l.memo(({actionManager:e,items:t,top:n,left:i,onClose:l})=>{let r=k7(),a=k8(),o=t.reduce((t,n)=>(n&&(n===yf||!n.predicate||n.predicate(a,r,e.app.props,e.app))&&t.push(n),t),[]);return(0,s.jsx)(cd,{onCloseRequest:()=>{l()},top:n,left:i,fitInViewport:!0,offsetLeft:r.offsetLeft,offsetTop:r.offsetTop,viewportWidth:r.width,viewportHeight:r.height,children:(0,s.jsx)("ul",{className:"context-menu",onContextMenu:e=>e.preventDefault(),children:o.map((t,n)=>{if(t===yf)return o[n-1]&&o[n-1]!==yf?(0,s.jsx)("hr",{className:"context-menu-item-separator"},n):null;let i=t.name,c="";return t.contextItemLabel&&(c="function"==typeof t.contextItemLabel?C(t.contextItemLabel(a,r,e.app)):C(t.contextItemLabel)),(0,s.jsx)("li",{"data-testid":i,onClick:()=>{l(()=>{e.executeAction(t,"contextMenu")})},children:(0,s.jsxs)("button",{className:(0,d.Z)("context-menu-item",{dangerous:"deleteSelectedElements"===i,checkmark:t.checked?.(r)}),children:[(0,s.jsx)("div",{className:"context-menu-item__label",children:c}),(0,s.jsx)("kbd",{className:"context-menu-item__shortcut",children:i?yg(i):""})]})},n)})})})})}),bJ=tC(()=>{}),bQ=tC(()=>{tM(),bJ(),yy={Row:(0,l.forwardRef)(({children:e,gap:t,align:n,justifyContent:i,className:l,style:r},a)=>(0,s.jsx)("div",{className:(0,d.Z)("Stack Stack_horizontal",l),style:{"--gap":t,alignItems:n,justifyContent:i,...r},ref:a,children:e})),Col:(0,l.forwardRef)(({children:e,gap:t,align:n,justifyContent:i,className:l,style:r},a)=>(0,s.jsx)("div",{className:(0,d.Z)("Stack Stack_vertical",l),style:{"--gap":t,justifyItems:n,justifyContent:i,...r},ref:a,children:e}))}}),b1=tC(()=>{}),b0=tC(()=>{tM(),CJ(),yv=yb=({className:e="",children:t,onToggle:n,title:i,...l})=>{let r=k4(),a=(0,d.Z)(`dropdown-menu-button ${e}`,"zen-mode-transition",{"dropdown-menu-button--mobile":r.editor.isMobile}).trim();return(0,s.jsx)("button",{"data-prevent-outside-click":!0,className:a,onClick:n,type:"button","data-testid":"dropdown-menu-button",title:i,...l,children:t})},yb.displayName="DropdownMenuTrigger"}),b2=tC(()=>{tM(),tR(),df(),yw=l.createContext({}),yE=(e="",t=!1)=>`dropdown-menu-item dropdown-menu-item-base ${e} ${t?"dropdown-menu-item--selected":""}`.trim(),yS=(e,t)=>{let n=(0,l.useContext)(yw);return nf(e,e=>{let i=new CustomEvent("menu.itemSelect",{bubbles:!0,cancelable:!0});t?.(i),i.defaultPrevented||n.onSelect?.(i)})}}),b3=tC(()=>{tM(),CJ(),yk=({icon:e,shortcut:t,children:n})=>{let i=k4();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"dropdown-menu-item__icon",children:e}),(0,s.jsx)("div",{className:"dropdown-menu-item__text",children:n}),t&&!i.editor.isMobile&&(0,s.jsx)("div",{className:"dropdown-menu-item__shortcut",children:t})]})}}),b6=tC(()=>{tM(),b2(),b3(),(yC=({icon:e,onSelect:t,children:n,shortcut:i,className:l,selected:r,...a})=>{let o=yS(a.onClick,t);return(0,s.jsx)("button",{...a,onClick:o,type:"button",className:yE(l,r),title:a.title??a["aria-label"],children:(0,s.jsx)(yk,{icon:e,shortcut:i,children:n})})}).displayName="DropdownMenuItem",(yI=({children:e})=>(0,s.jsx)("div",{style:{display:"inline-flex",marginLeft:"auto",padding:"2px 4px",background:"pink",borderRadius:6,fontSize:9,color:"black",fontFamily:"Cascadia, monospace"},children:e})).displayName="DropdownMenuItemBadge",yC.Badge=yI,yM=yC}),b4=tC(()=>{tM(),yT=yj=()=>(0,s.jsx)("div",{style:{height:"1px",backgroundColor:"var(--default-border-color)",margin:".5rem 0"}}),yj.displayName="DropdownMenuSeparator"}),b5=tC(()=>{tM(),yD=yL=({children:e,className:t="",style:n,title:i})=>(0,s.jsxs)("div",{className:`dropdown-menu-group ${t}`,style:n,children:[i&&(0,s.jsx)("p",{className:"dropdown-menu-group-title",children:i}),e]}),yL.displayName="DropdownMenuGroup"}),b8=tC(()=>{}),b7=tC(()=>{tM(),b8(),yA=l.forwardRef(({children:e,padding:t,className:n,style:i},l)=>(0,s.jsx)("div",{className:(0,d.Z)("Island",n),style:{"--padding":t,...i},ref:l,children:e}))}),b9=tC(()=>{tM(),b7(),CJ(),bQ(),b2(),cc(),(yP=({children:e,onClickOutside:t,className:n="",onSelect:i,style:r})=>{let a=k4(),o=(0,l.useRef)(null);d9(o,()=>{t?.()});let c=(0,d.Z)(`dropdown-menu ${n}`,{"dropdown-menu--mobile":a.editor.isMobile}).trim();return(0,s.jsx)(yw.Provider,{value:{onSelect:i},children:(0,s.jsx)("div",{ref:o,className:c,style:r,"data-testid":"dropdown-menu",children:a.editor.isMobile?(0,s.jsx)(yy.Col,{className:"dropdown-menu-container",children:e}):(0,s.jsx)(yA,{className:"dropdown-menu-container",padding:2,style:{zIndex:2},children:e})})})}).displayName="DropdownMenuContent",y_=yP}),ve=tC(()=>{tM(),b3(),b2(),yN=yR=({icon:e,shortcut:t,href:n,children:i,onSelect:l,className:r="",selected:a,...o})=>{let d=yS(o.onClick,l);return(0,s.jsx)("a",{...o,href:n,target:"_blank",rel:"noreferrer",className:yE(r,a),title:o.title??o["aria-label"],onClick:d,children:(0,s.jsx)(yk,{icon:e,shortcut:t,children:i})})},yR.displayName="DropdownMenuItemLink"}),vt=tC(()=>{tM(),yO=({children:e,className:t="",selected:n,...i})=>(0,s.jsx)("div",{...i,className:`dropdown-menu-item-base dropdown-menu-item-custom ${t} ${n?"dropdown-menu-item--selected":""}`.trim(),children:e})}),vn=tC(()=>{tM(),yz=e=>l.Children.toArray(e).find(e=>l.isValidElement(e)&&"string"!=typeof e.type&&e?.type.displayName&&"DropdownMenuTrigger"===e.type.displayName)||null,yH=e=>l.Children.toArray(e).find(e=>l.isValidElement(e)&&"string"!=typeof e.type&&e?.type.displayName&&"DropdownMenuContent"===e.type.displayName)||null}),vi=tC(()=>{}),vl=tC(()=>{tM(),b0(),b6(),b4(),b5(),b9(),ve(),vt(),vn(),vi(),(yB=({children:e,open:t})=>{let n=yz(e),i=yH(e);return(0,s.jsxs)(s.Fragment,{children:[n,t&&i]})}).Trigger=yv,yB.Content=y_,yB.Item=yM,yB.ItemLink=yN,yB.ItemCustom=yO,yB.Group=yD,yB.Separator=yT,yF=yB,yB.displayName="DropdownMenu"}),vr=tC(()=>{tM(),y$=l.createContext(null),yZ=()=>l.useContext(y$),yW=()=>l.useMemo(()=>({MainMenuTunnel:(0,tb.Z)(),WelcomeScreenMenuHintTunnel:(0,tb.Z)(),WelcomeScreenToolbarHintTunnel:(0,tb.Z)(),WelcomeScreenHelpHintTunnel:(0,tb.Z)(),WelcomeScreenCenterTunnel:(0,tb.Z)(),FooterCenterTunnel:(0,tb.Z)(),DefaultSidebarTriggerTunnel:(0,tb.Z)(),DefaultSidebarTabTriggersTunnel:(0,tb.Z)(),OverwriteConfirmDialogTunnel:(0,tb.Z)(),TTDDialogTriggerTunnel:(0,tb.Z)(),jotaiScope:Symbol()}),[])}),va=tC(()=>{tM(),fG(),tL(),CJ(),fK(),bK(),df(),bQ(),dR(),h7(),d$(),dx(),bZ(),dH(),ma(),b1(),vl(),dN(),dO(),vr(),yU=({appState:e,elements:t,renderAction:n})=>{let i=gK(fk(t),e),l=!1;2===i.length&&(nW(i[0])||nW(i[1]))&&(l=!0);let r=!!e.editingElement,a=k4(),o="rtl"===document.documentElement.getAttribute("dir"),d=cE(e.activeTool.type)&&!nt(e.currentItemBackgroundColor)||i.some(e=>cE(e.type)&&!nt(e.backgroundColor)),c=cE(e.activeTool.type)||i.some(e=>cE(e.type)),h=1===i.length||l,m=i[0]?.type||null;for(let e of i)if(e.type!==m){m=null;break}return(0,s.jsxs)("div",{className:"panelColumn",children:[(0,s.jsx)("div",{children:(cS(e.activeTool.type)&&"image"!==e.activeTool.type&&"image"!==m&&"frame"!==m&&"magicframe"!==m||i.some(e=>cS(e.type)))&&n("changeStrokeColor")}),c&&(0,s.jsx)("div",{children:n("changeBackgroundColor")}),d&&n("changeFillStyle"),(ck(e.activeTool.type)||i.some(e=>ck(e.type)))&&n("changeStrokeWidth"),("freedraw"===e.activeTool.type||i.some(e=>"freedraw"===e.type))&&n("changeStrokeShape"),(cC(e.activeTool.type)||i.some(e=>cC(e.type)))&&(0,s.jsxs)(s.Fragment,{children:[n("changeStrokeStyle"),n("changeSloppiness")]}),(cI(e.activeTool.type)||i.some(e=>cI(e.type)))&&(0,s.jsx)(s.Fragment,{children:n("changeRoundness")}),("text"===e.activeTool.type||i.some(nL))&&(0,s.jsxs)(s.Fragment,{children:[n("changeFontSize"),n("changeFontFamily"),("text"===e.activeTool.type||hq(i))&&n("changeTextAlign")]}),hX(i)&&n("changeVerticalAlign"),(cM(e.activeTool.type)||i.some(e=>cM(e.type)))&&(0,s.jsx)(s.Fragment,{children:n("changeArrowhead")}),n("changeOpacity"),(0,s.jsxs)("fieldset",{children:[(0,s.jsx)("legend",{children:C("labels.layers")}),(0,s.jsxs)("div",{className:"buttonList",children:[n("sendToBack"),n("sendBackward"),n("bringToFront"),n("bringForward")]})]}),i.length>1&&!l&&(0,s.jsxs)("fieldset",{children:[(0,s.jsx)("legend",{children:C("labels.align")}),(0,s.jsxs)("div",{className:"buttonList",children:[o?(0,s.jsxs)(s.Fragment,{children:[n("alignRight"),n("alignHorizontallyCentered"),n("alignLeft")]}):(0,s.jsxs)(s.Fragment,{children:[n("alignLeft"),n("alignHorizontallyCentered"),n("alignRight")]}),i.length>2&&n("distributeHorizontally"),(0,s.jsx)("div",{style:{flexBasis:"100%",height:0}}),(0,s.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:".5rem",marginTop:"-0.5rem"},children:[n("alignTop"),n("alignVerticallyCentered"),n("alignBottom"),i.length>2&&n("distributeVertically")]})]})]}),!r&&i.length>0&&(0,s.jsxs)("fieldset",{children:[(0,s.jsx)("legend",{children:C("labels.actions")}),(0,s.jsxs)("div",{className:"buttonList",children:[!a.editor.isMobile&&n("duplicateSelection"),!a.editor.isMobile&&n("deleteSelectedElements"),n("group"),n("ungroup"),h&&n("hyperlink")]})]})]})},yG=({activeTool:e,appState:t,app:n,UIOptions:i})=>{let[r,a]=(0,l.useState)(!1),o="frame"===e.type,c="laser"===e.type,h="embeddable"===e.type,{TTDDialogTriggerTunnel:m}=yZ();return(0,s.jsxs)(s.Fragment,{children:[ym.map(({value:l,icon:r,key:a,numericKey:o,fillable:c},h)=>{if(i.tools?.[l]===!1)return null;let m=C(`toolBar.${l}`),u=a&&tB("string"==typeof a?a:a[0]),p=u?`${u} ${C("helpDialog.or")} ${o}`:`${o}`;return(0,s.jsx)(lF,{className:(0,d.Z)("Shape",{fillable:c}),type:"radio",icon:r,checked:e.type===l,name:"editor-current-shape",title:`${tB(m)} \u2014 ${p}`,keyBindingLabel:o||u,"aria-label":tB(m),"aria-keyshortcuts":p,"data-testid":`toolbar-${l}`,onPointerDown:({pointerType:e})=>{t.penDetected||"pen"!==e||n.togglePenMode(!0)},onChange:({pointerType:e})=>{t.activeTool.type!==l&&aX("toolbar",l,"ui"),"image"===l?n.setActiveTool({type:l,insertOnCanvasDirectly:"mouse"!==e}):n.setActiveTool({type:l})}},l)}),(0,s.jsx)("div",{className:"App-toolbar__divider"}),(0,s.jsxs)(yF,{open:r,children:[(0,s.jsx)(yF.Trigger,{className:(0,d.Z)("App-toolbar__extra-tools-trigger",{"App-toolbar__extra-tools-trigger--selected":o||h||c&&!n.props.isCollaborating}),onToggle:()=>a(!r),title:C("toolBar.extraTools"),children:ak}),(0,s.jsxs)(yF.Content,{onClickOutside:()=>a(!1),onSelect:()=>a(!1),className:"App-toolbar__extra-tools-dropdown",children:[(0,s.jsx)(yF.Item,{onSelect:()=>n.setActiveTool({type:"frame"}),icon:aC,shortcut:aO.F.toLocaleUpperCase(),"data-testid":"toolbar-frame",selected:o,children:C("toolBar.frame")}),(0,s.jsx)(yF.Item,{onSelect:()=>n.setActiveTool({type:"embeddable"}),icon:ra,"data-testid":"toolbar-embeddable",selected:h,children:C("toolBar.embeddable")}),(0,s.jsx)(yF.Item,{onSelect:()=>n.setActiveTool({type:"laser"}),icon:aj,"data-testid":"toolbar-laser",selected:c,shortcut:aO.K.toLocaleUpperCase(),children:C("toolBar.laser")}),(0,s.jsx)("div",{style:{margin:"6px 0",fontSize:14,fontWeight:600},children:"Generate"}),!1!==n.props.aiEnabled&&(0,s.jsx)(m.Out,{}),(0,s.jsx)(yF.Item,{onSelect:()=>n.setOpenDialog({name:"ttd",tab:"mermaid"}),icon:aI,"data-testid":"toolbar-embeddable",children:C("toolBar.mermaidToExcalidraw")}),!1!==n.props.aiEnabled&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(yF.Item,{onSelect:()=>n.onMagicframeToolSelect(),icon:aT,"data-testid":"toolbar-magicframe",children:[C("toolBar.magicframe"),(0,s.jsx)(yF.Item.Badge,{children:"AI"})]}),(0,s.jsx)(yF.Item,{onSelect:()=>{aX("ai","open-settings","d2c"),n.setOpenDialog({name:"settings",source:"settings",tab:"diagram-to-code"})},icon:aL,"data-testid":"toolbar-magicSettings",children:C("toolBar.magicSettings")})]})]})]})]})},yV=({renderAction:e,zoom:t})=>(0,s.jsx)(yy.Col,{gap:1,className:"zoom-actions",children:(0,s.jsxs)(yy.Row,{align:"center",children:[e("zoomOut"),e("resetZoom"),e("zoomIn")]})}),yK=({renderAction:e,className:t})=>(0,s.jsxs)("div",{className:`undo-redo-buttons ${t}`,children:[(0,s.jsx)("div",{className:"undo-button-container",children:(0,s.jsx)(aU,{label:C("buttons.undo"),children:e("undo")})}),(0,s.jsx)("div",{className:"redo-button-container",children:(0,s.jsxs)(aU,{label:C("buttons.redo"),children:[" ",e("redo")]})})]}),yY=({actionManager:e,showExitZenModeBtn:t})=>(0,s.jsx)("button",{className:(0,d.Z)("disable-zen-mode",{"disable-zen-mode--visible":t}),onClick:()=>e.executeAction(x1),children:C("buttons.exitZenMode")}),yX=({renderAction:e,className:t})=>(0,s.jsx)("div",{className:`finalize-button ${t}`,children:e("finalize",{size:"small"})})}),vs=tC(()=>{tM(),yq=()=>{let[e,t]=(0,l.useState)(null);return[e,(0,l.useCallback)(e=>t(e),[])]}}),vo=tC(()=>{}),vd=tC(()=>{}),vc=tC(()=>{tM(),vd(),dO(),d7(),yJ=e=>{let{closeOnClickOutside:t=!0}=e,n=dg({className:"excalidraw-modal-container"});return n?(0,tc.createPortal)((0,s.jsxs)("div",{className:(0,d.Z)("Modal",e.className),role:"dialog","aria-modal":"true",onKeyDown:t=>{t.key===aO.ESCAPE&&(t.nativeEvent.stopImmediatePropagation(),t.stopPropagation(),e.onCloseRequest())},"aria-labelledby":e.labelledBy,"data-prevent-outside-click":!0,children:[(0,s.jsx)("div",{className:"Modal__background",onClick:t?e.onCloseRequest:void 0}),(0,s.jsx)("div",{className:"Modal__content",style:{"--max-width":`${e.maxWidth}px`},tabIndex:0,children:e.children})]}),n):null}}),vh=tC(()=>{tM(),tR(),tL(),yQ=({theme:e,id:t,libraryReturnUrl:n})=>{let i=n||window.location.origin+window.location.pathname;return(0,s.jsx)("a",{className:"library-menu-browse-button",href:`${u.VITE_APP_LIBRARY_URL}?target=${window.name||"_blank"}&referrer=${i}&useHash=true&token=${t}&theme=${e}&version=${eq.excalidrawLibrary}`,target:"_excalidraw_libraries",children:C("labels.libraries")})}}),vm=tC(()=>{tM(),vh(),y1=({libraryReturnUrl:e,theme:t,id:n,style:i,children:l,className:r})=>(0,s.jsxs)("div",{className:(0,d.Z)("library-menu-control-buttons",r),style:i,children:[(0,s.jsx)(yQ,{id:n,libraryReturnUrl:e,theme:t}),l]})}),vu=tC(()=>{tM(),tL(),y0=/({{[\w-]+}})|(<[\w-]+>)|(<\/[\w-]+>)/g,y2=/{{([\w-]+)}}/,y3=/<([\w-]+)>/,y6=/<\/([\w-]+)>/,y4=(e,t)=>{let n=[{name:"",children:[]}];return e.split(y0).filter(Boolean).forEach(i=>{let r=i.match(y3),a=i.match(y6),s=i.match(y2);if(null!==r){let i=r[1];t.hasOwnProperty(i)?n.push({name:i,children:[]}):console.warn(`Trans: missed to pass in prop ${i} for interpolating ${e}`)}else if(null!==a){if(a[1]===n[n.length-1].name){let e=n.pop(),i=l.createElement(l.Fragment,{},...e.children),r=t[e.name];"function"==typeof r&&n[n.length-1].children.push(r(i))}else console.warn(`Trans: unexpected end tag ${i} for interpolating ${e}`)}else if(null!==s){let i=s[1];t.hasOwnProperty(i)?n[n.length-1].children.push(t[i]):console.warn(`Trans: key ${i} not in props for interpolating ${e}`)}else n[n.length-1].children.push(i)}),1!==n.length&&console.warn(`Trans: stack not empty for interpolating ${e}`),n[0].children},y5=({i18nKey:e,children:t,...n})=>{let{t:i}=M();return l.createElement(l.Fragment,{},...y4(i(e),n))}}),vp=tC(()=>{}),vg=tC(()=>{}),vf=tC(()=>{tM(),vg(),tA(),y8=({label:e,onClick:t,className:n,children:i,actionType:l,type:r="button",isLoading:a,...o})=>{let c=l?`Dialog__action-button--${l}`:"";return(0,s.jsxs)("button",{className:(0,d.Z)("Dialog__action-button",c,n),type:r,"aria-label":e,onClick:t,...o,children:[i&&(0,s.jsx)("div",{style:a?{visibility:"hidden"}:{},children:i}),(0,s.jsx)("div",{style:a?{visibility:"hidden"}:{},children:e}),a&&(0,s.jsx)("div",{style:{position:"absolute",inset:0},children:(0,s.jsx)(j,{})})]})}}),vx=tC(()=>{tM(),tL(),wP(),vp(),vf(),wA(),CJ(),tj(),y7=e=>{let{onConfirm:t,onCancel:n,children:l,confirmText:r=C("buttons.confirm"),cancelText:a=C("buttons.cancel"),className:o="",...d}=e,c=k9(),h=(0,i.b9)(vO,p),{container:m}=k5();return(0,s.jsxs)(v$,{onCloseRequest:n,size:"small",...d,className:`confirm-dialog ${o}`,children:[l,(0,s.jsxs)("div",{className:"confirm-dialog-buttons",children:[(0,s.jsx)(y8,{label:a,onClick:()=>{c({openMenu:null}),h(!1),n(),m?.focus()}}),(0,s.jsx)(y8,{label:r,onClick:()=>{c({openMenu:null}),h(!1),t(),m?.focus()},actionType:"danger"})]})]})}}),vy=tC(()=>{tM(),y9=class{static has(e){try{return!!window.localStorage.getItem(e)}catch(e){return console.warn(`localStorage.getItem error: ${e.message}`),!1}}static get(e){try{let t=window.localStorage.getItem(e);return t?JSON.parse(t):null}catch(e){return console.warn(`localStorage.getItem error: ${e.message}`),null}}static set=(e,t)=>{try{return window.localStorage.setItem(e,JSON.stringify(t)),!0}catch(e){return console.warn(`localStorage.setItem error: ${e.message}`),!1}};static delete=e=>{try{window.localStorage.removeItem(e)}catch(e){console.warn(`localStorage.removeItem error: ${e.message}`)}}}}),vb=tC(()=>{}),vv=tC(()=>{tM(),wP(),tL(),vu(),gy(),tR(),pW(),df(),vf(),dN(),dR(),vy(),vb(),be=async e=>{let t=Math.round(8),n=Math.max(Math.round(2),2),i=tJ(e,6),l=document.createElement("canvas");l.width=128*i[0].length+(i[0].length+1)*(2*t)-2*t,l.height=128*i.length+(i.length+1)*(2*t)-2*t;let r=l.getContext("2d");for(let[i,a]of(r.fillStyle=o.white,r.fillRect(0,0,l.width,l.height),e.entries())){let e=await gc({elements:a.elements,files:null,maxWidthOrHeight:128}),{width:l,height:s}=e,d=Math.floor(i/6)*(128+2*t),c=i%6*(128+2*t);r.drawImage(e,c+(128-l)/2+t,d+(128-s)/2+t),r.lineWidth=n,r.strokeStyle=o.gray[4],r.strokeRect(c+t/2,d+t/2,128+t,128+t)}return await pm(new File([await po(l)],"preview",{type:eC.png}),{outputType:eC.jpg,maxWidthOrHeight:5e3})},bt=({libItem:e,appState:t,index:n,onChange:i,onRemove:r})=>{let a=(0,l.useRef)(null),d=(0,l.useRef)(null);return(0,l.useEffect)(()=>{let n=a.current;n&&(async()=>{let i=await gm({elements:e.elements,appState:{...t,viewBackgroundColor:o.white,exportBackground:!0},files:null});n.innerHTML=i.outerHTML})()},[e.elements,t]),(0,s.jsxs)("div",{className:"single-library-item",children:["published"===e.status&&(0,s.jsx)("span",{className:"single-library-item-status",children:C("labels.statusPublished")}),(0,s.jsx)("div",{ref:a,className:"single-library-item__svg"}),(0,s.jsx)(lF,{"aria-label":C("buttons.remove"),type:"button",icon:r$,className:"single-library-item--remove",onClick:r.bind(null,e.id),title:C("buttons.remove")}),(0,s.jsxs)("div",{style:{display:"flex",margin:"0.8rem 0",width:"100%",fontSize:"14px",fontWeight:500,flexDirection:"column"},children:[(0,s.jsxs)("label",{style:{display:"flex",justifyContent:"space-between",flexDirection:"column"},children:[(0,s.jsxs)("div",{style:{padding:"0.5em 0"},children:[(0,s.jsx)("span",{style:{fontWeight:500,color:o.gray[6]},children:C("publishDialog.itemName")}),(0,s.jsx)("span",{"aria-hidden":"true",className:"required",children:"*"})]}),(0,s.jsx)("input",{type:"text",ref:d,style:{width:"80%",padding:"0.2rem"},defaultValue:e.name,placeholder:"Item name",onChange:e=>{i(e.target.value,n)}})]}),(0,s.jsx)("span",{className:"error",children:e.error})]})]})},bn=({onClose:e,libraryItems:t,appState:n,onSuccess:i,onError:r,updateItemsInStorage:a,onRemove:o})=>{let d,[c,h]=(0,l.useState)({authorName:"",githubHandle:"",name:"",description:"",twitterHandle:"",website:""}),[m,p]=(0,l.useState)(!1);(0,l.useEffect)(()=>{let e=y9.get(tr.PUBLISH_LIBRARY);e&&h(e)},[]);let[g,f]=(0,l.useState)(t.slice());(0,l.useEffect)(()=>{f(t.slice())},[t]);let x=e=>{h({...c,[e.target.name]:e.target.value})},y=async e=>{e.preventDefault(),p(!0);let t=[],n=!1;if(g.forEach(e=>{let i="";e.name||(i=C("publishDialog.errors.required"),n=!0),t.push({...e,error:i})}),n){f(t),p(!1);return}let l=await be(g),a=JSON.stringify({type:eM.excalidrawLibrary,version:eq.excalidrawLibrary,source:ej,libraryItems:g},null,2),s=new Blob([a],{type:"application/json"}),o=new FormData;o.append("excalidrawLib",s),o.append("previewImage",l),o.append("previewImageType",l.type),o.append("title",c.name),o.append("authorName",c.authorName),o.append("githubHandle",c.githubHandle),o.append("name",c.name),o.append("description",c.description),o.append("twitterHandle",c.twitterHandle),o.append("website",c.website),fetch(`${u.VITE_APP_LIBRARY_BACKEND}/submit`,{method:"post",body:o}).then(e=>e.ok?e.json().then(({url:e})=>{y9.delete(tr.PUBLISH_LIBRARY),i({url:e,authorName:c.authorName,items:g})}):e.json().catch(()=>{throw Error(e.statusText||"something went wrong")}).then(t=>{throw Error(t.message||e.statusText||"something went wrong")}),e=>{console.error(e),r(e),p(!1)}).catch(e=>{console.error(e),r(e),p(!1)})},b=(0,l.useCallback)(()=>{a(g),y9.set(tr.PUBLISH_LIBRARY,c),e()},[g,e,a,c]),v=!!t.length,w=t.some(e=>"published"===e.status);return(0,s.jsx)(v$,{onCloseRequest:b,title:C("publishDialog.title"),className:"publish-library",children:v?(0,s.jsxs)("form",{onSubmit:y,children:[(0,s.jsx)("div",{className:"publish-library-note",children:(0,s.jsx)(y5,{i18nKey:"publishDialog.noteDescription",link:e=>(0,s.jsx)("a",{href:"https://libraries.excalidraw.com",target:"_blank",rel:"noopener noreferrer",children:e})})}),(0,s.jsx)("span",{className:"publish-library-note",children:(0,s.jsx)(y5,{i18nKey:"publishDialog.noteGuidelines",link:e=>(0,s.jsx)("a",{href:"https://github.com/excalidraw/excalidraw-libraries#guidelines",target:"_blank",rel:"noopener noreferrer",children:e})})}),(0,s.jsx)("div",{className:"publish-library-note",children:C("publishDialog.noteItems")}),w&&(0,s.jsx)("span",{className:"publish-library-note publish-library-warning",children:C("publishDialog.republishWarning")}),(d=[],g.forEach((e,t)=>{d.push((0,s.jsx)("div",{className:"single-library-item-wrapper",children:(0,s.jsx)(bt,{libItem:e,appState:n,index:t,onChange:(e,t)=>{let n=g.slice();n[t].name=e,f(n)},onRemove:o})},t))}),(0,s.jsx)("div",{className:"selected-library-items",children:d})),(0,s.jsxs)("div",{className:"publish-library__fields",children:[(0,s.jsxs)("label",{children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{children:C("publishDialog.libraryName")}),(0,s.jsx)("span",{"aria-hidden":"true",className:"required",children:"*"})]}),(0,s.jsx)("input",{type:"text",name:"name",required:!0,value:c.name,onChange:x,placeholder:C("publishDialog.placeholder.libraryName")})]}),(0,s.jsxs)("label",{style:{alignItems:"flex-start"},children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{children:C("publishDialog.libraryDesc")}),(0,s.jsx)("span",{"aria-hidden":"true",className:"required",children:"*"})]}),(0,s.jsx)("textarea",{name:"description",rows:4,required:!0,value:c.description,onChange:x,placeholder:C("publishDialog.placeholder.libraryDesc")})]}),(0,s.jsxs)("label",{children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{children:C("publishDialog.authorName")}),(0,s.jsx)("span",{"aria-hidden":"true",className:"required",children:"*"})]}),(0,s.jsx)("input",{type:"text",name:"authorName",required:!0,value:c.authorName,onChange:x,placeholder:C("publishDialog.placeholder.authorName")})]}),(0,s.jsxs)("label",{children:[(0,s.jsx)("span",{children:C("publishDialog.githubUsername")}),(0,s.jsx)("input",{type:"text",name:"githubHandle",value:c.githubHandle,onChange:x,placeholder:C("publishDialog.placeholder.githubHandle")})]}),(0,s.jsxs)("label",{children:[(0,s.jsx)("span",{children:C("publishDialog.twitterUsername")}),(0,s.jsx)("input",{type:"text",name:"twitterHandle",value:c.twitterHandle,onChange:x,placeholder:C("publishDialog.placeholder.twitterHandle")})]}),(0,s.jsxs)("label",{children:[(0,s.jsx)("span",{children:C("publishDialog.website")}),(0,s.jsx)("input",{type:"text",name:"website",pattern:"https?://.+",title:C("publishDialog.errors.website"),value:c.website,onChange:x,placeholder:C("publishDialog.placeholder.website")})]}),(0,s.jsx)("span",{className:"publish-library-note",children:(0,s.jsx)(y5,{i18nKey:"publishDialog.noteLicense",link:e=>(0,s.jsx)("a",{href:"https://github.com/excalidraw/excalidraw-libraries/blob/main/LICENSE",target:"_blank",rel:"noopener noreferrer",children:e})})})]}),(0,s.jsxs)("div",{className:"publish-library__buttons",children:[(0,s.jsx)(y8,{label:C("buttons.cancel"),onClick:b,"data-testid":"cancel-clear-canvas-button"}),(0,s.jsx)(y8,{type:"submit",label:C("buttons.submit"),actionType:"primary",isLoading:m})]})]}):(0,s.jsx)("p",{style:{padding:"1em",textAlign:"center",fontWeight:500},children:C("publishDialog.atleastOneLibItem")})})}}),vw=tC(()=>{tM(),tL(),vu(),tj(),CJ(),pU(),gx(),dN(),dR(),uQ(),df(),vx(),vv(),wP(),vl(),wA(),d8(),gf(),bi=(e,t)=>e.filter(e=>t.includes(e.id)),bl=({setAppState:e,selectedItems:t,library:n,onRemoveFromLibrary:r,resetLibrary:a,onSelectItems:o,appState:c,className:h})=>{let m,u,[g]=(0,i.KO)(gn,p),[f,x]=(0,i.KO)(vO,p),[y,b]=(0,l.useState)(!1),v=!!t.length,w=v?g.libraryItems.filter(e=>t.includes(e.id)):g.libraryItems,E=v?C("buttons.remove"):C("buttons.resetLibrary"),[S,k]=(0,l.useState)(!1),[I,M]=(0,l.useState)(null),j=(0,l.useCallback)(()=>(0,s.jsxs)(v$,{onCloseRequest:()=>M(null),title:C("publishSuccessDialog.title"),className:"publish-library-success",size:"small",children:[(0,s.jsx)("p",{children:(0,s.jsx)(y5,{i18nKey:"publishSuccessDialog.content",authorName:I.authorName,link:e=>(0,s.jsx)("a",{href:I?.url,target:"_blank",rel:"noopener noreferrer",children:e})})}),(0,s.jsx)(lF,{type:"button",title:C("buttons.close"),"aria-label":C("buttons.close"),label:C("buttons.close"),onClick:()=>M(null),"data-testid":"publish-library-success-close",className:"publish-library-success-close"})]}),[M,I]),T=(e,i)=>{k(!1),M({url:e.url,authorName:e.authorName});let l=i.slice();l.forEach(e=>{t.includes(e.id)&&(e.status="published")}),n.setLibrary(l)},L=async()=>{try{await n.updateLibrary({libraryItems:uk({description:"Excalidraw library files"}),merge:!0,openLibraryMenu:!0})}catch(t){if(t?.name==="AbortError"){console.warn(t);return}e({errorMessage:C("errors.importLibraryError")})}},D=async()=>{let t=v?w:await n.getLatestLibrary();pj(t).catch(t7).catch(t=>{e({errorMessage:t.message})})};return(0,s.jsxs)("div",{className:(0,d.Z)("library-menu-dropdown-container",h),children:[(0,s.jsxs)(yF,{open:f,children:[(0,s.jsx)(yF.Trigger,{onToggle:()=>x(!f),children:lY}),(0,s.jsxs)(yF.Content,{onClickOutside:()=>x(!1),onSelect:()=>x(!1),className:"library-menu",children:[!v&&(0,s.jsx)(yF.Item,{onSelect:L,icon:rw,"data-testid":"lib-dropdown--load",children:C("buttons.load")}),!!w.length&&(0,s.jsx)(yF.Item,{onSelect:D,icon:rh,"data-testid":"lib-dropdown--export",children:C("buttons.export")}),!!w.length&&(0,s.jsx)(yF.Item,{onSelect:()=>b(!0),icon:rr,children:E}),v&&(0,s.jsx)(yF.Item,{icon:ax,onSelect:()=>k(!0),"data-testid":"lib-dropdown--remove",children:C("buttons.publishLibrary")})]})]}),t.length>0&&(0,s.jsx)("div",{className:"library-actions-counter",children:t.length}),y&&(m=t.length?C("alerts.removeItemsFromsLibrary",{count:t.length}):C("alerts.resetLibrary"),u=t.length?C("confirmDialog.removeItemsFromLib"):C("confirmDialog.resetLibrary"),(0,s.jsx)(y7,{onConfirm:()=>{t.length?r():a(),b(!1)},onCancel:()=>{b(!1)},title:u,children:(0,s.jsx)("p",{children:m})})),S&&(0,s.jsx)(bn,{onClose:()=>k(!1),libraryItems:bi(g.libraryItems,t),appState:c,onSuccess:e=>T(e,g.libraryItems),onError:e=>window.alert(e),updateItemsInStorage:()=>n.setLibrary(g.libraryItems),onRemove:e=>o(t.filter(t=>t!==e))}),I&&j()]})},br=({selectedItems:e,onSelectItems:t,className:n})=>{let{library:l}=k3(),{clearLibraryCache:r,deleteItemsFromLibraryCache:a}=gt(),o=dp(),d=k9(),[c]=(0,i.KO)(gn,p),h=async n=>{let i=n.filter(t=>!e.includes(t.id));l.setLibrary(i).catch(()=>{d({errorMessage:C("alerts.errorRemovingFromLibrary")})}),a(e),t([])};return(0,s.jsx)(bl,{appState:o,setAppState:d,selectedItems:e,onSelectItems:t,library:l,onRemoveFromLibrary:()=>h(c.libraryItems),resetLibrary:()=>{l.resetLibrary(),r()},className:n})}}),vE=tC(()=>{}),vS=tC(()=>{tM(),CJ(),vE(),bw(),dN(),gf(),ba=(0,l.memo)(({id:e,elements:t,isPending:n,onClick:i,selected:r,onToggle:a,onDrag:o,svgCache:c})=>{let h=(0,l.useRef)(null),m=ge(e,t,c);(0,l.useEffect)(()=>{let e=h.current;if(e)return m&&(e.innerHTML=m.outerHTML),()=>{e.innerHTML=""}},[m]);let[u,p]=(0,l.useState)(!1),g=k4().editor.isMobile,f=n&&(0,s.jsx)("div",{className:"library-unit__adder",children:lK});return(0,s.jsxs)("div",{className:(0,d.Z)("library-unit",{"library-unit__active":t,"library-unit--hover":t&&u,"library-unit--selected":r,"library-unit--skeleton":!m}),onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1),children:[(0,s.jsx)("div",{className:(0,d.Z)("library-unit__dragger",{"library-unit__pulse":!!n}),ref:h,draggable:!!t,onClick:t||n?t=>{e&&t.shiftKey?a(e,t):i(e)}:void 0,onDragStart:t=>{if(!e){t.preventDefault();return}p(!1),o(e,t)}}),f,e&&t&&(u||g||r)&&(0,s.jsx)(xx,{checked:r,onChange:(t,n)=>a(e,n),className:"library-unit__checkbox"})]})}),bs=()=>(0,s.jsx)("div",{className:"library-unit library-unit--skeleton"})});function vk(){return[!1,(0,l.useCallback)(e=>e(),[])]}var vC,vI,vM,vj,vT,vL=tC(()=>{tM(),vC=l.useTransition||vk}),vD=tC(()=>{tM(),vS(),vL(),vI=({children:e})=>(0,s.jsx)("div",{className:"library-menu-items-container__grid",children:e}),vM=(0,l.memo)(({items:e,onItemSelectToggle:t,onItemDrag:n,isItemSelected:i,onClick:r,svgCache:a,itemsRenderedPerBatch:o})=>{let[,d]=vC(),[c,h]=(0,l.useState)(0);return(0,l.useEffect)(()=>{c<e.length&&d(()=>{h(c+o)})},[c,e.length,d,o]),(0,s.jsx)(s.Fragment,{children:e.map((e,l)=>l<c?(0,s.jsx)(ba,{elements:e?.elements,isPending:!e?.id&&!!e?.elements,onClick:r,svgCache:a,id:e?.id,selected:i(e.id),onToggle:t,onDrag:n},e?.id??l):(0,s.jsx)(bs,{},l))})})}),vA=tC(()=>{tM(),vj=(0,i.cn)(0),vT=e=>{let[t,n]=(0,i.KO)(vj);return(0,l.useEffect)(()=>{let{current:t}=e;if(!t)return;let i=tv(()=>{let{scrollTop:e}=t;n(e)},200);return t.addEventListener("scroll",i),()=>{i.cancel(),t.removeEventListener("scroll",i)}},[e,n]),t}}),vP=tC(()=>{});function v_({isLoading:e,libraryItems:t,onAddToLibrary:n,onInsertLibraryItems:i,pendingElements:r,theme:a,id:o,libraryReturnUrl:d,onSelectItems:c,selectedItems:h}){let m=(0,l.useRef)(null),u=vT(m);(0,l.useEffect)(()=>{u>0&&m.current?.scrollTo(0,u)},[]);let{svgCache:p}=gt(),g=(0,l.useMemo)(()=>t.filter(e=>"published"!==e.status),[t]),f=(0,l.useMemo)(()=>t.filter(e=>"published"===e.status),[t]),x=!t.length&&!r.length,y=!r.length&&!g.length&&!f.length,[b,v]=(0,l.useState)(null),w=(0,l.useCallback)((e,t)=>{let n=!h.includes(e),i=[...g,...f];if(n){if(t.shiftKey&&b){let t=i.findIndex(e=>e.id===b),n=i.findIndex(t=>t.id===e);if(-1===t||-1===n){c([...h,e]);return}let l=na(h);c(i.reduce((e,i,r)=>((r>=t&&r<=n||l.has(i.id))&&e.push(i.id),e),[]))}else c([...h,e]);v(e)}else v(null),c(h.filter(t=>t!==e))},[b,c,f,h,g]),E=(0,l.useCallback)(e=>(h.includes(e)?t.filter(e=>h.includes(e.id)):t.filter(t=>t.id===e)).map(e=>({...e,elements:ly(e.elements,{randomizeSeed:!0})})),[t,h]),S=(0,l.useCallback)((e,t)=>{t.dataTransfer.setData(eC.excalidrawlib,pM(E(e)))},[E]),k=(0,l.useCallback)(e=>!!e&&h.includes(e),[h]),I=(0,l.useCallback)(()=>{n(r)},[r,n]),M=(0,l.useCallback)(e=>{e&&i(E(e))},[E,i]),T=p.size>=t.length?vN:vR;return(0,s.jsxs)("div",{className:"library-menu-items-container",style:r.length||g.length||f.length?{justifyContent:"flex-start"}:{borderBottom:0},children:[!y&&(0,s.jsx)(br,{selectedItems:h,onSelectItems:c,className:"library-menu-dropdown-container--in-heading"}),(0,s.jsxs)(yy.Col,{className:"library-menu-items-container__items",align:"start",gap:1,style:{flex:f.length>0?1:"0 1 auto",marginBottom:0},ref:m,children:[(0,s.jsxs)(s.Fragment,{children:[!y&&(0,s.jsx)("div",{className:"library-menu-items-container__header",children:C("labels.personalLib")}),e&&(0,s.jsx)("div",{style:{position:"absolute",top:"var(--container-padding-y)",right:"var(--container-padding-x)",transform:"translateY(50%)"},children:(0,s.jsx)(j,{})}),r.length||g.length?(0,s.jsxs)(vI,{children:[r.length>0&&(0,s.jsx)(vM,{itemsRenderedPerBatch:T,items:[{id:null,elements:r}],onItemSelectToggle:w,onItemDrag:S,onClick:I,isItemSelected:k,svgCache:p}),(0,s.jsx)(vM,{itemsRenderedPerBatch:T,items:g,onItemSelectToggle:w,onItemDrag:S,onClick:M,isItemSelected:k,svgCache:p})]}):(0,s.jsxs)("div",{className:"library-menu-items__no-items",children:[(0,s.jsx)("div",{className:"library-menu-items__no-items__label",children:C("library.noItems")}),(0,s.jsx)("div",{className:"library-menu-items__no-items__hint",children:f.length>0?C("library.hint_emptyPrivateLibrary"):C("library.hint_emptyLibrary")})]})]}),(0,s.jsxs)(s.Fragment,{children:[(f.length>0||r.length>0||g.length>0)&&(0,s.jsx)("div",{className:"library-menu-items-container__header library-menu-items-container__header--excal",children:C("labels.excalidrawLib")}),f.length>0?(0,s.jsx)(vI,{children:(0,s.jsx)(vM,{itemsRenderedPerBatch:T,items:f,onItemSelectToggle:w,onItemDrag:S,onClick:M,isItemSelected:k,svgCache:p})}):g.length>0?(0,s.jsx)("div",{style:{margin:"1rem 0",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",fontSize:".9rem"},children:C("library.noItems")}):null]}),x&&(0,s.jsx)(y1,{style:{padding:"16px 0",width:"100%"},id:o,libraryReturnUrl:d,theme:a,children:(0,s.jsx)(br,{selectedItems:h,onSelectItems:c})})]})]})}var vR,vN,vO,vz,vH,vB,vF,v$,vZ,vW,vU,vG,vV,vK,vY,vX,vq,vJ,vQ,v1,v0,v2,v3,v6,v4,v5,v8,v7,v9,we,wt,wn,wi,wl,wr,wa,ws,wo,wd,wc,wh,wm,wu,wp,wg,wf,wx,wy,wb,wv,ww,wE,wS,wk,wC,wI,wM,wj,wT,wL=tC(()=>{tM(),pU(),tL(),df(),bQ(),tR(),tA(),dD(),vm(),vw(),vD(),vA(),gf(),vP(),vR=17,vN=64}),wD=tC(()=>{}),wA=tC(()=>{tM(),gx(),tL(),dL(),wL(),d$(),tj(),tA(),CJ(),fK(),d8(),wD(),vm(),df(),tR(),vO=(0,i.cn)(!1),vz=({children:e})=>(0,s.jsx)("div",{className:"layer-ui__library",children:e}),vH=({onInsertLibraryItems:e,pendingElements:t,onAddToLibrary:n,setAppState:r,libraryReturnUrl:a,library:o,id:d,theme:c,selectedItems:h,onSelectItems:m})=>{let[u]=(0,i.KO)(gn,p),g=(0,l.useCallback)(e=>{(async(e,t)=>{for(let t of(aX("element","addToLibrary","ui"),ti))if(e.some(e=>e.type===t))return r({errorMessage:C(`errors.libraryElementTypeError.${t}`)});let i=[{status:"unpublished",elements:e,id:i9(),created:Date.now()},...t];n(),o.setLibrary(i).catch(()=>{r({errorMessage:C("alerts.errorAddingToLibrary")})})})(e,u.libraryItems)},[n,o,r,u.libraryItems]),f=(0,l.useMemo)(()=>u.libraryItems,[u]);if("loading"===u.status&&!u.isInitialized)return(0,s.jsx)(vz,{children:(0,s.jsx)("div",{className:"layer-ui__library-message",children:(0,s.jsxs)("div",{children:[(0,s.jsx)(j,{size:"2em"}),(0,s.jsx)("span",{children:C("labels.libraryLoadingMessage")})]})})});let x=u.libraryItems.length>0||t.length>0;return(0,s.jsxs)(vz,{children:[(0,s.jsx)(v_,{isLoading:"loading"===u.status,libraryItems:f,onAddToLibrary:g,onInsertLibraryItems:e,pendingElements:t,id:d,libraryReturnUrl:a,theme:c,onSelectItems:m,selectedItems:h}),x&&(0,s.jsx)(y1,{className:"library-menu-control-buttons--at-bottom",style:{padding:"16px 12px 0 12px"},id:d,libraryReturnUrl:a,theme:c})]})},vB=(e,t)=>{let n=()=>gV(t,e,{includeBoundTextElement:!0,includeElementsInFrames:!0}),i=(0,l.useRef)(n()),r=(0,l.useRef)(e),a=(0,l.useRef)(t);return ng(e.selectedElementIds,r.current.selectedElementIds)&&ng(t,a.current)||(i.current=n(),r.current=e,a.current=t),i.current},vF=()=>{let{library:e,id:t,onInsertElements:n}=k3(),i=k6(),r=dp(),a=k9(),o=k8(),[d,c]=(0,l.useState)([]),h=(0,l.useMemo)(()=>e,[e]),m=vB(r,o),u=(0,l.useCallback)(e=>{n(gs(e))},[n]),p=(0,l.useCallback)(()=>{a({selectedElementIds:{},selectedGroupIds:{},activeEmbeddable:null})},[a]);return(0,s.jsx)(vH,{pendingElements:m,onInsertLibraryItems:u,onAddToLibrary:p,setAppState:a,libraryReturnUrl:i.libraryReturnUrl,library:h,id:t,theme:r.theme,selectedItems:d,onSelectItems:c})}}),wP=tC(()=>{tM(),vs(),tL(),CJ(),dO(),vo(),dN(),b7(),vc(),df(),wA(),tj(),v$=e=>{let[t,n]=yq(),[r]=(0,l.useState)(document.activeElement),{id:a}=k5(),o=k4().viewport.isMobile;(0,l.useEffect)(()=>{if(!t)return;let n=nu(t);n.length>0&&!1!==e.autofocus&&(n[1]||n[0]).focus();let i=e=>{if(e.key===aO.TAB){let n=nu(t),{activeElement:i}=document,l=n.findIndex(e=>e===i);0===l&&e.shiftKey?(n[n.length-1].focus(),e.preventDefault()):l!==n.length-1||e.shiftKey||(n[0].focus(),e.preventDefault())}};return t.addEventListener("keydown",i),()=>t.removeEventListener("keydown",i)},[t,e.autofocus]);let c=k9(),h=(0,i.b9)(vO,p),m=()=>{c({openMenu:null}),h(!1),r.focus(),e.onCloseRequest()};return(0,s.jsx)(yJ,{className:(0,d.Z)("Dialog",e.className,{"Dialog--fullscreen":o}),labelledBy:"dialog-title",maxWidth:function(e){if(e&&"number"==typeof e)return e;switch(e){case"small":return 550;case"wide":return 1024;default:return 800}}(e.size),onCloseRequest:m,closeOnClickOutside:e.closeOnClickOutside,children:(0,s.jsxs)(yA,{ref:n,children:[e.title&&(0,s.jsx)("h2",{id:`${a}-dialog-title`,className:"Dialog__title",children:(0,s.jsx)("span",{className:"Dialog__titleContent",children:e.title})}),(0,s.jsx)("button",{className:"Dialog__close",onClick:m,title:C("buttons.close"),"aria-label":C("buttons.close"),children:o?rZ:r$}),(0,s.jsx)("div",{className:"Dialog__content",children:e.children})]})})}}),w_=tC(()=>{tM(),tL(),wP(),CJ(),vZ=({children:e,onClose:t})=>{let[n,i]=(0,l.useState)(!!e),{container:r}=k5(),a=l.useCallback(()=>{i(!1),t&&t(),r?.focus()},[t,r]);return(0,s.jsx)(s.Fragment,{children:n&&(0,s.jsx)(v$,{size:"small",onCloseRequest:a,title:C("errorDialog.title"),children:(0,s.jsx)("div",{style:{whiteSpace:"pre-wrap"},children:e})})})}}),wR=tC(()=>{}),wN=tC(()=>{tM(),wR(),vW=function({onChange:e,value:t,choices:n,name:i}){return(0,s.jsx)("div",{className:"RadioGroup",children:n.map(n=>(0,s.jsxs)("div",{className:(0,d.Z)("RadioGroup__choice",{active:n.value===t}),children:[(0,s.jsx)("input",{name:i,type:"radio",checked:n.value===t,onChange:()=>e(n.value)}),n.label]},n.label))})}}),wO=tC(()=>{}),wz=tC(()=>{tM(),wO(),vU=({title:e,name:t,checked:n,onChange:i,disabled:l=!1})=>(0,s.jsx)("div",{className:(0,d.Z)("Switch",{toggled:n,disabled:l}),children:(0,s.jsx)("input",{name:t,id:t,title:e,type:"checkbox",checked:n,disabled:l,onChange:()=>i(!n),onKeyDown:e=>{" "===e.key&&i(!n)}})})}),wH=tC(()=>{}),wB=tC(()=>{}),wF=tC(()=>{tM(),wB(),vG=(0,l.forwardRef)(({children:e,startIcon:t,onClick:n,label:i,variant:l="filled",color:r="primary",size:a="medium",fullWidth:o,className:c},h)=>(0,s.jsxs)("button",{className:(0,d.Z)("ExcButton",`ExcButton--color-${r}`,`ExcButton--variant-${l}`,`ExcButton--size-${a}`,{"ExcButton--fullWidth":o},c),onClick:n,type:"button","aria-label":i,ref:h,children:[t&&(0,s.jsx)("div",{className:"ExcButton__icon","aria-hidden":!0,children:t}),"icon"!==l&&(e??i)]}))}),w$=tC(()=>{tM(),bE(),ml(),tR(),pW(),uQ(),tL(),fK(),gy(),dN(),wP(),wN(),wz(),dH(),wH(),CJ(),wF(),df(),by(),vV="filter"in document.createElement("canvas").getContext("2d"),vK=()=>(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{children:C("canvasError.cannotShowPreview")}),(0,s.jsx)("p",{children:(0,s.jsx)("span",{children:C("canvasError.canvasTooBig")})}),(0,s.jsxs)("em",{children:["(",C("canvasError.canvasTooBigTip"),")"]})]}),vY=({appStateSnapshot:e,elementsSnapshot:t,files:n,actionManager:i,onExportImage:r})=>{let a=gU(t,e),o=k6(),[d,c]=(0,l.useState)(e.name),[h,m]=(0,l.useState)(a),[u,p]=(0,l.useState)(e.exportBackground),[g,f]=(0,l.useState)(e.exportWithDarkMode),[x,y]=(0,l.useState)(e.exportEmbedScene),[b,v]=(0,l.useState)(e.exportScale),w=(0,l.useRef)(null),[E,S]=(0,l.useState)(null),{exportedElements:k,exportingFrame:I}=xp(t,e,h);return(0,l.useEffect)(()=>{let t=w.current;if(!t)return;let i=t.offsetWidth,l=t.offsetHeight;i&&gc({elements:k,appState:{...e,name:d,exportBackground:u,exportWithDarkMode:g,exportScale:b,exportEmbedScene:x},files:n,exportPadding:eV,maxWidthOrHeight:Math.max(i,l),exportingFrame:I}).then(e=>(S(null),po(e).then(()=>{t.replaceChildren(e)}))).catch(e=>{console.error(e),S(e)})},[e,n,k,I,d,u,g,b,x]),(0,s.jsxs)("div",{className:"ImageExportModal",children:[(0,s.jsx)("h3",{children:C("imageExportDialog.header")}),(0,s.jsxs)("div",{className:"ImageExportModal__preview",children:[(0,s.jsx)("div",{className:"ImageExportModal__preview__canvas",ref:w,children:E&&(0,s.jsx)(vK,{})}),(0,s.jsx)("div",{className:"ImageExportModal__preview__filename",children:!tp.Zh&&(0,s.jsx)("input",{type:"text",className:"TextInput",value:d,style:{width:"30ch"},disabled:"u">typeof o.name||e.viewModeEnabled,onChange:e=>{c(e.target.value),i.executeAction(xy,"ui",e.target.value)}})})]}),(0,s.jsxs)("div",{className:"ImageExportModal__settings",children:[(0,s.jsx)("h3",{children:C("imageExportDialog.header")}),a&&(0,s.jsx)(vX,{label:C("imageExportDialog.label.onlySelected"),name:"exportOnlySelected",children:(0,s.jsx)(vU,{name:"exportOnlySelected",checked:h,onChange:e=>{m(e)}})}),(0,s.jsx)(vX,{label:C("imageExportDialog.label.withBackground"),name:"exportBackgroundSwitch",children:(0,s.jsx)(vU,{name:"exportBackgroundSwitch",checked:u,onChange:e=>{p(e),i.executeAction(xv,"ui",e)}})}),vV&&(0,s.jsx)(vX,{label:C("imageExportDialog.label.darkMode"),name:"exportDarkModeSwitch",children:(0,s.jsx)(vU,{name:"exportDarkModeSwitch",checked:g,onChange:e=>{f(e),i.executeAction(xC,"ui",e)}})}),(0,s.jsx)(vX,{label:C("imageExportDialog.label.embedScene"),tooltip:C("imageExportDialog.tooltip.embedScene"),name:"exportEmbedSwitch",children:(0,s.jsx)(vU,{name:"exportEmbedSwitch",checked:x,onChange:e=>{y(e),i.executeAction(xw,"ui",e)}})}),(0,s.jsx)(vX,{label:C("imageExportDialog.label.scale"),name:"exportScale",children:(0,s.jsx)(vW,{name:"exportScale",value:b,onChange:e=>{v(e),i.executeAction(xb,"ui",e)},choices:eG.map(e=>({value:e,label:`${e}\xd7`}))})}),(0,s.jsxs)("div",{className:"ImageExportModal__settings__buttons",children:[(0,s.jsx)(vG,{className:"ImageExportModal__settings__buttons__button",label:C("imageExportDialog.title.exportToPng"),onClick:()=>r(eI.png,k,{exportingFrame:I}),startIcon:ab,children:C("imageExportDialog.button.exportToPng")}),(0,s.jsx)(vG,{className:"ImageExportModal__settings__buttons__button",label:C("imageExportDialog.title.exportToSvg"),onClick:()=>r(eI.svg,k,{exportingFrame:I}),startIcon:ab,children:C("imageExportDialog.button.exportToSvg")}),(hl||Y)&&(0,s.jsx)(vG,{className:"ImageExportModal__settings__buttons__button",label:C("imageExportDialog.title.copyPngToClipboard"),onClick:()=>r(eI.clipboard,k,{exportingFrame:I}),startIcon:av,children:C("imageExportDialog.button.copyPngToClipboard")})]})]})]})},vX=({label:e,children:t,tooltip:n,name:i})=>(0,s.jsxs)("div",{className:"ImageExportModal__settings__setting",title:e,children:[(0,s.jsxs)("label",{htmlFor:i,className:"ImageExportModal__settings__setting__label",children:[e,n&&(0,s.jsx)(aU,{label:n,long:!0,children:aw})]}),(0,s.jsx)("div",{className:"ImageExportModal__settings__setting__content",children:t})]}),vq=({elements:e,appState:t,files:n,actionManager:i,onExportImage:r,onCloseRequest:a})=>{let[{appStateSnapshot:o,elementsSnapshot:d}]=(0,l.useState)(()=>({appStateSnapshot:nv(t),elementsSnapshot:nv(e)}));return(0,s.jsx)(v$,{onCloseRequest:a,size:"wide",title:!1,children:(0,s.jsx)(vY,{elementsSnapshot:d,appStateSnapshot:o,files:n,actionManager:i,onExportImage:r})})}}),wZ=tC(()=>{}),wW=tC(()=>{tM(),wZ(),vJ=({children:e,side:t,className:n})=>(0,s.jsx)("div",{className:(0,d.Z)("FixedSideContainer",`FixedSideContainer_side_${t}`,n),children:e})}),wU=tC(()=>{}),wG=tC(()=>{tM(),tL(),dx(),df(),dy(),wU(),vQ=({appState:e,isMobile:t,device:n,app:i})=>{let{activeTool:l,isResizing:r,isRotating:a,lastPointerDownWith:s}=e,o=null!==e.multiElement;if(e.openSidebar&&!n.editor.canFitSidebar)return null;if(n2(e))return C("hints.eraserRevert");if("arrow"===l.type||"line"===l.type)return o?C("hints.linearElementMulti"):C("hints.linearElement");if("freedraw"===l.type)return C("hints.freeDraw");if("text"===l.type)return C("hints.text");if("embeddable"===l.type)return C("hints.embeddable");if("image"===e.activeTool.type&&e.pendingImageElementId)return C("hints.placeImage");let d=i.scene.getSelectedElements(e);if(r&&"mouse"===s&&1===d.length){let e=d[0];return nN(e)&&2===e.points.length?C("hints.lockAngle"):nI(e)?C("hints.resizeImage"):C("hints.resize")}if(a&&"mouse"===s)return C("hints.rotate");if(1===d.length&&nL(d[0]))return C("hints.text_selected");if(e.editingElement&&nL(e.editingElement))return C("hints.text_editing");if("selection"===l.type){if(e.draggingElement?.type==="selection"&&!d.length&&!e.editingElement&&!e.editingLinearElement)return C("hints.deepBoxSelect");if(e.gridSize&&e.draggingElement)return C("hints.disableSnapping");if(!d.length&&!t)return C("hints.canvasPanning");if(1===d.length){if(nN(d[0]))return e.editingLinearElement?e.editingLinearElement.selectedPointsIndices?C("hints.lineEditor_pointSelected"):C("hints.lineEditor_nothingSelected"):C("hints.lineEditor_info");if(!e.draggingElement&&n$(d[0]))return C("hints.bindTextToElement")}}return null},v1=({appState:e,isMobile:t,device:n,app:i})=>{let l=vQ({appState:e,isMobile:t,device:n,app:i});return l?(l=t0(l),(0,s.jsx)("div",{className:"HintViewer",children:(0,s.jsx)("span",{children:l})})):null}}),wV=tC(()=>{tM(),dP(),dN(),v0={CHECKED:lJ,UNCHECKED:lq},v2=e=>(0,s.jsxs)("label",{className:(0,d.Z)("ToolIcon ToolIcon__lock","ToolIcon_size_medium",{"is-mobile":e.isMobile}),title:`${e.title} \u2014 Q`,children:[(0,s.jsx)("input",{className:"ToolIcon_type_checkbox",type:"checkbox",name:e.name,onChange:e.onChange,checked:e.checked,"aria-label":e.title,"data-testid":"toolbar-lock"}),(0,s.jsx)("div",{className:"ToolIcon__icon",children:e.checked?v0.CHECKED:v0.UNCHECKED})]})}),wK=tC(()=>{tM(),tL(),CJ(),v3=({heading:e,children:t,...n})=>{let{id:i}=k5(),l=(0,s.jsx)("h2",{className:"visually-hidden",id:`${i}-${e}-title`,children:C(`headings.${e}`)});return(0,s.jsx)("section",{...n,"aria-labelledby":`${i}-${e}-title`,children:"function"==typeof t?t(l):(0,s.jsxs)(s.Fragment,{children:[l,t]})})}}),wY=tC(()=>{tM(),dP(),dN(),v6=e=>e.penDetected?(0,s.jsxs)("label",{className:(0,d.Z)("ToolIcon ToolIcon__penMode","ToolIcon_size_medium",{"is-mobile":e.isMobile}),title:`${e.title}`,children:[(0,s.jsx)("input",{className:"ToolIcon_type_checkbox",type:"checkbox",name:e.name,onChange:e.onChange,checked:e.checked,"aria-label":e.title}),(0,s.jsx)("div",{className:"ToolIcon__icon",children:l7})]}):null}),wX=tC(()=>{}),wq=tC(()=>{tM(),uq(),tL(),fK(),dN(),b7(),wX(),v4=e=>{let t=m6(e.elements),n=gK(e.elements,e.appState),i=m6(n);return(0,s.jsx)("div",{className:"Stats",children:(0,s.jsxs)(yA,{padding:2,children:[(0,s.jsx)("div",{className:"close",onClick:e.onClose,children:r$}),(0,s.jsx)("h3",{children:C("stats.title")}),(0,s.jsx)("table",{children:(0,s.jsxs)("tbody",{children:[(0,s.jsx)("tr",{children:(0,s.jsx)("th",{colSpan:2,children:C("stats.scene")})}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:C("stats.elements")}),(0,s.jsx)("td",{children:e.elements.length})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:C("stats.width")}),(0,s.jsx)("td",{children:Math.round(t[2])-Math.round(t[0])})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:C("stats.height")}),(0,s.jsx)("td",{children:Math.round(t[3])-Math.round(t[1])})]}),1===n.length&&(0,s.jsx)("tr",{children:(0,s.jsx)("th",{colSpan:2,children:C("stats.element")})}),n.length>1&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("tr",{children:(0,s.jsx)("th",{colSpan:2,children:C("stats.selected")})}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:C("stats.elements")}),(0,s.jsx)("td",{children:n.length})]})]}),n.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"x"}),(0,s.jsx)("td",{children:Math.round(i[0])})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"y"}),(0,s.jsx)("td",{children:Math.round(i[1])})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:C("stats.width")}),(0,s.jsx)("td",{children:Math.round(i[2]-i[0])})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:C("stats.height")}),(0,s.jsx)("td",{children:Math.round(i[3]-i[1])})]})]}),1===n.length&&(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:C("stats.angle")}),(0,s.jsx)("td",{children:`${Math.round(180*n[0].angle/Math.PI)}\xb0`})]}),e.renderCustomStats?.(e.elements,e.appState)]})})]})})}}),wJ=tC(()=>{tM(),dP(),dR(),dN(),dO(),v5=e=>(0,s.jsx)(lF,{className:(0,d.Z)("Shape",{fillable:!1}),type:"radio",icon:ay,name:"editor-current-shape",checked:e.checked,title:`${e.title} \u2014 H`,keyBindingLabel:e.isMobile?void 0:aO.H.toLocaleUpperCase(),"aria-label":`${e.title} \u2014 H`,"aria-keyshortcuts":aO.H,"data-testid":"toolbar-hand",onChange:()=>e.onChange?.()})}),wQ=tC(()=>{tM(),tL(),bQ(),fG(),wW(),b7(),wG(),fK(),va(),wK(),fV(),wV(),wY(),wq(),bZ(),wJ(),dy(),vr(),v8=({appState:e,elements:t,actionManager:n,setAppState:i,onLockToggle:l,onHandToolToggle:r,onPenModeToggle:a,renderTopRightUI:o,renderCustomStats:d,renderSidebars:c,device:h,renderWelcomeScreen:m,UIOptions:u,app:p})=>{let{WelcomeScreenCenterTunnel:g,MainMenuTunnel:f,DefaultSidebarTriggerTunnel:x}=yZ();return(0,s.jsxs)(s.Fragment,{children:[c(),!e.viewModeEnabled&&(0,s.jsxs)(vJ,{side:"top",className:"App-top-bar",children:[m&&(0,s.jsx)(g.Out,{}),(0,s.jsx)(v3,{heading:"shapes",children:t=>(0,s.jsx)(yy.Col,{gap:4,align:"center",children:(0,s.jsxs)(yy.Row,{gap:1,className:"App-toolbar-container",children:[(0,s.jsxs)(yA,{padding:1,className:"App-toolbar App-toolbar--mobile",children:[t,(0,s.jsx)(yy.Row,{gap:1,children:(0,s.jsx)(yG,{appState:e,activeTool:e.activeTool,UIOptions:u,app:p})})]}),o&&o(!0,e),(0,s.jsxs)("div",{className:"mobile-misc-tools-container",children:[!e.viewModeEnabled&&(0,s.jsx)(x.Out,{}),(0,s.jsx)(v6,{checked:e.penMode,onChange:()=>a(null),title:C("toolBar.penMode"),isMobile:!0,penDetected:e.penDetected}),(0,s.jsx)(v2,{checked:e.activeTool.locked,onChange:l,title:C("toolBar.lock"),isMobile:!0}),(0,s.jsx)(v5,{checked:n3(e),onChange:()=>r(),title:C("toolBar.hand"),isMobile:!0})]})]})})}),(0,s.jsx)(v1,{appState:e,isMobile:!0,device:h,app:p})]}),!e.openMenu&&e.showStats&&(0,s.jsx)(v4,{appState:e,setAppState:i,elements:t,onClose:()=>{n.executeAction(x2)},renderCustomStats:d}),(0,s.jsx)("div",{className:"App-bottom-bar",style:{marginBottom:fL+2*fT,marginLeft:fL+2*fT,marginRight:fL+2*fT},children:(0,s.jsxs)(yA,{padding:0,children:["shape"===e.openMenu&&!e.viewModeEnabled&&fw(e,t)?(0,s.jsx)(v3,{className:"App-mobile-menu",heading:"selectedShapeActions",children:(0,s.jsx)(yU,{appState:e,elements:t,renderAction:n.renderAction})}):null,(0,s.jsxs)("footer",{className:"App-toolbar",children:[e.viewModeEnabled?(0,s.jsx)("div",{className:"App-toolbar-content",children:(0,s.jsx)(f.Out,{})}):(0,s.jsxs)("div",{className:"App-toolbar-content",children:[(0,s.jsx)(f.Out,{}),n.renderAction("toggleEditMenu"),n.renderAction("undo"),n.renderAction("redo"),n.renderAction(e.multiElement?"finalize":"duplicateSelection"),n.renderAction("deleteSelectedElements")]}),e.scrolledOutside&&!e.openMenu&&!e.openSidebar&&(0,s.jsx)("button",{className:"scroll-back-to-content",onClick:()=>{i(e=>({...cH(t,e)}))},children:C("buttons.scrollBackToContent")})]})]})})]})}}),w1=tC(()=>{}),w0=tC(()=>{tM(),d$(),mi(),tL(),pV(),CJ(),wP(),w1(),v7=e=>{let t=(0,l.useRef)(null),[n,i]=(0,l.useState)(null);return(0,l.useLayoutEffect)(()=>{if(!e.spreadsheet)return;let n=hn(e.chartType,e.spreadsheet,0,0);i(n);let l,r=t.current;return(async()=>(l=await pB(n,{exportBackground:!1,viewBackgroundColor:o.white},null),l.querySelector(".style-fonts")?.remove(),r.replaceChildren(),r.appendChild(l),e.selected&&r.parentNode.focus()))(),()=>{r.replaceChildren()}},[e.spreadsheet,e.chartType,e.selected]),(0,s.jsx)("button",{className:"ChartPreview",onClick:()=>{n&&e.onClick(e.chartType,n)},children:(0,s.jsx)("div",{ref:t})})},v9=({setAppState:e,appState:t,onClose:n})=>{let{onInsertElements:i}=k3(),r=l.useCallback(()=>{n&&n()},[n]),a=(t,n)=>{i(n),aX("paste","chart",t),e({currentChartType:t,pasteDialog:{shown:!1,data:null}})};return(0,s.jsx)(v$,{size:"small",onCloseRequest:r,title:C("labels.pasteCharts"),className:"PasteChartDialog",autofocus:!1,children:(0,s.jsxs)("div",{className:"container",children:[(0,s.jsx)(v7,{chartType:"bar",spreadsheet:t.pasteDialog.data,selected:"bar"===t.currentChartType,onClick:a}),(0,s.jsx)(v7,{chartType:"line",spreadsheet:t.pasteDialog.data,selected:"line"===t.currentChartType,onClick:a})]})})}}),w2=tC(()=>{}),w3=tC(()=>{tM(),tL(),dO(),wP(),df(),w2(),dN(),ml(),tR(),we=()=>(0,s.jsxs)("div",{className:"HelpDialog__header",children:[(0,s.jsxs)("a",{className:"HelpDialog__btn",href:"https://docs.excalidraw.com",target:"_blank",rel:"noopener noreferrer",children:[C("helpDialog.documentation"),(0,s.jsx)("div",{className:"HelpDialog__link-icon",children:ru})]}),(0,s.jsxs)("a",{className:"HelpDialog__btn",href:"https://blog.excalidraw.com",target:"_blank",rel:"noopener noreferrer",children:[C("helpDialog.blog"),(0,s.jsx)("div",{className:"HelpDialog__link-icon",children:ru})]}),(0,s.jsxs)("a",{className:"HelpDialog__btn",href:"https://github.com/excalidraw/excalidraw/issues",target:"_blank",rel:"noopener noreferrer",children:[C("helpDialog.github"),(0,s.jsx)("div",{className:"HelpDialog__link-icon",children:ru})]})]}),wt=e=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h3",{children:e.title}),(0,s.jsx)("div",{className:"HelpDialog__islands-container",children:e.children})]}),wn=e=>(0,s.jsxs)("div",{className:`HelpDialog__island ${e.className}`,children:[(0,s.jsx)("h4",{className:"HelpDialog__island-title",children:e.caption}),(0,s.jsx)("div",{className:"HelpDialog__island-content",children:e.children})]}),wi=e=>e.replace(/\b[a-z]\b/,e=>e.toUpperCase()),wl=({label:e,shortcuts:t,isOr:n=!0})=>{let i=t.map(e=>(e.endsWith("++")?[...e.slice(0,-2).split("+"),"+"]:e.split("+")).map(e=>(0,s.jsx)(wr,{children:wi(e)},e)));return(0,s.jsxs)("div",{className:"HelpDialog__shortcut",children:[(0,s.jsx)("div",{children:e}),(0,s.jsx)("div",{className:"HelpDialog__key-container",children:[...function*(e,t){let n=!0;for(let i of e)n||(yield t),n=!1,yield i}(i,n?C("helpDialog.or"):null)]})]})},wr=e=>(0,s.jsx)("kbd",{className:"HelpDialog__key",...e}),wa=({onClose:e})=>{let t=l.useCallback(()=>{e&&e()},[e]);return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(v$,{onCloseRequest:t,title:C("helpDialog.title"),className:"HelpDialog",children:[(0,s.jsx)(we,{}),(0,s.jsxs)(wt,{title:C("helpDialog.shortcuts"),children:[(0,s.jsxs)(wn,{className:"HelpDialog__island--tools",caption:C("helpDialog.tools"),children:[(0,s.jsx)(wl,{label:C("toolBar.hand"),shortcuts:[aO.H]}),(0,s.jsx)(wl,{label:C("toolBar.selection"),shortcuts:[aO.V,aO[1]]}),(0,s.jsx)(wl,{label:C("toolBar.rectangle"),shortcuts:[aO.R,aO[2]]}),(0,s.jsx)(wl,{label:C("toolBar.diamond"),shortcuts:[aO.D,aO[3]]}),(0,s.jsx)(wl,{label:C("toolBar.ellipse"),shortcuts:[aO.O,aO[4]]}),(0,s.jsx)(wl,{label:C("toolBar.arrow"),shortcuts:[aO.A,aO[5]]}),(0,s.jsx)(wl,{label:C("toolBar.line"),shortcuts:[aO.L,aO[6]]}),(0,s.jsx)(wl,{label:C("toolBar.freedraw"),shortcuts:[aO.P,aO[7]]}),(0,s.jsx)(wl,{label:C("toolBar.text"),shortcuts:[aO.T,aO[8]]}),(0,s.jsx)(wl,{label:C("toolBar.image"),shortcuts:[aO[9]]}),(0,s.jsx)(wl,{label:C("toolBar.eraser"),shortcuts:[aO.E,aO[0]]}),(0,s.jsx)(wl,{label:C("toolBar.frame"),shortcuts:[aO.F]}),(0,s.jsx)(wl,{label:C("toolBar.laser"),shortcuts:[aO.K]}),(0,s.jsx)(wl,{label:C("labels.eyeDropper"),shortcuts:[aO.I,"Shift+S","Shift+G"]}),(0,s.jsx)(wl,{label:C("helpDialog.editLineArrowPoints"),shortcuts:[t0("CtrlOrCmd+Enter")]}),(0,s.jsx)(wl,{label:C("helpDialog.editText"),shortcuts:[t0("Enter")]}),(0,s.jsx)(wl,{label:C("helpDialog.textNewLine"),shortcuts:[t0("Enter"),t0("Shift+Enter")]}),(0,s.jsx)(wl,{label:C("helpDialog.textFinish"),shortcuts:[t0("Esc"),t0("CtrlOrCmd+Enter")]}),(0,s.jsx)(wl,{label:C("helpDialog.curvedArrow"),shortcuts:["A",C("helpDialog.click"),C("helpDialog.click"),C("helpDialog.click")],isOr:!1}),(0,s.jsx)(wl,{label:C("helpDialog.curvedLine"),shortcuts:["L",C("helpDialog.click"),C("helpDialog.click"),C("helpDialog.click")],isOr:!1}),(0,s.jsx)(wl,{label:C("toolBar.lock"),shortcuts:[aO.Q]}),(0,s.jsx)(wl,{label:C("helpDialog.preventBinding"),shortcuts:[t0("CtrlOrCmd")]}),(0,s.jsx)(wl,{label:C("toolBar.link"),shortcuts:[t0("CtrlOrCmd+K")]})]}),(0,s.jsxs)(wn,{className:"HelpDialog__island--view",caption:C("helpDialog.view"),children:[(0,s.jsx)(wl,{label:C("buttons.zoomIn"),shortcuts:[t0("CtrlOrCmd++")]}),(0,s.jsx)(wl,{label:C("buttons.zoomOut"),shortcuts:[t0("CtrlOrCmd+-")]}),(0,s.jsx)(wl,{label:C("buttons.resetZoom"),shortcuts:[t0("CtrlOrCmd+0")]}),(0,s.jsx)(wl,{label:C("helpDialog.zoomToFit"),shortcuts:["Shift+1"]}),(0,s.jsx)(wl,{label:C("helpDialog.zoomToSelection"),shortcuts:["Shift+2"]}),(0,s.jsx)(wl,{label:C("helpDialog.movePageUpDown"),shortcuts:["PgUp/PgDn"]}),(0,s.jsx)(wl,{label:C("helpDialog.movePageLeftRight"),shortcuts:["Shift+PgUp/PgDn"]}),(0,s.jsx)(wl,{label:C("buttons.zenMode"),shortcuts:[t0("Alt+Z")]}),(0,s.jsx)(wl,{label:C("buttons.objectsSnapMode"),shortcuts:[t0("Alt+S")]}),(0,s.jsx)(wl,{label:C("labels.showGrid"),shortcuts:[t0("CtrlOrCmd+'")]}),(0,s.jsx)(wl,{label:C("labels.viewMode"),shortcuts:[t0("Alt+R")]}),(0,s.jsx)(wl,{label:C("labels.toggleTheme"),shortcuts:[t0("Alt+Shift+D")]}),(0,s.jsx)(wl,{label:C("stats.title"),shortcuts:[t0("Alt+/")]})]}),(0,s.jsxs)(wn,{className:"HelpDialog__island--editor",caption:C("helpDialog.editor"),children:[(0,s.jsx)(wl,{label:C("labels.moveCanvas"),shortcuts:[t0(`Space+${C("helpDialog.drag")}`),t0(`Wheel+${C("helpDialog.drag")}`)],isOr:!0}),(0,s.jsx)(wl,{label:C("buttons.clearReset"),shortcuts:[t0("CtrlOrCmd+Delete")]}),(0,s.jsx)(wl,{label:C("labels.delete"),shortcuts:[t0("Delete")]}),(0,s.jsx)(wl,{label:C("labels.cut"),shortcuts:[t0("CtrlOrCmd+X")]}),(0,s.jsx)(wl,{label:C("labels.copy"),shortcuts:[t0("CtrlOrCmd+C")]}),(0,s.jsx)(wl,{label:C("labels.paste"),shortcuts:[t0("CtrlOrCmd+V")]}),(0,s.jsx)(wl,{label:C("labels.pasteAsPlaintext"),shortcuts:[t0("CtrlOrCmd+Shift+V")]}),(0,s.jsx)(wl,{label:C("labels.selectAll"),shortcuts:[t0("CtrlOrCmd+A")]}),(0,s.jsx)(wl,{label:C("labels.multiSelect"),shortcuts:[t0(`Shift+${C("helpDialog.click")}`)]}),(0,s.jsx)(wl,{label:C("helpDialog.deepSelect"),shortcuts:[t0(`CtrlOrCmd+${C("helpDialog.click")}`)]}),(0,s.jsx)(wl,{label:C("helpDialog.deepBoxSelect"),shortcuts:[t0(`CtrlOrCmd+${C("helpDialog.drag")}`)]}),(hl||Y)&&(0,s.jsx)(wl,{label:C("labels.copyAsPng"),shortcuts:[t0("Shift+Alt+C")]}),(0,s.jsx)(wl,{label:C("labels.copyStyles"),shortcuts:[t0("CtrlOrCmd+Alt+C")]}),(0,s.jsx)(wl,{label:C("labels.pasteStyles"),shortcuts:[t0("CtrlOrCmd+Alt+V")]}),(0,s.jsx)(wl,{label:C("labels.sendToBack"),shortcuts:[V?t0("CtrlOrCmd+Alt+["):t0("CtrlOrCmd+Shift+[")]}),(0,s.jsx)(wl,{label:C("labels.bringToFront"),shortcuts:[V?t0("CtrlOrCmd+Alt+]"):t0("CtrlOrCmd+Shift+]")]}),(0,s.jsx)(wl,{label:C("labels.sendBackward"),shortcuts:[t0("CtrlOrCmd+[")]}),(0,s.jsx)(wl,{label:C("labels.bringForward"),shortcuts:[t0("CtrlOrCmd+]")]}),(0,s.jsx)(wl,{label:C("labels.alignTop"),shortcuts:[t0("CtrlOrCmd+Shift+Up")]}),(0,s.jsx)(wl,{label:C("labels.alignBottom"),shortcuts:[t0("CtrlOrCmd+Shift+Down")]}),(0,s.jsx)(wl,{label:C("labels.alignLeft"),shortcuts:[t0("CtrlOrCmd+Shift+Left")]}),(0,s.jsx)(wl,{label:C("labels.alignRight"),shortcuts:[t0("CtrlOrCmd+Shift+Right")]}),(0,s.jsx)(wl,{label:C("labels.duplicateSelection"),shortcuts:[t0("CtrlOrCmd+D"),t0(`Alt+${C("helpDialog.drag")}`)]}),(0,s.jsx)(wl,{label:C("helpDialog.toggleElementLock"),shortcuts:[t0("CtrlOrCmd+Shift+L")]}),(0,s.jsx)(wl,{label:C("buttons.undo"),shortcuts:[t0("CtrlOrCmd+Z")]}),(0,s.jsx)(wl,{label:C("buttons.redo"),shortcuts:K?[t0("CtrlOrCmd+Y"),t0("CtrlOrCmd+Shift+Z")]:[t0("CtrlOrCmd+Shift+Z")]}),(0,s.jsx)(wl,{label:C("labels.group"),shortcuts:[t0("CtrlOrCmd+G")]}),(0,s.jsx)(wl,{label:C("labels.ungroup"),shortcuts:[t0("CtrlOrCmd+Shift+G")]}),(0,s.jsx)(wl,{label:C("labels.flipHorizontal"),shortcuts:[t0("Shift+H")]}),(0,s.jsx)(wl,{label:C("labels.flipVertical"),shortcuts:[t0("Shift+V")]}),(0,s.jsx)(wl,{label:C("labels.showStroke"),shortcuts:[t0("S")]}),(0,s.jsx)(wl,{label:C("labels.showBackground"),shortcuts:[t0("G")]}),(0,s.jsx)(wl,{label:C("labels.decreaseFontSize"),shortcuts:[t0("CtrlOrCmd+Shift+<")]}),(0,s.jsx)(wl,{label:C("labels.increaseFontSize"),shortcuts:[t0("CtrlOrCmd+Shift+>")]})]})]})]})})}}),w6=tC(()=>{}),w4=tC(()=>{tM(),w6(),dH(),CJ(),b7(),dN(),tL(),df(),ws=({shouldWrap:e,children:t,clientId:n,username:i})=>e?(0,s.jsx)(aU,{label:i||"Unknown user",children:t},n):(0,s.jsx)(l.Fragment,{children:t},n),wo=({actionManager:e,collaborator:t,clientId:n,withName:i=!1,shouldWrapWithTooltip:l=!1,isBeingFollowed:r})=>{let a=e.renderAction("goToCollaborator",{clientId:n,collaborator:t,withName:i,isBeingFollowed:r});return(0,s.jsx)(ws,{clientId:n,username:t.username,shouldWrap:l,children:a},n)},wd=["avatarUrl","id","socketId","username"],wc=l.memo(({className:e,mobile:t,collaborators:n,userToFollow:i})=>{let r=Ce(),a=new Map;n.forEach((e,t)=>{let n=e.id||t;a.set(n,{...e,socketId:t})});let o=Array.from(a).filter(([e,t])=>t.username?.trim()),[c,h]=l.useState("");if(0===o.length)return null;let m=c.trim().toLowerCase()?o.filter(([,e])=>e.username?.toLowerCase().includes(c)):o,u=o.slice(0,3).map(([e,t])=>wo({actionManager:r,collaborator:t,clientId:e,shouldWrapWithTooltip:!0,isBeingFollowed:t.socketId===i}));return t?(0,s.jsx)("div",{className:(0,d.Z)("UserList UserList_mobile",e),children:o.map(([e,t])=>wo({actionManager:r,collaborator:t,clientId:e,shouldWrapWithTooltip:!0,isBeingFollowed:t.socketId===i}))}):(0,s.jsxs)("div",{className:(0,d.Z)("UserList",e),children:[u,o.length>3&&(0,s.jsxs)(th.fC,{onOpenChange:e=>{e||h("")},children:[(0,s.jsxs)(th.xz,{className:"UserList__more",children:["+",o.length-3]}),(0,s.jsx)(th.VY,{style:{zIndex:2,width:"13rem",textAlign:"left"},align:"end",sideOffset:10,children:(0,s.jsxs)(yA,{style:{overflow:"hidden"},children:[o.length>=8&&(0,s.jsxs)("div",{className:"UserList__search-wrapper",children:[aR,(0,s.jsx)("input",{className:"UserList__search",type:"text",placeholder:C("userList.search.placeholder"),value:c,onChange:e=>{h(e.target.value)}})]}),(0,s.jsxs)("div",{className:"dropdown-menu UserList__collaborators",children:[0===m.length&&(0,s.jsx)("div",{className:"UserList__collaborators__empty",children:C("userList.search.empty")}),(0,s.jsx)("div",{className:"UserList__hint",children:C("userList.hint.text")}),m.map(([e,t])=>wo({actionManager:r,collaborator:t,clientId:e,withName:!0,isBeingFollowed:t.socketId===i}))]})]})})]})]})},(e,t)=>{if(e.collaborators.size!==t.collaborators.size||e.mobile!==t.mobile||e.className!==t.className||e.userToFollow!==t.userToFollow)return!1;for(let[n,i]of e.collaborators){let e=t.collaborators.get(n);if(!e||!ng(i,e,wd))return!1}return!0})}),w5=tC(()=>{}),w8=tC(()=>{tM(),w5(),wh=({children:e,color:t})=>(0,s.jsx)("div",{className:"Card",style:{"--card-color":"primary"===t?"var(--color-primary)":o[t][7],"--card-color-darker":"primary"===t?"var(--color-primary-darker)":o[t][8],"--card-color-darkest":"primary"===t?"var(--color-primary-darkest)":o[t][9]},children:e})}),w7=tC(()=>{}),w9=tC(()=>{tM(),tL(),wP(),dN(),dR(),bE(),w8(),w7(),uQ(),d$(),df(),wm=({elements:e,appState:t,setAppState:n,files:i,actionManager:l,exportOpts:r,canvas:a,onCloseRequest:o})=>{let{onExportToBackend:d}=r;return(0,s.jsx)("div",{className:"ExportDialog ExportDialog--json",children:(0,s.jsxs)("div",{className:"ExportDialog-cards",children:[r.saveFileToDisk&&(0,s.jsxs)(wh,{color:"lime",children:[(0,s.jsx)("div",{className:"Card-icon",children:rk}),(0,s.jsx)("h2",{children:C("exportDialog.disk_title")}),(0,s.jsxs)("div",{className:"Card-details",children:[C("exportDialog.disk_details"),!tp.Zh&&l.renderAction("changeProjectName")]}),(0,s.jsx)(lF,{className:"Card-button",type:"button",title:C("exportDialog.disk_button"),"aria-label":C("exportDialog.disk_button"),showAriaLabel:!0,onClick:()=>{l.executeAction(xS,"ui")}})]}),d&&(0,s.jsxs)(wh,{color:"pink",children:[(0,s.jsx)("div",{className:"Card-icon",children:ry}),(0,s.jsx)("h2",{children:C("exportDialog.link_title")}),(0,s.jsx)("div",{className:"Card-details",children:C("exportDialog.link_details")}),(0,s.jsx)(lF,{className:"Card-button",type:"button",title:C("exportDialog.link_button"),"aria-label":C("exportDialog.link_button"),showAriaLabel:!0,onClick:async()=>{try{aX("export","link",`ui (${nh()})`),await d(e,t,i,a),o()}catch(e){n({errorMessage:e.message})}}})]}),r.renderCustomUI&&r.renderCustomUI(e,t,i,a)]})})},wu=({elements:e,appState:t,files:n,actionManager:i,exportOpts:r,canvas:a,setAppState:o})=>{let d=l.useCallback(()=>{o({openDialog:null})},[o]);return(0,s.jsx)(s.Fragment,{children:t.openDialog?.name==="jsonExport"&&(0,s.jsx)(v$,{onCloseRequest:d,title:C("buttons.export"),children:(0,s.jsx)(wm,{elements:e,appState:t,setAppState:o,files:n,actionManager:i,onCloseRequest:d,exportOpts:r,canvas:a})})})}}),Ee=tC(()=>{tM(),tL(),dN(),wp=e=>(0,s.jsx)("button",{className:"help-icon",onClick:e.onClick,type:"button",title:`${C("helpDialog.title")} \u2014 ?`,"aria-label":C("helpDialog.title"),children:rm})}),Et=tC(()=>{tM(),bZ(),va(),CJ(),vr(),Ee(),wK(),bQ(),wf=wg=({appState:e,actionManager:t,showExitZenModeBtn:n,renderWelcomeScreen:i})=>{let{FooterCenterTunnel:l,WelcomeScreenHelpHintTunnel:r}=yZ(),a=k4(),o=!e.viewModeEnabled&&e.multiElement&&a.isTouchScreen;return(0,s.jsxs)("footer",{role:"contentinfo",className:"layer-ui__wrapper__footer App-menu App-menu_bottom",children:[(0,s.jsx)("div",{className:(0,d.Z)("layer-ui__wrapper__footer-left zen-mode-transition",{"layer-ui__wrapper__footer-left--transition-left":e.zenModeEnabled}),children:(0,s.jsx)(yy.Col,{gap:2,children:(0,s.jsxs)(v3,{heading:"canvasActions",children:[(0,s.jsx)(yV,{renderAction:t.renderAction,zoom:e.zoom}),!e.viewModeEnabled&&(0,s.jsx)(yK,{renderAction:t.renderAction,className:(0,d.Z)("zen-mode-transition",{"layer-ui__wrapper__footer-left--transition-bottom":e.zenModeEnabled})}),o&&(0,s.jsx)(yX,{renderAction:t.renderAction,className:(0,d.Z)("zen-mode-transition",{"layer-ui__wrapper__footer-left--transition-left":e.zenModeEnabled})})]})})}),(0,s.jsx)(l.Out,{}),(0,s.jsx)("div",{className:(0,d.Z)("layer-ui__wrapper__footer-right zen-mode-transition",{"transition-right":e.zenModeEnabled}),children:(0,s.jsxs)("div",{style:{position:"relative"},children:[i&&(0,s.jsx)(r.Out,{}),(0,s.jsx)(wp,{onClick:()=>t.executeAction(xT)})]})}),(0,s.jsx)(yY,{actionManager:t,showExitZenModeBtn:n})]})},wg.displayName="Footer"}),En=tC(()=>{tM(),wx=l.createContext({})}),Ei=tC(()=>{}),El=tC(()=>{tM(),df(),Ei(),wy=({type:e="button",onSelect:t,selected:n,children:i,className:l="",...r})=>(0,s.jsx)("button",{onClick:nf(r.onClick,e=>{t()}),type:e,className:(0,d.Z)("excalidraw-button",l,{selected:n}),...r,children:i})}),Er=tC(()=>{tM(),tL(),CJ(),En(),dN(),dH(),El(),(wb=({children:e,className:t})=>{let n=k4(),i=(0,l.useContext)(wx),r=!!(n.editor.canFitSidebar&&i.shouldRenderDockButton);return(0,s.jsxs)("div",{className:(0,d.Z)("sidebar__header",t),"data-testid":"sidebar-header",children:[e,(0,s.jsxs)("div",{className:"sidebar__header__buttons",children:[r&&(0,s.jsx)(aU,{label:C("labels.sidebarLock"),children:(0,s.jsx)(wy,{onSelect:()=>i.onDock?.(!i.docked),selected:!!i.docked,className:"sidebar__dock","data-testid":"sidebar-dock","aria-label":C("labels.sidebarLock"),children:lX})}),(0,s.jsx)(wy,{"data-testid":"sidebar-close",className:"sidebar__close",onSelect:i.onCloseRequest,"aria-label":C("buttons.close"),children:r$})]})]})}).displayName="SidebarHeader"}),Ea=tC(()=>{}),Es=tC(()=>{tM(),CJ(),d8(),Ea(),(wv=({name:e,tab:t,icon:n,title:i,children:l,onToggle:r,className:a,style:o})=>{let c=k9(),h=dp();return(0,s.jsxs)("label",{title:i,className:"sidebar-trigger__label-element",children:[(0,s.jsx)("input",{className:"ToolIcon_type_checkbox",type:"checkbox",onChange:n=>{document.querySelector(".layer-ui__wrapper")?.classList.remove("animate");let i=n.target.checked;c({openSidebar:i?{name:e,tab:t}:null}),r?.(i)},checked:h.openSidebar?.name===e,"aria-label":i,"aria-keyshortcuts":"0"}),(0,s.jsxs)("div",{className:(0,d.Z)("sidebar-trigger",a),style:o,children:[n&&(0,s.jsx)("div",{children:n}),l&&(0,s.jsx)("div",{className:"sidebar-trigger__label",children:l})]})]})}).displayName="SidebarTrigger"}),Eo=tC(()=>{tM(),(ww=({children:e,...t})=>(0,s.jsx)(tw.aV,{className:"sidebar-triggers",...t,children:e})).displayName="SidebarTabTriggers"}),Ed=tC(()=>{tM(),(wE=({children:e,tab:t,onSelect:n,...i})=>(0,s.jsx)(tw.xz,{value:t,asChild:!0,onSelect:n,children:(0,s.jsx)("button",{type:"button",className:"excalidraw-button sidebar-tab-trigger",...i,children:e})})).displayName="SidebarTabTrigger"}),Ec=tC(()=>{tM(),d8(),CJ(),(wS=({children:e,...t})=>{let n=dp(),i=k9();if(!n.openSidebar)return null;let{name:l}=n.openSidebar;return(0,s.jsx)(tw.fC,{className:"sidebar-tabs-root",value:n.openSidebar.tab,onValueChange:e=>i(t=>({...t,openSidebar:{...t.openSidebar,name:l,tab:e}})),...t,children:e})}).displayName="SidebarTabs"}),Eh=tC(()=>{tM(),(wk=({tab:e,children:t,...n})=>(0,s.jsx)(tw.VY,{...n,value:e,children:t})).displayName="SidebarTab"}),Em=tC(()=>{}),Eu=tC(()=>{tM(),b7(),tj(),En(),Er(),CJ(),df(),dO(),tR(),Es(),Eo(),Ed(),Ec(),Eh(),d8(),cc(),Em(),wC=(0,i.cn)(!1),(wI=(0,l.forwardRef)(({name:e,children:t,onDock:n,docked:r,className:a,...o},c)=>{u.DEV&&n&&null==r&&console.warn("Sidebar: `docked` must be set when `onDock` is supplied for the sidebar to be user-dockable. To hide this message, either pass `docked` or remove `onDock`");let h=k9(),m=(0,i.b9)(wC,p);(0,l.useLayoutEffect)(()=>(m(!!r),()=>{m(!1)}),[m,r]);let g=(0,l.useRef)({});g.current.onCloseRequest=()=>{h({openSidebar:null})},g.current.onDock=e=>n?.(e),g.current=nc(g.current,{docked:r,shouldRenderDockButton:!!n&&null!=r});let f=(0,l.useRef)(null);(0,l.useImperativeHandle)(c,()=>f.current);let x=k4(),y=(0,l.useCallback)(()=>{document.querySelector(".Dialog")||h({openSidebar:null})},[h]);return d9(f,(0,l.useCallback)(e=>{!e.target.closest(".sidebar-trigger")&&(r&&x.editor.canFitSidebar||y())},[y,r,x.editor.canFitSidebar])),(0,l.useEffect)(()=>{let e=e=>{e.key!==aO.ESCAPE||r&&x.editor.canFitSidebar||y()};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[y,r,x.editor.canFitSidebar]),(0,s.jsx)(yA,{...o,className:(0,d.Z)("sidebar",{"sidebar--docked":r},a),ref:f,children:(0,s.jsx)(wx.Provider,{value:g.current,children:t})})})).displayName="SidebarInner",(wM=Object.assign((0,l.forwardRef)((e,t)=>{let n=dp(),{onStateChange:i}=e,r=(0,l.useRef)(n.openSidebar);(0,l.useEffect)(()=>{(n.openSidebar||r?.current?.name!==e.name)&&(n.openSidebar?.name!==e.name||r?.current?.name===e.name)&&r.current?.name!==e.name||n.openSidebar===r.current||i?.(n.openSidebar?.name!==e.name?null:n.openSidebar),r.current=n.openSidebar},[n.openSidebar,i,e.name]);let[a,s]=(0,l.useState)(!1);return(0,l.useLayoutEffect)(()=>(s(!0),()=>s(!1)),[]),a&&n.openSidebar?.name===e.name?(0,l.createElement)(wI,{...e,ref:t,key:e.name}):null}),{Header:wb,TabTriggers:ww,TabTrigger:wE,Tabs:wS,Tab:wk,Trigger:wv})).displayName="Sidebar"}),Ep=tC(()=>{}),Eg=tC(()=>{tM(),bZ(),tL(),tj(),CJ(),vx(),wj=(0,i.cn)(null),wT=()=>{let[e,t]=(0,i.KO)(wj,p),n=Ce();return e&&"clearCanvas"===e?(0,s.jsx)(y7,{onConfirm:()=>{n.executeAction(c$),t(null)},onCancel:()=>t(null),title:C("clearCanvasDialog.title"),children:(0,s.jsxs)("p",{className:"clear-canvas__content",children:[" ",C("alerts.clearReset")]})}):null}});async function Ef({title:e,description:t,actionLabel:n,color:i}){return new Promise(l=>{g.set(Ex,{active:!0,onConfirm:()=>l(!0),onClose:()=>l(!1),onReject:()=>l(!1),title:e,description:t,actionLabel:n,color:i})})}var Ex,Ey=tC(()=>{tM(),tj(),Ex=(0,i.cn)({active:!1})}),Eb={};tI(Eb,{ChangeCanvasBackground:()=>EI,ClearCanvas:()=>Ek,Export:()=>EM,Help:()=>ES,LiveCollaborationTrigger:()=>ET,LoadScene:()=>Ev,SaveAsImage:()=>EE,SaveToActiveFile:()=>Ew,Socials:()=>Ej,ToggleTheme:()=>EC});var Ev,Ew,EE,ES,Ek,EC,EI,EM,Ej,ET,EL,ED,EA,EP,E_,ER,EN,EO,Ez,EH,EB,EF,E$,EZ,EW,EU,EG,EV,EK,EY,EX,Eq,EJ,EQ,E1,E0,E2,E3,E6,E4,E5,E8,E7,E9,Se,St,Sn,Si,Sl,Sr,Sa,Ss,So,Sd,Sc,Sh,Sm,Su,Sp,Sg,Sf,Sx,Sy,Sb,Sv,Sw,SE,SS,Sk,SC,SI,SM,Sj,ST,SL,SD,SA,SP,S_,SR,SN,SO,Sz,SH,SB,SF,S$,SZ,SW,SU,SG,SV,SK,SY,SX,Sq,SJ,SQ,S1,S0,S2=tC(()=>{tM(),bX(),tL(),CJ(),dN(),dN(),b6(),ve(),bZ(),Ep(),Eg(),tj(),d8(),Ey(),vu(),(Ev=()=>{let{t:e}=M(),t=Ce(),n=k8();return t.isActionEnabled(xk)?(0,s.jsx)(yM,{icon:rw,onSelect:async()=>{(!n.length||await Ef({title:e("overwriteConfirm.modal.loadFromFile.title"),actionLabel:e("overwriteConfirm.modal.loadFromFile.button"),color:"warning",description:(0,s.jsx)(y5,{i18nKey:"overwriteConfirm.modal.loadFromFile.description",bold:e=>(0,s.jsx)("strong",{children:e}),br:()=>(0,s.jsx)("br",{})})}))&&t.executeAction(xk)},"data-testid":"load-button",shortcut:yg("loadScene"),"aria-label":e("buttons.load"),children:e("buttons.load")}):null}).displayName="LoadScene",(Ew=()=>{let{t:e}=M(),t=Ce();return t.isActionEnabled(xE)?(0,s.jsx)(yM,{shortcut:yg("saveScene"),"data-testid":"save-button",onSelect:()=>t.executeAction(xE),icon:rb,"aria-label":`${e("buttons.save")}`,children:`${e("buttons.save")}`}):null}).displayName="SaveToActiveFile",(EE=()=>{let e=k9(),{t}=M();return(0,s.jsx)(yM,{icon:rS,"data-testid":"image-export-button",onSelect:()=>e({openDialog:{name:"imageExport"}}),shortcut:yg("imageExport"),"aria-label":t("buttons.exportImage"),children:t("buttons.exportImage")})}).displayName="SaveAsImage",(ES=()=>{let{t:e}=M(),t=Ce();return(0,s.jsx)(yM,{"data-testid":"help-menu-item",icon:rm,onSelect:()=>t.executeAction(xT),shortcut:"?","aria-label":e("helpDialog.title"),children:e("helpDialog.title")})}).displayName="Help",(Ek=()=>{let{t:e}=M(),t=(0,i.b9)(wj,p);return Ce().isActionEnabled(c$)?(0,s.jsx)(yM,{icon:rr,onSelect:()=>t("clearCanvas"),"data-testid":"clear-canvas-button","aria-label":e("buttons.clearReset"),children:e("buttons.clearReset")}):null}).displayName="ClearCanvas",(EC=()=>{let{t:e}=M(),t=dp(),n=Ce();return n.isActionEnabled(cK)?(0,s.jsx)(yM,{onSelect:e=>(e.preventDefault(),n.executeAction(cK)),icon:"dark"===t.theme?rd:ro,"data-testid":"toggle-dark-mode",shortcut:yg("toggleTheme"),"aria-label":e("dark"===t.theme?"buttons.lightMode":"buttons.darkMode"),children:e("dark"===t.theme?"buttons.lightMode":"buttons.darkMode")}):null}).displayName="ToggleTheme",(EI=()=>{let{t:e}=M(),t=dp(),n=Ce(),i=k6();return t.viewModeEnabled||!i.UIOptions.canvasActions.changeViewBackgroundColor?null:(0,s.jsxs)("div",{style:{marginTop:"0.5rem"},children:[(0,s.jsx)("div",{"data-testid":"canvas-background-label",style:{fontSize:".75rem",marginBottom:".5rem"},children:e("labels.canvasBackground")}),(0,s.jsx)("div",{style:{padding:"0 0.625rem"},children:n.renderAction("changeViewBackgroundColor")})]})}).displayName="ChangeCanvasBackground",(EM=()=>{let{t:e}=M(),t=k9();return(0,s.jsx)(yM,{icon:rh,onSelect:()=>{t({openDialog:{name:"jsonExport"}})},"data-testid":"json-export-button","aria-label":e("buttons.export"),children:e("buttons.export")})}).displayName="Export",(Ej=()=>{let{t:e}=M();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(yN,{icon:rp,href:"https://github.com/excalidraw/excalidraw","aria-label":"GitHub",children:"GitHub"}),(0,s.jsx)(yN,{icon:rf,href:"https://x.com/excalidraw","aria-label":"X",children:e("labels.followUs")}),(0,s.jsx)(yN,{icon:rg,href:"https://discord.gg/UexuTaE","aria-label":"Discord",children:e("labels.discordChat")})]})}).displayName="Socials",(ET=({onSelect:e,isCollaborating:t})=>{let{t:n}=M();return(0,s.jsx)(yM,{"data-testid":"collab-button",icon:rF,className:(0,d.Z)({"active-collab":t}),onSelect:e,children:n("labels.liveCollaboration")})}).displayName="LiveCollaborationTrigger"}),S3=tC(()=>{tM(),vr(),EL=(e,t)=>{let n=(0,i.cn)(0),r=e=>{let{jotaiScope:r}=yZ(),[,a]=(0,i.KO)(n,r),o=(0,l.useRef)({preferHost:!1,counter:0});return(0,l.useLayoutEffect)(()=>{let e=o.current;return a(t=>{let n=t+1;return e.counter=n,n}),()=>{a(t=>{let n=t-1;return e.counter=n,n||(e.preferHost=!1),n})}},[a]),e.__fallback||(o.current.preferHost=!0),!o.current.counter&&e.__fallback&&o.current.preferHost||o.current.counter>1&&e.__fallback?null:(0,s.jsx)(t,{...e})};return r.displayName=e,r}}),S6=tC(()=>{tM(),CJ(),vl(),S2(),w4(),tL(),dN(),S3(),df(),vr(),d8(),ED=Object.assign(EL("MainMenu",({children:e,onSelect:t})=>{let{MainMenuTunnel:n}=yZ(),i=k4(),l=dp(),r=k9(),a=i.editor.isMobile?void 0:()=>r({openMenu:null});return(0,s.jsx)(n.In,{children:(0,s.jsxs)(yF,{open:"canvas"===l.openMenu,children:[(0,s.jsx)(yF.Trigger,{onToggle:()=>{r({openMenu:"canvas"===l.openMenu?null:"canvas"})},"data-testid":"main-menu-trigger",className:"main-menu-trigger",children:rc}),(0,s.jsxs)(yF.Content,{onClickOutside:a,onSelect:nf(t,()=>{r({openMenu:null})}),children:[e,i.editor.isMobile&&l.collaborators.size>0&&(0,s.jsxs)("fieldset",{className:"UserList-Wrapper",children:[(0,s.jsx)("legend",{children:C("labels.collaborators")}),(0,s.jsx)(wc,{mobile:!0,collaborators:l.collaborators,userToFollow:l.userToFollow?.socketId||null})]})]})]})})}),{Trigger:yF.Trigger,Item:yF.Item,ItemLink:yF.ItemLink,ItemCustom:yF.ItemCustom,Group:yF.Group,Separator:yF.Separator,DefaultItems:Eb})}),S4=tC(()=>{tM(),wF(),CJ(),bZ(),tL(),bE(),EA=({title:e,children:t,actionLabel:n,onClick:i})=>(0,s.jsxs)("div",{className:"OverwriteConfirm__Actions__Action",children:[(0,s.jsx)("h4",{children:e}),(0,s.jsx)("div",{className:"OverwriteConfirm__Actions__Action__content",children:t}),(0,s.jsx)(vG,{variant:"outlined",color:"muted",label:n,size:"large",fullWidth:!0,onClick:i})]}),EP=Object.assign(({children:e})=>(0,s.jsx)("div",{className:"OverwriteConfirm__Actions",children:e}),{ExportToImage:()=>{let{t:e}=M(),t=Ce(),n=k9();return(0,s.jsx)(EA,{title:e("overwriteConfirm.action.exportToImage.title"),actionLabel:e("overwriteConfirm.action.exportToImage.button"),onClick:()=>{t.executeAction(xw,"ui",!0),n({openDialog:{name:"imageExport"}})},children:e("overwriteConfirm.action.exportToImage.description")})},SaveToDisk:()=>{let{t:e}=M(),t=Ce();return(0,s.jsx)(EA,{title:e("overwriteConfirm.action.saveToDisk.title"),actionLabel:e("overwriteConfirm.action.saveToDisk.button"),onClick:()=>{t.executeAction(xS,"ui")},children:e("overwriteConfirm.action.saveToDisk.description")})}})}),S5=tC(()=>{}),S8=tC(()=>{tM(),vr(),tj(),wP(),S3(),Ey(),wF(),dN(),S4(),S5(),E_=Object.assign(EL("OverwriteConfirmDialog",({children:e})=>{let{OverwriteConfirmDialogTunnel:t}=yZ(),[n,l]=(0,i.KO)(Ex,p);return n.active?(0,s.jsx)(t.In,{children:(0,s.jsx)(v$,{onCloseRequest:()=>{n.onClose(),l(e=>({...e,active:!1}))},title:!1,size:916,children:(0,s.jsxs)("div",{className:"OverwriteConfirm",children:[(0,s.jsx)("h3",{children:n.title}),(0,s.jsxs)("div",{className:`OverwriteConfirm__Description OverwriteConfirm__Description--color-${n.color}`,children:[(0,s.jsx)("div",{className:"OverwriteConfirm__Description__icon",children:aE}),(0,s.jsx)("div",{children:n.description}),(0,s.jsx)("div",{className:"OverwriteConfirm__Description__spacer"}),(0,s.jsx)(vG,{color:n.color,size:"large",label:n.actionLabel,onClick:()=>{n.onConfirm(),l(e=>({...e,active:!1}))}})]}),(0,s.jsx)(EP,{children:e})]})})}):null}),{Actions:EP,Action:EA})}),S7=tC(()=>{tM(),tR(),vr(),d8(),tL(),df(),CJ(),S3(),wA(),Eu(),(ER=EL("DefaultSidebarTrigger",e=>{let{DefaultSidebarTriggerTunnel:t}=yZ();return(0,s.jsx)(t.In,{children:(0,s.jsx)(wM.Trigger,{...e,className:"default-sidebar-trigger",name:tn.name})})})).displayName="DefaultSidebarTrigger",(EN=({children:e,...t})=>{let{DefaultSidebarTabTriggersTunnel:n}=yZ();return(0,s.jsx)(n.In,{children:(0,s.jsx)(wM.TabTriggers,{...t,children:e})})}).displayName="DefaultTabTriggers",EO=Object.assign(EL("DefaultSidebar",({children:e,className:t,onDock:n,docked:i,...r})=>{let a=dp(),o=k9(),{DefaultSidebarTabTriggersTunnel:c}=yZ();return(0,l.createElement)(wM,{...r,name:"default",key:"default",className:(0,d.Z)("default-sidebar",t),docked:i??a.defaultSidebarDockedPreference,onDock:!1!==n&&(n||null==i)?nf(n,e=>{o({defaultSidebarDockedPreference:e})}):void 0},(0,s.jsxs)(wM.Tabs,{children:[(0,s.jsxs)(wM.Header,{children:[r.__fallback&&(0,s.jsx)("div",{style:{color:"var(--color-primary)",fontSize:"1.2em",fontWeight:"bold",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",paddingRight:"1em"},children:C("toolBar.library")}),(0,s.jsx)(c.Out,{})]}),(0,s.jsx)(wM.Tab,{tab:tt,children:(0,s.jsx)(vF,{})}),e]}))}),{Trigger:ER,TabTriggers:EN})}),S9=tC(()=>{}),ke=tC(()=>{}),kt=tC(()=>{tM(),dP(),dN(),Ez=e=>(0,s.jsxs)("label",{className:(0,d.Z)("ToolIcon ToolIcon__LaserPointer","ToolIcon_size_small",{"is-mobile":e.isMobile}),title:`${e.title}`,children:[(0,s.jsx)("input",{className:"ToolIcon_type_checkbox",type:"checkbox",name:e.name,onChange:e.onChange,checked:e.checked,"aria-label":e.title,"data-testid":"toolbar-LaserPointer"}),(0,s.jsx)("div",{className:"ToolIcon__icon",children:aj})]})}),kn=tC(()=>{}),ki=tC(()=>{tM(),kn(),El(),dN(),EH=(0,l.forwardRef)(({value:e,onChange:t,label:n,fullWidth:i,placeholder:r,readonly:a,selectOnRender:o,onKeyDown:c,isRedacted:h=!1},m)=>{let u=(0,l.useRef)(null);(0,l.useImperativeHandle)(m,()=>u.current),(0,l.useLayoutEffect)(()=>{o&&u.current?.select()},[o]);let[p,g]=(0,l.useState)(!1);return(0,s.jsxs)("div",{className:(0,d.Z)("ExcTextField",{"ExcTextField--fullWidth":i}),onClick:()=>{u.current?.focus()},children:[(0,s.jsx)("div",{className:"ExcTextField__label",children:n}),(0,s.jsxs)("div",{className:(0,d.Z)("ExcTextField__input",{"ExcTextField__input--readonly":a}),children:[(0,s.jsx)("input",{className:(0,d.Z)({"is-redacted":e&&h&&!p}),readOnly:a,value:e,placeholder:r,ref:u,onChange:e=>t?.(e.target.value),onKeyDown:c}),h&&(0,s.jsx)(wy,{onSelect:()=>g(!p),style:{border:0,userSelect:"none"},children:p?aP:aA})]})]})})}),kl=tC(()=>{tM(),EB=({icon:e})=>(0,s.jsx)("span",{style:{width:"1em",margin:"0 0.5ex 0 0.5ex",display:"inline-block",lineHeight:0,verticalAlign:"middle"},children:e})}),kr=tC(()=>{tM(),EF=e=>(0,s.jsx)("p",{className:"excalidraw__paragraph",style:e.style,children:e.children})}),ka=tC(()=>{}),ks=tC(()=>{tM(),CJ(),df(),(E$=e=>{let t=k9(),n=(0,l.useRef)(null),i=(0,l.useRef)(0);return(0,s.jsx)(tw.fC,{ref:n,className:"ttd-dialog-tabs-root",value:e.tab,onValueChange:l=>{if(!l)return;let r=n.current?.closest(".Modal__content");if(r){let e=r.offsetHeight||0;e>i.current&&(i.current=e,r.style.minHeight=`min(${i.current}px, 100%)`)}"settings"===e.dialog&&nb(["text-to-diagram","diagram-to-code"],l)?t({openDialog:{name:e.dialog,tab:l,source:"settings"}}):"ttd"===e.dialog&&nb(["text-to-diagram","mermaid"],l)&&t({openDialog:{name:e.dialog,tab:l}})},children:e.children})}).displayName="TTDDialogTabs",EZ=E$}),ko=tC(()=>{tM(),(EW=({tab:e,children:t,...n})=>(0,s.jsx)(tw.VY,{...n,value:e,children:t})).displayName="TTDDialogTab"}),kd=tC(()=>{tM(),wP(),ki(),dN(),wF(),bw(),dO(),d8(),kl(),kr(),ka(),ks(),ko(),EU=e=>{let[t,n]=(0,l.useState)(e.openAIKey||""),[i,r]=(0,l.useState)(e.isPersisted),a=dp(),o=()=>{e.onConfirm(t.trim(),i)};return a.openDialog?.name!=="settings"?null:(0,s.jsx)(v$,{onCloseRequest:()=>{e.onClose(),e.onConfirm(t.trim(),i)},title:(0,s.jsxs)("div",{style:{display:"flex"},children:["Wireframe to Code (AI)"," ",(0,s.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"0.1rem 0.5rem",marginLeft:"1rem",fontSize:14,borderRadius:"12px",color:"#000",background:"pink"},children:"Experimental"})]}),className:"MagicSettings",autofocus:!1,children:(0,s.jsx)(EZ,{dialog:"settings",tab:a.openDialog.tab,children:(0,s.jsxs)(EW,{tab:"diagram-to-code",children:[(0,s.jsxs)(EF,{children:["For the diagram-to-code feature we use"," ",(0,s.jsx)(EB,{icon:aL}),"OpenAI."]}),(0,s.jsxs)(EF,{children:["While the OpenAI API is in beta, its use is strictly limited — as such we require you use your own API key. You can create an"," ",(0,s.jsx)("a",{href:"https://platform.openai.com/login?launch",rel:"noopener noreferrer",target:"_blank",children:"OpenAI account"}),", add a small credit (5 USD minimum), and"," ",(0,s.jsx)("a",{href:"https://platform.openai.com/api-keys",rel:"noopener noreferrer",target:"_blank",children:"generate your own API key"}),"."]}),(0,s.jsx)(EF,{children:"Your OpenAI key does not leave the browser, and you can also set your own limit in your OpenAI account dashboard if needed."}),(0,s.jsx)(EH,{isRedacted:!0,value:t,placeholder:"Paste your API key here",label:"OpenAI API key",onChange:t=>{n(t),e.onChange(t.trim(),i)},selectOnRender:!0,onKeyDown:e=>e.key===aO.ENTER&&o()}),(0,s.jsx)(EF,{children:"By default, your API token is not persisted anywhere so you'll need to insert it again after reload. But, you can persist locally in your browser below."}),(0,s.jsx)(xx,{checked:i,onChange:r,children:"Persist API key in browser storage"}),(0,s.jsxs)(EF,{children:["Once API key is set, you can use the ",(0,s.jsx)(EB,{icon:aT})," ","tool to wrap your elements in a frame that will then allow you to turn it into code. This dialog can be accessed using the"," ",(0,s.jsx)("b",{children:"AI Settings"})," ",(0,s.jsx)(EB,{icon:aL}),"."]}),(0,s.jsx)(vG,{className:"MagicSettings__confirm",size:"large",label:"Confirm",onClick:o})]})})})}}),kc=tC(()=>{}),kh=tC(()=>{tM(),tR(),Il(),pW(),vy(),EG=({canvasRef:e,setError:t})=>{let n=e.current;if(!n)return;let i=n.parentElement;i&&(i.style.background="",t(null),n.replaceChildren())},EV=async({canvasRef:e,mermaidToExcalidrawLib:t,mermaidDefinition:n,setError:i,data:l})=>{let r=e.current,a=r?.parentElement;if(!(!r||!a)){if(!n){EG({canvasRef:e,setError:i});return}try{let e=await t.api,s;try{s=await e.parseMermaidToExcalidraw(n,{fontSize:ey})}catch{s=await e.parseMermaidToExcalidraw(n.replace(/"/g,"'"),{fontSize:ey})}let{elements:o,files:d}=s;i(null),l.current={elements:SH(o,{regenerateIds:!0}),files:d};let c=await gc({elements:l.current.elements,files:l.current.files,exportPadding:eV,maxWidthOrHeight:Math.max(a.offsetWidth,a.offsetHeight)*window.devicePixelRatio});await po(c),a.style.background="var(--default-bg-color)",r.replaceChildren(c)}catch(e){throw a.style.background="var(--default-bg-color)",n&&i(e),e}}},EK=e=>{y9.set(tr.MERMAID_TO_EXCALIDRAW,e)},EY=({app:e,data:t,text:n,shouldSaveMermaidDataToStorage:i})=>{let{elements:l,files:r}=t.current;l.length&&(e.addElementsFromPasteOrLibrary({elements:l,files:r,position:"center",fitToContent:!0}),e.setOpenDialog(null),i&&n&&EK(n))}}),km=tC(()=>{tM(),EX=({children:e})=>(0,s.jsx)("div",{className:"ttd-dialog-panels",children:e})}),ku=tC(()=>{tM(),El(),tA(),Eq=({label:e,children:t,panelAction:n,panelActionDisabled:i=!1,onTextSubmitInProgess:l,renderTopRight:r,renderSubmitShortcut:a,renderBottomRight:o})=>(0,s.jsxs)("div",{className:"ttd-dialog-panel",children:[(0,s.jsxs)("div",{className:"ttd-dialog-panel__header",children:[(0,s.jsx)("label",{children:e}),r?.()]}),t,(0,s.jsxs)("div",{className:(0,d.Z)("ttd-dialog-panel-button-container",{invisible:!n}),style:{display:"flex",alignItems:"center"},children:[(0,s.jsxs)(wy,{className:"ttd-dialog-panel-button",onSelect:n?n.action:()=>{},disabled:i||l,children:[(0,s.jsxs)("div",{className:(0,d.Z)({invisible:l}),children:[n?.label,n?.icon&&(0,s.jsx)("span",{children:n.icon})]}),l&&(0,s.jsx)(j,{})]}),!i&&!l&&a?.(),o?.()]})]})}),kp=tC(()=>{tM(),tR(),dO(),EJ=({input:e,placeholder:t,onChange:n,onKeyboardSubmit:i})=>{let r=(0,l.useRef)(null),a=(0,l.useRef)(i);return a.current=i,(0,l.useEffect)(()=>{if(!a.current)return;let e=r.current;if(e){let t=e=>{e[aO.CTRL_OR_CMD]&&e.key===aO.ENTER&&(e.preventDefault(),a.current?.())};return e.addEventListener("keydown",t),()=>{e.removeEventListener("keydown",t)}}},[]),(0,s.jsx)("textarea",{className:"ttd-dialog-input",onChange:n,value:e,placeholder:t,autoFocus:!0,ref:r})}}),kg=tC(()=>{tM(),tA(),EQ=({error:e})=>(0,s.jsxs)("div",{"data-testid":"ttd-dialog-output-error",className:"ttd-dialog-output-error",children:["Error! ",(0,s.jsx)("p",{children:e})]}),E1=({error:e,canvasRef:t,loaded:n})=>(0,s.jsxs)("div",{className:"ttd-dialog-output-wrapper",children:[e&&(0,s.jsx)(EQ,{error:e.message}),n?(0,s.jsx)("div",{ref:t,style:{opacity:e?"0.15":1},className:"ttd-dialog-output-canvas-container"}):(0,s.jsx)(j,{size:"2rem"})]})}),kf=tC(()=>{tM(),df(),E0=()=>(0,s.jsxs)("div",{className:"ttd-dialog-submit-shortcut",children:[(0,s.jsx)("div",{className:"ttd-dialog-submit-shortcut__key",children:t0("CtrlOrCmd")}),(0,s.jsx)("div",{className:"ttd-dialog-submit-shortcut__key",children:t0("Enter")})]})}),kx=tC(()=>{tM(),CJ(),dN(),kc(),tL(),vu(),kh(),km(),ku(),kp(),kg(),vy(),tR(),df(),kf(),E2=`flowchart TD
 A[Christmas] -->|Get money| B(Go shopping)
 B --> C{Let me think}
 C -->|One| D[Laptop]
 C -->|Two| E[iPhone]
 C -->|Three| F[Car]`,E3=tV(EK,300),E6=({mermaidToExcalidrawLib:e})=>{let[t,n]=(0,l.useState)(()=>y9.get(tr.MERMAID_TO_EXCALIDRAW)||E2),i=(0,l.useDeferredValue)(t.trim()),[r,a]=(0,l.useState)(null),o=(0,l.useRef)(null),d=(0,l.useRef)({elements:[],files:null}),c=k3();(0,l.useEffect)(()=>{EV({canvasRef:o,data:d,mermaidToExcalidrawLib:e,setError:a,mermaidDefinition:i}).catch(()=>{}),E3(i)},[i,e]),(0,l.useEffect)(()=>()=>{E3.flush()},[]);let h=()=>{EY({app:c,data:d,text:t,shouldSaveMermaidDataToStorage:!0})};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"ttd-dialog-desc",children:(0,s.jsx)(y5,{i18nKey:"mermaid.description",flowchartLink:e=>(0,s.jsx)("a",{href:"https://mermaid.js.org/syntax/flowchart.html",children:e}),sequenceLink:e=>(0,s.jsx)("a",{href:"https://mermaid.js.org/syntax/sequenceDiagram.html",children:e}),classLink:e=>(0,s.jsx)("a",{href:"https://mermaid.js.org/syntax/classDiagram.html",children:e})})}),(0,s.jsxs)(EX,{children:[(0,s.jsx)(Eq,{label:C("mermaid.syntax"),children:(0,s.jsx)(EJ,{input:t,placeholder:"Write Mermaid diagram defintion here...",onChange:e=>n(e.target.value),onKeyboardSubmit:()=>{h()}})}),(0,s.jsx)(Eq,{label:C("mermaid.preview"),panelAction:{action:()=>{h()},label:C("mermaid.button"),icon:aM},renderSubmitShortcut:()=>(0,s.jsx)(E0,{}),children:(0,s.jsx)(E1,{canvasRef:o,loaded:e.loaded,error:r})})]})]})}}),ky=tC(()=>{tM(),(E4=({children:e,...t})=>(0,s.jsx)(tw.aV,{className:"ttd-dialog-triggers",...t,children:e})).displayName="TTDDialogTabTriggers"}),kb=tC(()=>{tM(),(E5=({children:e,tab:t,onSelect:n,...i})=>(0,s.jsx)(tw.xz,{value:t,asChild:!0,onSelect:n,children:(0,s.jsx)("button",{type:"button",className:"ttd-dialog-tab-trigger",...i,children:e})})).displayName="TTDDialogTabTrigger"}),kv=tC(()=>{}),kw=tC(()=>{tM(),wP(),CJ(),kx(),ks(),d8(),S3(),ky(),kb(),ko(),tL(),kp(),kg(),ku(),km(),kh(),dN(),kv(),df(),d$(),kl(),kf(),E8=(0,i.cn)(null),E7=(0,i.cn)(null),E9=e=>{let t=dp();return t.openDialog?.name!=="ttd"?null:(0,s.jsx)(Se,{...e,tab:t.openDialog.tab})},Se=EL("TTDDialogBase",({tab:e,...t})=>{let r=k3(),a=k9(),o=(0,l.useRef)(null),[d,c]=(0,i.KO)(E7),[h,m]=(0,l.useState)(d?.prompt??""),u=h.trim(),[p,g]=(0,l.useState)(!1),[f,x]=(0,i.KO)(E8),y=async()=>{if(u.length>1e3||u.length<3||p||f?.rateLimitRemaining===0||"__fallback"in t){u.length<3&&k(Error("Prompt is too short (min 3 characters)")),u.length>1e3&&k(Error("Prompt is too long (max 1000 characters)"));return}try{g(!0),aX("ai","generate","ttd");let{generatedResponse:e,error:n,rateLimit:i,rateLimitRemaining:l}=await t.onTextSubmit(u);if("string"==typeof e&&c(t=>({generatedResponse:e,prompt:t?.prompt??null})),nw(i)&&nw(l)&&x({rateLimit:i,rateLimitRemaining:l}),n){k(n);return}if(!e){k(Error("Generation failed"));return}try{await EV({canvasRef:o,data:E,mermaidToExcalidrawLib:v,setError:k,mermaidDefinition:e}),aX("ai","mermaid parse success","ttd")}catch(e){console.info(`%cTTD mermaid render errror: ${e.message}`,"color: red"),console.info(`>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
TTD mermaid definition render errror: ${e.message}`,"color: yellow"),aX("ai","mermaid parse failed","ttd"),k(Error("Generated an invalid diagram :(. You may also try a different prompt."))}}catch(t){let e=t.message;e&&"Failed to fetch"!==e||(e="Request failed"),k(Error(e))}finally{g(!1)}},b=(0,l.useRef)(y);b.current=y;let[v,w]=(0,l.useState)({loaded:!1,api:Promise.all([n.e(8457),n.e(8576)]).then(n.bind(n,4363))});(0,l.useEffect)(()=>{(async()=>{await v.api,w(e=>({...e,loaded:!0}))})()},[v.api]);let E=(0,l.useRef)({elements:[],files:null}),[S,k]=(0,l.useState)(null);return(0,s.jsx)(v$,{className:"ttd-dialog",onCloseRequest:()=>{r.setOpenDialog(null)},size:1200,title:!1,...t,autofocus:!1,children:(0,s.jsxs)(EZ,{dialog:"ttd",tab:e,children:["__fallback"in t&&t.__fallback?(0,s.jsx)("p",{className:"dialog-mermaid-title",children:C("mermaid.title")}):(0,s.jsxs)(E4,{children:[(0,s.jsx)(E5,{tab:"text-to-diagram",children:(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[C("labels.textToDiagram"),(0,s.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"1px 6px",marginLeft:"10px",fontSize:10,borderRadius:"12px",background:"pink",color:"#000"},children:"AI Beta"})]})}),(0,s.jsx)(E5,{tab:"mermaid",children:"Mermaid"})]}),(0,s.jsx)(EW,{className:"ttd-dialog-content",tab:"mermaid",children:(0,s.jsx)(E6,{mermaidToExcalidrawLib:v})}),!("__fallback"in t)&&(0,s.jsxs)(EW,{className:"ttd-dialog-content",tab:"text-to-diagram",children:[(0,s.jsx)("div",{className:"ttd-dialog-desc",children:"Currently we use Mermaid as a middle step, so you'll get best results if you describe a diagram, workflow, flow chart, and similar."}),(0,s.jsxs)(EX,{children:[(0,s.jsx)(Eq,{label:C("labels.prompt"),panelAction:{action:y,label:"Generate",icon:aM},onTextSubmitInProgess:p,panelActionDisabled:u.length>1e3||f?.rateLimitRemaining===0,renderTopRight:()=>f?(0,s.jsxs)("div",{className:"ttd-dialog-rate-limit",style:{fontSize:12,marginLeft:"auto",color:0===f.rateLimitRemaining?"var(--color-danger)":void 0},children:[f.rateLimitRemaining," requests left today"]}):null,renderSubmitShortcut:()=>(0,s.jsx)(E0,{}),renderBottomRight:()=>{if("string"==typeof d?.generatedResponse)return(0,s.jsxs)("div",{className:"excalidraw-link",style:{marginLeft:"auto",fontSize:14},onClick:()=>{"string"==typeof d?.generatedResponse&&(EK(d.generatedResponse),a({openDialog:{name:"ttd",tab:"mermaid"}}))},children:["View as Mermaid",(0,s.jsx)(EB,{icon:aM})]});let e=u.length/1e3;return e>.8?(0,s.jsxs)("div",{style:{marginLeft:"auto",fontSize:12,fontFamily:"monospace",color:e>1?"var(--color-danger)":void 0},children:["Length: ",u.length,"/",1e3]}):null},children:(0,s.jsx)(EJ,{onChange:e=>{m(e.target.value),c(t=>({generatedResponse:t?.generatedResponse??null,prompt:e.target.value}))},input:h,placeholder:"Describe what you want to see...",onKeyboardSubmit:()=>{b.current()}})}),(0,s.jsx)(Eq,{label:"Preview",panelAction:{action:()=>{console.info("Panel action clicked"),EY({app:r,data:E})},label:"Insert",icon:aM},children:(0,s.jsx)(E1,{canvasRef:o,error:S,loaded:v.loaded})})]})]})]})})})}),kE=tC(()=>{tM(),tR(),fG(),tL(),fK(),df(),va(),w_(),w$(),wW(),wG(),b7(),tN(),wV(),wQ(),w0(),wK(),w3(),bQ(),w4(),w9(),wY(),d$(),CJ(),wq(),bH(),Et(),Eu(),tj(),S6(),Eg(),S8(),wJ(),dy(),vr(),dN(),d8(),S7(),cu(),S9(),ke(),fB(),dV(),fH(),kt(),kd(),kw(),St=({UIOptions:e})=>(0,s.jsxs)(ED,{__fallback:!0,children:[(0,s.jsx)(ED.DefaultItems.LoadScene,{}),(0,s.jsx)(ED.DefaultItems.SaveToActiveFile,{}),e.canvasActions.export&&(0,s.jsx)(ED.DefaultItems.Export,{}),e.canvasActions.saveAsImage&&(0,s.jsx)(ED.DefaultItems.SaveAsImage,{}),(0,s.jsx)(ED.DefaultItems.Help,{}),(0,s.jsx)(ED.DefaultItems.ClearCanvas,{}),(0,s.jsx)(ED.Separator,{}),(0,s.jsx)(ED.Group,{title:"Excalidraw links",children:(0,s.jsx)(ED.DefaultItems.Socials,{})}),(0,s.jsx)(ED.Separator,{}),(0,s.jsx)(ED.DefaultItems.ToggleTheme,{}),(0,s.jsx)(ED.DefaultItems.ChangeCanvasBackground,{})]}),Sn=()=>(0,s.jsxs)(E_,{__fallback:!0,children:[(0,s.jsx)(E_.Actions.SaveToDisk,{}),(0,s.jsx)(E_.Actions.ExportToImage,{})]}),Si=({actionManager:e,appState:t,files:n,setAppState:l,elements:r,canvas:a,onLockToggle:o,onHandToolToggle:c,onPenModeToggle:h,showExitZenModeBtn:m,renderTopRightUI:u,renderCustomStats:g,UIOptions:f,onExportImage:x,renderWelcomeScreen:y,children:b,app:v,isCollaborating:w,openAIKey:E,isOpenAIKeyPersisted:S,onOpenAIAPIKeyChange:k,onMagicSettingsConfirm:I})=>{let M;let j=k4(),T=yW(),[L,D]=(0,i.KO)(ct,p),A=()=>f.canvasActions.export?(0,s.jsx)(wu,{elements:r,appState:t,files:n,actionManager:e,exportOpts:f.canvasActions.export,canvas:a,setAppState:l}):null,P=()=>f.canvasActions.saveAsImage&&t.openDialog?.name==="imageExport"?(0,s.jsx)(vq,{elements:r,appState:t,files:n,actionManager:e,onExportImage:x,onCloseRequest:()=>l({openDialog:null})}):null,_=()=>(0,s.jsx)(EO,{__fallback:!0,onDock:e=>{aX("sidebar",`toggleDock (${e?"dock":"undock"})`,`(${j.editor.isMobile?"mobile":"desktop"})`)}}),R=(0,i.Dv)(wC,p),N=(0,s.jsxs)(s.Fragment,{children:[b,(0,s.jsx)(St,{UIOptions:f}),(0,s.jsx)(EO.Trigger,{__fallback:!0,icon:lV,title:tB(C("toolBar.library")),onToggle:e=>{e&&aX("sidebar",`${tn.name} (open)`,`button (${j.editor.isMobile?"mobile":"desktop"})`)},tab:tn.defaultTab,children:C("toolBar.library")}),(0,s.jsx)(Sn,{}),t.openDialog?.name==="ttd"&&(0,s.jsx)(E9,{__fallback:!0}),t.isLoading&&(0,s.jsx)(ta,{delay:250}),t.errorMessage&&(0,s.jsx)(vZ,{onClose:()=>l({errorMessage:null}),children:t.errorMessage}),L&&!j.editor.isMobile&&(0,s.jsx)(cn,{colorPickerType:L.colorPickerType,onCancel:()=>{D(null)},onChange:(e,t,n,{altKey:i})=>{if(!("elementBackground"!==e&&"elementStroke"!==e)){if(n.length){for(let l of n)gQ(l,{[i&&L.swapPreviewOnAlt?"elementBackground"===e?"strokeColor":"backgroundColor":"elementBackground"===e?"backgroundColor":"strokeColor"]:t},!1),sK.delete(l);gJ.getScene(n[0])?.informMutation()}else l("elementBackground"===e?{currentItemBackgroundColor:t}:{currentItemStrokeColor:t})}},onSelect:(e,t)=>{D(e=>e?.keepOpenOnAlt&&t.altKey?e:null),L?.onSelect?.(e,t)}}),t.openDialog?.name==="help"&&(0,s.jsx)(wa,{onClose:()=>{l({openDialog:null})}}),t.openDialog?.name==="settings"&&(0,s.jsx)(EU,{openAIKey:E,isPersisted:S,onChange:k,onConfirm:(e,n)=>{let i=t.openDialog?.name==="settings"?t.openDialog?.source:"settings";l({openDialog:null},()=>{I(e,n,i)})},onClose:()=>{l({openDialog:null})}}),(0,s.jsx)(wT,{}),(0,s.jsx)(T.OverwriteConfirmDialogTunnel.Out,{}),P(),A(),t.pasteDialog.shown&&(0,s.jsx)(v9,{setAppState:l,appState:t,onClose:()=>l({pasteDialog:{shown:!1,data:null}})}),j.editor.isMobile&&(0,s.jsx)(v8,{app:v,appState:t,elements:r,actionManager:e,renderJSONExportDialog:A,renderImageExportDialog:P,setAppState:l,onLockToggle:o,onHandToolToggle:c,onPenModeToggle:h,renderTopRightUI:u,renderCustomStats:g,renderSidebars:_,device:j,renderWelcomeScreen:y,UIOptions:f}),!j.editor.isMobile&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"layer-ui__wrapper",style:t.openSidebar&&R&&j.editor.canFitSidebar?{width:`calc(100% - ${eW}px)`}:{},children:[y&&(0,s.jsx)(T.WelcomeScreenCenterTunnel.Out,{}),(M=fw(t,r),(0,s.jsx)(vJ,{side:"top",children:(0,s.jsxs)("div",{className:"App-menu App-menu_top",children:[(0,s.jsxs)(yy.Col,{gap:6,className:(0,d.Z)("App-menu_top__left"),children:[(0,s.jsxs)("div",{style:{position:"relative"},children:[(0,s.jsx)(T.MainMenuTunnel.Out,{}),y&&(0,s.jsx)(T.WelcomeScreenMenuHintTunnel.Out,{})]}),M&&(0,s.jsx)(v3,{heading:"selectedShapeActions",className:(0,d.Z)("selected-shape-actions zen-mode-transition",{"transition-left":t.zenModeEnabled}),children:(0,s.jsx)(yA,{className:eh.SHAPE_ACTIONS_MENU,padding:2,style:{maxHeight:`${t.height-166}px`},children:(0,s.jsx)(yU,{appState:t,elements:r,renderAction:e.renderAction})})})]}),!t.viewModeEnabled&&(0,s.jsx)(v3,{heading:"shapes",className:"shapes-section",children:e=>(0,s.jsxs)("div",{style:{position:"relative"},children:[y&&(0,s.jsx)(T.WelcomeScreenToolbarHintTunnel.Out,{}),(0,s.jsx)(yy.Col,{gap:4,align:"start",children:(0,s.jsxs)(yy.Row,{gap:1,className:(0,d.Z)("App-toolbar-container",{"zen-mode":t.zenModeEnabled}),children:[(0,s.jsxs)(yA,{padding:1,className:(0,d.Z)("App-toolbar",{"zen-mode":t.zenModeEnabled}),children:[(0,s.jsx)(v1,{appState:t,isMobile:j.editor.isMobile,device:j,app:v}),e,(0,s.jsxs)(yy.Row,{gap:1,children:[(0,s.jsx)(v6,{zenModeEnabled:t.zenModeEnabled,checked:t.penMode,onChange:()=>h(null),title:C("toolBar.penMode"),penDetected:t.penDetected}),(0,s.jsx)(v2,{checked:t.activeTool.locked,onChange:o,title:C("toolBar.lock")}),(0,s.jsx)("div",{className:"App-toolbar__divider"}),(0,s.jsx)(v5,{checked:n3(t),onChange:()=>c(),title:C("toolBar.hand"),isMobile:!0}),(0,s.jsx)(yG,{appState:t,activeTool:t.activeTool,UIOptions:f,app:v})]})]}),w&&(0,s.jsx)(yA,{style:{marginLeft:8,alignSelf:"center",height:"fit-content"},children:(0,s.jsx)(Ez,{title:C("toolBar.laser"),checked:t.activeTool.type===tl.laser,onChange:()=>v.setActiveTool({type:tl.laser}),isMobile:!0})})]})})]})}),(0,s.jsxs)("div",{className:(0,d.Z)("layer-ui__wrapper__top-right zen-mode-transition",{"transition-right":t.zenModeEnabled}),children:[t.collaborators.size>0&&(0,s.jsx)(wc,{collaborators:t.collaborators,userToFollow:t.userToFollow?.socketId||null}),u?.(j.editor.isMobile,t),!t.viewModeEnabled&&(!R||t.openSidebar?.name!==tn.name)&&(0,s.jsx)(T.DefaultSidebarTriggerTunnel.Out,{})]})]})})),(0,s.jsx)(wf,{appState:t,actionManager:e,showExitZenModeBtn:m,renderWelcomeScreen:y}),t.showStats&&(0,s.jsx)(v4,{appState:t,setAppState:l,elements:r,onClose:()=>{e.executeAction(x2)},renderCustomStats:g}),t.scrolledOutside&&(0,s.jsx)("button",{className:"scroll-back-to-content",onClick:()=>{l(e=>({...cH(r,e)}))},children:C("buttons.scrollBackToContent")})]}),_()]})]});return(0,s.jsx)(du.Provider,{value:t,children:(0,s.jsx)(i.zt,{scope:T.jotaiScope,children:(0,s.jsx)(y$.Provider,{value:T,children:N})})})},Sl=e=>{let{suggestedBindings:t,startBoundElement:n,cursorButton:i,scrollX:l,scrollY:r,...a}=e;return a},Sr=(e,t)=>{if(e.children!==t.children)return!1;let{canvas:n,appState:i,...l}=e,{canvas:r,appState:a,...s}=t;return ng(Sl(i),Sl(a),{selectedElementIds:ng,selectedGroupIds:ng})&&ng(l,s)},Sa=l.memo(Si,Sr)}),kS=tC(()=>{}),kk=tC(()=>{tM(),dN(),kS(),dR(),Ss=5e3,So=({message:e,onClose:t,closable:n=!1,duration:i=Ss})=>{let r=(0,l.useRef)(0),a=i!==1/0,o=(0,l.useCallback)(()=>{a&&(r.current=window.setTimeout(()=>t(),i))},[t,i,a]);return(0,l.useEffect)(()=>{if(a)return o(),()=>clearTimeout(r.current)},[o,e,i,a]),(0,s.jsxs)("div",{className:"Toast",onMouseEnter:a?()=>clearTimeout(r?.current):void 0,onMouseLeave:a?o:void 0,children:[(0,s.jsx)("p",{className:"Toast__message",children:e}),n&&(0,s.jsx)(lF,{icon:r$,"aria-label":"close",type:"icon",onClick:t,className:"close"})]})}}),kC=tC(()=>{tM(),dO(),dj(),Sd=iY({name:"viewMode",viewMode:!0,trackEvent:{category:"canvas",predicate:e=>!e.viewModeEnabled},perform(e,t){return{appState:{...t,viewModeEnabled:!this.checked(t)},commitToHistory:!1}},checked:e=>e.viewModeEnabled,predicate:(e,t,n)=>typeof n.viewModeEnabled>"u",contextItemLabel:"labels.viewMode",keyTest:e=>!e[aO.CTRL_OR_CMD]&&e.altKey&&e.code===aN.R})}),kI=tC(()=>{tM(),fG(),fB(),dx(),df(),dV(),Sc=class e{scene;onSceneUpdated;constructor({scene:e,onSceneUpdated:t}){this.scene=e,this.onSceneUpdated=t}static loadedFontFaces=new Set;onFontsLoaded=t=>{if(t.every(t=>{let n=`${t.family}-${t.style}-${t.weight}`;return!!e.loadedFontFaces.has(n)||(e.loadedFontFaces.add(n),!1)}))return!1;let n=!1;this.scene.mapElements(e=>nL(e)&&!nU(e)?(sK.delete(e),n=!0,g1(e,{...ld(e)})):e),n&&this.onSceneUpdated()};loadFontsForElements=async e=>{let t=await Promise.all([...new Set(e.filter(e=>nL(e)).map(e=>e.fontFamily))].map(e=>{let t=tG({fontFamily:e,fontSize:16});if(!document.fonts?.check?.(t))return document.fonts?.load?.(t)}));this.onFontsLoaded(t.flat().filter(Boolean))}}}),kM=tC(()=>{tM(),fG(),fO(),fO(),dO(),df(),dT(),dj(),dx(),Sh=(e,t)=>{let n=t.scene.getSelectedElements(e);return 1===n.length&&nP(n[0])},Sm=iY({name:"selectAllElementsInFrame",trackEvent:{category:"canvas"},perform:(e,t,n,i)=>{let l=i.scene.getSelectedElements(t).at(0)||null;if(nP(l)){let n=gM(fk(e),l.id).filter(e=>!("text"===e.type&&e.containerId));return{elements:e,appState:{...t,selectedElementIds:n.reduce((e,t)=>(e[t.id]=!0,e),{})},commitToHistory:!1}}return{elements:e,appState:t,commitToHistory:!1}},contextItemLabel:"labels.selectAllElementsInFrame",predicate:(e,t,n,i)=>Sh(t,i)}),Su=iY({name:"removeAllElementsFromFrame",trackEvent:{category:"history"},perform:(e,t,n,i)=>{let l=i.scene.getSelectedElements(t).at(0)||null;return nP(l)?{elements:gR(e,l,t),appState:{...t,selectedElementIds:{[l.id]:!0}},commitToHistory:!0}:{elements:e,appState:t,commitToHistory:!1}},contextItemLabel:"labels.removeAllElementsFromFrame",predicate:(e,t,n,i)=>Sh(t,i)}),iY({name:"updateFrameRendering",viewMode:!0,trackEvent:{category:"canvas"},perform:(e,t)=>({elements:e,appState:{...t,frameRendering:{...t.frameRendering,enabled:!t.frameRendering.enabled}},commitToHistory:!1}),contextItemLabel:"labels.updateFrameRendering",checked:e=>e.frameRendering.enabled}),iY({name:"setFrameAsActiveTool",trackEvent:{category:"toolbar"},perform:(e,t,n,i)=>{let l=t1(t,{type:"frame"});return i4(i.interactiveCanvas,{...t,activeTool:l}),{elements:e,appState:{...t,activeTool:t1(t,{type:"frame"})},commitToHistory:!1}},keyTest:e=>!e[aO.CTRL_OR_CMD]&&!e.shiftKey&&!e.altKey&&e.key.toLocaleLowerCase()===aO.F})}),kj=tC(()=>{tM(),tR(),uq(),dx(),dI(),dO(),uJ(),fz(),Sp=e=>8/e,Sg=class e{static referenceSnapPoints=null;static visibleGaps=null;static setReferenceSnapPoints=t=>{e.referenceSnapPoints=t};static getReferenceSnapPoints=()=>e.referenceSnapPoints;static setVisibleGaps=t=>{e.visibleGaps=t};static getVisibleGaps=()=>e.visibleGaps;static destroy=()=>{e.referenceSnapPoints=null,e.visibleGaps=null}},Sf=({event:e,appState:t,selectedElements:n})=>e?t.objectsSnapModeEnabled&&!e[aO.CTRL_OR_CMD]||!t.objectsSnapModeEnabled&&e[aO.CTRL_OR_CMD]&&null===t.gridSize:(1!==n.length||"arrow"!==n[0].type)&&t.objectsSnapModeEnabled,Sx=(e,t,n=.01)=>Math.abs(e-t)<=n,Sy=(e,{omitCenter:t,boundingBoxCorners:n,dragOffset:i}={omitCenter:!1,boundingBoxCorners:!1})=>{let l=[];if(1===e.length){let r=e[0],[a,s,o,d,c,h]=mF(r);i&&(a+=i.x,o+=i.x,c+=i.x,s+=i.y,d+=i.y,h+=i.y);let m=(o-a)/2,u=(d-s)/2;if("diamond"!==r.type&&"ellipse"!==r.type||n){let e=un([a,s],[c,h],r.angle),n=un([o,s],[c,h],r.angle),i=un([a,d],[c,h],r.angle),m=un([o,d],[c,h],r.angle);l=t?[e,n,i,m]:[e,n,i,m,[c,h]]}else{let e=un([a,s+u],[c,h],r.angle),n=un([a+m,s],[c,h],r.angle),i=un([o,s+u],[c,h],r.angle),p=un([a+m,d],[c,h],r.angle);l=t?[e,n,i,p]:[e,n,i,p,[c,h]]}}else if(e.length>1){let[n,r,a,s]=m4(e,i??{x:0,y:0}),o=[n,r],d=[a,r],c=[n,s],h=[a,s];l=t?[o,d,c,h]:[o,d,c,h,[n+(a-n)/2,r+(s-r)/2]]}return l.map(e=>[SC(e[0]),SC(e[1])])},Sb=(e,t,n)=>{let i=t.filter(e=>nP(e)).map(e=>e.id);return gW(e,t,n).filter(e=>!(e.frameId&&i.includes(e.frameId)))},Sv=(e,t,n)=>{let i=Sb(e,t,n),l=iV(i).filter(e=>!(1===e.length&&nU(e[0]))).map(e=>m6(e).map(e=>SC(e))),r=l.sort((e,t)=>e[0]-t[0]),a=[],s=0;e:for(let e=0;e<r.length;e++){let t=r[e];for(let n=e+1;n<r.length;n++){if(++s>99999)break e;let e=r[n],[,i,l,o]=t,[d,c,,h]=e;l<d&&uw([i,o],[c,h])&&a.push({startBounds:t,endBounds:e,startSide:[[l,i],[l,o]],endSide:[[d,c],[d,h]],length:d-l,overlap:uE([i,o],[c,h])})}}let o=l.sort((e,t)=>e[1]-t[1]),d=[];s=0;e:for(let e=0;e<o.length;e++){let t=o[e];for(let n=e+1;n<o.length;n++){if(++s>99999)break e;let e=o[n],[i,,l,r]=t,[a,c,h]=e;r<c&&uw([i,l],[a,h])&&d.push({startBounds:t,endBounds:e,startSide:[[i,r],[l,r]],endSide:[[a,c],[h,c]],length:c-r,overlap:uE([i,l],[a,h])})}}return{horizontalGaps:a,verticalGaps:d}},Sw=(e,t,n,i,l,r,a)=>{if(!Sf({appState:n,event:i,selectedElements:e})||0===e.length)return[];let s=Sg.getVisibleGaps();if(s){let{horizontalGaps:n,verticalGaps:i}=s,[o,d,c,h]=m4(e,t).map(e=>SC(e)),m=(o+c)/2,u=(d+h)/2;for(let e of n){if(!uw([d,h],e.overlap))continue;let t=e.startSide[0][0]+e.length/2,n=SC(t-m);if(e.length>c-o&&Math.abs(n)<=a.x){Math.abs(n)<a.x&&(l.length=0),a.x=Math.abs(n);let t={type:"gap",direction:"center_horizontal",gap:e,offset:n};l.push(t);continue}let[,,i]=e.endBounds,r=o-i,s=SC(e.length-r);if(Math.abs(s)<=a.x){Math.abs(s)<a.x&&(l.length=0),a.x=Math.abs(s);let t={type:"gap",direction:"side_right",gap:e,offset:s};l.push(t);continue}let[u]=e.startBounds,p=SC(u-c-e.length);if(Math.abs(p)<=a.x){Math.abs(p)<a.x&&(l.length=0),a.x=Math.abs(p);let t={type:"gap",direction:"side_left",gap:e,offset:p};l.push(t);continue}}for(let e of i){if(!uw([o,c],e.overlap))continue;let t=e.startSide[0][1]+e.length/2,n=SC(t-u);if(e.length>h-d&&Math.abs(n)<=a.y){Math.abs(n)<a.y&&(r.length=0),a.y=Math.abs(n);let t={type:"gap",direction:"center_vertical",gap:e,offset:n};r.push(t);continue}let[,i]=e.startBounds,l=SC(i-h-e.length);if(Math.abs(l)<=a.y){Math.abs(l)<a.y&&(r.length=0),a.y=Math.abs(l);let t={type:"gap",direction:"side_top",gap:e,offset:l};r.push(t);continue}let[,,,s]=e.endBounds,m=SC(d-s),p=e.length-m;if(Math.abs(p)<=a.y){Math.abs(p)<a.y&&(r.length=0),a.y=Math.abs(p);let t={type:"gap",direction:"side_bottom",gap:e,offset:p};r.push(t);continue}}}},SE=(e,t,n)=>{let i=Sb(e,t,n);return iV(i).filter(e=>!(1===e.length&&nU(e[0]))).flatMap(e=>Sy(e))},SS=(e,t,n,i,l,r,a)=>{if(!Sf({appState:n,event:i,selectedElements:e})||0===e.length&&0===t.length)return[];let s=Sg.getReferenceSnapPoints();if(s)for(let e of t)for(let t of s){let n=t[0]-e[0],i=t[1]-e[1];Math.abs(n)<=a.x&&(Math.abs(n)<a.x&&(l.length=0),l.push({type:"point",points:[e,t],offset:n}),a.x=Math.abs(n)),Math.abs(i)<=a.y&&(Math.abs(i)<a.y&&(r.length=0),r.push({type:"point",points:[e,t],offset:i}),a.y=Math.abs(i))}},Sk=(e,t,n,i)=>{if(!Sf({appState:n,event:i,selectedElements:e})||0===e.length)return{snapOffset:{x:0,y:0},snapLines:[]};t.x=SC(t.x),t.y=SC(t.y);let l=[],r=[],a=Sp(n.zoom.value),s={x:a,y:a},o=Sy(e,{dragOffset:t});SS(e,o,n,i,l,r,s),Sw(e,t,n,i,l,r,s);let d={x:l[0]?.offset??0,y:r[0]?.offset??0};s.x=0,s.y=0,l.length=0,r.length=0;let c={x:SC(t.x+d.x),y:SC(t.y+d.y)};return SS(e,Sy(e,{dragOffset:c}),n,i,l,r,s),Sw(e,c,n,i,l,r,s),{snapOffset:d,snapLines:[...SM(l,r),...ST(e,c,[...l,...r].filter(e=>"gap"===e.type))]}},SC=e=>Math.round(1e6*e)/1e6,SI=e=>{let t=new Map;for(let n of e){let e=n.join(",");t.has(e)||t.set(e,n)}return Array.from(t.values())},SM=(e,t)=>{let n={},i={};if(e.length>0){for(let t of e)if("point"===t.type){let e=SC(t.points[0][0]);n[e]||(n[e]=[]),n[e].push(...t.points.map(e=>[SC(e[0]),SC(e[1])]))}}if(t.length>0){for(let e of t)if("point"===e.type){let t=SC(e.points[0][1]);i[t]||(i[t]=[]),i[t].push(...e.points.map(e=>[SC(e[0]),SC(e[1])]))}}return Object.entries(n).map(([e,t])=>({type:"points",points:SI(t.map(t=>[Number(e),t[1]]).sort((e,t)=>e[1]-t[1]))})).concat(Object.entries(i).map(([e,t])=>({type:"points",points:SI(t.map(t=>[t[0],Number(e)]).sort((e,t)=>e[0]-t[0]))})))},Sj=e=>{let t=new Map;for(let n of e){let e=n.points.flat().map(e=>[SC(e)]).join(",");t.has(e)||t.set(e,n)}return Array.from(t.values())},ST=(e,t,n)=>{let[i,l,r,a]=m4(e,t),s=[];for(let e of n){let[t,n,o,d]=e.gap.startBounds,[c,h,m,u]=e.gap.endBounds,p=uE([l,a],e.gap.overlap),g=uE([i,r],e.gap.overlap);switch(e.direction){case"center_horizontal":if(p){let t=(p[0]+p[1])/2;s.push({type:"gap",direction:"horizontal",points:[[e.gap.startSide[0][0],t],[i,t]]},{type:"gap",direction:"horizontal",points:[[r,t],[e.gap.endSide[0][0],t]]})}break;case"center_vertical":if(g){let t=(g[0]+g[1])/2;s.push({type:"gap",direction:"vertical",points:[[t,e.gap.startSide[0][1]],[t,l]]},{type:"gap",direction:"vertical",points:[[t,a],[t,e.gap.endSide[0][1]]]})}break;case"side_right":if(p){let e=(p[0]+p[1])/2;s.push({type:"gap",direction:"horizontal",points:[[o,e],[c,e]]},{type:"gap",direction:"horizontal",points:[[m,e],[i,e]]})}break;case"side_left":if(p){let e=(p[0]+p[1])/2;s.push({type:"gap",direction:"horizontal",points:[[r,e],[t,e]]},{type:"gap",direction:"horizontal",points:[[o,e],[c,e]]})}break;case"side_top":if(g){let e=(g[0]+g[1])/2;s.push({type:"gap",direction:"vertical",points:[[e,a],[e,n]]},{type:"gap",direction:"vertical",points:[[e,d],[e,h]]})}break;case"side_bottom":if(g){let e=(g[0]+g[1])/2;s.push({type:"gap",direction:"vertical",points:[[e,d],[e,h]]},{type:"gap",direction:"vertical",points:[[e,u],[e,l]]})}}}return Sj(s.map(e=>({...e,points:e.points.map(e=>[SC(e[0]),SC(e[1])])})))},SL=(e,t,n,i,l,r)=>{if(!Sf({event:i,selectedElements:e,appState:n})||0===e.length||1===e.length&&!Sx(e[0].angle,0))return{snapOffset:{x:0,y:0},snapLines:[]};let[a,s,o,d]=m6(t);r&&(r.includes("e")?o+=l.x:r.includes("w")&&(a+=l.x),r.includes("n")?s+=l.y:r.includes("s")&&(d+=l.y));let c=[];if(r)switch(r){case"e":c.push([o,s],[o,d]);break;case"w":c.push([a,s],[a,d]);break;case"n":c.push([a,s],[o,s]);break;case"s":c.push([a,d],[o,d]);break;case"ne":c.push([o,s]);break;case"nw":c.push([a,s]);break;case"se":c.push([o,d]);break;case"sw":c.push([a,d])}let h=Sp(n.zoom.value),m={x:h,y:h},u=[],p=[];SS(t,c,n,i,u,p,m);let g={x:u[0]?.offset??0,y:p[0]?.offset??0};m.x=0,m.y=0,u.length=0,p.length=0;let[f,x,y,b]=m6(e).map(e=>SC(e));return SS(e,[[f,x],[f,b],[y,x],[y,b]],n,i,u,p,m),{snapOffset:g,snapLines:SM(u,p)}},SD=(e,t,n,i,l)=>{if(!Sf({event:n,selectedElements:[e],appState:t}))return{snapOffset:{x:0,y:0},snapLines:[]};let r=[[i.x+l.x,i.y+l.y]],a=Sp(t.zoom.value),s={x:a,y:a},o=[],d=[];SS([e],r,t,n,o,d,s);let c={x:o[0]?.offset??0,y:d[0]?.offset??0};s.x=0,s.y=0,o.length=0,d.length=0;let h=Sy([e],{boundingBoxCorners:!0,omitCenter:!0});return SS([e],h,t,n,o,d,s),{snapOffset:c,snapLines:SM(o,d)}},SA=(e,t,n,i)=>{if(!Sf({event:i,selectedElements:[],appState:t}))return{originOffset:{x:0,y:0},snapLines:[]};let l=gW(e,[],t),r=Sp(t.zoom.value),a={x:r,y:r},s=[],o=[];for(let e of l)for(let t of Sy([e])){let e=t[0]-n.x;Math.abs(e)<=Math.abs(a.x)&&(Math.abs(e)<Math.abs(a.x)&&(o.length=0),o.push({type:"pointer",points:[t,[t[0],n.y]],direction:"vertical"}),a.x=e);let i=t[1]-n.y;Math.abs(i)<=Math.abs(a.y)&&(Math.abs(i)<Math.abs(a.y)&&(s.length=0),s.push({type:"pointer",points:[t,[n.x,t[1]]],direction:"horizontal"}),a.y=i)}return{originOffset:{x:o.length>0?o[0].points[0][0]-n.x:0,y:s.length>0?s[0].points[0][1]-n.y:0},snapLines:[...o,...s]}},SP=e=>e===tl.rectangle||e===tl.ellipse||e===tl.diamond||e===tl.frame||e===tl.magicframe||e===tl.image}),kT=tC(()=>{tM(),vu(),S_=()=>(0,s.jsxs)("div",{"data-testid":"brave-measure-text-error",children:[(0,s.jsx)("p",{children:(0,s.jsx)(y5,{i18nKey:"errors.brave_measure_text_error.line1",bold:e=>(0,s.jsx)("span",{style:{fontWeight:600},children:e})})}),(0,s.jsx)("p",{children:(0,s.jsx)(y5,{i18nKey:"errors.brave_measure_text_error.line2",bold:e=>(0,s.jsx)("span",{style:{fontWeight:600},children:e})})}),(0,s.jsx)("p",{children:(0,s.jsx)(y5,{i18nKey:"errors.brave_measure_text_error.line3",link:e=>(0,s.jsx)("a",{href:"http://docs.excalidraw.com/docs/@excalidraw/excalidraw/faq#turning-off-aggresive-block-fingerprinting-in-brave-browser",children:e})})}),(0,s.jsx)("p",{children:(0,s.jsx)(y5,{i18nKey:"errors.brave_measure_text_error.line4",issueLink:e=>(0,s.jsx)("a",{href:"https://github.com/excalidraw/excalidraw/issues/new",children:e}),discordLink:e=>(0,s.jsxs)("a",{href:"https://discord.gg/UexuTaE",children:[e,"."]})})})]})}),kL=tC(()=>{tM(),tR(),fG(),dY(),dD(),ma(),df(),uX(),dL(),SR={width:100,height:0},SN=(e,t)=>{let n=ls({x:0,y:0,textAlign:e2.CENTER,verticalAlign:e0.MIDDLE,...t,containerId:e.id,strokeColor:t.strokeColor||e.strokeColor});return Object.assign(e,{boundElements:(e.boundElements||[]).concat({type:"text",id:n.id})}),hC(n,e),[e,n]},SO=(e,t,n,i)=>{let l,r;if(Object.assign(e,{startBinding:e?.startBinding||null,endBinding:e.endBinding||null}),t){let n=t?.width??100,r=t?.height??100,a;t.id&&((a=i.getElement(t.id))||console.error(`No element for start binding with id ${t.id} found`));let s=t.x||e.x-n,o=t.y||e.y-r/2,d=a?a.type:t.type;if(d){if("text"===d){let n="";a&&"text"===a.type?n=a.text:"text"===t.type&&(n=t.text),n||console.error(`No text found for start binding text element for ${e.id}`),Object.assign(l=ls({x:s,y:o,type:"text",...a,...t,text:n}),{x:t.x||e.x-l.width,y:t.y||e.y-l.height/2})}else switch(d){case"rectangle":case"ellipse":case"diamond":l=lt({x:s,y:o,width:n,height:r,...a,...t,type:d});break;default:nx(e,`Unhandled element start type "${t.type}"`,!0)}oA(e,l,"start")}}if(n){let t=n?.height??100,l=n?.width??100,a;n.id&&((a=i.getElement(n.id))||console.error(`No element for end binding with id ${n.id} found`));let s=n.x||e.x+e.width,o=n.y||e.y-t/2,d=a?a.type:n.type;if(d){if("text"===d){let t="";a&&"text"===a.type?t=a.text:"text"===n.type&&(t=n.text),t||console.error(`No text found for end binding text element for ${e.id}`),Object.assign(r=ls({x:s,y:o,type:"text",...a,...n,text:t}),{y:n.y||e.y-r.height/2})}else switch(d){case"rectangle":case"ellipse":case"diamond":r=lt({x:s,y:o,width:l,height:t,...a,...n,type:d});break;default:nx(e,`Unhandled element end type "${d}"`,!0)}oA(e,r,"end")}}let a=e.points.length-1,s=nv(e.points);return e.points[a][0]>e.points[a-1][0]&&(s[0][0]=.5,s[a][0]-=.5),e.points[a][0]<e.points[a-1][0]&&(s[0][0]=-.5,s[a][0]+=.5),e.points[a][1]>e.points[a-1][1]&&(s[0][1]=.5,s[a][1]-=.5),e.points[a][1]<e.points[a-1][1]&&(s[0][1]=-.5,s[a][1]+=.5),Object.assign(e,{points:s}),{linearElement:e,startBoundElement:l,endBoundElement:r}},Sz=class{excalidrawElements=new Map;add=e=>{e&&this.excalidrawElements.set(e.id,e)};getElements=()=>Array.from(this.excalidrawElements.values());getElement=e=>this.excalidrawElements.get(e)},SH=(e,t)=>{if(!e)return[];let n=nv(e),i=new Sz,l=new Map,r=new Map;for(let e of n){let n,a=e.id;switch(t?.regenerateIds!==!1&&Object.assign(e,{id:i9()}),e.type){case"rectangle":case"ellipse":case"diamond":{let t=e?.label?.text&&void 0===e.width?0:e?.width||100,i=e?.label?.text&&void 0===e.height?0:e?.height||100;n=lt({...e,width:t,height:i});break}case"line":{let t=e.width||SR.width,i=e.height||SR.height;n=lm({width:t,height:i,points:[[0,0],[t,i]],...e});break}case"arrow":{let t=e.width||SR.width,i=e.height||SR.height;Object.assign(n=lm({width:t,height:i,endArrowhead:"arrow",points:[[0,0],[t,i]],...e}),mz(n.points));break}case"text":{let t=e?.fontFamily||eb,i=e?.fontSize||ey,l=e?.lineHeight||h5(t),r=e.text??"",a=hS(r),s=hT(a,tG({fontFamily:t,fontSize:i}),l);n=ls({width:s.width,height:s.height,fontFamily:t,fontSize:i,...e});break}case"image":n=lu({width:e?.width||100,height:e?.height||100,...e});break;case"frame":n=ll({x:0,y:0,...e});break;case"magicframe":n=lr({x:0,y:0,...e});break;case"freedraw":case"iframe":case"embeddable":n=e;break;default:n=e,nx(e,`Unhandled element type "${e.type}"`,!0)}i.getElement(n.id)?console.error(`Duplicate id found for ${n.id}`):(i.add(n),l.set(n.id,e),a&&r.set(a,n.id))}for(let[e,t]of l){let n=i.getElement(e);switch(t.type){case"rectangle":case"ellipse":case"diamond":case"arrow":if(t.label?.text){let[e,l]=SN(n,t?.label);if(i.add(e),i.add(l),"arrow"===e.type){let n="arrow"===t.type?t?.start:void 0,l="arrow"===t.type?t?.end:void 0;if(n&&n.id){let e=r.get(n.id);e&&Object.assign(n,{id:e})}if(l&&l.id){let e=r.get(l.id);e&&Object.assign(l,{id:e})}let{linearElement:a,startBoundElement:s,endBoundElement:o}=SO(e,n,l,i);e=a,i.add(a),i.add(s),i.add(o)}}else if("arrow"===t.type){let{start:e,end:l}=t;if(e&&e.id){let t=r.get(e.id);Object.assign(e,{id:t})}if(l&&l.id){let e=r.get(l.id);Object.assign(l,{id:e})}let{linearElement:a,startBoundElement:s,endBoundElement:o}=SO(n,e,l,i);i.add(a),i.add(s),i.add(o)}}}for(let[e,t]of l){if("frame"!==t.type&&"magicframe"!==t.type)continue;let n=i.getElement(e);if(!n)throw Error(`Excalidraw element with id ${e} doesn't exist`);let l=[];t.children.forEach(e=>{let t=r.get(e);if(!t)throw Error(`Element with ${e} wasn't mapped correctly`);let a=i.getElement(t);if(!a)throw Error(`Frame element with id ${t} doesn't exist`);Object.assign(a,{frameId:n.id}),a?.boundElements?.forEach(e=>{let t=i.getElement(e.id);if(!t)throw Error(`Bound element with id ${e.id} doesn't exist`);Object.assign(t,{frameId:n.id}),l.push(t)}),l.push(a)});let[a,s,o,d]=m6(l);a-=10,s-=10,o+=10,d+=10;let c=Math.max(n?.width,o-a),h=Math.max(n?.height,d-s);Object.assign(n,{x:a,y:s,width:c,height:h})}return i.getElements()}}),kD=tC(()=>{tM(),df(),SB=e=>t=>{(0,tc.unstable_batchedUpdates)(e,t)},SF=e=>tK(t=>{(0,tc.unstable_batchedUpdates)(e,t)}),S$=(()=>{let e;try{let t=l.version.split(".");e=Number(t[0])>17}catch{e=!1}let t=!1;return()=>!0===window.EXCALIDRAW_THROTTLE_RENDER&&(!!e||(t||(t=!0,console.warn("Excalidraw: render throttling is disabled on React versions < 18.")),!1))})()}),kA=tC(()=>{tM(),dU(),df(),tR(),tL(),kD(),SZ=e=>{let t=(0,l.useRef)(!1);return(0,l.useEffect)(()=>{if(!t.current){t.current=!0;return}let n={},i={},l={},r={},a={};e.appState.collaborators.forEach((t,s)=>{if(t.selectedElementIds)for(let e of Object.keys(t.selectedElementIds))e in l||(l[e]=[]),l[e].push(s);t.pointer&&(t.username&&(r[s]=t.username),t.userState&&(a[s]=t.userState),i[s]=t3({sceneX:t.pointer.x,sceneY:t.pointer.y},e.appState),n[s]=t.button)});let s=e.containerRef?.current&&getComputedStyle(e.containerRef.current).getPropertyValue("--color-selection")||"#6965db";sk({canvas:e.canvas,elements:e.elements,visibleElements:e.visibleElements,selectedElements:e.selectedElements,scale:window.devicePixelRatio,appState:e.appState,renderConfig:{remotePointerViewportCoords:i,remotePointerButton:n,remoteSelectedElementIds:l,remotePointerUsernames:r,remotePointerUserStates:a,selectionColor:s,renderScrollbars:!1},callback:e.renderInteractiveSceneCallback},S$())}),(0,s.jsx)("canvas",{className:"excalidraw__canvas interactive",style:{width:e.appState.width,height:e.appState.height,cursor:e.appState.viewModeEnabled?ea.GRAB:ea.AUTO},width:e.appState.width*e.scale,height:e.appState.height*e.scale,ref:e.handleCanvasRef,onContextMenu:e.onContextMenu,onPointerMove:e.onPointerMove,onPointerUp:e.onPointerUp,onPointerCancel:e.onPointerCancel,onTouchMove:e.onTouchMove,onPointerDown:e.onPointerDown,onDoubleClick:e.appState.viewModeEnabled?void 0:e.onDoubleClick,children:C("labels.drawingCanvas")})},SW=e=>({zoom:e.zoom,scrollX:e.scrollX,scrollY:e.scrollY,width:e.width,height:e.height,viewModeEnabled:e.viewModeEnabled,editingGroupId:e.editingGroupId,editingLinearElement:e.editingLinearElement,selectedElementIds:e.selectedElementIds,frameToHighlight:e.frameToHighlight,offsetLeft:e.offsetLeft,offsetTop:e.offsetTop,theme:e.theme,pendingImageElementId:e.pendingImageElementId,selectionElement:e.selectionElement,selectedGroupIds:e.selectedGroupIds,selectedLinearElement:e.selectedLinearElement,multiElement:e.multiElement,isBindingEnabled:e.isBindingEnabled,suggestedBindings:e.suggestedBindings,isRotating:e.isRotating,elementsToHighlight:e.elementsToHighlight,collaborators:e.collaborators,activeEmbeddable:e.activeEmbeddable,snapLines:e.snapLines,zenModeEnabled:e.zenModeEnabled}),SU=(e,t)=>e.selectionNonce===t.selectionNonce&&e.versionNonce===t.versionNonce&&e.scale===t.scale&&e.elements===t.elements&&e.visibleElements===t.visibleElements&&e.selectedElements===t.selectedElements&&ng(SW(e.appState),SW(t.appState)),SG=l.memo(SZ,SU)}),kP=tC(()=>{tM(),dU(),df(),kD(),SV=e=>{let t=(0,l.useRef)(null),n=(0,l.useRef)(!1);return(0,l.useEffect)(()=>{let i=t.current;if(!i)return;let l=e.canvas;n.current||(n.current=!0,i.replaceChildren(l),l.classList.add("excalidraw__canvas","static"));let r=`${e.appState.width}px`,a=`${e.appState.height}px`;l.style.width!==r&&(l.style.width=r),l.style.height!==a&&(l.style.height=a);let s=e.appState.width*e.scale,o=e.appState.height*e.scale;l.width!==s&&(l.width=s),l.height!==o&&(l.height=o),sI({canvas:l,rc:e.rc,scale:e.scale,elements:e.elements,visibleElements:e.visibleElements,appState:e.appState,renderConfig:e.renderConfig},S$())}),(0,s.jsx)("div",{className:"excalidraw__canvas-wrapper",ref:t})},SK=e=>({zoom:e.zoom,scrollX:e.scrollX,scrollY:e.scrollY,width:e.width,height:e.height,viewModeEnabled:e.viewModeEnabled,offsetLeft:e.offsetLeft,offsetTop:e.offsetTop,theme:e.theme,pendingImageElementId:e.pendingImageElementId,shouldCacheIgnoreZoom:e.shouldCacheIgnoreZoom,viewBackgroundColor:e.viewBackgroundColor,exportScale:e.exportScale,selectedElementsAreBeingDragged:e.selectedElementsAreBeingDragged,gridSize:e.gridSize,frameRendering:e.frameRendering,selectedElementIds:e.selectedElementIds,frameToHighlight:e.frameToHighlight,editingGroupId:e.editingGroupId}),SY=(e,t)=>e.versionNonce===t.versionNonce&&e.scale===t.scale&&e.elements===t.elements&&e.visibleElements===t.visibleElements&&ng(SK(e.appState),SK(t.appState))&&ng(e.renderConfig,t.renderConfig),SX=l.memo(SV,SY)}),k_=tC(()=>{tM(),kA(),kP()}),kR=tC(()=>{tM(),fF(),dx(),dU(),df(),Sq=class{scene;constructor(e){this.scene=e}getRenderableElements=(()=>{let e=({elements:e,zoom:t,offsetLeft:n,offsetTop:i,scrollX:l,scrollY:r,height:a,width:s})=>e.filter(e=>g3(e,s,a,{zoom:t,offsetLeft:n,offsetTop:i,scrollX:l,scrollY:r})),t=({editingElement:e,elements:t,pendingImageElementId:n})=>t.filter(t=>(!nI(t)||n!==t.id)&&(!e||"text"!==e.type||t.id!==e.id));return ny(({zoom:n,offsetLeft:i,offsetTop:l,scrollX:r,scrollY:a,height:s,width:o,editingElement:d,pendingImageElementId:c,versionNonce:h})=>{let m=t({elements:this.scene.getNonDeletedElements(),editingElement:d,pendingImageElementId:c}),u=e({elements:m,zoom:n,offsetLeft:i,offsetTop:l,scrollX:r,scrollY:a,height:s,width:o});return{canvasElements:m,visibleElements:u}})})();destroy(){sM(),this.getRenderableElements.clear()}}}),kN=tC(()=>{}),kO=tC(()=>{tM(),kN(),SJ=({trails:e})=>{let t=(0,l.useRef)(null);return(0,l.useEffect)(()=>{if(t.current)for(let n of e)n.start(t.current);return()=>{for(let t of e)t.stop()}},e),(0,s.jsx)("div",{className:"SVGLayer",children:(0,s.jsx)("svg",{ref:t})})}}),kz=tC(()=>{tM(),SQ=class{subscribers=[];on(...e){let t=e.flat().filter(e=>"function"==typeof e);return this.subscribers.push(...t),()=>this.off(t)}once(...e){let t=e.flat().filter(e=>"function"==typeof e);t.push(()=>n());let n=this.on(...t);return n}off(...e){let t=e.flat();this.subscribers=this.subscribers.filter(e=>!t.includes(e))}trigger(...e){for(let t of this.subscribers)t(...e);return this}clear(){this.subscribers=[]}}}),kH=tC(()=>{}),kB=tC(()=>{tM(),df(),fG(),CJ(),kH(),S1=(e,t)=>{let[n,i]=mF(e),{x:l,y:r}=t3({sceneX:n+e.width,sceneY:i},t);return{x:l-t.offsetLeft+10,y:r-t.offsetTop}},S0=({children:e,element:t})=>{let n=k7();if(n.contextMenu||n.draggingElement||n.resizingElement||n.isRotating||n.openMenu||n.viewModeEnabled)return null;let{x:i,y:l}=S1(t,n);return(0,s.jsx)("div",{className:"excalidraw-canvas-buttons",style:{top:`${l}px`,left:`${i}px`,padding:5},children:e})}});async function kF({image:e,apiKey:t,text:n,theme:i="light"}){let l={model:"gpt-4-vision-preview",max_tokens:4096,temperature:.1,messages:[{role:"system",content:k$},{role:"user",content:[{type:"image_url",image_url:{url:e,detail:"high"}},{type:"text",text:`Above is the reference wireframe. Please make a new website based on these and return just the HTML file. Also, please make it for the ${i} theme. What follows are the wireframe's text annotations (if any)...`},{type:"text",text:n}]}]},r=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(l)});return r.ok?{...await r.json(),ok:!0}:{...await r.json(),ok:!1}}var k$,kZ,kW,kU,kG,kV,kK,kY,kX,kq,kJ,kQ,k1,k0,k2,k3,k6,k4,k5,k8,k7,k9,Ce,Ct,Cn,Ci,Cl,Cr,Ca,Cs,Co,Cd,Cc,Ch,Cm,Cu,Cp,Cg,Cf,Cx,Cy,Cb,Cv,Cw,CE,CS,Ck,CC,CI,CM,Cj,CT,CL,CD,CA,CP,C_,CR,CN,CO,Cz,CH,CB,CF,C$,CZ,CW,CU=tC(()=>{tM(),k$=`You are a skilled front-end developer who builds interactive prototypes from wireframes, and is an expert at CSS Grid and Flex design.
Your role is to transform low-fidelity wireframes into working front-end HTML code.

YOU MUST FOLLOW FOLLOWING RULES:

- Use HTML, CSS, JavaScript to build a responsive, accessible, polished prototype
- Leverage Tailwind for styling and layout (import as script <script src="https://cdn.tailwindcss.com"></script>)
- Inline JavaScript when needed
- Fetch dependencies from CDNs when needed (using unpkg or skypack)
- Source images from Unsplash or create applicable placeholders
- Interpret annotations as intended vs literal UI
- Fill gaps using your expertise in UX and business logic
- generate primarily for desktop UI, but make it responsive.
- Use grid and flexbox wherever applicable.
- Convert the wireframe in its entirety, don't omit elements if possible.

If the wireframes, diagrams, or text is unclear or unreadable, refer to provided text for clarification.

Your goal is a production-ready prototype that brings the wireframes to life.

Please output JUST THE HTML file containing your best attempt at implementing the provided wireframes.`}),CG=tC(()=>{tM(),dP(),kZ=e=>(0,s.jsxs)("label",{className:(0,d.Z)("ToolIcon ToolIcon__MagicButton","ToolIcon_size_small",{"is-mobile":e.isMobile}),title:`${e.title}`,children:[(0,s.jsx)("input",{className:"ToolIcon_type_checkbox",type:"checkbox",name:e.name,onChange:e.onChange,checked:e.checked,"aria-label":e.title}),(0,s.jsx)("div",{className:"ToolIcon__icon",children:e.icon})]})}),CV=tC(()=>{}),CK=tC(()=>{tM(),dN(),CV(),kW=({height:e,width:t,userToFollow:n,onDisconnect:i})=>(0,s.jsx)("div",{style:{position:"relative"},children:(0,s.jsx)("div",{className:"follow-mode",style:{width:t,height:e},children:(0,s.jsxs)("div",{className:"follow-mode__badge",children:[(0,s.jsxs)("div",{className:"follow-mode__badge__label",children:["Following"," ",(0,s.jsx)("span",{className:"follow-mode__badge__username",title:n.username,children:n.username})]}),(0,s.jsx)("button",{onClick:i,className:"follow-mode__disconnect-btn",children:r$})]})})})}),CY=tC(()=>{tM(),kU=class{targets=new WeakMap;rafIds=new WeakMap;register(e,t){this.targets.set(e,{callback:t,stopped:!0})}start(e){let t=this.targets.get(e);t&&(this.rafIds.has(e)||(this.targets.set(e,{...t,stopped:!1}),this.scheduleFrame(e)))}stop(e){let t=this.targets.get(e);t&&!t.stopped&&this.targets.set(e,{...t,stopped:!0}),this.cancelFrame(e)}constructFrame(e){return t=>{let n=this.targets.get(e);if(!n)return;let i=this.onFrame(n,t);n.stopped||i?this.cancelFrame(e):this.scheduleFrame(e)}}scheduleFrame(e){let t=requestAnimationFrame(this.constructFrame(e));this.rafIds.set(e,t)}cancelFrame(e){if(this.rafIds.has(e)){let t=this.rafIds.get(e);cancelAnimationFrame(t)}this.rafIds.delete(e)}onFrame(e,t){return e.callback(t)??!1}}}),CX=tC(()=>{tM(),df(),tR(),kG=class{constructor(e,t,n){this.animationFrameHandler=e,this.app=t,this.options=n,this.animationFrameHandler.register(this,this.onFrame.bind(this)),this.trailElement=document.createElementNS(eX,"path")}currentTrail;pastTrails=[];container;trailElement;get hasCurrentTrail(){return!!this.currentTrail}hasLastPoint(e,t){if(this.currentTrail){let n=this.currentTrail.originalPoints.length;return this.currentTrail.originalPoints[n-1][0]===e&&this.currentTrail.originalPoints[n-1][1]===t}return!1}start(e){e&&(this.container=e),this.trailElement.parentNode!==this.container&&this.container&&this.container.appendChild(this.trailElement),this.animationFrameHandler.start(this)}stop(){this.animationFrameHandler.stop(this),this.trailElement.parentNode===this.container&&this.container?.removeChild(this.trailElement)}startPath(e,t){this.currentTrail=new tE.M(this.options),this.currentTrail.addPoint([e,t,performance.now()]),this.update()}addPointToPath(e,t){this.currentTrail&&(this.currentTrail.addPoint([e,t,performance.now()]),this.update())}endPath(){this.currentTrail&&(this.currentTrail.close(),this.currentTrail.options.keepHead=!1,this.pastTrails.push(this.currentTrail),this.currentTrail=void 0,this.update())}update(){this.start()}onFrame(){let e=[];for(let t of this.pastTrails)e.push(this.drawTrail(t,this.app.state));if(this.currentTrail){let t=this.drawTrail(this.currentTrail,this.app.state);e.push(t)}this.pastTrails=this.pastTrails.filter(e=>0!==e.getStrokeOutline().length),0===e.length&&this.stop();let t=e.join(" ").trim();this.trailElement.setAttribute("d",t),this.trailElement.setAttribute("fill",(this.options.fill??(()=>"black"))(this))}drawTrail(e,t){return function(e,t=!0){let n=e.length;if(n<4)return"";let i=e[0],l=e[1],r=e[2],a=`M${i[0].toFixed(2)},${i[1].toFixed(2)} Q${l[0].toFixed(2)},${l[1].toFixed(2)} ${nS(l[0],r[0]).toFixed(2)},${nS(l[1],r[1]).toFixed(2)} T`;for(let t=2,r=n-1;t<r;t++)i=e[t],l=e[t+1],a+=`${nS(i[0],l[0]).toFixed(2)},${nS(i[1],l[1]).toFixed(2)} `;return t&&(a+="Z"),a}(e.getStrokeOutline(e.options.size/t.zoom.value).map(([e,n])=>{let i=t3({sceneX:e,sceneY:n},t);return[i.x,i.y]}),!0)}}}),Cq=tC(()=>{tM(),CX(),df(),dC(),kV=class{constructor(e,t){this.animationFrameHandler=e,this.app=t,this.animationFrameHandler.register(this,this.onFrame.bind(this)),this.localTrail=new kG(e,t,{...this.getTrailOptions(),fill:()=>"red"})}localTrail;collabTrails=new Map;container;getTrailOptions(){return{simplify:0,streamline:.4,sizeMapping:e=>{let t=Math.max(0,1-(performance.now()-e.pressure)/1e3),n=(50-Math.min(50,e.totalLength-e.currentIndex))/50;return Math.min(tY(n),tY(t))}}}startPath(e,t){this.localTrail.startPath(e,t)}addPointToPath(e,t){this.localTrail.addPointToPath(e,t)}endPath(){this.localTrail.endPath()}start(e){this.container=e,this.animationFrameHandler.start(this),this.localTrail.start(e)}stop(){this.animationFrameHandler.stop(this),this.localTrail.stop()}onFrame(){this.updateCollabTrails()}updateCollabTrails(){if(!(!this.container||0===this.app.state.collaborators.size)){for(let[e,t]of this.app.state.collaborators.entries()){let n;this.collabTrails.has(e)?n=this.collabTrails.get(e):((n=new kG(this.animationFrameHandler,this.app,{...this.getTrailOptions(),fill:()=>iA(e)})).start(this.container),this.collabTrails.set(e,n)),t.pointer&&"laser"===t.pointer.tool&&("down"!==t.button||n.hasCurrentTrail||n.startPath(t.pointer.x,t.pointer.y),"down"===t.button&&n.hasCurrentTrail&&!n.hasLastPoint(t.pointer.x,t.pointer.y)&&n.addPointToPath(t.pointer.x,t.pointer.y),"up"===t.button&&n.hasCurrentTrail&&(n.addPointToPath(t.pointer.x,t.pointer.y),n.endPath()))}for(let e of this.collabTrails.keys())this.app.state.collaborators.has(e)||(this.collabTrails.get(e).stop(),this.collabTrails.delete(e))}}}}),CJ=tC(()=>{tM(),bZ(),bW(),bU(),dj(),d$(),dy(),ml(),tR(),by(),gx(),u1(),fG(),dY(),dX(),fB(),dD(),dx(),bG(),dI(),bV(),tL(),dO(),fF(),uJ(),fK(),fH(),mt(),bK(),df(),dA(),bq(),kE(),kk(),kC(),pW(),pG(),uQ(),ma(),dK(),dZ(),dB(),dG(),bF(),kI(),fO(),fz(),bR(),kM(),mn(),tj(),Eg(),d_(),kj(),bB(),kT(),cu(),kL(),Eu(),k_(),kR(),dV(),kO(),dT(),kz(),kB(),CU(),gy(),t_(),CG(),dN(),vy(),CK(),CY(),CX(),Cq(),kD(),uK(),kK=l.createContext(null),kY=l.createContext(null),kX={viewport:{isMobile:!1,isLandscape:!1},editor:{isMobile:!1,canFitSidebar:!1},isTouchScreen:!1},(kq=l.createContext(kX)).displayName="DeviceContext",(kJ=l.createContext({container:null,id:null})).displayName="ExcalidrawContainerContext",(kQ=l.createContext([])).displayName="ExcalidrawElementsContext",(k1=l.createContext({...nq(),width:0,height:0,offsetLeft:0,offsetTop:0})).displayName="ExcalidrawAppStateContext",(k0=l.createContext(()=>{console.warn("Uninitialized ExcalidrawSetAppStateContext context!")})).displayName="ExcalidrawSetAppStateContext",(k2=l.createContext(null)).displayName="ExcalidrawActionManagerContext",k3=()=>(0,l.useContext)(kK),k6=()=>(0,l.useContext)(kY),k4=()=>(0,l.useContext)(kq),k5=()=>(0,l.useContext)(kJ),k8=()=>(0,l.useContext)(kQ),k7=()=>(0,l.useContext)(k1),k9=()=>(0,l.useContext)(k0),Ce=()=>(0,l.useContext)(k2),Ct="u">typeof window&&"ResizeObserver"in window,Cn=!1,Ci=0,Cl=!1,Cr=!1,Ca=!1,Cs={horizontal:null,vertical:null},Co=0,Cd=!1,Cc=new Map,Ch=!1,Cm=0,Cu=!1,Cp=null,Cg={pointers:new Map,lastCenter:null,initialDistance:null,initialScale:null},Cf=class e extends l.Component{canvas;interactiveCanvas=null;rc;unmounted=!1;actionManager;device=kX;excalidrawContainerRef=l.createRef();scene;renderer;fonts;resizeObserver;nearestScrollableContainer;library;libraryItemsFromStorage;id;history;excalidrawContainerValue;files={};imageCache=new Map;iFrameRefs=new Map;embedsValidationStatus=new Map;initializedEmbeds=new Set;elementsPendingErasure=new Set;hitLinkElement;lastPointerDownEvent=null;lastPointerUpEvent=null;lastPointerMoveEvent=null;lastViewportPosition={x:0,y:0};animationFrameHandler=new kU;laserTrails=new kV(this.animationFrameHandler,this);eraserTrail=new kG(this.animationFrameHandler,this,{streamline:.2,size:5,keepHead:!0,sizeMapping:e=>{let t=Math.max(0,1-(performance.now()-e.pressure)/200),n=(10-Math.min(10,e.totalLength-e.currentIndex))/10;return Math.min(tY(n),tY(t))},fill:()=>this.state.theme===ep.LIGHT?"rgba(0, 0, 0, 0.2)":"rgba(255, 255, 255, 0.2)"});onChangeEmitter=new SQ;onPointerDownEmitter=new SQ;onPointerUpEmitter=new SQ;onUserFollowEmitter=new SQ;onScrollChangeEmitter=new SQ;missingPointerEventCleanupEmitter=new SQ;onRemoveEventListenersEmitter=new SQ;constructor(e){super(e);let t=nq(),{excalidrawAPI:n,viewModeEnabled:i=!1,zenModeEnabled:l=!1,gridModeEnabled:r=!1,objectsSnapModeEnabled:a=!1,theme:s=t.theme,name:o=t.name}=e;if(this.state={...t,theme:s,isLoading:!0,...this.getCanvasOffsets(),viewModeEnabled:i,zenModeEnabled:l,objectsSnapModeEnabled:a,gridSize:r?eE:null,name:o,width:window.innerWidth,height:window.innerHeight},this.id=(0,h.x0)(),this.library=new ga(this),this.actionManager=new ya(this.syncActionResult,()=>this.state,()=>this.scene.getElementsIncludingDeleted(),this),this.scene=new gJ,this.canvas=document.createElement("canvas"),this.rc=tm.Z.canvas(this.canvas),this.renderer=new Sq(this.scene),n){let e={updateScene:this.updateScene,updateLibrary:this.library.updateLibrary,addFiles:this.addFiles,resetScene:this.resetScene,getSceneElementsIncludingDeleted:this.getSceneElementsIncludingDeleted,history:{clear:this.resetHistory},scrollToContent:this.scrollToContent,getSceneElements:this.getSceneElements,getAppState:()=>this.state,getFiles:()=>this.files,registerAction:e=>{this.actionManager.registerAction(e)},refresh:this.refresh,setToast:this.setToast,id:this.id,setActiveTool:this.setActiveTool,setCursor:this.setCursor,resetCursor:this.resetCursor,updateFrameRendering:this.updateFrameRendering,toggleSidebar:this.toggleSidebar,onChange:e=>this.onChangeEmitter.on(e),onPointerDown:e=>this.onPointerDownEmitter.on(e),onPointerUp:e=>this.onPointerUpEmitter.on(e),onScrollChange:e=>this.onScrollChangeEmitter.on(e),onUserFollow:e=>this.onUserFollowEmitter.on(e)};"function"==typeof n?n(e):console.error("excalidrawAPI should be a function!")}this.excalidrawContainerValue={container:this.excalidrawContainerRef.current,id:this.id},this.fonts=new Sc({scene:this.scene,onSceneUpdated:this.onSceneUpdated}),this.history=new yh,this.actionManager.registerAll(iK),this.actionManager.registerAction(yi(this.history)),this.actionManager.registerAction(yl(this.history))}onWindowMessage(e){if("https://player.vimeo.com"!==e.origin&&"https://www.youtube.com"!==e.origin)return;let t=null;try{t=JSON.parse(e.data)}catch{}if(t)switch(e.origin){case"https://player.vimeo.com":if("paused"===t.method){let n=null,i=document.body.querySelectorAll("iframe.excalidraw__embeddable");if(!i)break;for(let t of i)t.contentWindow===e.source&&(n=t.contentWindow);n?.postMessage(JSON.stringify({method:t.value?"play":"pause",value:!0}),"*")}break;case"https://www.youtube.com":if("infoDelivery"===t.event&&t.info&&t.id&&"number"==typeof t.info.playerState){let e=t.id,n=t.info.playerState;Object.values(ed).includes(n)&&Cc.set(e,n)}}}cacheEmbeddableRef(e,t){t&&this.iFrameRefs.set(e.id,t)}getHTMLIFrameElement(e){return this.iFrameRefs.get(e.id)}handleEmbeddableCenterClick(e){if(this.state.activeEmbeddable?.element===e&&this.state.activeEmbeddable?.state==="active"||(setTimeout(()=>{this.setState({activeEmbeddable:{element:e,state:"active"},selectedElementIds:{[e.id]:!0},draggingElement:null,selectionElement:null})},100),nj(e)))return;let t=this.getHTMLIFrameElement(e);if(t?.contentWindow){if(t.src.includes("youtube")){let n=Cc.get(e.id);switch(n||(Cc.set(e.id,ed.UNSTARTED),t.contentWindow.postMessage(JSON.stringify({event:"listening",id:e.id}),"*")),n){case ed.PLAYING:case ed.BUFFERING:t.contentWindow?.postMessage(JSON.stringify({event:"command",func:"pauseVideo",args:""}),"*");break;default:t.contentWindow?.postMessage(JSON.stringify({event:"command",func:"playVideo",args:""}),"*")}}t.src.includes("player.vimeo.com")&&t.contentWindow.postMessage(JSON.stringify({method:"paused"}),"*")}}isIframeLikeElementCenter(e,t,n,i){return e&&!t.altKey&&!t.shiftKey&&!t.metaKey&&!t.ctrlKey&&(this.state.activeEmbeddable?.element!==e||this.state.activeEmbeddable?.state==="hover"||!this.state.activeEmbeddable)&&n>=e.x+e.width/3&&n<=e.x+2*e.width/3&&i>=e.y+e.height/3&&i<=e.y+2*e.height/3}updateEmbedValidationStatus=(e,t)=>{this.embedsValidationStatus.set(e.id,t),sK.delete(e)};updateEmbeddables=()=>{let e=new Set,t=!1;this.scene.getNonDeletedElements().filter(n=>{if(nM(n)){if(e.add(n.id),!this.embedsValidationStatus.has(n.id)){t=!0;let e=lO(n.link,this.props.validateEmbeddable);this.updateEmbedValidationStatus(n,e)}}else nj(n)&&e.add(n.id);return!1}),t&&this.scene.informMutation(),this.iFrameRefs.forEach((t,n)=>{e.has(n)||this.iFrameRefs.delete(n)})};renderEmbeddables(){let e=this.state.zoom.value,t=this.state.width,n=this.state.height,i=this.scene.getNonDeletedElements().filter(e=>nM(e)&&!0===this.embedsValidationStatus.get(e.id)||nj(e));return(0,s.jsx)(s.Fragment,{children:i.map(i=>{let l,{x:r,y:a}=t3({sceneX:i.x,sceneY:i.y},this.state),o=g3(i,t,n,this.state),c=this.initializedEmbeds.has(i.id);if(o&&!c&&this.initializedEmbeds.add(i.id),!(o||c))return null;if(nj(i)){l=null;let e=(i.customData?.generationData??this.magicGenerations.get(i.id))||{status:"error",message:"No generation data",code:"ERR_NO_GENERATION_DATA"};if("done"===e.status){let t=e.html;l={intrinsicSize:{w:i.width,h:i.height},type:"document",srcdoc:()=>t}}else if("pending"===e.status)l={intrinsicSize:{w:i.width,h:i.height},type:"document",srcdoc:()=>lD(`
                    <style>
                      html, body {
                        width: 100%;
                        height: 100%;
                        color: ${"dark"===this.state.theme?"white":"black"};
                      }
                      body {
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        flex-direction: column;
                        gap: 1rem;
                      }

                      .Spinner {
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        margin-left: auto;
                        margin-right: auto;
                      }

                      .Spinner svg {
                        animation: rotate 1.6s linear infinite;
                        transform-origin: center center;
                        width: 40px;
                        height: 40px;
                      }

                      .Spinner circle {
                        stroke: currentColor;
                        animation: dash 1.6s linear 0s infinite;
                        stroke-linecap: round;
                      }

                      @keyframes rotate {
                        100% {
                          transform: rotate(360deg);
                        }
                      }

                      @keyframes dash {
                        0% {
                          stroke-dasharray: 1, 300;
                          stroke-dashoffset: 0;
                        }
                        50% {
                          stroke-dasharray: 150, 300;
                          stroke-dashoffset: -200;
                        }
                        100% {
                          stroke-dasharray: 1, 300;
                          stroke-dashoffset: -280;
                        }
                      }
                    </style>
                    <div class="Spinner">
                      <svg
                        viewBox="0 0 100 100"
                      >
                        <circle
                          cx="50"
                          cy="50"
                          r="46"
                          stroke-width="8"
                          fill="none"
                          stroke-miter-limit="10"
                        />
                      </svg>
                    </div>
                    <div>Generating...</div>
                  `)};else{let t;t="ERR_GENERATION_INTERRUPTED"===e.code?"Generation was interrupted...":e.message||"Generation failed",l={intrinsicSize:{w:i.width,h:i.height},type:"document",srcdoc:()=>lD(`
                    <style>
                    html, body {
                      height: 100%;
                    }
                      body {
                        display: flex;
                        flex-direction: column;
                        align-items: center;
                        justify-content: center;
                        color: ${z.red[3]};
                      }
                      h1, h3 {
                        margin-top: 0;
                        margin-bottom: 0.5rem;
                      }
                    </style>
                    <h1>Error!</h1>
                    <h3>${t}</h3>
                  `)}}}else l=lA(aK(i.link||""));let h=this.state.activeEmbeddable?.element===i&&this.state.activeEmbeddable?.state==="active",m=this.state.activeEmbeddable?.element===i&&this.state.activeEmbeddable?.state==="hover";return(0,s.jsx)("div",{className:(0,d.Z)("excalidraw__embeddable-container",{"is-hovered":m}),style:{transform:o?`translate(${r-this.state.offsetLeft}px, ${a-this.state.offsetTop}px) scale(${e})`:"none",display:o?"block":"none",opacity:mp(i,gA(i),this.elementsPendingErasure),"--embeddable-radius":`${um(Math.min(i.width,i.height),i)}px`},children:(0,s.jsxs)("div",{className:"excalidraw__embeddable-container__inner",style:{width:o?`${i.width}px`:0,height:o?`${i.height}px`:0,transform:o?`rotate(${i.angle}rad)`:"none",pointerEvents:h?eo.enabled:eo.disabled},children:[m&&(0,s.jsx)("div",{className:"excalidraw__embeddable-hint",children:C("buttons.embeddableInteractionButton")}),(0,s.jsx)("div",{className:"excalidraw__embeddable__outer",style:{padding:`${i.strokeWidth}px`},children:(nM(i)?this.props.renderEmbeddable?.(i,this.state):null)??(0,s.jsx)("iframe",{ref:e=>this.cacheEmbeddableRef(i,e),className:"excalidraw__embeddable",srcDoc:l?.type==="document"?l.srcdoc(this.state.theme):void 0,src:l?.type!=="document"?l?.link??"":void 0,scrolling:"no",referrerPolicy:"no-referrer-when-downgrade",title:"Excalidraw Embedded Content",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,sandbox:"allow-same-origin allow-scripts allow-forms allow-popups allow-popups-to-escape-sandbox allow-presentation allow-downloads"})})]})},i.id)})})}getFrameNameDOMId=e=>`${this.id}-frame-name-${e.id}`;frameNameBoundsCache={get:e=>{let t=this.frameNameBoundsCache._cache.get(e.id);if(!t||t.zoom!==this.state.zoom.value||t.versionNonce!==e.versionNonce){let n=document.getElementById(this.getFrameNameDOMId(e));if(n){let i=n.getBoundingClientRect(),l=t2({clientX:i.x,clientY:i.y},this.state),r=t2({clientX:i.right,clientY:i.bottom},this.state);return t={x:l.x,y:l.y,width:r.x-l.x,height:r.y-l.y,angle:0,zoom:this.state.zoom.value,versionNonce:e.versionNonce},this.frameNameBoundsCache._cache.set(e.id,t),t}return null}return t},_cache:new Map};renderFrameNames=()=>{if(!this.state.frameRendering.enabled||!this.state.frameRendering.name)return null;let e="dark"===this.state.theme,t=0,n=0;return this.scene.getNonDeletedFramesLikes().map(i=>{if(nD(i)?t++:n++,!g3(i,this.canvas.width/window.devicePixelRatio,this.canvas.height/window.devicePixelRatio,{offsetLeft:this.state.offsetLeft,offsetTop:this.state.offsetTop,scrollX:this.state.scrollX,scrollY:this.state.scrollY,zoom:this.state.zoom}))return null;let{x:l,y:r}=t3({sceneX:i.x,sceneY:i.y},this.state),a=()=>{i.name?.trim()===""&&gQ(i,{name:null}),this.setState({editingFrame:null})},o,d=gF(i,nD(i)?t:n);return o=i.id===this.state.editingFrame?(0,s.jsx)("input",{autoFocus:!0,value:d,onChange:e=>{gQ(i,{name:e.target.value})},onBlur:()=>a(),onKeyDown:e=>{(e.key===aO.ESCAPE||e.key===aO.ENTER)&&a()},style:{background:this.state.viewBackgroundColor,filter:e?eN:"none",zIndex:2,border:"none",display:"block",padding:"6px",borderRadius:4,boxShadow:"inset 0 0 0 1px var(--color-primary)",fontFamily:"Assistant",fontSize:"14px",transform:"translate(-6px, 6px)",color:"var(--color-gray-80)",overflow:"hidden",maxWidth:`${document.body.clientWidth-l-6}px`},size:d.length+1||1,dir:"auto",autoComplete:"off",autoCapitalize:"off",autoCorrect:"off"}):d,(0,s.jsx)("div",{id:this.getFrameNameDOMId(i),style:{position:"absolute",bottom:`${this.state.height+eg.nameOffsetY-r+this.state.offsetTop}px`,left:`${l-this.state.offsetLeft}px`,zIndex:2,fontSize:eg.nameFontSize,color:e?eg.nameColorDarkTheme:eg.nameColorLightTheme,lineHeight:eg.nameLineHeight,width:"max-content",maxWidth:`${i.width}px`,overflow:i.id===this.state.editingFrame?"visible":"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",cursor:ea.MOVE,pointerEvents:this.state.viewModeEnabled?eo.disabled:eo.enabled},onPointerDown:e=>this.handleCanvasPointerDown(e),onWheel:e=>this.handleWheel(e),onContextMenu:this.handleCanvasContextMenu,onDoubleClick:()=>{this.setState({editingFrame:i.id})},children:o},i.id)})};render(){let e=this.scene.getSelectedElements(this.state),{renderTopRightUI:t,renderCustomStats:n}=this.props,i=this.scene.getVersionNonce(),{canvasElements:l,visibleElements:r}=this.renderer.getRenderableElements({versionNonce:i,zoom:this.state.zoom,offsetLeft:this.state.offsetLeft,offsetTop:this.state.offsetTop,scrollX:this.state.scrollX,scrollY:this.state.scrollY,height:this.state.height,width:this.state.width,editingElement:this.state.editingElement,pendingImageElementId:this.state.pendingImageElementId}),a=!(this.state.editingElement&&nN(this.state.editingElement))&&(this.state.selectionElement||this.state.draggingElement||this.state.resizingElement||"laser"===this.state.activeTool.type&&"down"===this.state.cursorButton||this.state.editingElement&&!nL(this.state.editingElement)),o=e[0];return(0,s.jsx)("div",{className:(0,d.Z)("excalidraw excalidraw-container",{"excalidraw--view-mode":this.state.viewModeEnabled,"excalidraw--mobile":this.device.editor.isMobile}),style:{"--ui-pointerEvents":a?eo.disabled:eo.enabled},ref:this.excalidrawContainerRef,onDrop:this.handleAppOnDrop,tabIndex:0,onKeyDown:this.props.handleKeyboardGlobally?void 0:this.onKeyDown,children:(0,s.jsx)(kK.Provider,{value:this,children:(0,s.jsx)(kY.Provider,{value:this.props,children:(0,s.jsx)(kJ.Provider,{value:this.excalidrawContainerValue,children:(0,s.jsx)(kq.Provider,{value:this.device,children:(0,s.jsx)(k0.Provider,{value:this.setAppState,children:(0,s.jsx)(k1.Provider,{value:this.state,children:(0,s.jsxs)(kQ.Provider,{value:this.scene.getNonDeletedElements(),children:[(0,s.jsxs)(k2.Provider,{value:this.actionManager,children:[(0,s.jsx)(Sa,{canvas:this.canvas,appState:this.state,files:this.files,setAppState:this.setAppState,actionManager:this.actionManager,elements:this.scene.getNonDeletedElements(),onLockToggle:this.toggleLock,onPenModeToggle:this.togglePenMode,onHandToolToggle:this.onHandToolToggle,langCode:S().code,renderTopRightUI:t,renderCustomStats:n,showExitZenModeBtn:typeof this.props?.zenModeEnabled>"u"&&this.state.zenModeEnabled,UIOptions:this.props.UIOptions,onExportImage:this.onExportImage,renderWelcomeScreen:!this.state.isLoading&&this.state.showWelcomeScreen&&"selection"===this.state.activeTool.type&&!this.state.zenModeEnabled&&!this.scene.getElementsIncludingDeleted().length,app:this,isCollaborating:this.props.isCollaborating,openAIKey:this.OPENAI_KEY,isOpenAIKeyPersisted:this.OPENAI_KEY_IS_PERSISTED,onOpenAIAPIKeyChange:this.onOpenAIKeyChange,onMagicSettingsConfirm:this.onMagicSettingsConfirm,children:this.props.children}),(0,s.jsx)("div",{className:"excalidraw-textEditorContainer"}),(0,s.jsx)("div",{className:"excalidraw-contextMenuContainer"}),(0,s.jsx)("div",{className:"excalidraw-eye-dropper-container"}),(0,s.jsx)(SJ,{trails:[this.laserTrails,this.eraserTrail]}),1===e.length&&this.state.showHyperlinkPopup&&(0,s.jsx)(a1,{element:o,setAppState:this.setAppState,onLinkOpen:this.props.onLinkOpen,setToast:this.setToast,updateEmbedValidationStatus:this.updateEmbedValidationStatus},o.id),!1!==this.props.aiEnabled&&1===e.length&&nA(o)&&(0,s.jsx)(S0,{element:o,children:(0,s.jsx)(kZ,{title:C("labels.convertToCode"),icon:aT,checked:!1,onChange:()=>this.onMagicFrameGenerate(o,"button")})}),1===e.length&&nj(o)&&o.customData?.generationData?.status==="done"&&(0,s.jsxs)(S0,{element:o,children:[(0,s.jsx)(kZ,{title:C("labels.copySource"),icon:av,checked:!1,onChange:()=>this.onIframeSrcCopy(o)}),(0,s.jsx)(kZ,{title:"Enter fullscreen",icon:aD,checked:!1,onChange:()=>{let e=this.getHTMLIFrameElement(o);if(e)try{e.requestFullscreen(),this.setState({activeEmbeddable:{element:o,state:"active"},selectedElementIds:{[o.id]:!0},draggingElement:null,selectionElement:null})}catch(e){console.warn(e),this.setState({errorMessage:"Couldn't enter fullscreen"})}}})]}),null!==this.state.toast&&(0,s.jsx)(So,{message:this.state.toast.message,onClose:()=>this.setToast(null),duration:this.state.toast.duration,closable:this.state.toast.closable}),this.state.contextMenu&&(0,s.jsx)(yx,{items:this.state.contextMenu.items,top:this.state.contextMenu.top,left:this.state.contextMenu.left,actionManager:this.actionManager,onClose:e=>{this.setState({contextMenu:null},()=>{this.focusContainer(),e?.()})}}),(0,s.jsx)(SX,{canvas:this.canvas,rc:this.rc,elements:l,visibleElements:r,versionNonce:i,selectionNonce:this.state.selectionElement?.versionNonce,scale:window.devicePixelRatio,appState:this.state,renderConfig:{imageCache:this.imageCache,isExporting:!1,renderGrid:!0,canvasBackgroundColor:this.state.viewBackgroundColor,embedsValidationStatus:this.embedsValidationStatus,elementsPendingErasure:this.elementsPendingErasure}}),(0,s.jsx)(SG,{containerRef:this.excalidrawContainerRef,canvas:this.interactiveCanvas,elements:l,visibleElements:r,selectedElements:e,versionNonce:i,selectionNonce:this.state.selectionElement?.versionNonce,scale:window.devicePixelRatio,appState:this.state,renderInteractiveSceneCallback:this.renderInteractiveSceneCallback,handleCanvasRef:this.handleInteractiveCanvasRef,onContextMenu:this.handleCanvasContextMenu,onPointerMove:this.handleCanvasPointerMove,onPointerUp:this.handleCanvasPointerUp,onPointerCancel:this.removePointer,onTouchMove:this.handleTouchMove,onPointerDown:this.handleCanvasPointerDown,onDoubleClick:this.handleCanvasDoubleClick}),this.state.userToFollow&&(0,s.jsx)(kW,{width:this.state.width,height:this.state.height,userToFollow:this.state.userToFollow,onDisconnect:this.maybeUnfollowRemoteUser}),this.renderFrameNames()]}),this.renderEmbeddables()]})})})})})})})})}focusContainer=()=>{this.excalidrawContainerRef.current?.focus()};getSceneElementsIncludingDeleted=()=>this.scene.getElementsIncludingDeleted();getSceneElements=()=>this.scene.getNonDeletedElements();onInsertElements=e=>{this.addElementsFromPasteOrLibrary({elements:e,position:"center",files:null})};onExportImage=async(e,t,n)=>{aX("export",e,"ui");let i=await xg(e,t,this.state,this.files,{exportBackground:this.state.exportBackground,name:this.state.name,viewBackgroundColor:this.state.viewBackgroundColor,exportingFrame:n.exportingFrame}).catch(t7).catch(e=>{console.error(e),this.setState({errorMessage:e.message})});this.state.exportEmbedScene&&i&&pn(i)&&this.setState({fileHandle:i})};magicGenerations=new Map;updateMagicGeneration=({frameElement:e,data:t})=>{"pending"===t.status?gQ(e,{customData:{generationData:void 0}},!1):gQ(e,{customData:{generationData:t}},!1),this.magicGenerations.set(e.id,t),this.onSceneUpdated()};getTextFromElements(e){return e.reduce((e,t)=>(nL(t)&&e.push(t.text),e),[]).join(`

`)}async onMagicFrameGenerate(e,t){if(!this.OPENAI_KEY){this.setState({openDialog:{name:"settings",tab:"diagram-to-code",source:"generation"}}),aX("ai","generate (missing key)","d2c");return}let n=p8({elements:this.scene.getNonDeletedElements(),bounds:e,type:"overlap"}).filter(e=>!nA(e));if(!n.length){"button"===t?(this.setState({errorMessage:"Cannot generate from an empty frame"}),aX("ai","generate (no-children)","d2c")):this.setActiveTool({type:"magicframe"});return}let i=this.insertIframeElement({sceneX:e.x+e.width+30,sceneY:e.y,width:e.width,height:e.height});if(!i)return;this.updateMagicGeneration({frameElement:i,data:{status:"pending"}}),this.setState({selectedElementIds:{[i.id]:!0}});let l=await gh({elements:this.scene.getNonDeletedElements(),appState:{...this.state,exportBackground:!0,viewBackgroundColor:this.state.viewBackgroundColor},exportingFrame:e,files:this.files}),r=await pc(l),a=this.getTextFromElements(n);aX("ai","generate (start)","d2c");let s=await kF({image:r,apiKey:this.OPENAI_KEY,text:a,theme:this.state.theme});if(!s.ok){aX("ai","generate (failed)","d2c"),console.error(s.error),this.updateMagicGeneration({frameElement:i,data:{status:"error",code:"ERR_OAI",message:s.error?.message||"Unknown error during generation"}});return}if(aX("ai","generate (success)","d2c"),null==s.choices[0].message.content){this.updateMagicGeneration({frameElement:i,data:{status:"error",code:"ERR_OAI",message:"Nothing genereated :("}});return}let o=s.choices[0].message.content,d=o.slice(o.indexOf("<!DOCTYPE html>"),o.indexOf("</html>")+7);this.updateMagicGeneration({frameElement:i,data:{status:"done",html:d}})}onIframeSrcCopy(e){e.customData?.generationData?.status==="done"&&(hg(e.customData.generationData.html),this.setToast({message:"copied to clipboard",closable:!1,duration:1500}))}OPENAI_KEY=y9.get(tr.OAI_API_KEY);OPENAI_KEY_IS_PERSISTED=y9.has(tr.OAI_API_KEY)||!1;onOpenAIKeyChange=(e,t)=>{if(this.OPENAI_KEY=e||null,t){let t=y9.set(tr.OAI_API_KEY,e);this.OPENAI_KEY_IS_PERSISTED=t}else this.OPENAI_KEY_IS_PERSISTED=!1};onMagicSettingsConfirm=(e,t,n)=>{if(this.OPENAI_KEY=e||null,this.onOpenAIKeyChange(this.OPENAI_KEY,t),"settings"===n)return;let i=this.scene.getSelectedElements({selectedElementIds:this.state.selectedElementIds});e?i.length?this.onMagicframeToolSelect():this.setActiveTool({type:"magicframe"}):nA(i[0])||this.setActiveTool({type:"magicframe"})};onMagicframeToolSelect=()=>{if(!this.OPENAI_KEY){this.setState({openDialog:{name:"settings",tab:"diagram-to-code",source:"tool"}}),aX("ai","tool-select (missing key)","d2c");return}let e=this.scene.getSelectedElements({selectedElementIds:this.state.selectedElementIds});if(0===e.length)this.setActiveTool({type:tl.magicframe}),aX("ai","tool-select (empty-selection)","d2c");else{let t,n=1===e.length&&nA(e[0])&&e[0];if(!n&&e.some(e=>nP(e)||e.frameId)){this.setActiveTool({type:tl.magicframe});return}if(aX("ai","tool-select (existing selection)","d2c"),n)t=n;else{let[n,i,l,r]=m6(e);for(let a of(t=lr({...eg,x:n-50,y:i-50,width:l-n+100,height:r-i+100,opacity:100,locked:!1}),this.scene.addNewElement(t),e))gQ(a,{frameId:t.id});this.setState({selectedElementIds:{[t.id]:!0}})}this.onMagicFrameGenerate(t,"upstream")}};openEyeDropper=({type:e})=>{g.set(ct,{swapPreviewOnAlt:!0,colorPickerType:"stroke"===e?"elementStroke":"elementBackground",onSelect:(t,n)=>{let i="background"===e&&n.altKey||"stroke"===e&&!n.altKey;this.scene.getSelectedElements(this.state).length&&"selection"===this.state.activeTool.type?this.updateScene({elements:this.scene.getElementsIncludingDeleted().map(e=>this.state.selectedElementIds[e.id]?g1(e,{[i?"strokeColor":"backgroundColor"]:t}):e)}):i?this.syncActionResult({appState:{...this.state,currentItemStrokeColor:t},commitToHistory:!0}):this.syncActionResult({appState:{...this.state,currentItemBackgroundColor:t},commitToHistory:!0})},keepOpenOnAlt:!1})};syncActionResult=SB(e=>{if(this.unmounted||!1===e)return;let t=null;if(e.elements&&(e.elements.forEach(e=>{this.state.editingElement?.id===e.id&&this.state.editingElement!==e&&fC(e)&&(t=e)}),this.scene.replaceAllElements(e.elements),e.commitToHistory&&this.history.resumeRecording()),e.files&&(this.files=e.replaceFiles?e.files:{...this.files,...e.files},this.addNewImagesToImageCache()),e.appState||t||this.state.contextMenu){e.commitToHistory&&this.history.resumeRecording();let n=e?.appState?.viewModeEnabled||!1,i=e?.appState?.zenModeEnabled||!1,l=e?.appState?.gridSize||null,r=e?.appState?.theme||this.props.theme||ep.LIGHT,a=e?.appState?.name??this.state.name,s=e?.appState?.errorMessage??this.state.errorMessage;"u">typeof this.props.viewModeEnabled&&(n=this.props.viewModeEnabled),"u">typeof this.props.zenModeEnabled&&(i=this.props.zenModeEnabled),"u">typeof this.props.gridModeEnabled&&(l=this.props.gridModeEnabled?eE:null),"u">typeof this.props.name&&(a=this.props.name),t=t||e.appState?.editingElement||null,t?.isDeleted&&(t=null),this.setState(o=>Object.assign(e.appState||{},{contextMenu:null,editingElement:t,viewModeEnabled:n,zenModeEnabled:i,gridSize:l,theme:r,name:a,errorMessage:s}),()=>{e.syncHistory&&this.history.setCurrentState(this.state,this.scene.getElementsIncludingDeleted())})}});onBlur=SB(()=>{Cl=!1,this.setState({isBindingEnabled:!0})});onUnload=()=>{this.onBlur()};disableEvent=e=>{e.preventDefault()};resetHistory=()=>{this.history.clear()};resetScene=SB(e=>{this.scene.replaceAllElements([]),this.setState(t=>({...nq(),isLoading:!e?.resetLoadingState&&t.isLoading,theme:this.state.theme})),this.resetHistory()});initializeScene=async()=>{"launchQueue"in window&&"LaunchParams"in window&&window.launchQueue.setConsumer(async e=>{if(!e.files.length)return;let t=e.files[0],n=await t.getFile();this.loadFileToCanvas(new File([n],n.name||"",{type:n.type}),t)}),this.props.theme&&this.setState({theme:this.props.theme}),this.state.isLoading||this.setState({isLoading:!0});let e=null;try{e=await this.props.initialData||null,e?.libraryItems&&this.library.updateLibrary({libraryItems:e.libraryItems,merge:!0}).catch(e=>{console.error(e)})}catch(t){console.error(t),e={appState:{errorMessage:t.message||"Encountered an error during importing or restoring scene data"}}}let t=uz(e,null,null,{repairBindings:!0});t.appState={...t.appState,theme:this.props.theme||t.appState.theme,openSidebar:t.appState?.openSidebar||this.state.openSidebar,activeTool:"image"===t.appState.activeTool.type?{...t.appState.activeTool,type:"selection"}:t.appState.activeTool,isLoading:!1,toast:this.state.toast},e?.scrollToContent&&(t.appState={...t.appState,...cH(t.elements,{...t.appState,width:this.state.width,height:this.state.height,offsetTop:this.state.offsetTop,offsetLeft:this.state.offsetLeft})}),this.fonts.loadFontsForElements(t.elements),this.resetHistory(),this.syncActionResult({...t,commitToHistory:!0})};isMobileBreakpoint=(e,t)=>e<eB||t<e$&&e<eF;refreshViewportBreakpoints=()=>{if(!this.excalidrawContainerRef.current)return;let{clientWidth:e,clientHeight:t}=document.body,n=this.device.viewport,i=nc(n,{isLandscape:e>t,isMobile:this.isMobileBreakpoint(e,t)});return n!==i&&(this.device={...this.device,viewport:i},!0)};refreshEditorBreakpoints=()=>{let e=this.excalidrawContainerRef.current;if(!e)return;let{width:t,height:n}=e.getBoundingClientRect(),i=null!=this.props.UIOptions.dockedSidebarBreakpoint?this.props.UIOptions.dockedSidebarBreakpoint:eZ,l=this.device.editor,r=nc(l,{isMobile:this.isMobileBreakpoint(t,n),canFitSidebar:t>i});return l!==r&&(this.device={...this.device,editor:r},!0)};async componentDidMount(){this.unmounted=!1,this.excalidrawContainerValue.container=this.excalidrawContainerRef.current,(u.MODE===ec.TEST||u.DEV)&&(this.setState.bind(this),Object.defineProperties(window.h,{state:{configurable:!0,get:()=>this.state},setState:{configurable:!0,value:(...e)=>this.setState(...e)},app:{configurable:!0,value:this},history:{configurable:!0,value:this.history}})),this.scene.addCallback(this.onSceneUpdated),this.addEventListeners(),this.props.autoFocus&&this.excalidrawContainerRef.current&&this.focusContainer(),no()||(this.refreshViewportBreakpoints(),this.refreshEditorBreakpoints()),Ct&&this.excalidrawContainerRef.current&&(this.resizeObserver=new ResizeObserver(()=>{this.refreshEditorBreakpoints(),this.updateDOMRect()}),this.resizeObserver?.observe(this.excalidrawContainerRef.current)),new URLSearchParams(window.location.search.slice(1)).has("web-share-target")?this.restoreFileFromShare():this.updateDOMRect(this.initializeScene),J()&&!h6()&&this.setState({errorMessage:(0,s.jsx)(S_,{})})}componentWillUnmount(){this.renderer.destroy(),this.scene=new gJ,this.renderer=new Sq(this.scene),this.files={},this.imageCache.clear(),this.resizeObserver?.disconnect(),this.unmounted=!0,this.removeEventListeners(),this.scene.destroy(),this.library.destroy(),this.laserTrails.stop(),this.eraserTrail.stop(),this.onChangeEmitter.clear(),sK.destroy(),Sg.destroy(),clearTimeout(Co),gU.clearCache(),iR.clearCache(),Co=0}onResize=SB(()=>{this.scene.getElementsIncludingDeleted().forEach(e=>sK.delete(e)),this.refreshViewportBreakpoints(),this.updateDOMRect(),Ct||this.refreshEditorBreakpoints(),this.setState({})});onFullscreenChange=()=>{document.fullscreenElement||this.state.activeEmbeddable?.state!=="active"||this.setState({activeEmbeddable:null})};removeEventListeners(){this.onRemoveEventListenersEmitter.trigger()}addEventListeners(){this.removeEventListeners(),this.props.handleKeyboardGlobally&&this.onRemoveEventListenersEmitter.once(tz(document,"keydown",this.onKeyDown,!1)),this.onRemoveEventListenersEmitter.once(tz(this.excalidrawContainerRef.current,"wheel",this.onWheel,{passive:!1}),tz(window,"message",this.onWindowMessage,!1),tz(document,"pointerup",this.removePointer),tz(document,"copy",this.onCopy),tz(document,"keyup",this.onKeyUp,{passive:!0}),tz(document,"mousemove",this.updateCurrentCursorPosition),tz(document.fonts,"loadingdone",e=>{let t=e.fontfaces;this.fonts.onFontsLoaded(t)}),tz(document,"gesturestart",this.onGestureStart,!1),tz(document,"gesturechange",this.onGestureChange,!1),tz(document,"gestureend",this.onGestureEnd,!1),tz(window,"focus",()=>{this.maybeCleanupAfterMissingPointerUp(null)})),!this.state.viewModeEnabled&&(this.onRemoveEventListenersEmitter.once(tz(document,"fullscreenchange",this.onFullscreenChange),tz(document,"paste",this.pasteFromClipboard),tz(document,"cut",this.onCut),tz(window,"resize",this.onResize,!1),tz(window,"unload",this.onUnload,!1),tz(window,"blur",this.onBlur,!1),tz(this.excalidrawContainerRef.current,"dragover",this.disableEvent,!1),tz(this.excalidrawContainerRef.current,"drop",this.disableEvent,!1)),this.props.detectScroll&&this.onRemoveEventListenersEmitter.once(tz(nn(this.excalidrawContainerRef.current),"scroll",this.onScroll)))}componentDidUpdate(e,t){this.updateEmbeddables(),this.state.showWelcomeScreen||this.scene.getElementsIncludingDeleted().length||this.setState({showWelcomeScreen:!0}),e.UIOptions.dockedSidebarBreakpoint!==this.props.UIOptions.dockedSidebarBreakpoint&&this.refreshEditorBreakpoints(),t.userToFollow&&!this.state.collaborators.has(t.userToFollow.socketId)&&this.maybeUnfollowRemoteUser(),(t.zoom.value!==this.state.zoom.value||t.scrollX!==this.state.scrollX||t.scrollY!==this.state.scrollY)&&(this.props?.onScrollChange?.(this.state.scrollX,this.state.scrollY,this.state.zoom),this.onScrollChangeEmitter.trigger(this.state.scrollX,this.state.scrollY,this.state.zoom)),t.userToFollow!==this.state.userToFollow&&(t.userToFollow&&this.onUserFollowEmitter.trigger({userToFollow:t.userToFollow,action:"UNFOLLOW"}),this.state.userToFollow&&this.onUserFollowEmitter.trigger({userToFollow:this.state.userToFollow,action:"FOLLOW"})),Object.keys(this.state.selectedElementIds).length&&n2(this.state)&&this.setState({activeTool:t1(this.state,{type:"selection"})}),"eraser"===this.state.activeTool.type&&t.theme!==this.state.theme&&i6(this.interactiveCanvas,this.state.theme),"selection"===t.activeTool.type&&"selection"!==this.state.activeTool.type&&this.state.showHyperlinkPopup&&this.setState({showHyperlinkPopup:!1}),e.langCode!==this.props.langCode&&this.updateLanguage(),n2(t)&&!n2(this.state)&&this.eraserTrail.endPath(),e.viewModeEnabled!==this.props.viewModeEnabled&&this.setState({viewModeEnabled:!!this.props.viewModeEnabled}),t.viewModeEnabled!==this.state.viewModeEnabled&&(this.addEventListeners(),this.deselectElements()),e.zenModeEnabled!==this.props.zenModeEnabled&&this.setState({zenModeEnabled:!!this.props.zenModeEnabled}),e.theme!==this.props.theme&&this.props.theme&&this.setState({theme:this.props.theme}),e.gridModeEnabled!==this.props.gridModeEnabled&&this.setState({gridSize:this.props.gridModeEnabled?eE:null}),this.props.name&&e.name!==this.props.name&&this.setState({name:this.props.name}),this.excalidrawContainerRef.current?.classList.toggle("theme--dark","dark"===this.state.theme),this.state.editingLinearElement&&!this.state.selectedElementIds[this.state.editingLinearElement.elementId]&&setTimeout(()=>{this.state.editingLinearElement&&this.actionManager.executeAction(xc)}),this.state.editingElement?.isDeleted&&this.setState({editingElement:null}),this.state.selectedLinearElement&&!this.state.selectedElementIds[this.state.selectedLinearElement.elementId]&&this.setState({selectedLinearElement:null});let{multiElement:n}=t;t.activeTool!==this.state.activeTool&&null!=n&&oC(this.state)&&nH(n,!1)&&oD(n,this.state,this.scene,t8(o2.getPointAtIndexGlobalCoordinates(n,-1))),this.history.record(this.state,this.scene.getElementsIncludingDeleted()),this.state.isLoading||(this.props.onChange?.(this.scene.getElementsIncludingDeleted(),this.state,this.files),this.onChangeEmitter.trigger(this.scene.getElementsIncludingDeleted(),this.state,this.files))}renderInteractiveSceneCallback=({atLeastOneVisibleElement:e,scrollBars:t,elements:n})=>{t&&(Cs=t);let i=!nL(this.state.editingElement)&&!e&&n.length>0;this.state.scrolledOutside!==i&&this.setState({scrolledOutside:i}),this.scheduleImageRefresh()};onScroll=tV(()=>{let{offsetTop:e,offsetLeft:t}=this.getCanvasOffsets();this.setState(n=>n.offsetLeft===t&&n.offsetTop===e?null:{offsetTop:e,offsetLeft:t})},eA);onCut=SB(e=>{!this.excalidrawContainerRef.current?.contains(document.activeElement)||tW(e.target)||(this.actionManager.executeAction(xY,"keyboard",e),e.preventDefault(),e.stopPropagation())});onCopy=SB(e=>{!this.excalidrawContainerRef.current?.contains(document.activeElement)||tW(e.target)||(this.actionManager.executeAction(xV,"keyboard",e),e.preventDefault(),e.stopPropagation())});static resetTapTwice(){Cn=!1}onTouchStart=t=>{if(q&&t.preventDefault(),!Cn){Cn=!0,clearTimeout(Ci),Ci=window.setTimeout(e.resetTapTwice,eL);return}if(Cn&&1===t.touches.length){let e=t.touches[0];this.handleCanvasDoubleClick({clientX:e.clientX,clientY:e.clientY}),Cn=!1,clearTimeout(Ci)}2===t.touches.length&&this.setState({selectedElementIds:gY({},this.state),activeEmbeddable:null})};onTouchEnd=e=>{this.resetContextMenuTimer(),e.touches.length>0?this.setState({previousSelectedElementIds:{},selectedElementIds:gY(this.state.previousSelectedElementIds,this.state)}):Cg.pointers.clear()};pasteFromClipboard=SB(async e=>{let t=!!Ch,n=document.activeElement,i=this.excalidrawContainerRef.current?.contains(n);if(e&&!i)return;let l=document.elementFromPoint(this.lastViewportPosition.x,this.lastViewportPosition.y);if(e&&(!(l instanceof HTMLCanvasElement)||tW(n)))return;let{x:r,y:a}=t2({clientX:this.lastViewportPosition.x,clientY:this.lastViewportPosition.y},this.state),s=e?.clipboardData?.files[0],o=await hu(e,t);if(!s&&!t){if(o.mixedContent)return this.addElementsFromMixedContentPaste(o.mixedContent,{isPlainPaste:t,sceneX:r,sceneY:a});if(o.text){let e=o.text.trim();e.startsWith("<svg")&&e.endsWith("</svg>")&&(s=pu(e))}}if(pi(s)&&!o.spreadsheet){if(!this.isToolSupported("image")){this.setState({errorMessage:C("errors.imageToolNotSupported")});return}let e=this.createImageElement({sceneX:r,sceneY:a});this.insertImageElement(e,s),this.initializeImageDimensions(e),this.setState({selectedElementIds:gY({[e.id]:!0},this.state)});return}if(this.props.onPaste)try{if(await this.props.onPaste(o,e)===!1)return}catch(e){console.error(e)}if(o.errorMessage)this.setState({errorMessage:o.errorMessage});else if(o.spreadsheet&&!t)this.setState({pasteDialog:{data:o.spreadsheet,shown:!0}});else if(o.elements){let e=o.programmaticAPI?SH(o.elements):o.elements;this.addElementsFromPasteOrLibrary({elements:e,files:o.files||null,position:"cursor",retainSeed:t})}else if(o.text){let e=nk(o.text).split(/\n+/).map(e=>e.trim()).filter(Boolean),n=e.map(e=>lN(e)).filter(e=>lO(e,this.props.validateEmbeddable)&&(/^(http|https):\/\/[^\s/$.?#].[^\s]*$/.test(e)||lA(e)?.type==="video"));if(!Ch&&n.length>0&&n.length===e.length){let e=[];for(let t of n){let n=e[e.length-1],i=this.insertEmbeddableElement({sceneX:n?n.x+n.width+20:r,sceneY:a,link:aG(t)});i&&e.push(i)}e.length&&this.setState({selectedElementIds:Object.fromEntries(e.map(e=>[e.id,!0]))});return}this.addTextFromPaste(o.text,t)}this.setActiveTool({type:"selection"}),e?.preventDefault()});addElementsFromPasteOrLibrary=e=>{let t=u_(e.elements,null,void 0),[n,i,l,r]=m6(t),a=tQ(n,l)/2,s=tQ(i,r)/2,o="object"==typeof e.position?e.position.clientX:"cursor"===e.position?this.lastViewportPosition.x:this.state.width/2+this.state.offsetLeft,d="object"==typeof e.position?e.position.clientY:"cursor"===e.position?this.lastViewportPosition.y:this.state.height/2+this.state.offsetTop,{x:c,y:h}=t2({clientX:o,clientY:d},this.state),[m,u]=uh(c-a,h-s,this.state.gridSize),p=ly(t.map(e=>g1(e,{x:e.x+m-n,y:e.y+u-i})),{randomizeSeed:!e.retainSeed}),f=[...this.scene.getElementsIncludingDeleted(),...p];this.scene.replaceAllElements(f),p.forEach(e=>{if(nL(e)&&nU(e)){let t=hG(e);hC(e,t)}}),e.files&&(this.files={...this.files,...e.files}),this.history.resumeRecording();let x=g$(p);this.setState({...this.state,openSidebar:this.state.openSidebar&&this.device.editor.canFitSidebar&&g.get(wC)?this.state.openSidebar:null,...iR({editingGroupId:null,selectedElementIds:x.reduce((e,t)=>(nU(t)||(e[t.id]=!0),e),{})},this.scene.getNonDeletedElements(),this.state,this)},()=>{e.files&&this.addNewImagesToImageCache()}),this.setActiveTool({type:"selection"}),e.fitToContent&&this.scrollToContent(p,{fitToContent:!0})};async addElementsFromMixedContentPaste(e,{isPlainPaste:t,sceneX:n,sceneY:i}){if(!t&&e.some(e=>"imageUrl"===e.type)&&this.isToolSupported("image")){let t=e.filter(e=>"imageUrl"===e.type).map(e=>e.value),l=await Promise.all(t.map(async e=>{try{return{file:await pp(e)}}catch(e){return{errorMessage:e.message}}})),r=i,a=!1,s={};for(let e of l)if(e.file){let t=this.createImageElement({sceneX:n,sceneY:r}),i=await this.insertImageElement(t,e.file);i&&(a||(a=!0,r-=i.height/2),gQ(i,{y:r},!1),r=t.y+t.height+25,s[t.id]=!0)}this.setState({selectedElementIds:gY(s,this.state)});let o=l.find(e=>!!e.errorMessage);o&&o.errorMessage&&this.setState({errorMessage:o.errorMessage})}else{let n=e.filter(e=>"text"===e.type);n.length&&this.addTextFromPaste(n.map(e=>e.value).join(`

`),t)}}addTextFromPaste(e,t=!1){let{x:n,y:i}=t2({clientX:this.lastViewportPosition.x,clientY:this.lastViewportPosition.y},this.state),l={x:n,y:i,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roundness:null,roughness:this.state.currentItemRoughness,opacity:this.state.currentItemOpacity,text:e,fontSize:this.state.currentItemFontSize,fontFamily:this.state.currentItemFontFamily,textAlign:this.state.currentItemTextAlign,verticalAlign:ew,locked:!1},r=i,a=t?[e]:e.split(`
`),s=a.reduce((e,t,i)=>{let s=t.trim(),o=h5(l.fontFamily);if(s.length){let t=this.getTopLayerFrameAtSceneCoords({x:n,y:r}),i=ls({...l,x:n,y:r,text:s,lineHeight:o,frameId:t?t.id:null});e.push(i),r+=i.height+10}else a[i-1]?.trim()&&(r+=hA(l.fontSize,o)+10);return e},[]);if(0===s.length)return;let o=s[0].frameId;o?this.scene.insertElementsAtIndex(s,this.scene.getElementIndex(o)):this.scene.replaceAllElements([...this.scene.getElementsIncludingDeleted(),...s]),this.setState({selectedElementIds:gY(Object.fromEntries(s.map(e=>[e.id,!0])),this.state)}),t||!(s.length>1)||!1!==Cu||this.device.editor.isMobile||(this.setToast({message:C("toast.pasteAsSingleElement",{shortcut:t0("CtrlOrCmd+Shift+V")}),duration:5e3}),Cu=!0),this.history.resumeRecording()}setAppState=(e,t)=>{this.setState(e,t)};removePointer=e=>{Co&&this.resetContextMenuTimer(),Cg.pointers.delete(e.pointerId)};toggleLock=(e="ui")=>{this.state.activeTool.locked||aX("toolbar","toggleLock",`${e} (${this.device.editor.isMobile?"mobile":"desktop"})`),this.setState(e=>({activeTool:{...e.activeTool,...t1(this.state,e.activeTool.locked?{type:"selection"}:e.activeTool),locked:!e.activeTool.locked}}))};updateFrameRendering=e=>{this.setState(t=>{let n="function"==typeof e?e(t.frameRendering):e;return{frameRendering:{enabled:n?.enabled??t.frameRendering.enabled,clip:n?.clip??t.frameRendering.clip,name:n?.name??t.frameRendering.name,outline:n?.outline??t.frameRendering.outline}}})};togglePenMode=e=>{this.setState(t=>({penMode:e??!t.penMode,penDetected:!0}))};onHandToolToggle=()=>{this.actionManager.executeAction(cY)};zoomCanvas=e=>{this.setState({...cF({viewportX:this.state.width/2+this.state.offsetLeft,viewportY:this.state.height/2+this.state.offsetTop,nextZoom:cB(e)},this.state)})};cancelInProgressAnimation=null;scrollToContent=(e=this.scene.getNonDeletedElements(),t)=>{this.cancelInProgressAnimation?.();let n=Array.isArray(e)?e:[e],i=this.state.zoom,l=this.state.scrollX,r=this.state.scrollY;if(t?.fitToContent||t?.fitToViewport){let{appState:e}=cV({targetElements:n,appState:this.state,fitToViewport:!!t?.fitToViewport,viewportZoomFactor:t?.viewportZoomFactor});i=e.zoom,l=e.scrollX,r=e.scrollY}else{let e=cH(n,this.state);l=e.scrollX,r=e.scrollY}if(t?.animate){let e=this.state.scrollX,n=this.state.scrollY,a=this.state.zoom.value,s=tq({fromValues:{scrollX:e,scrollY:n,zoom:a},toValues:{scrollX:l,scrollY:r,zoom:i.value},interpolateValue:(e,t,n,i)=>{if("zoom"===i)return e*Math.pow(t/e,tY(n))},onStep:({scrollX:e,scrollY:t,zoom:n})=>{this.setState({scrollX:e,scrollY:t,zoom:{value:n}})},onStart:()=>{this.setState({shouldCacheIgnoreZoom:!0})},onEnd:()=>{this.setState({shouldCacheIgnoreZoom:!1})},onCancel:()=>{this.setState({shouldCacheIgnoreZoom:!1})},duration:t?.duration??500});this.cancelInProgressAnimation=()=>{s(),this.cancelInProgressAnimation=null}}else this.setState({scrollX:l,scrollY:r,zoom:i})};maybeUnfollowRemoteUser=()=>{this.state.userToFollow&&this.setState({userToFollow:null})};translateCanvas=e=>{this.cancelInProgressAnimation?.(),this.maybeUnfollowRemoteUser(),this.setState(e)};setToast=e=>{this.setState({toast:e})};restoreFileFromShare=async()=>{try{let e=await caches.open("web-share-target"),t=await e.match("shared-file");if(t){let n=await t.blob(),i=new File([n],n.name||"",{type:n.type});this.loadFileToCanvas(i,null),await e.delete("shared-file"),window.history.replaceState(null,Q,window.location.pathname)}}catch(e){this.setState({errorMessage:e.message})}};addFiles=SB(e=>{let t=e.reduce((e,t)=>(e.set(t.id,t),e),new Map);this.files={...this.files,...Object.fromEntries(t)},this.scene.getNonDeletedElements().forEach(e=>{nC(e)&&t.has(e.fileId)&&(this.imageCache.delete(e.fileId),sK.delete(e))}),this.scene.informMutation(),this.addNewImagesToImageCache()});updateScene=SB(e=>{e.commitToHistory&&this.history.resumeRecording(),e.appState&&this.setState(e.appState),e.elements&&this.scene.replaceAllElements(e.elements),e.collaborators&&this.setState({collaborators:e.collaborators})});onSceneUpdated=()=>{this.setState({})};toggleSidebar=({name:e,tab:t,force:n})=>{let i;return i=void 0===n?this.state.openSidebar?.name===e?null:e:n?e:null,this.setState({openSidebar:i?{name:i,tab:t}:null}),!!i};updateCurrentCursorPosition=SB(e=>{this.lastViewportPosition.x=e.clientX,this.lastViewportPosition.y=e.clientY});onKeyDown=SB(e=>{if("Proxy"in window&&(!e.shiftKey&&/^[A-Z]$/.test(e.key)||e.shiftKey&&/^[a-z]$/.test(e.key))&&(e=new Proxy(e,{get(t,n){let i=t[n];return"function"==typeof i?i.bind(t):"key"===n?e.shiftKey?t.key.toUpperCase():t.key.toLowerCase():i}})),e[aO.CTRL_OR_CMD]&&e.key.toLowerCase()===aO.V&&(Ch=e.shiftKey,clearTimeout(Cm),Cm=window.setTimeout(()=>{Ch=!1},100)),e[aO.CTRL_OR_CMD]&&tW(e.target)&&(e.code===aN.MINUS||e.code===aN.EQUAL)){e.preventDefault();return}if(tW(e.target)&&e.key!==aO.ESCAPE||az(e.key)&&t$(e.target))return;if(e.key===aO.QUESTION_MARK){this.setState({openDialog:{name:"help"}});return}if(e.key.toLowerCase()===aO.E&&e.shiftKey&&e[aO.CTRL_OR_CMD]){e.preventDefault(),this.setState({openDialog:{name:"imageExport"}});return}if(e.key===aO.PAGE_UP||e.key===aO.PAGE_DOWN){let t=(e.shiftKey?this.state.width:this.state.height)/this.state.zoom.value;e.key===aO.PAGE_DOWN&&(t=-t),e.shiftKey?this.translateCanvas(e=>({scrollX:e.scrollX+t})):this.translateCanvas(e=>({scrollY:e.scrollY+t}))}if(this.actionManager.handleKeyDown(e)||this.state.viewModeEnabled)return;if(e[aO.CTRL_OR_CMD]&&this.state.isBindingEnabled&&this.setState({isBindingEnabled:!1}),az(e.key)){let t=this.state.gridSize&&(e.shiftKey?ei:this.state.gridSize)||(e.shiftKey?en:ei),n=0,i=0;e.key===aO.ARROW_LEFT?n=-t:e.key===aO.ARROW_RIGHT?n=t:e.key===aO.ARROW_UP?i=-t:e.key===aO.ARROW_DOWN&&(i=t);let l=this.scene.getSelectedElements({selectedElementIds:this.state.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0});l.forEach(e=>{gQ(e,{x:e.x+n,y:e.y+i}),oH(e,{simultaneouslyUpdated:l})}),this.maybeSuggestBindingForAll(l),e.preventDefault()}else if(e.key===aO.ENTER){let t=this.scene.getSelectedElements(this.state);if(1===t.length){let n=t[0];if(e[aO.CTRL_OR_CMD])nN(n)&&(!this.state.editingLinearElement||this.state.editingLinearElement.elementId!==t[0].id)&&(this.history.resumeRecording(),this.setState({editingLinearElement:new o2(n,this.scene)}));else if(nL(n)||h1(n)){let t;nL(n)||(t=n);let i=hV(n,this.state),l=i.x,r=i.y;this.startTextEditing({sceneX:l,sceneY:r,container:t}),e.preventDefault();return}else nP(n)&&this.setState({editingFrame:n.id})}}else if(!e.ctrlKey&&!e.altKey&&!e.metaKey&&null===this.state.draggingElement){let t=yu(e.key);t?(this.state.activeTool.type!==t&&aX("toolbar",t,`keyboard (${this.device.editor.isMobile?"mobile":"desktop"})`),this.setActiveTool({type:t}),e.stopPropagation()):e.key===aO.Q&&(this.toggleLock("keyboard"),e.stopPropagation())}if(e.key===aO.SPACE&&0===Cg.pointers.size&&(Cl=!0,i0(this.interactiveCanvas,ea.GRAB),e.preventDefault()),(e.key===aO.G||e.key===aO.S)&&!e.altKey&&!e[aO.CTRL_OR_CMD]){let t=this.scene.getSelectedElements(this.state);if("selection"===this.state.activeTool.type&&!t.length)return;e.key===aO.G&&(cE(this.state.activeTool.type)||t.some(e=>cE(e.type)))&&(this.setState({openPopup:"elementBackground"}),e.stopPropagation()),e.key===aO.S&&(this.setState({openPopup:"elementStroke"}),e.stopPropagation())}if(e.key===aO.K&&!e.altKey&&!e[aO.CTRL_OR_CMD]){"laser"===this.state.activeTool.type?this.setActiveTool({type:"selection"}):this.setActiveTool({type:"laser"});return}e[aO.CTRL_OR_CMD]&&(e.key===aO.BACKSPACE||e.key===aO.DELETE)&&g.set(wj,"clearCanvas");let t=e.key.toLocaleLowerCase(),n=t===aO.S&&e.shiftKey,i=e.key===aO.I||t===aO.G&&e.shiftKey;(n||i)&&this.openEyeDropper({type:n?"stroke":"background"})});onWheel=SB(e=>{e.target instanceof HTMLCanvasElement||!e.ctrlKey||e.preventDefault()});onKeyUp=SB(e=>{if(e.key===aO.SPACE&&(this.state.viewModeEnabled?i0(this.interactiveCanvas,ea.GRAB):"selection"===this.state.activeTool.type?i1(this.interactiveCanvas):(i4(this.interactiveCanvas,this.state),this.setState({selectedElementIds:gY({},this.state),selectedGroupIds:{},editingGroupId:null,activeEmbeddable:null})),Cl=!1),e[aO.CTRL_OR_CMD]||this.state.isBindingEnabled||this.setState({isBindingEnabled:!0}),az(e.key)){let e=this.scene.getSelectedElements(this.state);oC(this.state)?oT(e):oR(e),this.setState({suggestedBindings:[]})}});isToolSupported=e=>this.props.UIOptions.tools?.[e]!==!1;setActiveTool=e=>{if(!this.isToolSupported(e.type)){console.warn(`"${e.type}" tool is disabled via "UIOptions.canvasActions.tools.${e.type}"`);return}let t=t1(this.state,e);"hand"===t.type?i0(this.interactiveCanvas,ea.GRAB):Cl||i4(this.interactiveCanvas,this.state),tF(document.activeElement)&&this.focusContainer(),nz(t.type)||this.setState({suggestedBindings:[]}),"image"===t.type&&this.onImageAction({insertOnCanvasDirectly:("image"===e.type&&e.insertOnCanvasDirectly)??!1}),this.setState(e=>{let n={snapLines:e.snapLines.length?[]:e.snapLines,originSnapOffset:null,activeEmbeddable:null};return"selection"!==t.type?{...e,activeTool:t,selectedElementIds:gY({},e),selectedGroupIds:gY({},e),editingGroupId:null,multiElement:null,...n}:{...e,activeTool:t,...n}})};setOpenDialog=e=>{this.setState({openDialog:e})};setCursor=e=>{i0(this.interactiveCanvas,e)};resetCursor=()=>{i1(this.interactiveCanvas)};isTouchScreenMultiTouchGesture=()=>Cg.pointers.size>=2;onGestureStart=SB(e=>{e.preventDefault(),this.isTouchScreenMultiTouchGesture()&&this.setState({selectedElementIds:gY({},this.state),activeEmbeddable:null}),Cg.initialScale=this.state.zoom.value});onGestureChange=SB(e=>{if(e.preventDefault(),this.isTouchScreenMultiTouchGesture())return;let t=Cg.initialScale;t&&this.setState(n=>({...cF({viewportX:this.lastViewportPosition.x,viewportY:this.lastViewportPosition.y,nextZoom:cB(t*e.scale)},n)}))});onGestureEnd=SB(e=>{e.preventDefault(),this.isTouchScreenMultiTouchGesture()&&this.setState({previousSelectedElementIds:{},selectedElementIds:gY(this.state.previousSelectedElementIds,this.state)}),Cg.initialScale=null});handleTextWysiwyg(e,{isExistingElement:t=!1}){let n=(t,n,i)=>{this.scene.replaceAllElements([...this.scene.getElementsIncludingDeleted().map(l=>l.id===e.id&&nL(l)?lc(l,{text:t,isDeleted:i,originalText:n}):l)])};hE({id:e.id,canvas:this.canvas,getViewportCoords:(e,t)=>{let{x:n,y:i}=t3({sceneX:e,sceneY:t},this.state);return[n-this.state.offsetLeft,i-this.state.offsetTop]},onChange:SB(t=>{n(t,t,!1),fC(e)&&oH(e)}),onSubmit:SB(({text:i,viaKeyboard:l,originalText:r})=>{let a=!i.trim();if(n(i,r,a),!a&&l){let t=e.containerId?e.containerId:e.id;this.setState(e=>({selectedElementIds:gY({...e.selectedElementIds,[t]:!0},e)}))}a&&oJ(this.scene.getNonDeletedElements(),[e]),(!a||t)&&this.history.resumeRecording(),this.setState({draggingElement:null,editingElement:null}),this.state.activeTool.locked&&i4(this.interactiveCanvas,this.state),this.focusContainer()}),element:e,excalidrawContainer:this.excalidrawContainerRef.current,app:this}),this.deselectElements(),n(e.text,e.originalText,!1)}deselectElements(){this.setState({selectedElementIds:gY({},this.state),selectedGroupIds:{},editingGroupId:null,activeEmbeddable:null})}getTextElementAtPosition(e,t){let n=this.getElementAtPosition(e,t,{includeBoundTextElement:!0});return n&&nL(n)&&!n.isDeleted?n:null}getElementAtPosition(e,t,n){let i=this.getElementsAtPosition(e,t,n?.includeBoundTextElement,n?.includeLockedElements);if(i.length>1){if(n?.preferSelected){for(let e=i.length-1;e>-1;e--)if(this.state.selectedElementIds[i[e].id])return i[e]}let l=i[i.length-1];return sq(l,this.state,this.frameNameBoundsCache,e,t)?i[i.length-2]:l}return 1===i.length?i[0]:null}getElementsAtPosition(e,t,n=!1,i=!1){let l=n&&i?this.scene.getNonDeletedElements():this.scene.getNonDeletedElements().filter(e=>(i||!e.locked)&&(n||!(nL(e)&&e.containerId)));return cT(l,n=>sX(n,this.state,this.frameNameBoundsCache,e,t)).filter(n=>{let i=gA(n);return!i||!this.state.frameRendering.enabled||!this.state.frameRendering.clip||gC({x:e,y:t},i)})}startTextEditing=({sceneX:e,sceneY:t,insertAtParentCenter:n=!0,container:i})=>{let l=!1,r=n&&this.getTextWysiwygSnappedToCenterPosition(e,t,this.state,i);i&&r&&(hU(i)||(l=!0));let a=null,s=this.scene.getSelectedElements(this.state);a=1===s.length?nL(s[0])?s[0]:i?hU(s[0]):this.getTextElementAtPosition(e,t):this.getTextElementAtPosition(e,t);let o=a?.fontFamily||this.state.currentItemFontFamily,d=a?.lineHeight||h5(o),c=this.state.currentItemFontSize;if(!a&&l&&i&&!nO(i)){let n=h$(tG({fontSize:c,fontFamily:o}),d),l=hP(c,d),a=Math.max(i.height,l),s=Math.max(i.width,n);gQ(i,{height:a,width:s}),e=i.x+s/2,t=i.y+a/2,r&&(r=this.getTextWysiwygSnappedToCenterPosition(e,t,this.state,i))}let h=this.getTopLayerFrameAtSceneCoords({x:e,y:t}),m=a||ls({x:r?r.elementCenterX:e,y:r?r.elementCenterY:t,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,opacity:this.state.currentItemOpacity,text:"",fontSize:c,fontFamily:o,textAlign:r?"center":this.state.currentItemTextAlign,verticalAlign:r?e0.MIDDLE:ew,containerId:l?i?.id:void 0,groupIds:i?.groupIds??[],lineHeight:d,angle:i?.angle??0,frameId:h?h.id:null});if(!a&&l&&i&&gQ(i,{boundElements:(i.boundElements||[]).concat({type:"text",id:m.id})}),this.setState({editingElement:m}),!a){if(i&&l){let e=this.scene.getElementIndex(i.id);this.scene.insertElementAtIndex(m,e+1)}else this.scene.addNewElement(m)}this.setState({editingElement:m}),this.handleTextWysiwyg(m,{isExistingElement:!!a})};handleCanvasDoubleClick=e=>{if(this.state.multiElement||"selection"!==this.state.activeTool.type)return;let t=this.scene.getSelectedElements(this.state);if(1===t.length&&nN(t[0])){if(e[aO.CTRL_OR_CMD]&&(!this.state.editingLinearElement||this.state.editingLinearElement.elementId!==t[0].id)){this.history.resumeRecording(),this.setState({editingLinearElement:new o2(t[0],this.scene)});return}if(this.state.editingLinearElement&&this.state.editingLinearElement.elementId===t[0].id)return}i1(this.interactiveCanvas);let{x:n,y:i}=t2(e,this.state);if(iz(this.state).length>0){let e=this.getElementAtPosition(n,i),t=e&&iZ(e,this.state.selectedGroupIds);if(t){this.setState(n=>({...n,...iR({editingGroupId:t,selectedElementIds:{[e.id]:!0}},this.scene.getNonDeletedElements(),n,this)}));return}}if(i1(this.interactiveCanvas),!e[aO.CTRL_OR_CMD]&&!this.state.viewModeEnabled){let t=this.getElementAtPosition(n,i);if(nT(t)){this.setState({activeEmbeddable:{element:t,state:"active"}});return}let l=hJ(this.scene.getNonDeletedElements(),this.state,n,i);if(l&&(nW(l)||!nt(l.backgroundColor)||sJ(l,this.state,this.frameNameBoundsCache,[n,i]))){let e=hV(l,this.state);n=e.x,i=e.y}this.startTextEditing({sceneX:n,sceneY:i,insertAtParentCenter:!e.altKey,container:l})}};getElementLinkAtPosition=(e,t)=>{let n=this.scene.getNonDeletedElements().slice().reverse(),i=1/0;return n.find((n,l)=>(t&&n.id===t.id&&(i=l),n.link&&l<=i&&a5(n,this.state,[e.x,e.y],this.device.editor.isMobile)))};redirectToLink=(e,t)=>{let n=ul(this.lastPointerDownEvent.clientX,this.lastPointerDownEvent.clientY,this.lastPointerUpEvent.clientX,this.lastPointerUpEvent.clientY);if(!this.hitLinkElement||t&&n>ee||!t&&0!==n)return;let i=t2(this.lastPointerDownEvent,this.state),l=a5(this.hitLinkElement,this.state,[i.x,i.y],this.device.editor.isMobile),r=t2(this.lastPointerUpEvent,this.state),a=a5(this.hitLinkElement,this.state,[r.x,r.y],this.device.editor.isMobile);if(l&&a){let t=this.hitLinkElement.link;if(t){let n;if(t=aG(t),this.props.onLinkOpen&&(n=nd("excalidraw-link",e.nativeEvent),this.props.onLinkOpen({...this.hitLinkElement,link:t},n)),!n?.defaultPrevented){let e=aV(t)?"_self":"_blank",n=window.open(void 0,e);n&&(n.opener=null,n.location=t)}}}};getTopLayerFrameAtSceneCoords=e=>{let t=this.scene.getNonDeletedFramesLikes().filter(t=>gC(e,t));return t.length?t[t.length-1]:null};handleCanvasPointerMove=e=>{this.savePointer(e.clientX,e.clientY,this.state.cursorButton),this.lastPointerMoveEvent=e.nativeEvent,Cg.pointers.has(e.pointerId)&&Cg.pointers.set(e.pointerId,{x:e.clientX,y:e.clientY});let t=Cg.initialScale;if(2===Cg.pointers.size&&Cg.lastCenter&&t&&Cg.initialDistance){let e=ys(Cg.pointers),n=e.x-Cg.lastCenter.x,i=e.y-Cg.lastCenter.y;Cg.lastCenter=e;let l=yo(Array.from(Cg.pointers.values())),r="freedraw"===this.state.activeTool.type&&this.state.penMode?1:l/Cg.initialDistance,a=r?cB(t*r):this.state.zoom.value;this.setState(t=>{let l=cF({viewportX:e.x,viewportY:e.y,nextZoom:a},t);this.translateCanvas({zoom:l.zoom,scrollX:l.scrollX+n/a,scrollY:l.scrollY+i/a,shouldCacheIgnoreZoom:!0})}),this.resetShouldCacheIgnoreZoomDebounced()}else Cg.lastCenter=Cg.initialDistance=Cg.initialScale=null;if(Cl||Cr||Ca||n3(this.state))return;let n=fP(Cs,e.clientX-this.state.offsetLeft,e.clientY-this.state.offsetTop).isOverEither;this.state.draggingElement||this.state.multiElement||(n?i1(this.interactiveCanvas):i4(this.interactiveCanvas,this.state));let i=t2(e,this.state),{x:l,y:r}=i;if(!this.state.draggingElement&&SP(this.state.activeTool.type)){let{originOffset:t,snapLines:n}=SA(this.scene.getNonDeletedElements(),this.state,{x:l,y:r},e);this.setState(e=>{let i=nE(e.snapLines,n),l=e.originSnapOffset?nE(e.originSnapOffset,t):t;return e.snapLines===i&&e.originSnapOffset===l?null:{snapLines:i,originSnapOffset:l}})}else this.state.draggingElement||this.setState(e=>e.snapLines.length?{snapLines:[]}:null);if(this.state.editingLinearElement&&!this.state.editingLinearElement.isDragging){let t=o2.handlePointerMove(e,l,r,this.state);t&&t!==this.state.editingLinearElement&&(0,tc.flushSync)(()=>{this.setState({editingLinearElement:t})}),t?.lastUncommittedPoint!=null?this.maybeSuggestBindingAtCursor(i):(0,tc.flushSync)(()=>{this.setState({suggestedBindings:[]})})}if(nB(this.state.activeTool.type)){let{draggingElement:e}=this.state;nH(e,!1)?this.maybeSuggestBindingsForLinearElementAtCoords(e,[i],this.state.startBoundElement):this.maybeSuggestBindingAtCursor(i)}if(this.state.multiElement){let{multiElement:t}=this.state,{x:n,y:i}=t,{points:a,lastCommittedPoint:s}=t,o=a[a.length-1];if(i4(this.interactiveCanvas,this.state),o===s)ul(l-n,r-i,o[0],o[1])>=et?gQ(t,{points:[...a,[l-n,r-i]]}):i0(this.interactiveCanvas,ea.POINTER);else if(a.length>2&&s&&ul(l-n,r-i,s[0],s[1])<et)i0(this.interactiveCanvas,ea.POINTER),gQ(t,{points:a.slice(0,-1)});else{let[s,o]=uh(l,r,e[aO.CTRL_OR_CMD]?null:this.state.gridSize),[d,c]=t?.lastCommittedPoint??[0,0],h=s-n-d,m=o-i-c;aF(e)&&({width:h,height:m}=g4(d+n,c+i,s,o)),ua(a,this.state.zoom.value)&&i0(this.interactiveCanvas,ea.POINTER),gQ(t,{points:[...a.slice(0,-1),[d+h,c+m]]})}return}if(e.buttons||"selection"!==this.state.activeTool.type&&"text"!==this.state.activeTool.type&&"eraser"!==this.state.activeTool.type)return;let a=this.scene.getNonDeletedElements(),s=this.scene.getSelectedElements(this.state);if(1!==s.length||n||this.state.editingLinearElement){if(s.length>1&&!n){let t=fe(m6(s),l,r,this.state.zoom,e.pointerType);if(t){i0(this.interactiveCanvas,fi({transformHandleType:t}));return}}}else{let t=g9(a,this.state,l,r,this.state.zoom,e.pointerType);if(t&&t.transformHandleType){i0(this.interactiveCanvas,fi(t));return}}let o=this.getElementAtPosition(i.x,i.y);this.hitLinkElement=this.getElementLinkAtPosition(i,o),!n2(this.state)&&(this.hitLinkElement&&!this.state.selectedElementIds[this.hitLinkElement.id]?(i0(this.interactiveCanvas,ea.POINTER),a7(this.hitLinkElement,this.state)):(se(),o&&(o.link||nM(o))&&this.state.selectedElementIds[o.id]&&!this.state.contextMenu&&!this.state.showHyperlinkPopup?this.setState({showHyperlinkPopup:"info"}):"text"===this.state.activeTool.type?i0(this.interactiveCanvas,nL(o)?ea.TEXT:ea.CROSSHAIR):this.state.viewModeEnabled?i0(this.interactiveCanvas,ea.GRAB):n?i0(this.interactiveCanvas,ea.AUTO):this.state.selectedLinearElement?this.handleHoverSelectedLinearElement(this.state.selectedLinearElement,l,r):e[aO.CTRL_OR_CMD]?i0(this.interactiveCanvas,ea.AUTO):(o||this.isHittingCommonBoundingBoxOfSelectedElements(i,s))&&!o?.locked&&(o&&nT(o)&&this.isIframeLikeElementCenter(o,e,l,r)?(i0(this.interactiveCanvas,ea.POINTER),this.setState({activeEmbeddable:{element:o,state:"hover"}})):(i0(this.interactiveCanvas,ea.MOVE),this.state.activeEmbeddable?.state==="hover"&&this.setState({activeEmbeddable:null})))))};handleEraser=(e,t,n)=>{this.eraserTrail.addPointToPath(n.x,n.y);let i=!1,l=new Set,r=this.scene.getNonDeletedElements(),a=t=>{for(let n of t){if(n.locked)return;if(e.altKey?this.elementsPendingErasure.delete(n.id)&&(i=!0):this.elementsPendingErasure.has(n.id)||(i=!0,this.elementsPendingErasure.add(n.id)),i&&n.groupIds?.length){let t=n.groupIds.at(-1);if(!l.has(t))for(let n of(l.add(t),i$(r,t)))e.altKey?this.elementsPendingErasure.delete(n.id):this.elementsPendingErasure.add(n.id)}}},s=ul(t.lastCoords.x,t.lastCoords.y,n.x,n.y),o=10/this.state.zoom.value,d={...t.lastCoords},c=0;for(;c<=s&&(a(this.getElementsAtPosition(d.x,d.y)),c!==s);){let e=(c=Math.min(c+o,s))/s,t=(1-e)*d.x+e*n.x,i=(1-e)*d.y+e*n.y;d.x=t,d.y=i}if(t.lastCoords.x=n.x,t.lastCoords.y=n.y,i){for(let t of this.scene.getNonDeletedElements())nU(t)&&(this.elementsPendingErasure.has(t.id)||this.elementsPendingErasure.has(t.containerId))&&(e.altKey?(this.elementsPendingErasure.delete(t.id),this.elementsPendingErasure.delete(t.containerId)):(this.elementsPendingErasure.add(t.id),this.elementsPendingErasure.add(t.containerId)));this.elementsPendingErasure=new Set(this.elementsPendingErasure),this.onSceneUpdated()}};handleTouchMove=e=>{Cd=!0};handleHoverSelectedLinearElement(e,t,n){let i=o2.getElement(e.elementId),l=hU(i);if(i){if(this.state.selectedLinearElement){let r=-1,a=null;sJ(i,this.state,this.frameNameBoundsCache,[t,n])?(r=o2.getPointIndexUnderCursor(i,this.state.zoom,t,n),a=o2.getSegmentMidpointHitCoords(e,{x:t,y:n},this.state),r>=0||a?i0(this.interactiveCanvas,ea.POINTER):i0(this.interactiveCanvas,ea.MOVE)):sV([i],this.state)&&sq(i,this.state,this.frameNameBoundsCache,t,n)?i0(this.interactiveCanvas,ea.MOVE):l&&sX(l,this.state,this.frameNameBoundsCache,t,n)&&i0(this.interactiveCanvas,ea.MOVE),this.state.selectedLinearElement.hoverPointIndex!==r&&this.setState({selectedLinearElement:{...this.state.selectedLinearElement,hoverPointIndex:r}}),o2.arePointsEqual(this.state.selectedLinearElement.segmentMidPointHoveredCoords,a)||this.setState({selectedLinearElement:{...this.state.selectedLinearElement,segmentMidPointHoveredCoords:a}})}else i0(this.interactiveCanvas,ea.AUTO)}}handleCanvasPointerDown=e=>{if(this.maybeCleanupAfterMissingPointerUp(e.nativeEvent),this.maybeUnfollowRemoteUser(),this.state.contextMenu&&this.setState({contextMenu:null}),this.state.snapLines&&this.setAppState({snapLines:[]}),this.updateGestureOnPointerDown(e),"touch"===e.pointerType&&this.state.draggingElement&&"freedraw"===this.state.draggingElement.type){let e=this.state.draggingElement;this.updateScene({...e.points.length<10?{elements:this.scene.getElementsIncludingDeleted().filter(t=>t.id!==e.id)}:{},appState:{draggingElement:null,editingElement:null,startBoundElement:null,suggestedBindings:[],selectedElementIds:gY(Object.keys(this.state.selectedElementIds).filter(t=>t!==e.id).reduce((e,t)=>(e[t]=this.state.selectedElementIds[t],e),{}),this.state)}});return}let t=document.getSelection();if(t?.anchorNode&&t.removeAllRanges(),this.maybeOpenContextMenuAfterPointerDownOnTouchDevices(e),this.state.penDetected||"pen"!==e.pointerType||this.setState(e=>({penMode:!0,penDetected:!0})),!this.device.isTouchScreen&&["pen","touch"].includes(e.pointerType)&&(this.device=nc(this.device,{isTouchScreen:!0})),Cr||(this.lastPointerDownEvent=e,this.handleCanvasPanUsingWheelOrSpaceDrag(e)))return;if(this.setState({lastPointerDownWith:e.pointerType,cursorButton:"down"}),this.savePointer(e.clientX,e.clientY,"down"),e.button===es.ERASER&&this.state.activeTool.type!==tl.eraser){this.setState({activeTool:t1(this.state,{type:tl.eraser,lastActiveToolBeforeEraser:this.state.activeTool})},()=>{this.handleCanvasPointerDown(e);let t=()=>{n(),i?.(),n2(this.state)&&this.setState({activeTool:t1(this.state,{...this.state.activeTool.lastActiveTool||{type:tl.selection},lastActiveToolBeforeEraser:null})})},n=tz(window,"pointerup",t,{once:!0}),i;requestAnimationFrame(()=>{i=this.missingPointerEventCleanupEmitter.once(t)})});return}if(e.button!==es.MAIN&&e.button!==es.TOUCH&&e.button!==es.ERASER||Cg.pointers.size>1)return;let n=this.initialPointerDownState(e);if(this.setState({selectedElementsAreBeingDragged:!1}),this.handleDraggingScrollBar(e,n)||(this.clearSelectionIfNotUsingSelection(),this.updateBindingEnabledOnPointerMove(e),this.handleSelectionOnPointerDown(e,n))||!(!this.state.penMode||"touch"!==e.pointerType||"selection"===this.state.activeTool.type||"text"===this.state.activeTool.type||"image"===this.state.activeTool.type))return;if("text"===this.state.activeTool.type){this.handleTextOnPointerDown(e,n);return}if("arrow"===this.state.activeTool.type||"line"===this.state.activeTool.type)this.handleLinearElementOnPointerDown(e,this.state.activeTool.type,n);else if("image"===this.state.activeTool.type){i0(this.interactiveCanvas,ea.CROSSHAIR);let t=this.state.pendingImageElementId&&this.scene.getElement(this.state.pendingImageElementId);if(!t)return;this.setState({draggingElement:t,editingElement:t,pendingImageElementId:null,multiElement:null});let{x:n,y:i}=t2(e,this.state),l=this.getTopLayerFrameAtSceneCoords({x:n,y:i});gQ(t,{x:n,y:i,frameId:l?l.id:null})}else"freedraw"===this.state.activeTool.type?this.handleFreeDrawElementOnPointerDown(e,this.state.activeTool.type,n):"custom"===this.state.activeTool.type?i4(this.interactiveCanvas,this.state):this.state.activeTool.type===tl.frame||this.state.activeTool.type===tl.magicframe?this.createFrameElementOnPointerDown(n,this.state.activeTool.type):"laser"===this.state.activeTool.type?this.laserTrails.startPath(n.lastCoords.x,n.lastCoords.y):"eraser"!==this.state.activeTool.type&&"hand"!==this.state.activeTool.type&&this.createGenericElementOnPointerDown(this.state.activeTool.type,n);this.props?.onPointerDown?.(this.state.activeTool,n),this.onPointerDownEmitter.trigger(this.state.activeTool,n,e),"eraser"===this.state.activeTool.type&&this.eraserTrail.startPath(n.lastCoords.x,n.lastCoords.y);let i=this.onPointerMoveFromPointerDownHandler(n),l=this.onPointerUpFromPointerDownHandler(n),r=this.onKeyDownFromPointerDownHandler(n),a=this.onKeyUpFromPointerDownHandler(n);this.missingPointerEventCleanupEmitter.once(t=>l(t||e.nativeEvent)),this.state.viewModeEnabled&&"laser"!==this.state.activeTool.type||(window.addEventListener("pointermove",i),window.addEventListener("pointerup",l),window.addEventListener("keydown",r),window.addEventListener("keyup",a),n.eventListeners.onMove=i,n.eventListeners.onUp=l,n.eventListeners.onKeyUp=a,n.eventListeners.onKeyDown=r)};handleCanvasPointerUp=e=>{this.removePointer(e),this.lastPointerUpEvent=e;let t=t2({clientX:e.clientX,clientY:e.clientY},this.state),n=e.timeStamp-(this.lastPointerDownEvent?.timeStamp??0);if(this.device.editor.isMobile&&n<300){let n=this.getElementAtPosition(t.x,t.y);if(nT(n)&&this.isIframeLikeElementCenter(n,e,t.x,t.y)){this.handleEmbeddableCenterClick(n);return}}if(this.device.isTouchScreen){let e=this.getElementAtPosition(t.x,t.y);this.hitLinkElement=this.getElementLinkAtPosition(t,e)}this.hitLinkElement&&!this.state.selectedElementIds[this.hitLinkElement.id]?n<300&&nT(this.hitLinkElement)&&!a4(this.hitLinkElement,this.state,[t.x,t.y])?this.handleEmbeddableCenterClick(this.hitLinkElement):this.redirectToLink(e,this.device.isTouchScreen):this.state.viewModeEnabled&&this.setState({activeEmbeddable:null,selectedElementIds:{}})};maybeOpenContextMenuAfterPointerDownOnTouchDevices=e=>{"touch"===e.pointerType&&(Cd=!1,Co?Cd=!0:Co=window.setTimeout(()=>{Co=0,Cd||this.handleCanvasContextMenu(e)},eD))};resetContextMenuTimer=()=>{clearTimeout(Co),Co=0,Cd=!1};maybeCleanupAfterMissingPointerUp=e=>{Cp?.(),this.missingPointerEventCleanupEmitter.trigger(e).clear()};handleCanvasPanUsingWheelOrSpaceDrag=e=>{if(!(Cg.pointers.size<=1&&(e.button===es.WHEEL||e.button===es.MAIN&&Cl||n3(this.state)||this.state.viewModeEnabled))||nL(this.state.editingElement))return!1;Cr=!0,e.preventDefault();let t=!1,n=/Linux/.test(window.navigator.platform);i0(this.interactiveCanvas,ea.GRABBING);let{clientX:i,clientY:l}=e,r=SF(e=>{let r=i-e.clientX,a=l-e.clientY;if(i=e.clientX,l=e.clientY,n&&!t&&(Math.abs(r)>1||Math.abs(a)>1)){t=!0;let e=t=>{document.body.removeEventListener("paste",e),t.stopPropagation()},n=()=>{setTimeout(()=>{document.body.removeEventListener("paste",e),window.removeEventListener("pointerup",n)},100)};document.body.addEventListener("paste",e),window.addEventListener("pointerup",n)}this.translateCanvas({scrollX:this.state.scrollX-r/this.state.zoom.value,scrollY:this.state.scrollY-a/this.state.zoom.value})}),a=SB(Cp=()=>{Cp=null,Cr=!1,Cl||(this.state.viewModeEnabled?i0(this.interactiveCanvas,ea.GRAB):i4(this.interactiveCanvas,this.state)),this.setState({cursorButton:"up"}),this.savePointer(e.clientX,e.clientY,"up"),window.removeEventListener("pointermove",r),window.removeEventListener("pointerup",a),window.removeEventListener("blur",a),r.flush()});return window.addEventListener("blur",a),window.addEventListener("pointermove",r,{passive:!0}),window.addEventListener("pointerup",a),!0};updateGestureOnPointerDown(e){Cg.pointers.set(e.pointerId,{x:e.clientX,y:e.clientY}),2===Cg.pointers.size&&(Cg.lastCenter=ys(Cg.pointers),Cg.initialScale=this.state.zoom.value,Cg.initialDistance=yo(Array.from(Cg.pointers.values())))}initialPointerDownState(e){let t=t2(e,this.state),n=this.scene.getSelectedElements(this.state),[i,l,r,a]=m6(n);return{origin:t,withCmdOrCtrl:e[aO.CTRL_OR_CMD],originInGrid:t8(uh(t.x,t.y,e[aO.CTRL_OR_CMD]?null:this.state.gridSize)),scrollbars:fP(Cs,e.clientX-this.state.offsetLeft,e.clientY-this.state.offsetTop),lastCoords:{...t},originalElements:this.scene.getNonDeletedElements().reduce((e,t)=>(e.set(t.id,lg(t)),e),new Map),resize:{handleType:!1,isResizing:!1,offset:{x:0,y:0},arrowDirection:"origin",center:{x:(r+i)/2,y:(a+l)/2}},hit:{element:null,allHitElements:[],wasAddedToSelection:!1,hasBeenDuplicated:!1,hasHitCommonBoundingBoxOfSelectedElements:this.isHittingCommonBoundingBoxOfSelectedElements(t,n)},drag:{hasOccurred:!1,offset:null},eventListeners:{onMove:null,onUp:null,onKeyUp:null,onKeyDown:null},boxSelection:{hasOccurred:!1}}}handleDraggingScrollBar(e,t){if(!(t.scrollbars.isOverEither&&!this.state.multiElement))return!1;Ca=!0,t.lastCoords.x=e.clientX,t.lastCoords.y=e.clientY;let n=SF(e=>{e.target instanceof HTMLElement&&this.handlePointerMoveOverScrollbars(e,t)}),i=SB(()=>{Cp=null,Ca=!1,i4(this.interactiveCanvas,this.state),this.setState({cursorButton:"up"}),this.savePointer(e.clientX,e.clientY,"up"),window.removeEventListener("pointermove",n),window.removeEventListener("pointerup",i),n.flush()});return Cp=i,window.addEventListener("pointermove",n),window.addEventListener("pointerup",i),!0}clearSelectionIfNotUsingSelection=()=>{"selection"!==this.state.activeTool.type&&this.setState({selectedElementIds:gY({},this.state),selectedGroupIds:{},editingGroupId:null,activeEmbeddable:null})};handleSelectionOnPointerDown=(e,t)=>{if("selection"===this.state.activeTool.type){let n=this.scene.getNonDeletedElements(),i=this.scene.getSelectedElements(this.state);if(1!==i.length||this.state.editingLinearElement)i.length>1&&(t.resize.handleType=fe(m6(i),t.origin.x,t.origin.y,this.state.zoom,e.pointerType));else{let i=g9(n,this.state,t.origin.x,t.origin.y,this.state.zoom,e.pointerType);null!=i&&(this.setState({resizingElement:i.element}),t.resize.handleType=i.transformHandleType)}if(t.resize.handleType)t.resize.isResizing=!0,t.resize.offset=t8(fp(t.resize.handleType,i,t.origin.x,t.origin.y)),1===i.length&&nN(i[0])&&2===i[0].points.length&&(t.resize.arrowDirection=fg(t.resize.handleType,i[0]));else{if(this.state.selectedLinearElement){let n=this.state.editingLinearElement||this.state.selectedLinearElement,i=o2.handlePointerDown(e,this.state,this.history,t.origin,n);if(i.hitElement&&(t.hit.element=i.hitElement),i.linearElementEditor&&(this.setState({selectedLinearElement:i.linearElementEditor}),this.state.editingLinearElement&&this.setState({editingLinearElement:i.linearElementEditor})),i.didAddPoint)return!0}if(t.hit.element=t.hit.element??this.getElementAtPosition(t.origin.x,t.origin.y),t.hit.element&&this.getElementLinkAtPosition({x:t.origin.x,y:t.origin.y},t.hit.element))return!1;t.hit.allHitElements=this.getElementsAtPosition(t.origin.x,t.origin.y);let n=t.hit.element,i=t.hit.allHitElements.some(e=>this.isASelectedElement(e));if(null!==n&&i||e.shiftKey||t.hit.hasHitCommonBoundingBoxOfSelectedElements||this.clearSelection(n),this.state.editingLinearElement)this.setState({selectedElementIds:gY({[this.state.editingLinearElement.elementId]:!0},this.state)});else if(null!=n){if(e[aO.CTRL_OR_CMD])return this.state.selectedElementIds[n.id]||(t.hit.wasAddedToSelection=!0),this.setState(e=>({...iB(e,n),previousSelectedElementIds:this.state.selectedElementIds})),!1;!this.state.selectedElementIds[n.id]&&(this.state.editingGroupId&&!iF(n,this.state.editingGroupId)&&this.setState({selectedElementIds:gY({},this.state),selectedGroupIds:{},editingGroupId:null,activeEmbeddable:null}),i||t.hit.hasHitCommonBoundingBoxOfSelectedElements||(this.setState(e=>{let t={...e.selectedElementIds,[n.id]:!0},i=[];if(Object.keys(e.selectedElementIds).forEach(e=>{let t=this.scene.getElement(e);t&&i.push(t)}),nP(n))gM(i,n.id).forEach(e=>{delete t[e.id]});else if(n.frameId)t[n.frameId]&&delete t[n.id];else{let e=n.groupIds,l=new Set(e.flatMap(e=>i$(this.scene.getNonDeletedElements(),e)).filter(e=>nP(e)).map(e=>e.id));l.size>0&&i.forEach(e=>{e.frameId&&l.has(e.frameId)&&(delete t[e.id],e.groupIds.flatMap(e=>i$(this.scene.getNonDeletedElements(),e)).forEach(e=>{delete t[e.id]}))})}return{...iR({editingGroupId:e.editingGroupId,selectedElementIds:t},this.scene.getNonDeletedElements(),e,this),showHyperlinkPopup:!!(n.link||nM(n))&&"info"}}),t.hit.wasAddedToSelection=!0))}this.setState({previousSelectedElementIds:this.state.selectedElementIds})}}return!1};isASelectedElement(e){return null!=e&&this.state.selectedElementIds[e.id]}isHittingCommonBoundingBoxOfSelectedElements(e,t){if(t.length<2)return!1;let n=10/this.state.zoom.value,[i,l,r,a]=m6(t);return e.x>i-n&&e.x<r+n&&e.y>l-n&&e.y<a+n}handleTextOnPointerDown=(e,t)=>{if(nL(this.state.editingElement))return;let n=t.origin.x,i=t.origin.y,l=this.getElementAtPosition(n,i,{includeBoundTextElement:!0}),r=hJ(this.scene.getNonDeletedElements(),this.state,n,i);nW(l)&&(r=l,n=l.x+l.width/2,i=l.y+l.height/2),this.startTextEditing({sceneX:n,sceneY:i,insertAtParentCenter:!e.altKey,container:r}),i1(this.interactiveCanvas),this.state.activeTool.locked||this.setState({activeTool:t1(this.state,{type:"selection"})})};handleFreeDrawElementOnPointerDown=(e,t,n)=>{let[i,l]=uh(n.origin.x,n.origin.y,null),r=this.getTopLayerFrameAtSceneCoords({x:i,y:l}),a=lh({type:t,x:i,y:l,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,opacity:this.state.currentItemOpacity,roundness:null,simulatePressure:.5===e.pressure,locked:!1,frameId:r?r.id:null});this.setState(e=>{let t={...e.selectedElementIds};return delete t[a.id],{selectedElementIds:gY(t,e)}});let s=a.simulatePressure?a.pressures:[...a.pressures,e.pressure];gQ(a,{points:[[0,0]],pressures:s});let o=oO(n.origin,this.scene);this.scene.addNewElement(a),this.setState({draggingElement:a,editingElement:a,startBoundElement:o,suggestedBindings:[]})};insertIframeElement=({sceneX:e,sceneY:t,width:n,height:i})=>{let[l,r]=uh(e,t,this.lastPointerDownEvent?.[aO.CTRL_OR_CMD]?null:this.state.gridSize),a=li({type:"iframe",x:l,y:r,strokeColor:"transparent",backgroundColor:"transparent",fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,roundness:this.getCurrentItemRoundness("iframe"),opacity:this.state.currentItemOpacity,locked:!1,width:n,height:i});return this.scene.replaceAllElements([...this.scene.getElementsIncludingDeleted(),a]),a};insertEmbeddableElement=({sceneX:e,sceneY:t,link:n})=>{let[i,l]=uh(e,t,this.lastPointerDownEvent?.[aO.CTRL_OR_CMD]?null:this.state.gridSize),r=lA(n);if(!r)return;r.warning&&this.setToast({message:r.warning,closable:!0});let a=ln({type:"embeddable",x:i,y:l,strokeColor:"transparent",backgroundColor:"transparent",fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,roundness:this.getCurrentItemRoundness("embeddable"),opacity:this.state.currentItemOpacity,locked:!1,width:r.intrinsicSize.w,height:r.intrinsicSize.h,link:n});return this.scene.replaceAllElements([...this.scene.getElementsIncludingDeleted(),a]),a};createImageElement=({sceneX:e,sceneY:t,addToFrameUnderCursor:n=!0})=>{let[i,l]=uh(e,t,this.lastPointerDownEvent?.[aO.CTRL_OR_CMD]?null:this.state.gridSize),r=n?this.getTopLayerFrameAtSceneCoords({x:i,y:l}):null;return lu({type:"image",x:i,y:l,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,roundness:null,opacity:this.state.currentItemOpacity,locked:!1,frameId:r?r.id:null})};handleLinearElementOnPointerDown=(e,t,n)=>{if(this.state.multiElement){let{multiElement:e}=this.state;if("line"===e.type&&ua(e.points,this.state.zoom.value)){gQ(e,{lastCommittedPoint:e.points[e.points.length-1]}),this.actionManager.executeAction(xc);return}let{x:t,y:i,lastCommittedPoint:l}=e;if(e.points.length>1&&l&&ul(n.origin.x-t,n.origin.y-i,l[0],l[1])<et){this.actionManager.executeAction(xc);return}this.setState(t=>({selectedElementIds:gY({...t.selectedElementIds,[e.id]:!0},t)})),gQ(e,{lastCommittedPoint:e.points[e.points.length-1]}),i0(this.interactiveCanvas,ea.POINTER)}else{let[i,l]=uh(n.origin.x,n.origin.y,e[aO.CTRL_OR_CMD]?null:this.state.gridSize),r=this.getTopLayerFrameAtSceneCoords({x:i,y:l}),{currentItemStartArrowhead:a,currentItemEndArrowhead:s}=this.state,[o,d]="arrow"===t?[a,s]:[null,null],c=lm({type:t,x:i,y:l,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,opacity:this.state.currentItemOpacity,roundness:"round"===this.state.currentItemRoundness?{type:e5.PROPORTIONAL_RADIUS}:null,startArrowhead:o,endArrowhead:d,locked:!1,frameId:r?r.id:null});this.setState(e=>{let t={...e.selectedElementIds};return delete t[c.id],{selectedElementIds:gY(t,e)}}),gQ(c,{points:[...c.points,[0,0]]});let h=oO(n.origin,this.scene);this.scene.addNewElement(c),this.setState({draggingElement:c,editingElement:c,startBoundElement:h,suggestedBindings:[]})}};getCurrentItemRoundness(e){return"round"===this.state.currentItemRoundness?{type:nG(e)?e5.ADAPTIVE_RADIUS:e5.PROPORTIONAL_RADIUS}:null}createGenericElementOnPointerDown=(e,t)=>{let[n,i]=uh(t.origin.x,t.origin.y,this.lastPointerDownEvent?.[aO.CTRL_OR_CMD]?null:this.state.gridSize),l=this.getTopLayerFrameAtSceneCoords({x:n,y:i}),r={x:n,y:i,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,opacity:this.state.currentItemOpacity,roundness:this.getCurrentItemRoundness(e),locked:!1,frameId:l?l.id:null},a;"selection"===(a="embeddable"===e?ln({type:"embeddable",...r}):lt({type:e,...r})).type?this.setState({selectionElement:a,draggingElement:a}):(this.scene.addNewElement(a),this.setState({multiElement:null,draggingElement:a,editingElement:a}))};createFrameElementOnPointerDown=(e,t)=>{let[n,i]=uh(e.origin.x,e.origin.y,this.lastPointerDownEvent?.[aO.CTRL_OR_CMD]?null:this.state.gridSize),l={x:n,y:i,opacity:this.state.currentItemOpacity,locked:!1,...eg},r=t===tl.magicframe?lr(l):ll(l);this.scene.replaceAllElements([...this.scene.getElementsIncludingDeleted(),r]),this.setState({multiElement:null,draggingElement:r,editingElement:r})};maybeCacheReferenceSnapPoints(e,t,n=!1){Sf({event:e,appState:this.state,selectedElements:t})&&(n||!Sg.getReferenceSnapPoints())&&Sg.setReferenceSnapPoints(SE(this.scene.getNonDeletedElements(),t,this.state))}maybeCacheVisibleGaps(e,t,n=!1){Sf({event:e,appState:this.state,selectedElements:t})&&(n||!Sg.getVisibleGaps())&&Sg.setVisibleGaps(Sv(this.scene.getNonDeletedElements(),t,this.state))}onKeyDownFromPointerDownHandler(e){return SB(t=>{this.maybeHandleResize(e,t)||this.maybeDragNewGenericElement(e,t)})}onKeyUpFromPointerDownHandler(e){return SB(t=>{t.key===aO.ALT&&t.preventDefault(),this.maybeHandleResize(e,t)||this.maybeDragNewGenericElement(e,t)})}onPointerMoveFromPointerDownHandler(e){return SF(t=>{if(null===e.drag.offset&&(e.drag.offset=t8(fb(this.scene.getSelectedElements(this.state),e.origin.x,e.origin.y))),!(t.target instanceof HTMLElement)||this.handlePointerMoveOverScrollbars(t,e))return;let n=t2(t,this.state);if(n2(this.state)){this.handleEraser(t,e,n);return}"laser"===this.state.activeTool.type&&this.laserTrails.addPointToPath(n.x,n.y);let[i,l]=uh(n.x,n.y,t[aO.CTRL_OR_CMD]?null:this.state.gridSize);if(!e.drag.hasOccurred&&("arrow"===this.state.activeTool.type||"line"===this.state.activeTool.type)&&ul(n.x,n.y,e.origin.x,e.origin.y)<ee)return;if(e.resize.isResizing&&(e.lastCoords.x=n.x,e.lastCoords.y=n.y,this.maybeHandleResize(e,t)))return!0;if(this.state.selectedLinearElement){let i=this.state.editingLinearElement||this.state.selectedLinearElement;if(o2.shouldAddMidpoint(this.state.selectedLinearElement,n,this.state)){let e=o2.addMidpoint(this.state.selectedLinearElement,n,this.state,!t[aO.CTRL_OR_CMD]);if(!e)return;(0,tc.flushSync)(()=>{this.state.selectedLinearElement&&this.setState({selectedLinearElement:{...this.state.selectedLinearElement,pointerDownState:e.pointerDownState,selectedPointsIndices:e.selectedPointsIndices}}),this.state.editingLinearElement&&this.setState({editingLinearElement:{...this.state.editingLinearElement,pointerDownState:e.pointerDownState,selectedPointsIndices:e.selectedPointsIndices}})});return}if(null!==i.pointerDownState.segmentMidpoint.value&&!i.pointerDownState.segmentMidpoint.added)return;if(o2.handlePointDragging(t,this.state,n.x,n.y,(e,t)=>{this.maybeSuggestBindingsForLinearElementAtCoords(e,t)},i)){e.lastCoords.x=n.x,e.lastCoords.y=n.y,e.drag.hasOccurred=!0,this.state.editingLinearElement&&!this.state.editingLinearElement.isDragging&&this.setState({editingLinearElement:{...this.state.editingLinearElement,isDragging:!0}}),this.state.selectedLinearElement.isDragging||this.setState({selectedLinearElement:{...this.state.selectedLinearElement,isDragging:!0}});return}}let r=e.hit.allHitElements.some(e=>this.isASelectedElement(e)),a=this.state.editingLinearElement&&t.shiftKey&&this.state.editingLinearElement.elementId===e.hit.element?.id;if((r||e.hit.hasHitCommonBoundingBoxOfSelectedElements)&&!a){let i=this.scene.getSelectedElements(this.state);if(i.every(e=>e.locked))return;let l=i.find(e=>nP(e)),r=this.getTopLayerFrameAtSceneCoords(n);if(this.setState({frameToHighlight:r&&!l?r:null}),e.drag.hasOccurred=!0,this.setState({selectedElementsAreBeingDragged:!0}),i.length>0&&!e.withCmdOrCtrl&&!this.state.editingElement&&this.state.activeEmbeddable?.state!=="active"){let l={x:n.x-e.origin.x,y:n.y-e.origin.y},r=[...e.originalElements.values()],a=t.shiftKey;if(a){let e=Math.abs(l.x),t=Math.abs(l.y);a&&e<t&&(l.x=0),a&&e>t&&(l.y=0)}this.maybeCacheVisibleGaps(t,i),this.maybeCacheReferenceSnapPoints(t,i);let{snapOffset:s,snapLines:o}=Sk(gV(r,this.state),l,this.state,t);if(this.setState({snapLines:o}),this.state.editingFrame||ff(e,i,l,this.state,this.scene,s,t[aO.CTRL_OR_CMD]?null:this.state.gridSize),this.maybeSuggestBindingForAll(i),t.altKey&&!e.hit.hasBeenDuplicated){e.hit.hasBeenDuplicated=!0;let n=[],l=[],r=new Map,a=new Map,s=e.hit.element,o=new Set(this.scene.getSelectedElements({selectedElementIds:this.state.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0}).map(e=>e.id));for(let t of this.scene.getElementsIncludingDeleted())if(o.has(t.id)||t.id===s?.id&&e.hit.wasAddedToSelection){let i=lx(this.state.editingGroupId,r,t),s=e.originalElements.get(t.id);gQ(i,{x:s.x,y:s.y}),e.originalElements.set(i.id,i),n.push(i),l.push(t),a.set(t.id,i.id)}else n.push(t);let d=[...n,...l];hI(n,l,a),oX(d,l,a,"duplicatesServeAsOld"),gv(d,l,a),this.scene.replaceAllElements(d),this.maybeCacheVisibleGaps(t,i,!0),this.maybeCacheReferenceSnapPoints(t,i,!0)}return}}let s=this.state.draggingElement;if(s){if("freedraw"===s.type){let e=s.points,i=n.x-s.x,l=n.y-s.y,r=e.length>0&&e[e.length-1];if(!(r&&r[0]===i&&r[1]===l)){let n=s.simulatePressure?s.pressures:[...s.pressures,t.pressure];gQ(s,{points:[...e,[i,l]],pressures:n})}}else if(nN(s)){e.drag.hasOccurred=!0,this.setState({selectedElementsAreBeingDragged:!0});let r=s.points,a=i-s.x,o=l-s.y;aF(t)&&2===r.length&&({width:a,height:o}=g4(s.x,s.y,n.x,n.y)),1===r.length?gQ(s,{points:[...r,[a,o]]}):2===r.length&&gQ(s,{points:[...r.slice(0,-1),[a,o]]}),nH(s,!1)&&this.maybeSuggestBindingsForLinearElementAtCoords(s,[n],this.state.startBoundElement)}else e.lastCoords.x=n.x,e.lastCoords.y=n.y,this.maybeDragNewGenericElement(e,t);if("selection"===this.state.activeTool.type){e.boxSelection.hasOccurred=!0;let n=this.scene.getNonDeletedElements();if(this.state.editingLinearElement)o2.handleBoxSelection(t,this.state,this.setState.bind(this));else{let i=!0;!t.shiftKey&&gU(n,this.state)&&(e.withCmdOrCtrl&&e.hit.element?this.setState(t=>iR({...t,selectedElementIds:{[e.hit.element.id]:!0}},this.scene.getNonDeletedElements(),t,this)):i=!1);let l=gZ(n,s);this.setState(t=>{let n={...i&&t.selectedElementIds,...l.reduce((e,t)=>(e[t.id]=!0,e),{})};return e.hit.element&&(l.length?delete n[e.hit.element.id]:n[e.hit.element.id]=!0),t=i?t:{...t,selectedGroupIds:{},editingGroupId:null},{...iR({editingGroupId:t.editingGroupId,selectedElementIds:n},this.scene.getNonDeletedElements(),t,this),selectedLinearElement:1===l.length&&nN(l[0])?new o2(l[0],this.scene):null,showHyperlinkPopup:!!(1===l.length&&(l[0].link||nM(l[0])))&&"info"}})}}}})}handlePointerMoveOverScrollbars(e,t){if(t.scrollbars.isOverHorizontal){let n=e.clientX,i=n-t.lastCoords.x;return this.translateCanvas({scrollX:this.state.scrollX-i/this.state.zoom.value}),t.lastCoords.x=n,!0}if(t.scrollbars.isOverVertical){let n=e.clientY,i=n-t.lastCoords.y;return this.translateCanvas({scrollY:this.state.scrollY-i/this.state.zoom.value}),t.lastCoords.y=n,!0}return!1}onPointerUpFromPointerDownHandler(e){return SB(t=>{this.removePointer(t),e.eventListeners.onMove&&e.eventListeners.onMove.flush();let{draggingElement:n,resizingElement:i,multiElement:l,activeTool:r,isResizing:a,isRotating:s}=this.state;if(this.setState(e=>({isResizing:!1,isRotating:!1,resizingElement:null,selectionElement:null,frameToHighlight:null,elementsToHighlight:null,cursorButton:"up",editingElement:l||nL(this.state.editingElement)?this.state.editingElement:null,snapLines:nE(e.snapLines,[]),originSnapOffset:null})),Sg.setReferenceSnapPoints(null),Sg.setVisibleGaps(null),this.savePointer(t.clientX,t.clientY,"up"),this.setState({selectedElementsAreBeingDragged:!1}),this.state.editingLinearElement){if(e.boxSelection.hasOccurred||e.hit?.element?.id===this.state.editingLinearElement.elementId){let e=o2.handlePointerUp(t,this.state.editingLinearElement,this.state);e!==this.state.editingLinearElement&&this.setState({editingLinearElement:e,suggestedBindings:[]})}else this.actionManager.executeAction(xc)}else if(this.state.selectedLinearElement){if(e.hit?.element?.id!==this.state.selectedLinearElement.elementId)this.scene.getSelectedElements(this.state).length>1&&this.setState({selectedLinearElement:null});else{let e=o2.handlePointerUp(t,this.state.selectedLinearElement,this.state),{startBindingElement:n,endBindingElement:i}=e,l=this.scene.getElement(e.elementId);nH(l)&&oM(l,n,i),e!==this.state.selectedLinearElement&&this.setState({selectedLinearElement:{...e,selectedPointsIndices:null},suggestedBindings:[]})}}if(this.missingPointerEventCleanupEmitter.clear(),window.removeEventListener("pointermove",e.eventListeners.onMove),window.removeEventListener("pointerup",e.eventListeners.onUp),window.removeEventListener("keydown",e.eventListeners.onKeyDown),window.removeEventListener("keyup",e.eventListeners.onKeyUp),this.state.pendingImageElementId&&this.setState({pendingImageElementId:null}),this.onPointerUpEmitter.trigger(this.state.activeTool,e,t),n?.type==="freedraw"){let e=t2(t,this.state),i=n.points,l=e.x-n.x,r=e.y-n.y;l===i[0][0]&&r===i[0][1]&&(r+=1e-4,l+=1e-4);let a=n.simulatePressure?[]:[...n.pressures,t.pressure];gQ(n,{points:[...i,[l,r]],pressures:a,lastCommittedPoint:[l,r]}),this.actionManager.executeAction(xc);return}if(nI(n)){try{this.initializeImageDimensions(n),this.setState({selectedElementIds:gY({[n.id]:!0},this.state)},()=>{this.actionManager.executeAction(xc)})}catch(e){console.error(e),this.scene.replaceAllElements(this.scene.getElementsIncludingDeleted().filter(e=>e.id!==n.id)),this.actionManager.executeAction(xc)}return}if(nN(n)){n.points.length>1&&this.history.resumeRecording();let i=t2(t,this.state);e.drag.hasOccurred||!n||l?e.drag.hasOccurred&&!l&&(oC(this.state)&&nH(n,!1)&&oD(n,this.state,this.scene,i),this.setState({suggestedBindings:[],startBoundElement:null}),r.locked?this.setState(e=>({draggingElement:null})):(i1(this.interactiveCanvas),this.setState(e=>({draggingElement:null,activeTool:t1(this.state,{type:"selection"}),selectedElementIds:gY({...e.selectedElementIds,[n.id]:!0},e),selectedLinearElement:new o2(n,this.scene)})))):(gQ(n,{points:[...n.points,[i.x-n.x,i.y-n.y]]}),this.setState({multiElement:n,editingElement:this.state.draggingElement}));return}if("selection"!==r.type&&n&&g2(n)){this.scene.replaceAllElements(this.scene.getElementsIncludingDeleted().filter(e=>e.id!==n.id)),this.setState({draggingElement:null});return}if(n){if(e.drag.hasOccurred){let e=t2(t,this.state);if(this.state.selectedLinearElement&&this.state.selectedLinearElement.isDragging){let e=this.scene.getElement(this.state.selectedLinearElement.elementId);if(e?.frameId){let t=gA(e);t&&e&&(gk(e,t)||(gQ(e,{groupIds:[]}),this.scene.replaceAllElements(g_(this.scene.getElementsIncludingDeleted(),[e],this.state))))}}else{let t=this.getTopLayerFrameAtSceneCoords(e),n=this.scene.getSelectedElements(this.state),i=this.scene.getElementsIncludingDeleted(),l=e=>{if(e.length>0){for(let t of e){let e=t.groupIds.indexOf(this.state.editingGroupId);gQ(t,{groupIds:t.groupIds.slice(0,e)},!1)}i.forEach(e=>{e.groupIds.length&&i$(i,e.groupIds[e.groupIds.length-1]).length<2&&gQ(e,{groupIds:[]},!1)}),this.setState({editingGroupId:null})}};if(t&&!this.state.selectedElementIds[t.id]){let e=n.filter(e=>e.frameId!==t.id&&gB(e,i,this.state));this.state.editingGroupId&&l(e),i=gP(i,e,t)}else!t&&this.state.editingGroupId&&l(n.filter(e=>e.frameId&&!gB(e,i,this.state)));i=gO(i,this.state,this),this.scene.replaceAllElements(i)}}if(nP(n)){let e=gD(this.scene.getElementsIncludingDeleted(),n);this.scene.replaceAllElements(gP(this.scene.getElementsIncludingDeleted(),e,n))}gQ(n,g5(n))}if(i&&this.history.resumeRecording(),i&&g2(i)&&this.scene.replaceAllElements(this.scene.getElementsIncludingDeleted().filter(e=>e.id!==i.id)),e.resize.isResizing){let e=gO(this.scene.getElementsIncludingDeleted(),this.state,this);for(let t of this.scene.getSelectedElements(this.state).filter(e=>nP(e)))e=gN(e,gL(this.scene.getElementsIncludingDeleted(),t,this.state),t,this.state);this.scene.replaceAllElements(e)}let o=e.hit.element;this.state.selectedLinearElement?.elementId!==o?.id&&nN(o)&&1===this.scene.getSelectedElements(this.state).length&&this.setState({selectedLinearElement:new o2(o,this.scene)});let d=this.lastPointerDownEvent,c=this.lastPointerUpEvent||this.lastPointerMoveEvent;if(n2(this.state)&&d&&c){if(this.eraserTrail.endPath(),0===ul(d.clientX,d.clientY,c.clientX,c.clientY)){let e=t2({clientX:c.clientX,clientY:c.clientY},this.state);this.getElementsAtPosition(e.x,e.y).forEach(e=>this.elementsPendingErasure.add(e.id))}this.eraseElements();return}if(this.elementsPendingErasure.size&&this.restoreReadyToEraseElements(),!o||e.drag.hasOccurred||e.hit.wasAddedToSelection||this.state.editingLinearElement&&e.boxSelection.hasOccurred||(t.shiftKey&&!this.state.editingLinearElement?this.state.selectedElementIds[o.id]?iN(this.state,o)?this.setState(e=>{let t={...e.selectedElementIds};for(let e of o.groupIds.flatMap(e=>i$(this.scene.getNonDeletedElements(),e)))delete t[e.id];return{selectedGroupIds:{...e.selectedElementIds,...o.groupIds.map(e=>({[e]:!1})).reduce((e,t)=>({...e,...t}),{})},selectedElementIds:gY(t,e)}}):this.state.selectedLinearElement?.isDragging||this.setState(e=>{let t={...e.selectedElementIds};delete t[o.id];let n=gV(this.scene.getNonDeletedElements(),{selectedElementIds:t});return{...iR({editingGroupId:e.editingGroupId,selectedElementIds:t},this.scene.getNonDeletedElements(),e,this),selectedLinearElement:1===n.length&&nN(n[0])?new o2(n[0],this.scene):e.selectedLinearElement}}):o.frameId&&this.state.selectedElementIds[o.frameId]?this.setState(e=>{let t={...e.selectedElementIds,[o.id]:!0};return delete t[o.frameId],(this.scene.getElement(o.frameId)?.groupIds??[]).flatMap(e=>i$(this.scene.getNonDeletedElements(),e)).forEach(e=>{delete t[e.id]}),{...iR({editingGroupId:e.editingGroupId,selectedElementIds:t},this.scene.getNonDeletedElements(),e,this),showHyperlinkPopup:!!(o.link||nM(o))&&"info"}}):this.setState(e=>({selectedElementIds:gY({...e.selectedElementIds,[o.id]:!0},e)})):this.setState(e=>({...iR({editingGroupId:e.editingGroupId,selectedElementIds:{[o.id]:!0}},this.scene.getNonDeletedElements(),e,this),selectedLinearElement:nN(o)&&e.selectedLinearElement?.elementId!==o.id?new o2(o,this.scene):e.selectedLinearElement}))),!e.drag.hasOccurred&&!this.state.isResizing&&(o&&sq(o,this.state,this.frameNameBoundsCache,e.origin.x,e.origin.y)||!o&&e.hit.hasHitCommonBoundingBoxOfSelectedElements)){this.state.editingLinearElement?this.setState({editingLinearElement:null}):this.setState({selectedElementIds:gY({},this.state),selectedGroupIds:{},editingGroupId:null,activeEmbeddable:null});return}if(!r.locked&&"freedraw"!==r.type&&n&&"selection"!==n.type&&this.setState(e=>({selectedElementIds:gY({...e.selectedElementIds,[n.id]:!0},e),showHyperlinkPopup:nM(n)&&!n.link?"editor":e.showHyperlinkPopup})),("selection"!==r.type||gU(this.scene.getNonDeletedElements(),this.state))&&this.history.resumeRecording(),(e.drag.hasOccurred||a||s)&&(oC(this.state)?oT:oR)(this.scene.getSelectedElements(this.state)),"laser"===r.type){this.laserTrails.endPath();return}r.locked||"freedraw"===r.type?this.setState({draggingElement:null,suggestedBindings:[]}):(i1(this.interactiveCanvas),this.setState({draggingElement:null,suggestedBindings:[],activeTool:t1(this.state,{type:"selection"})})),o&&this.lastPointerUpEvent&&this.lastPointerDownEvent&&this.lastPointerUpEvent.timeStamp-this.lastPointerDownEvent.timeStamp<300&&Cg.pointers.size<=1&&nT(o)&&this.isIframeLikeElementCenter(o,this.lastPointerUpEvent,e.origin.x,e.origin.y)&&this.handleEmbeddableCenterClick(o)})}restoreReadyToEraseElements=()=>{this.elementsPendingErasure=new Set,this.onSceneUpdated()};eraseElements=()=>{let e=!1,t=this.scene.getElementsIncludingDeleted().map(t=>this.elementsPendingErasure.has(t.id)||t.frameId&&this.elementsPendingErasure.has(t.frameId)||nU(t)&&this.elementsPendingErasure.has(t.containerId)?(e=!0,g1(t,{isDeleted:!0})):t);this.elementsPendingErasure=new Set,e&&(this.history.resumeRecording(),this.scene.replaceAllElements(t))};initializeImage=async({imageFile:e,imageElement:t,showCursorImagePreview:n=!1})=>{if(!pi(e))throw Error(C("errors.unsupportedFileType"));let i=e.type;if(i0(this.interactiveCanvas,"wait"),i===eC.svg)try{e=pu(await pP(await e.text()),e.name)}catch(e){throw console.warn(e),Error(C("errors.svgImageInsertError"))}let l=await (this.props.generateIdForFile?.(e)||pd(e));if(!l)throw console.warn("Couldn't generate file id or the supplied `generateIdForFile` didn't resolve to one."),Error(C("errors.imageInsertError"));if(!this.files[l]?.dataURL){try{e=await pm(e,{maxWidthOrHeight:eK})}catch(e){console.error("Error trying to resizing image file on insertion",e)}if(e.size>eY)throw Error(C("errors.fileTooBig",{maxSize:`${Math.trunc(eY/1024/1024)}MB`}))}if(n){let t=this.files[l]?.dataURL,n=t&&ph(t);this.setImagePreviewCursor(n||e)}let r=this.files[l]?.dataURL||await pc(e),a=gQ(t,{fileId:l},!1);return new Promise(async(e,t)=>{try{this.files={...this.files,[l]:{mimeType:i,id:l,dataURL:r,created:Date.now(),lastRetrieved:Date.now()}};let t=this.imageCache.get(l);t||(this.addNewImagesToImageCache(),await this.updateImageCache([a])),t?.image instanceof Promise&&await t.image,this.state.pendingImageElementId!==a.id&&this.state.draggingElement?.id!==a.id&&this.initializeImageDimensions(a,!0),e(a)}catch(e){console.error(e),t(Error(C("errors.imageInsertError")))}finally{n||i1(this.interactiveCanvas)}})};insertImageElement=async(e,t,n)=>{if(!this.isToolSupported("image")){this.setState({errorMessage:C("errors.imageToolNotSupported")});return}this.scene.addNewElement(e);try{return await this.initializeImage({imageFile:t,imageElement:e,showCursorImagePreview:n})}catch(t){return gQ(e,{isDeleted:!0}),this.actionManager.executeAction(xc),this.setState({errorMessage:t.message||C("errors.imageInsertError")}),null}};setImagePreviewCursor=async e=>{let t=await pm(e,{maxWidthOrHeight:96}),n=await pc(t);if(e.type===eC.svg){let e=await pT(n),t=Math.min(e.height,96),i=e.width/e.height*t;i>96&&(i=96,t=e.height/e.width*i);let l=document.createElement("canvas");l.height=t,l.width=i,l.getContext("2d").drawImage(e,0,0,i,t),n=l.toDataURL(eC.svg)}this.state.pendingImageElementId&&i0(this.interactiveCanvas,`url(${n}) 4 4, auto`)};onImageAction=async({insertOnCanvasDirectly:e})=>{try{let t=this.state.width/2+this.state.offsetLeft,n=this.state.height/2+this.state.offsetTop,{x:i,y:l}=t2({clientX:t,clientY:n},this.state),r=await uk({description:"Image",extensions:Object.keys(eS)}),a=this.createImageElement({sceneX:i,sceneY:l,addToFrameUnderCursor:!1});e?(this.insertImageElement(a,r),this.initializeImageDimensions(a),this.setState({selectedElementIds:gY({[a.id]:!0},this.state)},()=>{this.actionManager.executeAction(xc)})):this.setState({pendingImageElementId:a.id},()=>{this.insertImageElement(a,r,!0)})}catch(e){"AbortError"!==e.name?console.error(e):console.warn(e),this.setState({pendingImageElementId:null,editingElement:null,activeTool:t1(this.state,{type:"selection"})},()=>{this.actionManager.executeAction(xc)})}};initializeImageDimensions=(e,t=!1)=>{let n=nC(e)&&this.imageCache.get(e.fileId)?.image;if(!n||n instanceof Promise){if(e.width<ee/this.state.zoom.value&&e.height<ee/this.state.zoom.value){let t=100/this.state.zoom.value;gQ(e,{x:e.x-t/2,y:e.y-t/2,width:t,height:t})}return}if(t||e.width<ee/this.state.zoom.value&&e.height<ee/this.state.zoom.value){let t=Math.min(Math.max(this.state.height-120,160),Math.floor(.5*this.state.height)/this.state.zoom.value),i=Math.min(n.naturalHeight,t),l=n.naturalWidth/n.naturalHeight*i,r=e.x+e.width/2-l/2,a=e.y+e.height/2-i/2;gQ(e,{x:r,y:a,width:l,height:i})}};updateImageCache=async(e,t=this.files)=>{let{updatedFiles:n,erroredFiles:i}=await pL({imageCache:this.imageCache,fileIds:e.map(e=>e.fileId),files:t});if(n.size||i.size)for(let t of e)n.has(t.fileId)&&sK.delete(t);return i.size&&this.scene.replaceAllElements(this.scene.getElementsIncludingDeleted().map(e=>nC(e)&&i.has(e.fileId)?g1(e,{status:"error"}):e)),{updatedFiles:n,erroredFiles:i}};addNewImagesToImageCache=async(e=pD(this.scene.getNonDeletedElements()),t=this.files)=>{let n=e.filter(e=>!e.isDeleted&&!this.imageCache.has(e.fileId));if(n.length){let{updatedFiles:e}=await this.updateImageCache(n,t);e.size&&this.scene.informMutation()}};scheduleImageRefresh=tv(()=>{this.addNewImagesToImageCache()},eT);updateBindingEnabledOnPointerMove=e=>{let t=ok(e);this.state.isBindingEnabled!==t&&this.setState({isBindingEnabled:t})};maybeSuggestBindingAtCursor=e=>{let t=oO(e,this.scene);this.setState({suggestedBindings:null!=t?[t]:[]})};maybeSuggestBindingsForLinearElementAtCoords=(e,t,n)=>{if(!t.length)return;let i=t.reduce((t,i)=>{let l=oO(i,this.scene);return null==l||o_(e,n?.id,l)||t.push(l),t},[]);this.setState({suggestedBindings:i})};maybeSuggestBindingForAll(e){if(e.length>50)return;let t=oW(e);this.setState({suggestedBindings:t})}clearSelection(e){this.setState(t=>({selectedElementIds:gY({},t),activeEmbeddable:null,selectedGroupIds:{},editingGroupId:t.editingGroupId&&null!=e&&iF(e,t.editingGroupId)?t.editingGroupId:null})),this.setState({selectedElementIds:gY({},this.state),activeEmbeddable:null,previousSelectedElementIds:this.state.selectedElementIds})}handleInteractiveCanvasRef=e=>{null!==e?(this.interactiveCanvas=e,this.interactiveCanvas.addEventListener("wheel",this.handleWheel),this.interactiveCanvas.addEventListener("touchstart",this.onTouchStart),this.interactiveCanvas.addEventListener("touchend",this.onTouchEnd)):(this.interactiveCanvas?.removeEventListener("wheel",this.handleWheel),this.interactiveCanvas?.removeEventListener("touchstart",this.onTouchStart),this.interactiveCanvas?.removeEventListener("touchend",this.onTouchEnd))};handleAppOnDrop=async e=>{let{file:t,fileHandle:n}=await pg(e),{x:i,y:l}=t2(e,this.state);try{if(pi(t)&&this.isToolSupported("image")){if(t?.type===eC.png||t?.type===eC.svg)try{let e=await pr(t,this.state,this.scene.getElementsIncludingDeleted(),n);this.syncActionResult({...e,appState:{...e.appState||this.state,isLoading:!1},replaceFiles:!0,commitToHistory:!0});return}catch(e){if("EncodingError"!==e.name)throw e}let e=this.createImageElement({sceneX:i,sceneY:l});this.insertImageElement(e,t),this.initializeImageDimensions(e),this.setState({selectedElementIds:gY({[e.id]:!0},this.state)});return}}catch(e){return this.setState({isLoading:!1,errorMessage:e.message})}let r=e.dataTransfer.getData(eC.excalidrawlib);if(r&&"string"==typeof r){try{let t=pa(r);this.addElementsFromPasteOrLibrary({elements:gs(t),position:e,files:null})}catch(e){this.setState({errorMessage:e.message})}return}if(t&&await this.loadFileToCanvas(t,n),e.dataTransfer?.types?.includes("text/plain")){let t=e.dataTransfer?.getData("text");if(t&&lO(t,this.props.validateEmbeddable)&&(/^(http|https):\/\/[^\s/$.?#].[^\s]*$/.test(t)||lA(t)?.type==="video")){let e=this.insertEmbeddableElement({sceneX:i,sceneY:l,link:aG(t)});e&&this.setState({selectedElementIds:{[e.id]:!0}})}}};loadFileToCanvas=async(e,t)=>{e=await pb(e);try{let n=await pl(e,this.state,this.scene.getElementsIncludingDeleted(),t);n.type===eC.excalidraw?(this.setState({isLoading:!0}),this.syncActionResult({...n.data,appState:{...n.data.appState||this.state,isLoading:!1},replaceFiles:!0,commitToHistory:!0})):n.type===eC.excalidrawlib&&await this.library.updateLibrary({libraryItems:e,merge:!0,openLibraryMenu:!0}).catch(e=>{console.error(e),this.setState({errorMessage:C("errors.importLibraryError")})})}catch(e){if(e instanceof lB&&"IMAGE_NOT_CONTAINS_SCENE_DATA"===e.code&&!this.isToolSupported("image")){this.setState({isLoading:!1,errorMessage:C("errors.imageToolNotSupported")});return}this.setState({isLoading:!1,errorMessage:e.message})}};handleCanvasContextMenu=e=>{if(e.preventDefault(),("pointerType"in e.nativeEvent&&"touch"===e.nativeEvent.pointerType||"pointerType"in e.nativeEvent&&"pen"===e.nativeEvent.pointerType&&e.button!==es.SECONDARY)&&"selection"!==this.state.activeTool.type)return;let{x:t,y:n}=t2(e,this.state),i=this.getElementAtPosition(t,n,{preferSelected:!0,includeLockedElements:!0}),l=this.scene.getSelectedElements(this.state),r=this.isHittingCommonBoundingBoxOfSelectedElements({x:t,y:n},l),a=i||r?"element":"canvas",{top:s,left:o}=this.excalidrawContainerRef.current.getBoundingClientRect(),d=e.clientX-o,c=e.clientY-s;aX("contextMenu","openContextMenu",a),this.setState({...i&&!this.state.selectedElementIds[i.id]?{...this.state,...iR({editingGroupId:this.state.editingGroupId,selectedElementIds:{[i.id]:!0}},this.scene.getNonDeletedElements(),this.state,this),selectedLinearElement:nN(i)?new o2(i,this.scene):null}:this.state,showHyperlinkPopup:!1},()=>{this.setState({contextMenu:{top:c,left:d,items:this.getContextMenuItems(a)}})})};maybeDragNewGenericElement=(e,t)=>{let n=this.state.draggingElement,i=e.lastCoords;if(n){if("selection"===n.type&&"eraser"!==this.state.activeTool.type)fv(n,this.state.activeTool.type,e.origin.x,e.origin.y,i.x,i.y,tQ(e.origin.x,i.x),tQ(e.origin.y,i.y),aB(t),aH(t));else{let[l,r]=uh(i.x,i.y,t[aO.CTRL_OR_CMD]?null:this.state.gridSize),a=nC(n)&&this.imageCache.get(n.fileId)?.image,s=!a||a instanceof Promise?null:a.width/a.height;this.maybeCacheReferenceSnapPoints(t,[n]);let{snapOffset:o,snapLines:d}=SD(n,this.state,t,{x:e.originInGrid.x+(this.state.originSnapOffset?.x??0),y:e.originInGrid.y+(this.state.originSnapOffset?.y??0)},{x:l-e.originInGrid.x,y:r-e.originInGrid.y});l+=o.x,r+=o.y,this.setState({snapLines:d}),fv(n,this.state.activeTool.type,e.originInGrid.x,e.originInGrid.y,l,r,tQ(e.originInGrid.x,l),tQ(e.originInGrid.y,r),nI(n)?!aB(t):aB(t),aH(t),s,this.state.originSnapOffset),this.maybeSuggestBindingForAll([n]),(this.state.activeTool.type===tl.frame||this.state.activeTool.type===tl.magicframe)&&this.setState({elementsToHighlight:gL(this.scene.getNonDeletedElements(),n,this.state)})}}};maybeHandleResize=(e,t)=>{let n=this.scene.getSelectedElements(this.state),i=n.filter(e=>nP(e)),l=e.resize.handleType;if(i.length>0&&"rotation"===l)return!1;this.setState({isResizing:l&&"rotation"!==l,isRotating:"rotation"===l,activeEmbeddable:null});let r=e.lastCoords,[a,s]=uh(r.x-e.resize.offset.x,r.y-e.resize.offset.y,t[aO.CTRL_OR_CMD]?null:this.state.gridSize),o=new Map;if(i.forEach(e=>{gM(this.scene.getNonDeletedElements(),e.id).forEach(t=>{o.set(e.id+t.id,{x:t.x-e.x,y:t.y-e.y})})}),!this.state.selectedElementsAreBeingDragged){let[i,o]=uh(r.x,r.y,t[aO.CTRL_OR_CMD]?null:this.state.gridSize),d={x:i-e.originInGrid.x,y:o-e.originInGrid.y},c=[...e.originalElements.values()];this.maybeCacheReferenceSnapPoints(t,n);let{snapOffset:h,snapLines:m}=SL(n,gV(c,this.state),this.state,t,d,l);a+=h.x,s+=h.y,this.setState({snapLines:m})}if(fr(e,l,n,e.resize.arrowDirection,aF(t),aH(t),1===n.length&&nI(n[0])?!aB(t):aB(t),a,s,e.resize.center.x,e.resize.center.y,this.state)){this.maybeSuggestBindingForAll(n);let e=new Set;return i.forEach(t=>{gL(this.scene.getNonDeletedElements(),t,this.state).forEach(t=>e.add(t))}),this.setState({elementsToHighlight:[...e]}),!0}return!1};getContextMenuItems=e=>{let t=[];return t.push(xq,xX),"canvas"===e?this.state.viewModeEnabled?[...t,xQ,x1,Sd,x2]:[xK,yf,xq,xX,xJ,yf,xl,ye,yf,xQ,x0,x1,Sd,x2]:(t.push(xJ),this.state.viewModeEnabled?[xV,...t]:[xY,xV,xK,Sm,Su,yf,...t,yf,xM,xj,yf,xA,x3,x6,x8,xP,yf,xR,yf,xe,xt,xn,xi,yf,xZ,xW,yf,yt,a2,xo,x9,yf,fN])};handleWheel=SB(e=>{if(e.preventDefault(),Cr)return;let{deltaX:t,deltaY:n}=e;if(e.metaKey||e.ctrlKey){let e=Math.sign(n),t=100*eP,i=Math.abs(n),l=n;i>t&&(l=t*e);let r=this.state.zoom.value-l/100;r+=-(Math.log10(Math.max(1,this.state.zoom.value))*e)*Math.min(1,i/20),this.translateCanvas(e=>({...cF({viewportX:this.lastViewportPosition.x,viewportY:this.lastViewportPosition.y,nextZoom:cB(r)},e),shouldCacheIgnoreZoom:!0})),this.resetShouldCacheIgnoreZoomDebounced();return}if(e.shiftKey){this.translateCanvas(({zoom:e,scrollX:i})=>({scrollX:i-(n||t)/e.value}));return}this.translateCanvas(({zoom:e,scrollX:i,scrollY:l})=>({scrollX:i-t/e.value,scrollY:l-n/e.value}))});getTextWysiwygSnappedToCenterPosition(e,t,n,i){if(i){let l=i.x+i.width/2,r=i.y+i.height/2,a=hV(i,n);if(a&&(l=a.x,r=a.y),Math.hypot(e-l,t-r)<el){let{x:e,y:t}=t3({sceneX:l,sceneY:r},n);return{viewportX:e,viewportY:t,elementCenterX:l,elementCenterY:r}}}}savePointer=(e,t,n)=>{if(!e||!t)return;let{x:i,y:l}=t2({clientX:e,clientY:t},this.state);isNaN(i)||isNaN(l);let r={x:i,y:l,tool:"laser"===this.state.activeTool.type?"laser":"pointer"};this.props.onPointerUpdate?.({pointer:r,button:n,pointersMap:Cg.pointers})};resetShouldCacheIgnoreZoomDebounced=tV(()=>{this.unmounted||this.setState({shouldCacheIgnoreZoom:!1})},300);updateDOMRect=e=>{if(this.excalidrawContainerRef?.current){let{width:t,height:n,left:i,top:l}=this.excalidrawContainerRef.current.getBoundingClientRect(),{width:r,height:a,offsetTop:s,offsetLeft:o}=this.state;if(t===r&&n===a&&i===o&&l===s){e&&e();return}this.setState({width:t,height:n,offsetLeft:i,offsetTop:l},()=>{e&&e()})}};refresh=()=>{this.setState({...this.getCanvasOffsets()})};getCanvasOffsets(){if(this.excalidrawContainerRef?.current){let{left:e,top:t}=this.excalidrawContainerRef.current.getBoundingClientRect();return{offsetLeft:e,offsetTop:t}}return{offsetLeft:0,offsetTop:0}}async updateLanguage(){let e=y.find(e=>e.code===this.props.langCode)||x;await E(e),this.setAppState({})}},(u.MODE===ec.TEST||u.DEV)&&(window.h=window.h||{},Object.defineProperties(window.h,{elements:{configurable:!0,get(){return this.app?.scene.getElementsIncludingDeleted()},set(e){return this.app?.scene.replaceAllElements(e)}}})),Cx=Cf}),CQ=tC(()=>{}),C1=tC(()=>{}),C0=tC(()=>{}),C2=tC(()=>{tM(),Cy=()=>{Array.prototype.at||Object.defineProperty(Array.prototype,"at",{value:function(e){if((e=Math.trunc(e)||0)<0&&(e+=this.length),!(e<0||e>=this.length))return this[e]},writable:!0,enumerable:!1,configurable:!0}),Element.prototype.replaceChildren||(Element.prototype.replaceChildren=function(...e){this.innerHTML="",this.append(...e)})}}),C3=tC(()=>{}),C6=tC(()=>{tM(),vr(),C3(),d8(),Cv=Cb=({children:e})=>{let{FooterCenterTunnel:t}=yZ(),n=dp();return(0,s.jsx)(t.In,{children:(0,s.jsx)("div",{className:(0,d.Z)("footer-center zen-mode-transition",{"layer-ui__wrapper__footer-left--transition-bottom":n.zenModeEnabled}),children:e})})},Cb.displayName="FooterCenter"}),C4=tC(()=>{}),C5=tC(()=>{tM(),C4(),Cw=()=>(0,s.jsx)("svg",{viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"ExcalidrawLogo-icon",children:(0,s.jsx)("path",{d:"M39.9 32.889a.326.326 0 0 0-.279-.056c-2.094-3.083-4.774-6-7.343-8.833l-.419-.472a.212.212 0 0 0-.056-.139.586.586 0 0 0-.167-.111l-.084-.083-.056-.056c-.084-.167-.28-.278-.475-.167-.782.39-1.507.973-2.206 1.528-.92.722-1.842 1.445-2.708 2.25a8.405 8.405 0 0 0-.977 1.028c-.14.194-.028.361.14.444-.615.611-1.23 1.223-1.843 1.861a.315.315 0 0 0-.084.223c0 .083.056.166.111.194l1.09.833v.028c1.535 1.528 4.244 3.611 7.12 5.861.418.334.865.667 1.284 1 .195.223.39.473.558.695.084.11.28.139.391.055.056.056.14.111.196.167a.398.398 0 0 0 .167.056.255.255 0 0 0 .224-.111.394.394 0 0 0 .055-.167c.029 0 .028.028.056.028a.318.318 0 0 0 .224-.084l5.082-5.528a.309.309 0 0 0 0-.444Zm-14.63-1.917a.485.485 0 0 0 .111.14c.586.5 1.2 1 1.843 1.555l-2.569-1.945-.251-.166c-.056-.028-.112-.084-.168-.111l-.195-.167.056-.056.055-.055.112-.111c.866-.861 2.346-2.306 3.1-3.028-.81.805-2.43 3.167-2.095 3.944Zm8.767 6.89-2.122-1.612a44.713 44.713 0 0 0-2.625-2.5c1.145.861 2.122 1.611 2.262 1.75 1.117.972 1.06.806 1.815 1.445l.921.666a1.06 1.06 0 0 1-.251.25Zm.558.416-.056-.028c.084-.055.168-.111.252-.194l-.196.222ZM1.089 5.75c.055.361.14.722.195 1.056.335 1.833.67 3.5 1.284 4.75l.252.944c.084.361.223.806.363.917 1.424 1.25 3.602 3.11 5.947 4.889a.295.295 0 0 0 .363 0s0 .027.028.027a.254.254 0 0 0 .196.084.318.318 0 0 0 .223-.084c2.988-3.305 5.221-6.027 6.813-8.305.112-.111.14-.278.14-.417.111-.111.195-.25.307-.333.111-.111.111-.306 0-.39l-.028-.027c0-.055-.028-.139-.084-.167-.698-.666-1.2-1.138-1.731-1.638-.922-.862-1.871-1.75-3.881-3.75l-.028-.028c-.028-.028-.056-.056-.112-.056-.558-.194-1.703-.389-3.127-.639C6.087 2.223 3.21 1.723.614.944c0 0-.168 0-.196.028l-.083.084c-.028.027-.056.055-.224.11h.056-.056c.028.167.028.278.084.473 0 .055.112.5.112.555l.782 3.556Zm15.496 3.278-.335-.334c.084.112.196.195.335.334Zm-3.546 4.666-.056.056c0-.028.028-.056.056-.056Zm-2.038-10c.168.167.866.834 1.033.973-.726-.334-2.54-1.167-3.379-1.445.838.167 1.983.334 2.346.472ZM1.424 2.306c.419.722.754 3.222 1.089 5.666-.196-.778-.335-1.555-.503-2.278-.251-1.277-.503-2.416-.838-3.416.056 0 .14 0 .252.028Zm-.168-.584c-.112 0-.223-.028-.307-.028 0-.027 0-.055-.028-.055.14 0 .223.028.335.083Zm-1.089.222c0-.027 0-.027 0 0ZM39.453 1.333c.028-.11-.558-.61-.363-.639.42-.027.42-.666 0-.666-.558.028-1.144.166-1.675.25-.977.194-1.982.389-2.96.61-2.205.473-4.383.973-6.561 1.557-.67.194-1.424.333-2.066.666-.224.111-.196.333-.084.472-.056.028-.084.028-.14.056-.195.028-.363.056-.558.083-.168.028-.252.167-.224.334 0 .027.028.083.028.11-1.173 1.556-2.485 3.195-3.909 4.945-1.396 1.611-2.876 3.306-4.356 5.056-4.719 5.5-10.052 11.75-15.943 17.25a.268.268 0 0 0 0 .389c.028.027.056.055.084.055-.084.084-.168.14-.252.222-.056.056-.084.111-.084.167a.605.605 0 0 0-.111.139c-.112.111-.112.305.028.389.111.11.307.11.39-.028.029-.028.029-.056.056-.056a.44.44 0 0 1 .615 0c.335.362.67.723.977 1.028l-.698-.583c-.112-.111-.307-.083-.39.028-.113.11-.085.305.027.389l7.427 6.194c.056.056.112.056.196.056s.14-.028.195-.084l.168-.166c.028.027.083.027.111.027.084 0 .14-.027.196-.083 10.052-10.055 18.15-17.639 27.42-24.417.083-.055.111-.166.111-.25.112 0 .196-.083.251-.194 1.704-5.194 2.039-9.806 2.15-12.083v-.028c0-.028.028-.056.028-.083.028-.056.028-.084.028-.084a1.626 1.626 0 0 0-.111-1.028ZM21.472 9.5c.446-.5.893-1.028 1.34-1.5-2.876 3.778-7.65 9.583-14.408 16.5 4.607-5.083 9.242-10.333 13.068-15ZM5.193 35.778h.084-.084Zm3.462 3.194c-.027-.028-.027-.028 0-.028v.028Zm4.16-3.583c.224-.25.448-.472.699-.722 0 0 0 .027.028.027-.252.223-.475.445-.726.695Zm1.146-1.111c.14-.14.279-.334.446-.5l.028-.028c1.648-1.694 3.351-3.389 5.082-5.111l.028-.028c.419-.333.921-.694 1.368-1.028a379.003 379.003 0 0 0-6.952 6.695ZM24.794 6.472c-.921 1.195-1.954 2.778-2.82 4.028-2.736 3.944-11.532 13.583-11.727 13.75a1976.983 1976.983 0 0 1-8.042 7.639l-.167.167c-.14-.167-.14-.417.028-.556C14.49 19.861 22.03 10.167 25.074 5.917c-.084.194-.14.36-.28.555Zm4.83 5.695c-1.116-.64-1.646-1.64-1.34-2.611l.084-.334c.028-.083.084-.194.14-.277.307-.5.754-.917 1.257-1.167.027 0 .055 0 .083-.028-.028-.056-.028-.139-.028-.222.028-.167.14-.278.335-.278.335 0 1.369.306 1.76.639.111.083.223.194.335.305.14.167.363.445.474.667.056.028.112.306.196.445.056.222.111.472.084.694-.028.028 0 .194-.028.194a2.668 2.668 0 0 1-.363 1.028c-.028.028-.028.056-.056.084l-.028.027c-.14.223-.335.417-.53.556-.643.444-1.369.583-2.095.389 0 0-.195-.084-.28-.111Zm8.154-.834a39.098 39.098 0 0 1-.893 3.167c0 .028-.028.083 0 .111-.056 0-.084.028-.14.056-2.206 1.61-4.356 3.305-6.506 5.028 1.843-1.64 3.686-3.306 5.613-4.945.558-.5.949-1.139 1.06-1.861l.28-1.667v-.055c.14-.334.67-.195.586.166Z",fill:"currentColor"})}),CE=()=>(0,s.jsxs)("svg",{viewBox:"0 0 450 55",xmlns:"http://www.w3.org/2000/svg",fill:"none",className:"ExcalidrawLogo-text",children:[(0,s.jsx)("path",{d:"M429.27 96.74c2.47-1.39 4.78-3.02 6.83-4.95 1.43-1.35 2.73-2.86 3.81-4.51-.66.9-1.4 1.77-2.23 2.59-2.91 2.84-5.72 5.09-8.42 6.87h.01ZM343.6 69.36c.33 3.13.58 6.27.79 9.4.09 1.37.18 2.75.25 4.12-.12-4.46-.27-8.93-.5-13.39-.11-2.08-.24-4.16-.4-6.24-.06 1.79-.11 3.85-.13 6.11h-.01ZM378.47 98.34c.01-.37.07-1.13.01-6.51-.11 1.9-.22 3.81-.31 5.71-.07 1.42-.22 2.91-.16 4.35.39.03.78.07 1.17.1-.92-.85-.76-2.01-.72-3.66l.01.01ZM344.09 86.12c-.09-2.41-.22-4.83-.39-7.24v12.21c.15-.05.32-.09.47-.14.05-1.61-.03-3.23-.09-4.83h.01ZM440.69 66.79c-.22-.34-.45-.67-.69-.99-3.71-4.87-9.91-7.14-15.65-8.55-1.05-.26-2.12-.49-3.18-.71 2.29.59 4.48 1.26 6.64 2.02 7.19 2.54 10.57 5.41 12.88 8.23ZM305.09 72.46l1.2 3.6c.84 2.53 1.67 5.06 2.46 7.61.24.78.5 1.57.73 2.36.22-.04.44-.08.67-.12a776.9 776.9 0 0 1-5.01-13.57c-.02.04-.03.09-.05.13v-.01ZM345.49 90.25v.31c1.48-.42 3.05-.83 4.66-1.2-1.56.25-3.12.52-4.66.89ZM371.02 90.22c0-.57-.04-1.14-.11-1.71-.06-.02-.12-.04-.19-.05-.21-.05-.43-.08-.65-.11.42.16.74.88.95 1.87ZM398.93 54.23c-.13 0-.27-.01-.4-.02l.03.4c.11-.15.23-.27.37-.38ZM401.57 62.28v-.15c-1.22-.24-2.86-.61-3.23-1.25-.09-.15-.18-.51-.27-.98-.09.37-.2.73-.33 1.09 1.24.56 2.52.98 3.83 1.29ZM421.73 88.68c-2.97 1.65-6.28 3.12-9.69 3.68v.18c4.72-.14 11.63-3.85 16.33-8.38-2.04 1.75-4.33 3.24-6.63 4.53l-.01-.01ZM411.28 80.92c-.05-1.2-.09-2.4-.15-3.6-.21 5.66-.46 11.38-.47 14.51.24-.02.48-.04.71-.07.15-3.61.05-7.23-.09-10.83v-.01Z",transform:"translate(-144.023 -51.76)"}),(0,s.jsx)("path",{d:"M425.38 67.41c-3.5-1.45-7.19-2.57-14.06-3.62.09 1.97.06 4.88-.03 8.12.03.04.06.09.06.15.19 1.36.28 2.73.37 4.1.25 3.77.39 7.55.41 11.33 0 1.38-.01 2.76-.07 4.13 1.4-.25 2.78-.65 4.12-1.15 4.07-1.5 7.94-3.78 11.28-6.54 2.33-1.92 5.13-4.49 5.88-7.58.63-3.53-2.45-6.68-7.97-8.96l.01.02ZM411.35 92.53v-.06l-.34.03c.11.01.22.03.34.03ZM314.26 64.06c-.23-.59-.47-1.17-.7-1.75.57 1.62 1.11 3.25 1.6 4.9l.15.54 2.35 6.05c.32.82.66 1.64.98 2.46-1.38-4.1-2.83-8.17-4.39-12.2h.01ZM156.82 103.07c-.18.13-.38.23-.58.33 1.32-.03 2.66-.2 3.93-.34.86-.09 1.72-.22 2.58-.33-2.12.1-4.12.17-5.94.34h.01ZM210.14 68.88s.03.04.05.07c.18-.31.39-.64.58-.96-.21.3-.42.6-.64.89h.01ZM201.65 82.8c-.5.77-1.02 1.56-1.49 2.37 1.11-1.55 2.21-3.1 3.2-4.59-.23.23-.49.51-.75.79-.32.47-.65.95-.96 1.43ZM194.03 98.66c-.33-.4-.65-.84-1.05-1.17-.24-.2-.07-.49.17-.56-.23-.26-.42-.5-.63-.75 1.51-2.55 3.93-5.87 6.4-9.28-.17-.08-.29-.28-.2-.49.04-.09.09-.17.13-.26-1.21 1.78-2.42 3.55-3.61 5.33-.87 1.31-1.74 2.64-2.54 4-.29.5-.63 1.04-.87 1.61.81.65 1.63 1.27 2.47 1.88-.09-.11-.18-.21-.27-.32v.01ZM307.79 82.93c-1-3.17-2.05-6.32-3.1-9.48-1.62 4.08-3.69 9.17-6.16 15.19 3.32-1.04 6.77-1.87 10.27-2.5-.32-1.08-.67-2.15-1.01-3.21ZM149.5 80.7c.05-1.71.04-3.43 0-5.14-.1 2.26-.16 4.51-.22 6.77-.02.73-.03 1.46-.04 2.19.14-1.27.2-2.55.24-3.82h.02ZM228.98 98.3c.39 1.25.91 3.03.94 3.91.06-.03.12-.07.17-.1.08-1.29-.55-2.65-1.11-3.81ZM307.72 53.36c.81.5 1.53 1.04 2.07 1.49-.38-.8-.78-1.58-1.21-2.35-.17.03-.34.06-.51.11-.43.12-.86.26-1.29.41.35-.01.53.1.94.34ZM283.69 96.14c3.91-7.25 6.89-13.35 8.88-18.15l1.1-2.66c-1.27 2.64-2.56 5.27-3.83 7.9-1.53 3.15-3.06 6.31-4.58 9.47-.87 1.81-1.76 3.62-2.54 5.47.04.02.07.04.11.07.05.05.1.09.15.14.05-.73.27-1.48.71-2.24ZM289.92 103.23s-.04.01-.05.03c0-.02.04-.03.05-.04.05-.05.11-.1.16-.15l.21-.21c-.55 0-1.5-.27-2.55-.72.4.26.8.51 1.22.74.24.13.48.26.73.37.05.02.1.03.14.05a.27.27 0 0 1 .08-.07h.01ZM269.23 68.49c-.39-.19-.82-.48-1.33-.87-3.06-1.56-6.31-2.78-9.36-2.35-3.5.49-5.7 1.11-7.74 2.44 5.71-2.6 12.82-2.07 18.44.79l-.01-.01ZM177.87 53.69l1.06.03c-.96-.22-2-.25-2.89-.3-4.95-.26-9.99.33-14.86 1.19-2.44.43-4.88.95-7.28 1.59 9.09-1.76 15.69-2.77 23.97-2.51ZM219.85 55.51c-.18.12-.36.27-.56.45-.45.53-.86 1.11-1.26 1.66-1.91 2.61-3.71 5.31-5.57 7.95l-.12.18 8.05-10.11c-.18-.05-.36-.1-.55-.13h.01ZM510.71 54.1c.12-.15.29-.3.53-.45.69-.4 3.72-.63 5.87-.74-.36-.02-.73-.04-1.09-.05-1.84-.03-3.67.09-5.49.35.05.3.12.59.18.88v.01ZM510.76 86.02c1.37-3.07 2.49-6.27 3.57-9.46.55-1.64 1.12-3.3 1.6-4.97-1.59 4.01-3.67 9.14-6.2 15.3.24-.08.5-.14.74-.22.1-.22.19-.44.29-.65ZM566.95 75.76c.11-.02.23.03.31.11-.05-.13-.09-.26-.14-.39-.05.09-.11.18-.17.28ZM511.33 86.41c3.08-.89 6.24-1.62 9.46-2.14-1.51-3.98-2.98-7.96-4.39-11.87-.05.15-.09.31-.14.46-1.02 3.32-2.15 6.61-3.39 9.85-.48 1.25-.98 2.49-1.53 3.7h-.01ZM578.24 74.45c.11-.44.23-.87.35-1.31-.31.7-.64 1.39-.97 2.08.09.21.19.4.28.61.12-.46.23-.92.35-1.38h-.01ZM520.62 53.11c-.09 0-.18-.01-.28-.02.38.34.29 1.08.93 2.53l6.65 17.15c2.2 5.68 4.69 11.36 7.41 16.87l1.06 2.17c-2.95-7.05-5.92-14.08-8.87-21.13-1.58-3.79-3.16-7.59-4.7-11.4-.78-1.92-1.73-3.89-2.25-5.91-.03-.1 0-.19.04-.26h.01ZM578.78 77.87c1.45-5.77 3.07-10.43 3.58-13.36.05-.34.16-.88.31-1.55-.67 1.79-1.37 3.56-2.08 5.33-.12.43-.23.86-.35 1.29-.65 2.43-1.29 4.86-1.9 7.3.14.33.29.65.43 1l.01-.01ZM545.3 94.66c.02-.44.03-.83.05-1.12.02-1.01.05-2.02.11-3.02.03-6.66-.46-14.33-1.46-22.8-.13-.42-.27-1.24-.56-2.89 0-.02 0-.04-.01-.06.62 6.61.95 13.25 1.32 19.87.17 3.08.33 6.16.52 9.23.02.25.03.52.04.78l-.01.01ZM580.77 102.81c.13.2.27.38.37.49.27-.11.53-.22.8-.32-.43.09-.82.05-1.17-.16v-.01ZM530.48 104.07h.33c-.36-.13-.71-.32-1.04-.56.14.24.3.47.45.7.06-.08.14-.13.26-.13v-.01ZM542.63 58.82c.06.23.11.47.15.71.14-.33.36-.62.7-.86-.28.05-.57.11-.85.15ZM583.81 57.87c.15-.7.29-1.41.42-2.11-.14.45-.28.9-.42 1.34-.46 1.44-.89 2.89-1.31 4.34.44-1.19.88-2.37 1.31-3.57ZM523.62 91.48c-4.66 1.17-9.05 2.89-14.02 5.27 4.65-1.84 9.48-3.29 14.28-4.63-.09-.22-.17-.41-.26-.64ZM460.64 78.3c-.04-2.9-.11-5.81-.28-8.71-.1-1.68-.17-3.43-.5-5.09-.07.02-.14.03-.2.05.3 6.54.45 12.17.51 17.12.17-.07.34-.14.51-.2 0-1.06-.01-2.11-.03-3.17h-.01ZM470.63 63.24c-3.38-.26-6.81.32-10.1 1.1.41 2.01.47 4.14.57 6.18.18 3.55.25 7.11.27 10.67 3.31-1.38 6.5-3.12 9.3-5.35 1.96-1.56 3.86-3.41 5.02-5.66.73-1.41 1.19-3.22.26-4.65-1.09-1.7-3.46-2.14-5.32-2.29ZM460.29 63.68c1-.24 2.01-.46 3.04-.65-1.15.16-2.37.38-3.71.69v.13c.07-.02.15-.04.22-.05.11-.13.3-.18.45-.11v-.01ZM457.24 100.96c.43-.03.86-.07 1.29-.11.14-.49.27-.99.38-1.49-.44.7-1 1.23-1.67 1.6ZM482.88 104.98c-.18.23-.36.38-.55.47.14.09.27.19.4.28a70.76 70.76 0 0 0 4.37-4.63c.76-.89 1.52-1.81 2.19-2.77-.3-.27-.61-.53-.92-.79-.07 1.94-4.62 6.32-5.49 7.45v-.01Z",transform:"translate(-144.023 -51.76)"}),(0,s.jsx)("path",{d:"M474.36 63.31c-.4-.16-.84-.27-1.29-.37 1.56.42 3.08 1.22 3.76 2.74.62 1.4.32 2.95-.28 4.32.7-1.22.94-2.34.74-3.47-.24-1.33-1.19-2.54-2.93-3.21v-.01ZM477.34 89.18c-1.2-.81-2.4-1.62-3.6-2.42-.14.1-.26.19-.4.29 1.4.67 2.73 1.39 4 2.13ZM465.88 93.85c.37.25.74.5 1.1.75.46.32.92.65 1.38.97-1.57-1.2-2.01-1.61-2.49-1.72h.01ZM574.92 90.06c-2.28-5.21-4.93-11.13-5.67-12.26-.1-.15-1.57-3.01-1.63-3.08 0 0-.01.02-.02.02.4 1.37 1.09 2.69 1.65 3.99 2.14 4.95 4.36 9.86 6.67 14.73.6 1.26 1.21 2.52 1.83 3.78-.75-2.01-1.64-4.45-2.83-7.18ZM448.73 65.29c.1.2.22.38.34.57.22-.02.43-.06.65-.08v-.08c-.14-.05-.25 0-.99-.41ZM460.16 94.81c-.02.31-.06.59-.1.89-.03 1.71-.33 3.43-.79 5.07.15-.02.3-.03.45-.05.01-.04.02-.08.03-.11.09-.34.15-.69.2-1.03.17-1.07.25-2.16.33-3.24.05-.69.08-1.39.12-2.08-.27.1-.27.26-.24.57v-.02Z",transform:"translate(-144.023 -51.76)"}),(0,s.jsx)("path",{d:"m328.67 98.12-3.22-6.58c-1.29-2.63-2.53-5.29-3.72-7.97-.25-.85-.52-1.69-.79-2.53-.81-2.57-1.67-5.12-2.55-7.67-1.92-5.53-3.9-11.08-6.32-16.41-.72-1.58-1.46-3.44-2.63-4.79-.03-.17-.16-.29-.34-.36a.282.282 0 0 0-.23-.04c-.06-.01-.12 0-.18.01-.74.06-1.5.38-2.19.61-2.22.77-4.4 1.64-6.63 2.38-.03-.08-.06-.16-.09-.25-.15-.42-.82-.24-.67.19.03.09.07.19.1.28l-.18.06c-.36.11-.28.6 0 .68.18 1.18.63 2.36.98 3.49.03.09.06.17.08.26-.08.23-.17.46-.24.64-.37.98-.79 1.94-1.21 2.9-1.27 2.89-2.62 5.75-3.98 8.6-3.18 6.67-6.44 13.31-9.64 19.97-1.08 2.25-2.2 4.5-3.15 6.81-.13.32.24.5.5.37 1.34 1.33 2.84 2.5 4.4 3.57.65.44 1.31.87 2.01 1.24.4.22.86.48 1.33.5.24.01.35-.19.33-.37.11-.1.21-.21.28-.28.41-.41.81-.84 1.2-1.26.85-.92 1.69-1.87 2.5-2.84 6.31-2.34 12.6-4.31 18.71-5.84 2.14 5.3 3.43 8.43 3.97 9.58.55 1.05 1.15 1.88 1.82 2.52 1.32.56 6.96-.03 9.23-1.96.87-1.28 1.19-2.67.93-4.15-.09-.5-.22-.95-.4-1.33l-.01-.03Zm-20.09-45.61c.43.77.83 1.56 1.21 2.35-.54-.45-1.27-.99-2.07-1.49-.42-.24-.6-.35-.94-.34.43-.15.85-.29 1.29-.41.17-.05.34-.08.51-.11Zm-25.86 45.66c.78-1.85 1.67-3.66 2.54-5.47 1.51-3.16 3.05-6.31 4.58-9.47 1.28-2.63 2.56-5.26 3.83-7.9l-1.1 2.66c-1.99 4.79-4.97 10.9-8.88 18.15-.43.76-.66 1.51-.71 2.24-.05-.05-.1-.09-.15-.14a.259.259 0 0 0-.11-.07Zm6.24 4.71c-.42-.23-.82-.48-1.22-.74 1.05.45 2 .72 2.55.72l-.21.21c-.05.05-.11.1-.16.15-.01.01-.04.03-.05.04 0-.02.03-.02.05-.03a.27.27 0 0 0-.08.07c-.05-.02-.1-.03-.14-.05-.25-.1-.49-.24-.73-.37h-.01Zm15.73-29.43c1.05 3.15 2.1 6.31 3.1 9.48.34 1.06.69 2.13 1.01 3.21-3.5.63-6.95 1.46-10.27 2.5 2.48-6.03 4.54-11.11 6.16-15.19Zm4.79 12.57c-.23-.79-.49-1.58-.73-2.36-.79-2.54-1.63-5.08-2.46-7.61l-1.2-3.6c.02-.04.04-.09.05-.13 1.6 4.45 3.28 9 5.01 13.57l-.67.12v.01Zm5.83-18.27-.15-.54c-.49-1.64-1.03-3.28-1.6-4.9.23.58.47 1.17.7 1.75 1.56 4.03 3.01 8.1 4.39 12.2-.33-.82-.67-1.64-.98-2.46l-2.35-6.05h-.01ZM390.43 79.37c-.13-10.43-.22-17.5-.24-19.97-.24-1.6.21-2.88-.65-3.65-.14-.13-.32-.23-.52-.32h.03c.45 0 .45-.69 0-.7-1.75-.03-3.5-.04-5.25-.14-1.38-.08-2.76-.21-4.15-.31-.07 0-.12.01-.17.04-.21-.07-.47.03-.45.31l.03.45c-.11.14-.19.3-.22.5-.21 1.26-.32 13.67-.36 23.59-.32 5.79-.67 11.57-.97 17.36-.09 1.73-.29 3.54-.21 5.3-.39.02-.38.64.04.69v.12c.05.44.74.45.7 0v-.06c1.1.09 2.2.21 3.3.3 1.14.19 2.44.2 3.29.17 1.73-.05 2.92-.05 3.8-.37.45-.05.9-.11 1.35-.17.44-.06.25-.73-.19-.67h-.01c.24-.32.45-.72.62-1.25.66-1.84.41-6.36.34-11.33l-.13-9.9.02.01Zm-12.26 18.17c.09-1.91.2-3.81.31-5.71.06 5.38 0 6.14-.01 6.51-.05 1.65-.21 2.81.72 3.66-.39-.04-.78-.07-1.17-.1-.06-1.44.09-2.93.16-4.35l-.01-.01ZM588.97 53.85c-2.06-.25-3.17-.51-3.76-.6a.3.3 0 0 1 .04-.08c.22-.39-.39-.75-.6-.35-.56 1.02-.9 2.19-1.26 3.29-.61 1.88-1.17 3.78-1.72 5.68-.63 2.19-1.24 4.39-1.83 6.59-.81 2.03-1.67 4.05-2.61 6.03-1.7-3.64-3.11-6.04-4.03-7.57-2.26-3.74-2.85-5.48-3.57-6.08l.31-.09c.43-.12.25-.8-.19-.67-1.06.3-2.12.6-3.17.95-.93.32-1.85.69-2.76 1.07-.13.05-.19.16-.22.27-.04.02-.08.05-.11.07-.04-.06-.07-.12-.11-.18a.354.354 0 0 0-.48-.12c-.16.09-.22.32-.13.48l.33.54c0 .09.02.18.06.28.51 1.16.78 1.38.72 1.47-2.42 3.44-5.41 7.86-6.2 9.1-1.27 1.97-2.01 3.14-2.45 3.84l-.91-6.56-.43-4.1c-.19-1.85-.37-3.23-.53-4.13-.19-1.1-.3-2.15-.45-3.16-.2-1.36-.29-2.06-.47-2.42h.04c.45.02.45-.68 0-.7-3.43-.16-6.81.94-10.17 1.48-.24-.22-.73-.04-.58.32.24.59.33 1.25.43 1.87.17 1.06.29 2.13.4 3.2.32 3.09.53 6.2.74 9.3.44 6.75.77 13.51 1.17 20.26.11 1.95.13 3.96.46 5.89.05.3.37.31.55.14.74 1.71 2.87 1.27 6.13 1.27 1.34 0 2.39.04 2.99-.11.02.32.48.53.63.18 3.61-8.26 7.41-16.46 12.05-24.2.03-.05.04-.1.05-.15.3.73.64 1.45.94 2.16.97 2.26 1.97 4.52 2.98 6.76 2.26 5.03 4.54 10.07 7.09 14.96.47.9.94 1.79 1.47 2.65.2.32.4.67.66.96-.18.25 0 .68.34.54.91-.38 1.82-.75 2.76-1.07 1.04-.35 2.11-.65 3.17-.95.39-.11.28-.66-.07-.68.62-.4.95-.96.87-1.91-.3-3.34.72-7.47.86-8.52l2.14-11.43c1.75-10.74 3.13-17.51 3.23-20.86.02-.49.08-2.84.13-3.24.17-1.25.48-1-4.96-1.65l.03-.02Zm-46.19 5.67c-.04-.24-.09-.48-.15-.71l.85-.15c-.34.24-.56.53-.7.86Zm1.95 25.12c-.36-6.63-.7-13.26-1.32-19.87 0 .02 0 .04.01.06.29 1.65.44 2.47.56 2.89 1 8.46 1.5 16.14 1.46 22.8-.06.99-.1 2-.11 3.02-.01.29-.03.68-.05 1.12-.01-.26-.03-.53-.04-.78-.19-3.08-.35-6.16-.52-9.23l.01-.01Zm36.4 18.66c-.11-.11-.24-.29-.37-.49.35.21.74.26 1.17.16-.27.11-.53.22-.8.32v.01Zm-.89-33.72c.12-.43.23-.86.35-1.29.71-1.77 1.41-3.55 2.08-5.33-.15.68-.26 1.22-.31 1.55-.5 2.94-2.13 7.59-3.58 13.36-.15-.35-.29-.66-.43-1 .61-2.44 1.25-4.87 1.9-7.3l-.01.01Zm3.56-12.48c.14-.44.28-.89.42-1.34-.13.7-.27 1.41-.42 2.11-.43 1.19-.86 2.38-1.31 3.57.42-1.45.85-2.9 1.31-4.34Zm-5.22 16.05c-.11.44-.23.87-.35 1.31-.12.46-.23.92-.35 1.38-.1-.22-.19-.4-.28-.61.34-.69.66-1.38.97-2.08h.01Zm-11.64 2.62c.06-.1.12-.19.17-.28.05.13.09.26.14.39a.398.398 0 0 0-.31-.11Zm2.3 2.98c-.56-1.3-1.25-2.63-1.65-3.99 0 0 .01-.02.02-.02.06.08 1.52 2.93 1.63 3.08.73 1.13 3.38 7.04 5.67 12.26 1.2 2.73 2.08 5.17 2.83 7.18-.62-1.25-1.23-2.51-1.83-3.78-2.31-4.87-4.53-9.78-6.67-14.73ZM275.92 87.03c-1.06-2.18-1.13-3.45-2.44-2.93-1.52.57-2.94 1.3-4.5 2.1-1.4.72-2.68 1.44-3.92 2.12.01-.25-.24-.5-.51-.34-4.8 2.93-12.41 4.7-17.28 1.31-1.98-1.77-3.32-4.15-3.97-5.78-.29-.95-.49-1.94-.63-2.93-.14-3.34 1.58-6.53 3.9-9.12.8-.79 1.68-1.51 2.66-2.12 3.7-2.3 8.22-3.07 12.51-2.51 2.71.35 5.32 1.24 7.71 2.55.39.22.75-.39.35-.6-.18-.1-.37-.18-.55-.27.56.27 1.03.33 1.51.19l-.48.39c-.15.11-.23.3-.13.48.09.15.33.24.48.13 1.3-.97 2.46-2.09 3.45-3.37.37-.29.64-.6.65-.97v-.02c.08-.33-.03-.7-.21-1.08-.31-.87-.98-2.01-2.19-3.26-2.43-2.52-3.79-3.45-5.68-4.26-1.14-.49-3.12-1.06-4.42-1.23-3.28-.42-10.64-1.21-18.18 4.11-7.74 5.46-11.94 12.3-12.23 20.61-.08 2.06.04 3.98.34 5.71.74 4.18 2.57 8 5.44 11.34 4.26 4.99 9.76 7.52 16.34 7.52 4.85 0 9.69-1.77 14.89-4.62.23-.12.45-.23.68-.35 2.19-1.1 4.37-2.23 6.46-3.5.49-.3 1.03-.61 1.5-.98 1.47-.87 1.11-1.12.49-2.95-.39-1.14-.76-2.7-2.06-5.36l.02-.01Zm-17.38-21.76c3.05-.42 6.31.79 9.36 2.35.51.39.94.68 1.33.87-5.61-2.86-12.72-3.39-18.44-.79 2.05-1.33 4.24-1.95 7.74-2.44l.01.01ZM443.67 72.67c-.4-2.2-1.15-4.33-2.37-6.22-1.49-2.32-3.58-4.19-5.91-5.64-6.17-3.81-13.75-5.11-20.83-6.01-3.23-.41-6.47-.69-9.72-.92l-1.39-.12c-.85-.07-1.52-.1-2.05-.1-1.08-.06-2.17-.12-3.25-.17-.08 0-.14.02-.19.05-.1.05-.18.14-.16.3.27 2.55-.01 5.12-.92 7.52-.15.38.4.56.62.28 1.32.59 2.68 1.05 4.08 1.37 0 2.78-.14 7.58-.33 12.91 0 0 0 .02-.01.03-.61 3.66-.79 7.42-1 11.12-.23 4.01-.43 8.03-.44 12.05 0 .64 0 1.28.03 1.93.02.31 0 .68.15.96.06.11.14.16.24.17-.2.17-.21.54.11.59 3.83.67 7.78.71 11.68.25 2.3-.19 4.87-.65 7.65-1.56 1.85-.54 3.67-1.18 5.43-1.91 7.2-3.02 14.31-8.07 17.35-15.53.76-1.86 1.17-3.8 1.31-5.75.3-1.93.28-3.82-.09-5.58l.01-.02Zm-19.32-15.42c5.74 1.41 11.94 3.68 15.65 8.55.25.32.47.65.69.99-2.3-2.82-5.68-5.69-12.88-8.23-2.16-.76-4.35-1.43-6.64-2.02 1.06.21 2.13.45 3.18.71Zm-25.82-3.04c.13 0 .27.01.4.02-.14.1-.26.23-.37.38 0-.13-.02-.26-.03-.4Zm34.82 22.17c-.75 3.09-3.55 5.66-5.88 7.58-3.35 2.76-7.21 5.03-11.28 6.54-1.33.49-2.71.9-4.12 1.15.06-1.38.08-2.76.07-4.13-.02-3.78-.16-7.56-.41-11.33-.09-1.37-.18-2.74-.37-4.1 0-.06-.03-.11-.06-.15.09-3.25.12-6.16.03-8.12 6.86 1.05 10.56 2.17 14.06 3.62 5.52 2.28 8.59 5.44 7.97 8.96l-.01-.02Zm-22 16.15c-.12 0-.23-.02-.34-.03l.34-.03v.06Zm-.69-.7c0-3.13.26-8.84.47-14.51.06 1.2.11 2.41.15 3.6.15 3.6.25 7.23.09 10.83-.24.03-.48.05-.71.07v.01Zm-12.33-30.94c.37.63 2.01 1.01 3.23 1.25v.15c-1.31-.31-2.59-.73-3.83-1.29.12-.36.23-.72.33-1.09.08.48.18.84.27.98Zm13.7 31.65v-.18c3.41-.56 6.71-2.02 9.69-3.68 2.31-1.28 4.59-2.78 6.63-4.53-4.69 4.53-11.61 8.24-16.33 8.38l.01.01Zm24.07-.75c-2.05 1.93-4.37 3.56-6.83 4.95 2.7-1.78 5.52-4.03 8.42-6.87.82-.82 1.56-1.69 2.23-2.59-1.08 1.65-2.38 3.16-3.81 4.51h-.01ZM187.16 92.14c-.79-2.47-2.1-7.12-3.1-6.87-.19-.01-2.09.77-4.08 1.54-3.06 1.18-5.91 2.13-10.09 2.82-2.74.42-5.87 1.01-10.61 1.06.04-3.34.05-6.01.05-7.99 7.97-.65 12.33-2.11 16.37-3.55 1.11-.39 2.69-1.01 2.63-1.8-.08-.35-.55-1.39-1.17-2.61-.47-1.16-.98-2.31-1.61-3.38-.42-.71-1.04-1.69-1.86-2.06-.11-.08-.22-.13-.29-.12-.02 0-.04 0-.07.01-.19-.04-.39-.05-.6-.01-.17.03-.24.15-.25.28-.04.02-.09.04-.14.05-4.33 1.48-8.85 2.33-13.24 3.61a499.1 499.1 0 0 0-.31-8.19c4.51-.99 8.88-1.38 13.11-1.82 3.68-.38 6.28.12 7.47.34.59.11.9.16 1.16.18h.1c-.1.37.44.66.62.28.02-.04.03-.08.05-.13.15.2.53.22.62-.1.17-.58.19-1.21.21-1.81v-.36c.03-.15.05-.3.07-.45.52-2.47.33-5.09-.64-7.44-.11-.27-.44-.28-.6-.14-.08-.21-.15-.42-.24-.62-.19-.41-.79-.05-.6.35.03.07.05.15.09.22-.98-.42-2.15-.54-3.17-.63-2.17-.19-4.37-.14-6.54 0-5.7.35-11.4 1.3-16.91 2.79-2.08.56-4.13 1.22-6.14 2-4.54 1.05-3.79 1.51-2.17 6.07.18.51.46 1.68.54 1.94.82 2.47 1.08 2.13 3.1 2.13s0 .05 0 .08h.52c-.48 2.66-.51 5.45-.62 8.13-.15 3.48-.22 6.96-.28 10.45 0 .41-.01.82-.02 1.23-.16.29-.33.57-.51.85-.05.38-.09.77-.14 1.18-.42 3.52-.59 6.48-.52 8.8v.34c.02.47.05.76.06.87.16 1.57-.26 3.47 1.35 3.79 1.61.32 3.5.55 4.85.55.11 0 .22-.02.33-.02 1.79.24 3.67.05 5.45-.12 2.85-.28 5.69-.7 8.51-1.19 3.03-.53 6.05-1.14 9.04-1.86 2.4-.58 4.82-1.19 7.13-2.06.51-.19 1.73-.57 2.46-1.14 1.81-.68 2.18-1 1.57-2.67-.23-.62-.48-1.49-.91-2.78l-.03-.02Zm-11.12-38.71c.89.05 1.93.08 2.89.3-.33 0-.68-.02-1.06-.03-8.28-.26-14.88.75-23.97 2.51 2.41-.64 4.85-1.16 7.28-1.59 4.87-.86 9.91-1.45 14.86-1.19Zm-26.53 22.13c.03 1.71.04 3.43 0 5.14-.04 1.27-.11 2.55-.24 3.82 0-.73.02-1.46.04-2.19.05-2.26.12-4.51.22-6.77h-.02Zm6.73 27.85c.2-.1.4-.21.58-.33 1.82-.17 3.82-.24 5.94-.34-.86.11-1.72.24-2.58.33-1.27.14-2.61.31-3.93.34h-.01ZM534.48 85.44c-3.52-8.38-7.07-16.75-10.5-25.17-.63-1.54-1.25-3.09-1.86-4.65-.31-.8-.65-1.6-.87-2.43-.04-.17-.17-.24-.31-.25.1-.2 0-.51-.29-.53-1.59-.08-3.18-.22-4.78-.25-1.96-.03-3.91.13-5.84.42-.31.05-.31.38-.13.56-.03.06-.05.14-.04.22.23 1.54.63 3.06 1.16 4.53.13.35.27.7.41 1.06l-2.68 6.18c-.11.03-.2.09-.25.22-.67 1.9-1.52 3.73-2.34 5.56a536.85 536.85 0 0 1-3.9 8.45c-2.64 5.64-5.34 11.25-7.91 16.93-.44.97-.88 1.94-1.29 2.93-.2.48-.47 1-.55 1.52v.05c-.02.12.02.26.16.34 1.19.73 2.41 1.41 3.66 2.05 1.2.62 2.45 1.25 3.76 1.61.43.12.62-.55.19-.67-1.13-.31-2.2-.83-3.24-1.36 1.09.36 2.1.69 2.75.93 2.82 1.01 2.38 1.1 4.3-3.75 2.1-1.09 4.34-1.96 6.53-2.79 4.35-1.64 8.8-3.03 13.27-4.29.82 2.01 1.77 3.97 2.72 5.92.35.83.62 1.45.79 1.82.22.42.45.8.69 1.15.17.33.33.67.5 1 .42.8.84 1.63 1.4 2.35.23.29.6 0 .55-.31 1.53-.02 3.06-.07 4.58-.27.92-.12 1.82-.32 2.71-.54 1.39-.27 3.85-1.11 3.74-1.42-.67-1.96-1.55-3.87-2.34-5.78-1.57-3.78-3.16-7.56-4.75-11.33v-.01Zm-11.65-26.16c1.54 3.81 3.12 7.6 4.7 11.4 2.94 7.05 5.91 14.09 8.87 21.13l-1.06-2.17c-2.71-5.51-5.2-11.19-7.41-16.87l-6.65-17.15c-.65-1.45-.55-2.19-.93-2.53.09 0 .18.01.28.02a.29.29 0 0 0-.04.26c.52 2.02 1.47 3.98 2.25 5.91h-.01Zm-6.58 13.58c.05-.15.09-.31.14-.46 1.41 3.92 2.88 7.9 4.39 11.87-3.22.52-6.38 1.25-9.46 2.14.55-1.22 1.05-2.46 1.53-3.7 1.24-3.24 2.37-6.53 3.39-9.85h.01Zm-.23-20c.36 0 .73.03 1.09.05-2.15.1-5.18.33-5.87.74-.24.15-.41.3-.53.45-.06-.29-.13-.58-.18-.88 1.82-.26 3.65-.39 5.49-.35v-.01Zm-.09 18.72c-.49 1.67-1.05 3.33-1.6 4.97-1.07 3.19-2.19 6.38-3.57 9.46-.09.21-.19.43-.29.65-.25.07-.5.14-.74.22 2.53-6.16 4.61-11.29 6.2-15.3Zm-6.34 25.16c4.97-2.38 9.37-4.1 14.02-5.27l.26.64c-4.8 1.35-9.63 2.8-14.28 4.63Zm20.17 6.76c.33.23.68.42 1.04.56h-.33c-.12 0-.21.06-.26.13-.15-.23-.31-.45-.45-.7v.01ZM226.57 91.75c-3.55-4.74-6.68-9.11-9.31-12.99 9.2-15.25 10.05-17.81 10.35-18.38.17-.34 1.09-2.27.64-2.53-1.13-.65-1.03-.65-2.97-1.71-1.19-.65-3.04-1.61-4.53-2.12-1.71-.59-1.24-.36-3 2.77-.06.1-.11.2-.17.3-.75 1.02-1.48 2.05-2.2 3.09-1.88 2.71-3.73 5.45-5.69 8.1-3.68-4.91-6.88-8.76-9.51-11.43-.15-.15-.3-.29-.46-.42-1.27-1.28-7.24 3.53-7.93 5.58-.09.09-.19.16-.28.25-.27.26.03.64.33.58.19.65.5 1.29.94 1.91 3.85 5.06 7.19 9.76 9.94 14-1.23 2.61-3.06 5-4.67 7.38l-2.28 3.33c-.5.66-.93 1.23-1.29 1.69-.67.93-2.09 2.61-2.3 3.87-.51.85-1.16 1.84-1.29 2.83-.06.44.61.63.67.19.01-.08.04-.15.06-.22 1.36 1.08 2.76 2.11 4.19 3.11 1.3.91 2.62 1.85 4.04 2.56.21.1.4 0 .48-.17.24.07.48.14.72.2.44.1.62-.57.19-.67-2.02-.48-3.77-1.57-5.23-3.02-.47-.46-.9-.96-1.32-1.46 1.74 1.35 4.2 2.89 5.89 4.14 1.39 1.03 2.85-2.27 4.22-4.2 1.86-2.64 3.96-5.86 5.52-8.29l10.39 14.51c.67.81 1.14 1.21 1.57 1.36-.05.24.12.51.41.4 1.53-.58 3.05-1.19 4.54-1.87 1.52-.69 3.06-1.45 4.36-2.5a.28.28 0 0 0 .12-.23c1.66-1.1.81-1.74-1.41-4.91-1.13-1.58-1.71-2.36-3.7-5.01l-.03-.02Zm2.41 6.54c.56 1.15 1.19 2.52 1.11 3.81-.06.04-.12.07-.17.1-.03-.88-.55-2.66-.94-3.91Zm-16.51-32.73c1.86-2.65 3.65-5.35 5.57-7.95.4-.55.81-1.13 1.26-1.66.19-.18.38-.33.56-.45.18.03.36.08.55.13l-8.05 10.11.12-.18h-.01ZM192.7 95.48c.79-1.37 1.66-2.69 2.54-4 1.19-1.79 2.4-3.56 3.61-5.33-.04.09-.09.17-.13.26-.1.22.03.41.2.49-2.47 3.42-4.89 6.73-6.4 9.28.21.24.4.48.63.75-.24.07-.4.36-.17.56.4.33.72.77 1.05 1.17.09.11.18.21.27.32-.84-.61-1.66-1.24-2.47-1.88.24-.57.58-1.11.87-1.61v-.01Zm7.46-10.32c.47-.81.98-1.59 1.49-2.37.31-.48.64-.95.96-1.43.26-.29.52-.56.75-.79-.99 1.48-2.09 3.03-3.2 4.59Zm10.03-16.22s-.03-.05-.05-.07c.22-.29.43-.59.64-.89-.2.32-.4.65-.58.96h-.01ZM371.54 87.96c-.01-.08-.01-.16-.03-.23-.06-.38-.58-.29-.66.03-.3-.05-.6-.08-.81-.11-1.14-.15-2.29-.19-3.44-.2 1.04-.09 2.09-.18 3.14-.23.45-.02.45-.72 0-.7-6.57.35-13.14 1.23-19.65 2.11-1.53.21-3.05.42-4.57.68-.01 0-.02.01-.04.01-.04-3.33-.13-6.66-.24-9.99-.19-5.7-.4-11.41-.88-17.1-.13-1.51-.23-3.07-.49-4.58 0-.25 0-.48-.02-.68-.06-1.19-.04-2.61-.68-2.78-.16-.07-.72-.16-1.5-.24.22-.17.16-.62-.2-.63-1.19-.04-2.39.09-3.57.23-1.2.14-2.41.32-3.59.6-.16-.1-.41-.06-.5.12-.06.02-.13.03-.19.05-.35.1-.29.55-.03.66-.26.6-.19 2.27-.21 3-.02.66-.66 33.73-.9 40.3-.03.65.06 1.12.04 1.45-.16 3.05.87 4.96 6.34 3.93 1.09-.08 2.75-.77 5.36-1.43 4.13-1.04 5.78-1.52 6.2-1.65 6.43-1.69 6.78-1.97 11.72-2.43.55-.05 4.8-.38 6.03-.3.64.04 1.19.07 1.65.1.09 0 .16-.03.24-.05.1.27.56.33.66-.02.39-1.32.61-2.71.78-4.08.2-1.61.29-3.24.15-4.86.24.03.52-.23.38-.53-.09-.2-.27-.33-.49-.43v-.02Zm-.63.56c.07.57.11 1.14.11 1.71-.21-.99-.53-1.71-.95-1.87.22.03.44.06.65.11.06.01.12.04.19.05Zm-25.41 1.73c1.54-.36 3.1-.64 4.66-.89-1.61.37-3.18.77-4.66 1.2v-.31Zm-.86-7.37c-.07-1.37-.16-2.75-.25-4.12-.21-3.13-.45-6.27-.79-9.4.02-2.25.08-4.31.13-6.11.16 2.08.29 4.16.4 6.24.23 4.46.38 8.93.5 13.39h.01Zm-.94-4c.16 2.41.29 4.83.39 7.24.06 1.6.14 3.22.09 4.83-.15.05-.32.09-.47.14V78.88h-.01ZM483.72 92.83c-3.05-2.28-6.22-4.4-9.38-6.51 8.86-6.49 13.49-12.95 13.73-19.23.04-.76 0-1.5-.13-2.2-.67-3.82-3.5-6.68-8.39-8.48.13.04.27.08.4.13 3.92 1.39 7.74 4.23 8.5 8.56.34 1.95-.05 3.96-.98 5.69-.21.4.39.75.6.35 1.86-3.46 1.46-7.55-.97-10.63-3.53-4.47-9.76-5.88-15.16-6.16-2.32-.12-4.64-.04-6.95.19-6 .32-12.71 1.68-17.63 3.21-.37.11-.67.23-.92.35-.2-.17-.62.02-.57.37v.03c-.64.68-.18 1.64.48 3.21.38.91.67 1.89 1.15 2.58.32.76.68 1.51 1.13 2.19.14.21.38.19.53.07.19-.02.38-.05.57-.08v1.57c-.06.06-.1.13-.11.23-.27 4.18-.34 8.38-.48 12.57l-.3 9.03c-.24 3.91-.44 6.77-.46 7.26-.05.88-.11 1.95.07 2.81-.01.22-.02.43-.04.65 0 .11-.02.23-.03.35 0 .05-.03.27-.01.16-.05.4.5.59.64.28.05.04.12.08.2.08 1.75.13 3.5.28 5.25.3 1.69.02 3.38-.12 5.06-.32.08.23.36.39.55.15.06-.08.11-.17.16-.26.18-.09.24-.32.18-.48.05-.2.1-.4.13-.6.16-.86.25-1.74.33-2.62.11-1.17.17-2.34.23-3.51.15-.01.32-.03.52-.04.36-.03 1.73-.15 2.06-.15.39 0 .7-.02.95-.04 1.76 1.11 3.45 2.35 5.14 3.55 2.83 2.01 5.64 4.04 8.47 6.04 1.42 1 2.85 2 4.29 2.97.1.06.19.07.27.04.08 0 .17-.02.25-.1 1.61-1.56 3.15-3.18 4.6-4.88.75-.88 1.49-1.78 2.15-2.73.01.01.03.02.04.03.34.3.83-.2.49-.49-2.16-1.9-4.34-3.76-6.64-5.48l.03-.01Zm-6.38-3.65a55.72 55.72 0 0 0-4-2.13c.14-.1.26-.19.4-.29 1.2.81 2.4 1.61 3.6 2.42Zm-20.1 11.78c.67-.37 1.23-.91 1.67-1.6-.11.5-.24 1-.38 1.49-.43.04-.86.08-1.29.11Zm2.38-37.24c1.34-.31 2.56-.52 3.71-.69-1.03.19-2.04.41-3.04.65-.14-.07-.34-.02-.45.11-.07.02-.15.04-.22.05v-.13.01Zm.04.84c.07-.02.14-.03.2-.05.34 1.66.41 3.41.5 5.09.17 2.9.24 5.81.28 8.71l.03 3.17c-.17.07-.34.14-.51.2-.06-4.96-.21-10.58-.51-17.12h.01Zm16.04 5.62c-1.16 2.25-3.06 4.1-5.02 5.66-2.8 2.23-5.99 3.97-9.3 5.35-.01-3.56-.09-7.12-.27-10.67-.1-2.04-.16-4.16-.57-6.18 3.3-.78 6.72-1.36 10.1-1.1 1.85.14 4.23.59 5.32 2.29.92 1.43.46 3.24-.26 4.65Zm.85-.18c.6-1.37.9-2.92.28-4.32-.67-1.52-2.2-2.32-3.76-2.74.46.1.89.21 1.29.37 1.74.67 2.69 1.88 2.93 3.21.2 1.13-.05 2.25-.74 3.47V70Zm-27.47-4.14c-.12-.19-.23-.38-.34-.57.74.42.85.36.99.41v.08c-.22.03-.43.06-.65.08Zm11.21 30.46c-.08 1.08-.16 2.17-.33 3.24-.05.35-.11.69-.2 1.03 0 .04-.02.07-.03.11-.15.02-.3.04-.45.05.45-1.64.76-3.36.79-5.07.03-.29.08-.57.1-.89-.03-.31-.03-.47.24-.57-.04.69-.07 1.39-.12 2.08v.02Zm5.6-2.47c.48.11.92.52 2.49 1.72-.46-.32-.92-.65-1.38-.97-.37-.25-.73-.5-1.1-.75h-.01Zm21.23 7.24a70.76 70.76 0 0 1-4.37 4.63c-.14-.09-.27-.19-.4-.28.19-.09.37-.24.55-.47.87-1.14 5.43-5.51 5.49-7.45.31.26.62.53.92.79-.67.97-1.42 1.88-2.19 2.77v.01Z",fill:"currentColor",transform:"translate(-144.023 -51.76)"})]}),CS=({style:e,size:t="small",withText:n})=>(0,s.jsxs)("div",{className:`ExcalidrawLogo is-${t}`,style:e,children:[(0,s.jsx)(Cw,{}),n&&(0,s.jsx)(CE,{})]})}),C8=tC(()=>{tM(),bZ(),bX(),tL(),CJ(),vr(),dN(),d8(),C5(),(Ck=({icon:e,shortcut:t,children:n})=>{let i=k4();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"welcome-screen-menu-item__icon",children:e}),(0,s.jsx)("div",{className:"welcome-screen-menu-item__text",children:n}),t&&!i.editor.isMobile&&(0,s.jsx)("div",{className:"welcome-screen-menu-item__shortcut",children:t})]})}).displayName="WelcomeScreenMenuItemContent",(CC=({onSelect:e,children:t,icon:n,shortcut:i,className:l="",...r})=>(0,s.jsx)("button",{...r,type:"button",className:`welcome-screen-menu-item ${l}`,onClick:e,children:(0,s.jsx)(Ck,{icon:n,shortcut:i,children:t})})).displayName="WelcomeScreenMenuItem",(CI=({children:e,href:t,icon:n,shortcut:i,className:l="",...r})=>(0,s.jsx)("a",{...r,className:`welcome-screen-menu-item ${l}`,href:t,target:"_blank",rel:"noreferrer",children:(0,s.jsx)(Ck,{icon:n,shortcut:i,children:e})})).displayName="WelcomeScreenMenuItemLink",(CM=({children:e})=>{let{WelcomeScreenCenterTunnel:t}=yZ();return(0,s.jsx)(t.In,{children:(0,s.jsx)("div",{className:"welcome-screen-center",children:e||(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Cj,{}),(0,s.jsx)(CT,{children:C("welcomeScreen.defaults.center_heading")}),(0,s.jsxs)(CL,{children:[(0,s.jsx)(CA,{}),(0,s.jsx)(CD,{})]})]})})})}).displayName="Center",(Cj=({children:e})=>(0,s.jsx)("div",{className:"welcome-screen-center__logo virgil welcome-screen-decor",children:e||(0,s.jsx)(CS,{withText:!0})})).displayName="Logo",(CT=({children:e})=>(0,s.jsx)("div",{className:"welcome-screen-center__heading welcome-screen-decor virgil",children:e})).displayName="Heading",(CL=({children:e})=>(0,s.jsx)("div",{className:"welcome-screen-menu",children:e})).displayName="Menu",(CD=()=>{let e=Ce();return(0,s.jsx)(CC,{onSelect:()=>e.executeAction(xT),shortcut:"?",icon:rm,children:C("helpDialog.title")})}).displayName="MenuItemHelp",(CA=()=>{let e=dp(),t=Ce();return e.viewModeEnabled?null:(0,s.jsx)(CC,{onSelect:()=>t.executeAction(xk),shortcut:yg("loadScene"),icon:rw,children:C("buttons.load")})}).displayName="MenuItemLoadScene",(CP=({onSelect:e})=>{let{t}=M();return(0,s.jsx)(CC,{shortcut:null,onSelect:e,icon:rF,children:t("labels.liveCollaboration")})}).displayName="MenuItemLiveCollaborationTrigger",CM.Logo=Cj,CM.Heading=CT,CM.Menu=CL,CM.MenuItem=CC,CM.MenuItemLink=CI,CM.MenuItemHelp=CD,CM.MenuItemLoadScene=CA,CM.MenuItemLiveCollaborationTrigger=CP}),C7=tC(()=>{tM(),tL(),vr(),dN(),(C_=({children:e})=>{let{WelcomeScreenMenuHintTunnel:t}=yZ();return(0,s.jsx)(t.In,{children:(0,s.jsxs)("div",{className:"virgil welcome-screen-decor welcome-screen-decor-hint welcome-screen-decor-hint--menu",children:[lQ,(0,s.jsx)("div",{className:"welcome-screen-decor-hint__label",children:e||C("welcomeScreen.defaults.menuHint")})]})})}).displayName="MenuHint",(CR=({children:e})=>{let{WelcomeScreenToolbarHintTunnel:t}=yZ();return(0,s.jsx)(t.In,{children:(0,s.jsxs)("div",{className:"virgil welcome-screen-decor welcome-screen-decor-hint welcome-screen-decor-hint--toolbar",children:[(0,s.jsx)("div",{className:"welcome-screen-decor-hint__label",children:e||C("welcomeScreen.defaults.toolbarHint")}),l0]})})}).displayName="ToolbarHint",(CN=({children:e})=>{let{WelcomeScreenHelpHintTunnel:t}=yZ();return(0,s.jsx)(t.In,{children:(0,s.jsxs)("div",{className:"virgil welcome-screen-decor welcome-screen-decor-hint welcome-screen-decor-hint--help",children:[(0,s.jsx)("div",{children:e||C("welcomeScreen.defaults.helpHint")}),l1]})})}).displayName="HelpHint"}),C9=tC(()=>{}),Ie=tC(()=>{tM(),C8(),C7(),C9(),(CO=e=>(0,s.jsx)(s.Fragment,{children:e.children||(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(CM,{}),(0,s.jsx)(C_,{}),(0,s.jsx)(CR,{}),(0,s.jsx)(CN,{})]})})).displayName="WelcomeScreen",CO.Center=CM,CO.Hints={MenuHint:C_,ToolbarHint:CR,HelpHint:CN},Cz=CO}),It=tC(()=>{}),In=tC(()=>{tM(),tL(),dN(),El(),It(),d8(),CB=CH=({isCollaborating:e,onSelect:t,...n})=>{let i=dp();return(0,s.jsxs)(wy,{...n,className:(0,d.Z)("collab-button",{active:e}),type:"button",onSelect:t,style:{position:"relative"},title:C("labels.liveCollaboration"),children:[rF,i.collaborators.size>0&&(0,s.jsx)("div",{className:"CollabButton-collaborators",children:i.collaborators.size})]})},CH.displayName="LiveCollaborationTrigger"}),Ii=tC(()=>{tM(),vr(),vl(),CJ(),dN(),tL(),d$(),(CF=({children:e,icon:t})=>{let{TTDDialogTriggerTunnel:n}=yZ(),i=k9();return(0,s.jsx)(n.In,{children:(0,s.jsxs)(yF.Item,{onSelect:()=>{aX("ai","dialog open","ttd"),i({openDialog:{name:"ttd",tab:"text-to-diagram"}})},icon:t??a_,children:[e??C("labels.textToDiagram"),(0,s.jsx)(yF.Item.Badge,{children:"AI"})]})})}).displayName="TTDDialogTrigger"}),Il=tC(()=>{tM(),tO(),CJ(),df(),CQ(),C1(),C0(),C2(),tL(),tR(),tj(),C6(),S6(),Ie(),In(),fG(),tL(),u1(),gy(),dx(),tR(),fB(),gx(),df(),Eu(),El(),CJ(),S7(),kw(),Ii(),dB(),mn(),kL(),uq(),gy(),Cy(),C$=e=>{let{onChange:t,initialData:n,excalidrawAPI:r,isCollaborating:a=!1,onPointerUpdate:o,renderTopRightUI:d,langCode:c=x.code,viewModeEnabled:h,zenModeEnabled:m,gridModeEnabled:u,libraryReturnUrl:f,theme:y,name:b,renderCustomStats:v,onPaste:w,detectScroll:E=!0,handleKeyboardGlobally:S=!1,onLibraryChange:k,autoFocus:C=!1,generateIdForFile:I,onLinkOpen:M,onPointerDown:j,onScrollChange:T,children:L,validateEmbeddable:D,renderEmbeddable:A,aiEnabled:P}=e,_=e.UIOptions?.canvasActions,R={...e.UIOptions,canvasActions:{...eH.canvasActions,..._},tools:{image:e.UIOptions?.tools?.image??!0}};return _?.export&&(R.canvasActions.export.saveFileToDisk=_.export?.saveFileToDisk??eH.canvasActions.export.saveFileToDisk),null===R.canvasActions.toggleTheme&&typeof y>"u"&&(R.canvasActions.toggleTheme=!0),(0,l.useEffect)(()=>{let e=e=>{"number"==typeof e.scale&&1!==e.scale&&e.preventDefault()};return document.addEventListener("touchmove",e,{passive:!1}),()=>{document.removeEventListener("touchmove",e)}},[]),(0,s.jsx)(i.zt,{unstable_createStore:()=>g,scope:p,children:(0,s.jsx)(ts,{langCode:c,theme:y,children:(0,s.jsx)(Cx,{onChange:t,initialData:n,excalidrawAPI:r,isCollaborating:a,onPointerUpdate:o,renderTopRightUI:d,langCode:c,viewModeEnabled:h,zenModeEnabled:m,gridModeEnabled:u,libraryReturnUrl:f,theme:y,name:b,renderCustomStats:v,UIOptions:R,onPaste:w,detectScroll:E,handleKeyboardGlobally:S,onLibraryChange:k,autoFocus:C,generateIdForFile:I,onLinkOpen:M,onPointerDown:j,onScrollChange:T,validateEmbeddable:D,renderEmbeddable:A,aiEnabled:!1!==P,children:L})})})},CZ=(e,t)=>{if(e.children!==t.children)return!1;let{initialData:n,UIOptions:i={},...l}=e,{initialData:r,UIOptions:a={},...s}=t,o=Object.keys(i),d=Object.keys(a);return o.length===d.length&&o.every(e=>"canvasActions"===e?Object.keys(i.canvasActions).every(e=>"export"===e&&i?.canvasActions?.export&&a?.canvasActions?.export?i.canvasActions.export.saveFileToDisk===a.canvasActions.export.saveFileToDisk:i?.canvasActions?.[e]===a?.canvasActions?.[e]):i[e]===a[e])&&ng(l,s)},(CW=l.memo(C$,CZ)).displayName="Excalidraw"});Il()}}]);